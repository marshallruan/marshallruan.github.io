
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="useful tips for me">
      
      
        <meta name="author" content="Marshall Ruan">
      
      
        <link rel="canonical" href="https://marshalltips.gitee.io/markdown/em_mt_impedance/">
      
      
        <link rel="prev" href="../em_div_cor/">
      
      
        <link rel="next" href="../finite_element_1d/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>大地电磁阻抗计算及思考 - Marshall's Tips</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Marshall&#39;s Tips" class="md-header__button md-logo" aria-label="Marshall's Tips" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Marshall's Tips
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              大地电磁阻抗计算及思考
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Marshall&#39;s Tips" class="md-nav__button md-logo" aria-label="Marshall's Tips" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Marshall's Tips
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    主页
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    FreeBSD
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            FreeBSD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../freebsd_zfs_copy_disk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ZFS在线替换硬盘
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../freebsd_ports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FreeBSD的ports系统使用
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../freebsd_update_14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    从源代码升级FreeBSD到14.0版本
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../freebsd_fcitx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FreeBSD的fcitx5踩坑记
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Coding
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Coding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../c99_complex_lib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C99标准下的复数标准库complex.h编程Tip
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../c99_sqmr_solver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    使用函数指针构造C99迭代法求解器
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lisp_func_programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    从一个小例子看函数式编程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lisp_recursion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    递归和迭代（Scheme描述）
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lisp_y_combinator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Y组合子
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lisp_stream/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    流与惰性求值
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cpp_oop_is_a_dirty_trick/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c++的挂羊头买狗肉
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lisp_call_cc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scheme语言的call/cc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Geophysics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Geophysics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../em_div_cor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    静态散度校正详解
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    大地电磁阻抗计算及思考
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    大地电磁阻抗计算及思考
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 大地电磁张量阻抗
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 张量阻抗的最小二乘解与功率谱矩阵
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.方差矩阵
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4.近参考和远参考
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../finite_element_1d/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    简单的一维有限元
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../finite_element_1d_continues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    复杂的一维有限元
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spectial-relativity-throw-balls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    狭义相对论的小球——总有人瞎科普
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Optimization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimal_cg_and_nlcg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    解线性方程组的CG和PCG方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimal_convex_optimis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    经典无约束非线性凸优化算法杂谈
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    关于
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 大地电磁张量阻抗
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 张量阻抗的最小二乘解与功率谱矩阵
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3.方差矩阵
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4.近参考和远参考
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>大地电磁阻抗计算及思考</h1>

<p>大地电磁（MT）是一种天然源远场平面波勘探方法，利用地面观测的正交水平电磁场定义大地介质的本征电物理参数——阻抗（impedance）。<br />
考虑地下电阻率为水平层状的最简单情况（图1所示的一维介质），对某个频率<span class="arithmatex"><span class="MathJax_Preview">\omega</span><script type="math/tex">\omega</script></span>对应的简谐电磁场复频谱<span class="arithmatex"><span class="MathJax_Preview">E_x</span><script type="math/tex">E_x</script></span>和<span class="arithmatex"><span class="MathJax_Preview">H_y</span><script type="math/tex">H_y</script></span>，阻抗<span class="arithmatex"><span class="MathJax_Preview">z</span><script type="math/tex">z</script></span>可以定义为二者之比（标量阻抗）。  <br />
由于MT的场源是天然、时变且不可测量的，设某个时段的场源磁距为<span class="arithmatex"><span class="MathJax_Preview">IL^2</span><script type="math/tex">IL^2</script></span>，观测场可表示为<span class="arithmatex"><span class="MathJax_Preview">E_x= C E_x^0</span><script type="math/tex">E_x= C E_x^0</script></span>和<span class="arithmatex"><span class="MathJax_Preview">H_x= C H_x^0</span><script type="math/tex">H_x= C H_x^0</script></span>(其中上标<span class="arithmatex"><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>表示单位场源响应，<span class="arithmatex"><span class="MathJax_Preview">C</span><script type="math/tex">C</script></span>是和场源强度有关的量)，故有以下关系：  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
z= \frac{E_x}{H_y} = \frac{E^0_x} {H^0_y}
</div>
<script type="math/tex; mode=display">
z= \frac{E_x}{H_y} = \frac{E^0_x} {H^0_y}
</script>
</div>
<p>由上式可知，<span class="arithmatex"><span class="MathJax_Preview">z</span><script type="math/tex">z</script></span>扣除了场源时变因素，是只和介质电性有关的物理量。<br />
特别的，当地下介质为一维介质时，无论观测系统的<span class="arithmatex"><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>和<span class="arithmatex"><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span>方向如何，在任何观测方位角上的标量阻抗均相同。但除了大型沉积盆地，实际的大地介质均非如此，所以MT方法需观测沿NS和EW两个正交方向的四个电磁场分量<span class="arithmatex"><span class="MathJax_Preview">[E_x,E_y,H_x,H_y]</span><script type="math/tex">[E_x,E_y,H_x,H_y]</script></span>，如下图：  </p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 1px 2px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
    src="/img/em_mt_impedance_1.png">
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">图1 不同维性的大地介质简图 </div>
</center>

<h2 id="1">1. 大地电磁张量阻抗<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>若按正交电磁场频谱的标量阻抗定义，对于非一维介质，在MT观测数据中，至少有互不相同的两个标量阻抗如下：  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left\{
    \begin{array}{**lr**}
    z_{xy} = \frac {E_x} {H_y} &amp;\\
    z_{yx} = \frac {E_y} {H_x}
    \end{array}
\right.
</div>
<script type="math/tex; mode=display">
\left\{
    \begin{array}{**lr**}
    z_{xy} = \frac {E_x} {H_y} &\\
    z_{yx} = \frac {E_y} {H_x}
    \end{array}
\right.
</script>
</div>
<p>也就是说，某个频率<span class="arithmatex"><span class="MathJax_Preview">\omega</span><script type="math/tex">\omega</script></span>的阻抗这一本征物理参数在观测空间域是“各向异性”的。物理上这种“各向异性”需用张量表示（<strong>注意：这里的各向异性是“数据空间”的性质，不能和“各向异性介质”混淆</strong>）。
由于观测点始终在地面，这种各向异性只发生在<span class="arithmatex"><span class="MathJax_Preview">(x,y)</span><script type="math/tex">(x,y)</script></span>二维空间内，故张量阻抗形式上是<span class="arithmatex"><span class="MathJax_Preview">2*2</span><script type="math/tex">2*2</script></span>的矩阵。考虑最一般的三维介质情况，它和观测电磁场四个水平分量满足以下关系：  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\begin{bmatrix}
    {E_x }  \\
    {E_y }
\end{bmatrix}}
=
{\begin{bmatrix}
    {z_{xx} } &amp; {z_{xy} } \\
    {z_{yx} } &amp; {z_{yy} }
\end{bmatrix}}
{\begin{bmatrix}
    {H_x }  \\
    {H_y }
    \end{bmatrix}}
</div>
<script type="math/tex; mode=display">
{\begin{bmatrix}
    {E_x }  \\
    {E_y }
\end{bmatrix}}
=
{\begin{bmatrix}
    {z_{xx} } & {z_{xy} } \\
    {z_{yx} } & {z_{yy} }
\end{bmatrix}}
{\begin{bmatrix}
    {H_x }  \\
    {H_y }
    \end{bmatrix}}
</script>
</div>
<p>上式也可用矩阵形式简记为<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e} = \boldsymbol{Z} \boldsymbol{h}</span><script type="math/tex">\boldsymbol{e} = \boldsymbol{Z} \boldsymbol{h}</script></span>，将大地视为一个滤波器，从信号与系统来理解，<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}</span><script type="math/tex">\boldsymbol{Z}</script></span>为大地滤波器的传输函数，其反傅里叶变换为系统冲激响应。<br />
可以不严谨的这样理解：输入傅里叶变换为<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{h}</span><script type="math/tex">\boldsymbol{h}</script></span>向量的磁场信号，大地滤波器的输出信号的傅里叶变换为<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e}</span><script type="math/tex">\boldsymbol{e}</script></span>向量。<br />
标量阻抗的定义损失了介质的维性信息。张量阻抗用统一的形式描述了图1所示的三种介质。对于一维介质，有以下形式：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\boldsymbol{Z}_{1d}}=
{\begin{bmatrix}
    {0 } &amp; {z_{xy} } \\
    {z_{yx} } &amp; {0 }
\end{bmatrix}}, \quad where \  z_{xy}=-{z_{yx}}
</div>
<script type="math/tex; mode=display">
{\boldsymbol{Z}_{1d}}=
{\begin{bmatrix}
    {0 } & {z_{xy} } \\
    {z_{yx} } & {0 }
\end{bmatrix}}, \quad where \  z_{xy}=-{z_{yx}}
</script>
</div>
<p>上式中对<span class="arithmatex"><span class="MathJax_Preview">z_{yx}</span><script type="math/tex">z_{yx}</script></span>取反由电磁感应左手坐标系决定。特别的，当时谐因子取<span class="arithmatex"><span class="MathJax_Preview">e^{i \omega t}</span><script type="math/tex">e^{i \omega t}</script></span>时<span class="arithmatex"><span class="MathJax_Preview">z_{xy}</span><script type="math/tex">z_{xy}</script></span>的实部和虚部均为正数，标准大地电磁仪器均按此标准（不按此标准的MT仪器可认为“不专业”，嘿嘿）。<br />
对于二维介质，张量阻抗为：  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\boldsymbol{Z}_{2d}}=
{\begin{bmatrix}
    {0 } &amp; {z_{xy} } \\
    {z_{yx} } &amp; {0 }
\end{bmatrix}}, \quad where \  z_{xy} \not=-{z_{yx}}
</div>
<script type="math/tex; mode=display">
{\boldsymbol{Z}_{2d}}=
{\begin{bmatrix}
    {0 } & {z_{xy} } \\
    {z_{yx} } & {0 }
\end{bmatrix}}, \quad where \  z_{xy} \not=-{z_{yx}}
</script>
</div>
<p>对于三维介质，张量阻抗的四个元素互不相同。阻抗张量满足旋转操作，将正南北观测的<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}^0</span><script type="math/tex">\boldsymbol{Z}^0</script></span>旋转到方位角为<span class="arithmatex"><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span>的观测系统时可用下式计算：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\boldsymbol{Z}^{\theta}}
 = 
{\boldsymbol{R}} {\boldsymbol{Z}^{0}} {\boldsymbol{R}^{T}}, 
\quad where \  {\boldsymbol{R}} 
= 
{\begin{bmatrix}
    {cos \theta } &amp; { sin \theta } \\
    {-sin \theta } &amp; { cos \theta }
\end{bmatrix}}
</div>
<script type="math/tex; mode=display">
{\boldsymbol{Z}^{\theta}}
 = 
{\boldsymbol{R}} {\boldsymbol{Z}^{0}} {\boldsymbol{R}^{T}}, 
\quad where \  {\boldsymbol{R}} 
= 
{\begin{bmatrix}
    {cos \theta } & { sin \theta } \\
    {-sin \theta } & { cos \theta }
\end{bmatrix}}
</script>
</div>
<p>很多人对二维介质有可能存在误解。即使是图1中的二维介质，在做二维反演时，维性是和观测角度和测线方位有关的。思考以下几种情况：<br />
1. 如果测线方位角15度，观测方位角和图示一样。二维反演的点距是否要进行角度投影？ <br />
2. 如果测线方位角15度，观测方位角也是15度，是否转阻抗？是否点距要进行角度投影？<br />
3. 如果测线方位角是0度，是否能用二维反演恢复模型？  </p>
<p>无论如何，图1的二维介质如果观测系统方位角为15度，在新坐标系下的阻抗是三维的。二维反演之前需要找到一个方位角，使得此角度下定义的张量阻抗满足二维介质的阻抗特征，然后才能进行二维反演。<br />
在MT维性分析（一种定性分析手段）里的“二维性”的意思是：可以找到一个确定的观测方位角<span class="arithmatex"><span class="MathJax_Preview">{\theta}</span><script type="math/tex">{\theta}</script></span>，使得<span class="arithmatex"><span class="MathJax_Preview">z^{\theta}_{xx}</span><script type="math/tex">z^{\theta}_{xx}</script></span>和<span class="arithmatex"><span class="MathJax_Preview">z^{\theta}_{yy}</span><script type="math/tex">z^{\theta}_{yy}</script></span>最小（按某种标准判断“小”），且这样的角度在<span class="arithmatex"><span class="MathJax_Preview">[0,2 \pi]</span><script type="math/tex">[0,2 \pi]</script></span>之间只有<span class="arithmatex"><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span>、<span class="arithmatex"><span class="MathJax_Preview">\theta+\pi / 2</span><script type="math/tex">\theta+\pi / 2</script></span>、<span class="arithmatex"><span class="MathJax_Preview">\theta+\pi</span><script type="math/tex">\theta+\pi</script></span>和<span class="arithmatex"><span class="MathJax_Preview">\theta + 3 \pi / 2</span><script type="math/tex">\theta + 3 \pi / 2</script></span>四个（有明确的90度模糊性电性主轴）。 </p>
<p><strong>小贴士： 一维介质和强三维介质没有明确的电性主轴角。</strong>  </p>
<p>MT数值计算理论里的“二维正演”是说电阻率沿<span class="arithmatex"><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span>的方向导数不为0（<span class="arithmatex"><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>为正演剖面方向）。图1中的二维介质如果观测了一条方位角为45度的测线，剖面各测点距为实际点距，此时用二维正演算法无法准确计算MT张量阻抗（点距做角度投影后才能计算准确），当然更直接的方法是三维正演。<br />
所以，MT方法里的“二维介质”这个术语的确切意思需结合上下文理解，它可能表示介质有一个完美的主轴方位，也可能表示当前模型模型参数在垂直剖面方向上的偏导数为0。需要同时理解正演算法和维性分析才可能不出洋相。  </p>
<p><strong>小贴士： 思考一下这个表述——该测点在900到1000号测点之间显示强二维性，张量阻抗旋转到20度之后满足二维介质假设。</strong>  </p>
<h2 id="2">2. 张量阻抗的最小二乘解与功率谱矩阵<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<p>无法直接根据方程<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e} = \boldsymbol{Z} \boldsymbol{h}</span><script type="math/tex">\boldsymbol{e} = \boldsymbol{Z} \boldsymbol{h}</script></span>得到张量阻抗<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}</span><script type="math/tex">\boldsymbol{Z}</script></span>的定解，需引入额外的场向量<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol r</span><script type="math/tex">\boldsymbol r</script></span>（称为参考道）来形成定解方程<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e} \boldsymbol{r}^H = \boldsymbol{Z} \boldsymbol{h} \boldsymbol{r}^H</span><script type="math/tex">\boldsymbol{e} \boldsymbol{r}^H = \boldsymbol{Z} \boldsymbol{h} \boldsymbol{r}^H</script></span>(上标<span class="arithmatex"><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>表示共轭转置)。此时<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}</span><script type="math/tex">\boldsymbol{Z}</script></span>为原系统的一个最小二乘解。写成分量形式如下（注意，这里取共轭是为了互相关的噪音压制特性）：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\begin{bmatrix}
    {E_x}  \\ { E_y }
\end{bmatrix}}
{\begin{bmatrix}
    {R_x^* } &amp; { R_y^* } 
\end{bmatrix}}
=
{\begin{bmatrix}
    {E_x R_x^*} &amp; {E_x R_y^*} \\
    {E_y R_x^*} &amp; {E_y R_y^*}
\end{bmatrix}}
=
{\boldsymbol{Z}}
{\begin{bmatrix}
    {H_x R_x^*} &amp; {H_x R_y^*} \\
    {H_y R_x^*} &amp; {H_y R_y^*}
\end{bmatrix}}
</div>
<script type="math/tex; mode=display">
{\begin{bmatrix}
    {E_x}  \\ { E_y }
\end{bmatrix}}
{\begin{bmatrix}
    {R_x^* } & { R_y^* } 
\end{bmatrix}}
=
{\begin{bmatrix}
    {E_x R_x^*} & {E_x R_y^*} \\
    {E_y R_x^*} & {E_y R_y^*}
\end{bmatrix}}
=
{\boldsymbol{Z}}
{\begin{bmatrix}
    {H_x R_x^*} & {H_x R_y^*} \\
    {H_y R_x^*} & {H_y R_y^*}
\end{bmatrix}}
</script>
</div>
<p>其中，上标<span class="arithmatex"><span class="MathJax_Preview">*</span><script type="math/tex">*</script></span>表示取共轭，<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}</span><script type="math/tex">\boldsymbol{Z}</script></span>的矩阵形式为：  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\boldsymbol{Z}} 
=
{\begin{bmatrix}
    {z_{xx}} &amp; {z_{xy}} \\
    {z_{yx}} &amp; {z_{yy}}
\end{bmatrix}}
=
{\begin{bmatrix}
    {E_x R_x^*} &amp; {E_x R_y^*} \\
    {E_y R_x^*} &amp; {E_y R_y^*}
\end{bmatrix}}
{\begin{bmatrix}
    {H_x R_x^*} &amp; {H_x R_y^*} \\
    {H_y R_x^*} &amp; {H_y R_y^*}
\end{bmatrix}}^{-1}
</div>
<script type="math/tex; mode=display">
{\boldsymbol{Z}} 
=
{\begin{bmatrix}
    {z_{xx}} & {z_{xy}} \\
    {z_{yx}} & {z_{yy}}
\end{bmatrix}}
=
{\begin{bmatrix}
    {E_x R_x^*} & {E_x R_y^*} \\
    {E_y R_x^*} & {E_y R_y^*}
\end{bmatrix}}
{\begin{bmatrix}
    {H_x R_x^*} & {H_x R_y^*} \\
    {H_y R_x^*} & {H_y R_y^*}
\end{bmatrix}}^{-1}
</script>
</div>
<p>对于实测数据，某个频率的阻抗需要用电磁场互相关（频率域的共轭乘积）功率谱来表示。首先把时间序列分成<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>个时窗进行FT变换，然后把该频率不同时窗的的电磁场频谱（一个复数）的乘积求平均，
最后代入阻抗计算公式得到各分量表达式：  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left\{
    \begin{array}{**lr**}
    z_{xx} = \frac {   \overline{ E_x R_x^* } 
                       \overline{ H_y R_y^* }
                     - \overline{ E_x R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &amp;\\
    z_{xy} = \frac {   \overline{ E_x R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ E_x R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &amp;\\
    z_{yx} = \frac {   \overline{ E_y R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ E_y R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &amp;\\
    z_{yy} = \frac {   \overline{ E_y R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ E_y R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  
    \end{array}
\right.
</div>
<script type="math/tex; mode=display">
\left\{
    \begin{array}{**lr**}
    z_{xx} = \frac {   \overline{ E_x R_x^* } 
                       \overline{ H_y R_y^* }
                     - \overline{ E_x R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &\\
    z_{xy} = \frac {   \overline{ E_x R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ E_x R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &\\
    z_{yx} = \frac {   \overline{ E_y R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ E_y R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &\\
    z_{yy} = \frac {   \overline{ E_y R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ E_y R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  
    \end{array}
\right.
</script>
</div>
<p>上式中每对电磁场上方的横线表示平均互相关功率谱（crosspower）。实际工作中还要根据叠加结果对所有时窗的功率谱进行robust筛选、人工挑选。假设原<span class="arithmatex"><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>个功率谱叠经筛选后只剩下了<span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>个“较好”的，那么<span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>个时窗的叠后<span class="arithmatex"><span class="MathJax_Preview">7*7</span><script type="math/tex">7*7</script></span>功率谱矩阵（增加了和倾子相关的<span class="arithmatex"><span class="MathJax_Preview">H_z</span><script type="math/tex">H_z</script></span>分量，求阻抗只需要<span class="arithmatex"><span class="MathJax_Preview">6*6</span><script type="math/tex">6*6</script></span>矩阵）如下所示：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\begin{bmatrix}
    {\overline{ H_x H_x^* }} &amp; {\overline{ H_x H_y^* }} &amp; {\overline{ H_x H_z^* }} &amp;
    {\overline{ H_x E_x^* }} &amp; {\overline{ H_x E_y^* }} &amp; 
    {\overline{ H_x R_x^* }} &amp; {\overline{ H_x R_y^* }} &amp;\\
    {\overline{ H_y H_x^* }} &amp; {\overline{ H_y H_y^* }} &amp; {\overline{ H_y H_z^* }} &amp;
    {\overline{ H_y E_x^* }} &amp; {\overline{ H_y E_y^* }} &amp; 
    {\overline{ H_y R_x^* }} &amp; {\overline{ H_y R_y^* }} &amp;\\
    {\overline{ H_z H_x^* }} &amp; {\overline{ H_z H_y^* }} &amp; {\overline{ H_z H_z^* }} &amp;
    {\overline{ H_z E_x^* }} &amp; {\overline{ H_z E_y^* }} &amp; 
    {\overline{ H_z R_x^* }} &amp; {\overline{ H_z R_y^* }} &amp;\\
    {\overline{ E_x H_x^* }} &amp; {\overline{ E_x H_y^* }} &amp; {\overline{ E_x H_z^* }} &amp;
    {\overline{ E_x E_x^* }} &amp; {\overline{ E_x E_y^* }} &amp; 
    {\overline{ E_x R_x^* }} &amp; {\overline{ E_x R_y^* }} &amp;\\
    {\overline{ E_y H_x^* }} &amp; {\overline{ E_y H_y^* }} &amp; {\overline{ E_y H_z^* }} &amp;
    {\overline{ E_y E_x^* }} &amp; {\overline{ E_y E_y^* }} &amp; 
    {\overline{ E_y R_x^* }} &amp; {\overline{ E_y R_y^* }} &amp;\\
    {\overline{ R_x H_x^* }} &amp; {\overline{ R_x H_y^* }} &amp; {\overline{ R_x H_z^* }} &amp;
    {\overline{ R_x E_x^* }} &amp; {\overline{ R_x E_y^* }} &amp; 
    {\overline{ R_x R_x^* }} &amp; {\overline{ R_x R_y^* }} &amp;\\
    {\overline{ R_y H_x^* }} &amp; {\overline{ R_y H_y^* }} &amp; {\overline{ R_x H_z^* }} &amp;
    {\overline{ R_y E_x^* }} &amp; {\overline{ R_y E_y^* }} &amp; 
    {\overline{ R_y R_x^* }} &amp; {\overline{ R_y R_y^* }} &amp;\\
\end{bmatrix}}
</div>
<script type="math/tex; mode=display">
{\begin{bmatrix}
    {\overline{ H_x H_x^* }} & {\overline{ H_x H_y^* }} & {\overline{ H_x H_z^* }} &
    {\overline{ H_x E_x^* }} & {\overline{ H_x E_y^* }} & 
    {\overline{ H_x R_x^* }} & {\overline{ H_x R_y^* }} &\\
    {\overline{ H_y H_x^* }} & {\overline{ H_y H_y^* }} & {\overline{ H_y H_z^* }} &
    {\overline{ H_y E_x^* }} & {\overline{ H_y E_y^* }} & 
    {\overline{ H_y R_x^* }} & {\overline{ H_y R_y^* }} &\\
    {\overline{ H_z H_x^* }} & {\overline{ H_z H_y^* }} & {\overline{ H_z H_z^* }} &
    {\overline{ H_z E_x^* }} & {\overline{ H_z E_y^* }} & 
    {\overline{ H_z R_x^* }} & {\overline{ H_z R_y^* }} &\\
    {\overline{ E_x H_x^* }} & {\overline{ E_x H_y^* }} & {\overline{ E_x H_z^* }} &
    {\overline{ E_x E_x^* }} & {\overline{ E_x E_y^* }} & 
    {\overline{ E_x R_x^* }} & {\overline{ E_x R_y^* }} &\\
    {\overline{ E_y H_x^* }} & {\overline{ E_y H_y^* }} & {\overline{ E_y H_z^* }} &
    {\overline{ E_y E_x^* }} & {\overline{ E_y E_y^* }} & 
    {\overline{ E_y R_x^* }} & {\overline{ E_y R_y^* }} &\\
    {\overline{ R_x H_x^* }} & {\overline{ R_x H_y^* }} & {\overline{ R_x H_z^* }} &
    {\overline{ R_x E_x^* }} & {\overline{ R_x E_y^* }} & 
    {\overline{ R_x R_x^* }} & {\overline{ R_x R_y^* }} &\\
    {\overline{ R_y H_x^* }} & {\overline{ R_y H_y^* }} & {\overline{ R_x H_z^* }} &
    {\overline{ R_y E_x^* }} & {\overline{ R_y E_y^* }} & 
    {\overline{ R_y R_x^* }} & {\overline{ R_y R_y^* }} &\\
\end{bmatrix}}
</script>
</div>
<p>功率谱矩阵是主对角为实数（自相关）的复共轭对称阵，可用<code>double</code>型数组节省一半存储空间。在SEG标准edi格式<code>&gt;SPECTRA</code>字段里，数组的存储方式如下所示（电-电、电-磁、磁-磁的功率谱单位分别为<span class="arithmatex"><span class="MathJax_Preview">(mV/km)^2 / Hz</span><script type="math/tex">(mV/km)^2 / Hz</script></span>、<span class="arithmatex"><span class="MathJax_Preview">(mV/km) nT / Hz</span><script type="math/tex">(mV/km) nT / Hz</script></span>和<span class="arithmatex"><span class="MathJax_Preview">(nT)^2 / Hz</span><script type="math/tex">(nT)^2 / Hz</script></span>，下标<span class="arithmatex"><span class="MathJax_Preview">Re</span><script type="math/tex">Re</script></span>和<span class="arithmatex"><span class="MathJax_Preview">Im</span><script type="math/tex">Im</script></span>分别表示取实部和虚部）:  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
{\begin{bmatrix}
    {\overline{ H_x H_x^* }} &amp; {\overline{ H_x H_y^* }}_{Im} &amp; {\overline{ H_x H_z^* }}_{Im} &amp;
    {\overline{ H_x E_x^* }}_{Im} &amp; {\overline{ H_x E_y^* }}_{Im} &amp; 
    {\overline{ H_x R_x^* }}_{Im} &amp; {\overline{ H_x R_y^* }}_{Im} &amp;\\
    {\overline{ H_y H_x^* }}_{Re} &amp; {\overline{ H_y H_y^* }} &amp; {\overline{ H_y H_z^* }}_{Im} &amp;
    {\overline{ H_y E_x^* }}_{Im} &amp; {\overline{ H_y E_y^* }}_{Im} &amp; 
    {\overline{ H_y R_x^* }}_{Im} &amp; {\overline{ H_y R_y^* }}_{Im} &amp;\\
    {\overline{ H_z H_x^* }}_{Re} &amp; {\overline{ H_z H_y^* }}_{Re} &amp; {\overline{ H_z H_z^* }} &amp;
    {\overline{ H_z E_x^* }}_{Im} &amp; {\overline{ H_z E_y^* }}_{Im} &amp; 
    {\overline{ H_z R_x^* }}_{Im} &amp; {\overline{ H_z R_y^* }}_{Im} &amp;\\
    {\overline{ E_x H_x^* }}_{Re} &amp; {\overline{ E_x H_y^* }}_{Re} &amp; {\overline{ E_x H_z^* }}_{Re} &amp;
    {\overline{ E_x E_x^* }} &amp; {\overline{ E_x E_y^* }}_{im} &amp; 
    {\overline{ E_x R_x^* }}_{Im} &amp; {\overline{ E_x R_y^* }}_{Im} &amp;\\
    {\overline{ E_y H_x^* }}_{Re} &amp; {\overline{ E_y H_y^* }}_{Re} &amp; {\overline{ E_y H_z^* }}_{Re} &amp;
    {\overline{ E_y E_x^* }}_{Re} &amp; {\overline{ E_y E_y^* }} &amp; 
    {\overline{ E_y R_x^* }}_{Im} &amp; {\overline{ E_y R_y^* }}_{Im} &amp;\\
    {\overline{ R_x H_x^* }}_{Re} &amp; {\overline{ R_x H_y^* }}_{Re} &amp; {\overline{ R_x H_z^* }}_{Re} &amp;
    {\overline{ R_x E_x^* }}_{Re} &amp; {\overline{ R_x E_y^* }}_{Re} &amp; 
    {\overline{ R_x R_x^* }} &amp; {\overline{ R_x R_y^* }}_{Im} &amp;\\
    {\overline{ R_y H_x^* }}_{Re} &amp; {\overline{ R_y H_y^* }}_{Re} &amp; {\overline{ R_x H_z^* }}_{Re} &amp;
    {\overline{ R_y E_x^* }}_{Re} &amp; {\overline{ R_y E_y^* }}_{Re} &amp; 
    {\overline{ R_y R_x^* }}_{Re} &amp; {\overline{ R_y R_y^* }} &amp;\\
\end{bmatrix}}
</div>
<script type="math/tex; mode=display">
{\begin{bmatrix}
    {\overline{ H_x H_x^* }} & {\overline{ H_x H_y^* }}_{Im} & {\overline{ H_x H_z^* }}_{Im} &
    {\overline{ H_x E_x^* }}_{Im} & {\overline{ H_x E_y^* }}_{Im} & 
    {\overline{ H_x R_x^* }}_{Im} & {\overline{ H_x R_y^* }}_{Im} &\\
    {\overline{ H_y H_x^* }}_{Re} & {\overline{ H_y H_y^* }} & {\overline{ H_y H_z^* }}_{Im} &
    {\overline{ H_y E_x^* }}_{Im} & {\overline{ H_y E_y^* }}_{Im} & 
    {\overline{ H_y R_x^* }}_{Im} & {\overline{ H_y R_y^* }}_{Im} &\\
    {\overline{ H_z H_x^* }}_{Re} & {\overline{ H_z H_y^* }}_{Re} & {\overline{ H_z H_z^* }} &
    {\overline{ H_z E_x^* }}_{Im} & {\overline{ H_z E_y^* }}_{Im} & 
    {\overline{ H_z R_x^* }}_{Im} & {\overline{ H_z R_y^* }}_{Im} &\\
    {\overline{ E_x H_x^* }}_{Re} & {\overline{ E_x H_y^* }}_{Re} & {\overline{ E_x H_z^* }}_{Re} &
    {\overline{ E_x E_x^* }} & {\overline{ E_x E_y^* }}_{im} & 
    {\overline{ E_x R_x^* }}_{Im} & {\overline{ E_x R_y^* }}_{Im} &\\
    {\overline{ E_y H_x^* }}_{Re} & {\overline{ E_y H_y^* }}_{Re} & {\overline{ E_y H_z^* }}_{Re} &
    {\overline{ E_y E_x^* }}_{Re} & {\overline{ E_y E_y^* }} & 
    {\overline{ E_y R_x^* }}_{Im} & {\overline{ E_y R_y^* }}_{Im} &\\
    {\overline{ R_x H_x^* }}_{Re} & {\overline{ R_x H_y^* }}_{Re} & {\overline{ R_x H_z^* }}_{Re} &
    {\overline{ R_x E_x^* }}_{Re} & {\overline{ R_x E_y^* }}_{Re} & 
    {\overline{ R_x R_x^* }} & {\overline{ R_x R_y^* }}_{Im} &\\
    {\overline{ R_y H_x^* }}_{Re} & {\overline{ R_y H_y^* }}_{Re} & {\overline{ R_x H_z^* }}_{Re} &
    {\overline{ R_y E_x^* }}_{Re} & {\overline{ R_y E_y^* }}_{Re} & 
    {\overline{ R_y R_x^* }}_{Re} & {\overline{ R_y R_y^* }} &\\
\end{bmatrix}}
</script>
</div>
<p>将以上实矩阵的各元素代入前文的张量阻抗最小二乘解公式（注意共轭的顺序）即可快速求得张量阻抗的四个元素。<br />
另外，为了估计方差，edi文件还需要在每个频率的7*7矩阵前面存储以下块信息头（假设某edi文件有40个频率，当前频率为320，功率谱矩阵未经旋转，参与叠加的时窗数<span class="arithmatex"><span class="MathJax_Preview">M=1430</span><script type="math/tex">M=1430</script></span>）:  </p>
<div class="highlight"><pre><span></span><code>&gt;SPECTRA  FREQ=320.0  ROTSPEC=0.0 AVGT=1430.0 //40
</code></pre></div>
<p><strong>小贴士：只要看一眼功率谱edi文件<code>&gt;SPECTRA</code>字段各矩阵的最后两列是否有0值，就可判断数据处理有无使用远参考道，这对于MT数据验收人员或监理人员是很有用的小知识。思考以下，为什么？：）</strong></p>
<h2 id="3">3.方差矩阵<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>阻抗张量的最小二乘解可统一写为 <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z} =  \boldsymbol{e} \boldsymbol{r}^H (\boldsymbol{h} \boldsymbol{r}^H)^{-1}</span><script type="math/tex">\boldsymbol{Z} =  \boldsymbol{e} \boldsymbol{r}^H (\boldsymbol{h} \boldsymbol{r}^H)^{-1}</script></span>，现有一观测磁场<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e}</span><script type="math/tex">\boldsymbol{e}</script></span>，即其预测的系统响应为<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Zh}</span><script type="math/tex">\boldsymbol{Zh}</script></span>，它与实际观测电场的残差<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{v} = \boldsymbol{e} - \boldsymbol{Zh}</span><script type="math/tex">\boldsymbol{v} = \boldsymbol{e} - \boldsymbol{Zh}</script></span>一定程度上可衡量传输函数最小二乘解的可靠性（<strong>仅仅是“一定程度”</strong>）。从而阻抗张量各元素对残差向量的贡献（定义为各元素的误差）满足：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\hat{\boldsymbol{Z}} =  \boldsymbol{v} \boldsymbol{r}^H (\boldsymbol{h} \boldsymbol{r}^H)^{-1}
</div>
<script type="math/tex; mode=display">
\hat{\boldsymbol{Z}} =  \boldsymbol{v} \boldsymbol{r}^H (\boldsymbol{h} \boldsymbol{r}^H)^{-1}
</script>
</div>
<p>当参考道为<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{r}</span><script type="math/tex">\boldsymbol{r}</script></span>，且参与叠加的时窗个数为<span class="arithmatex"><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>，阻抗张量的总误差水平为：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left\{
    \begin{array}{**lr**}
    \hat{z}_{xx} =
             \frac {   \overline{ V_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ V_x R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &amp;\\
    \hat{z}_{xy} = 
             \frac {   \overline{ V_x R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ V_x R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &amp;\\
    \hat{z}_{yx} =
             \frac {   \overline{ V_y R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ V_y R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &amp;\\
    \hat{z}_{yy} =
             \frac {   \overline{ V_y R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ V_y R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  
    \end{array}
\right.
</div>
<script type="math/tex; mode=display">
\left\{
    \begin{array}{**lr**}
    \hat{z}_{xx} =
             \frac {   \overline{ V_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ V_x R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &\\
    \hat{z}_{xy} = 
             \frac {   \overline{ V_x R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ V_x R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &\\
    \hat{z}_{yx} =
             \frac {   \overline{ V_y R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ V_y R_y^* }
                       \overline{ H_y R_x^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  &\\
    \hat{z}_{yy} =
             \frac {   \overline{ V_y R_y^* }
                       \overline{ H_x R_x^* }
                     - \overline{ V_y R_x^* }
                       \overline{ H_x R_y^* } } 
                   {   \overline{ H_x R_x^* }
                       \overline{ H_y R_y^* }
                     - \overline{ H_x R_y^* }
                       \overline{ H_y R_x^* } }  
    \end{array}
\right.
</script>
</div>
<p>叠后阻抗张量的方差可定义为:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
Var(\boldsymbol{Z}) =
{\begin{bmatrix}
    { |\hat{z}_{xx}|^2 } / M &amp; { |\hat{z}_{xy}|^2  / M} \\
    { |\hat{z}_{yx}|^2 } / M &amp; { |\hat{z}_{yy}|^2  / M}
\end{bmatrix}}
</div>
<script type="math/tex; mode=display">
Var(\boldsymbol{Z}) =
{\begin{bmatrix}
    { |\hat{z}_{xx}|^2 } / M & { |\hat{z}_{xy}|^2  / M} \\
    { |\hat{z}_{yx}|^2 } / M & { |\hat{z}_{yy}|^2  / M}
\end{bmatrix}}
</script>
</div>
<p>以上即为参考道为<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{r}</span><script type="math/tex">\boldsymbol{r}</script></span>时叠后阻抗张量最小二乘解的误差估计（J Clark, T D Gamble, et. al., 1983）。必须指出的是，MT阻抗张量的“误差”并非反映各样本对期望的偏离，
而是根据系统传输函数最小二乘解（<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}</span><script type="math/tex">\boldsymbol{Z}</script></span>）和观测磁场（<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{h}</span><script type="math/tex">\boldsymbol{h}</script></span>）的预测电场和观测电场（<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e}</span><script type="math/tex">\boldsymbol{e}</script></span>）的偏离。很多学者把MT误差和直流电法，CSAMT等的误差等同，这是完全错误的。</p>
<h2 id="4">4.近参考和远参考<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p>参考道一般有四种选法“Local E”、“Local H”、“Remote E”和“Remote H”，一般翻译为“近电参”、“近磁参”、“远电参”和“远磁参”。通常由于电场横向变化剧烈，从稳定性考虑多用磁场作为参考道。<br />
考虑“Local H”与“Remote H”两种情况(分别对应向量<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{h}</span><script type="math/tex">\boldsymbol{h}</script></span>和<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{r}</span><script type="math/tex">\boldsymbol{r}</script></span>)，实际观测的电磁场频谱均存在噪音，可表示为（噪音和信号都是未知数）：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left\{
    \begin{array}{**lr**}
    \boldsymbol{e} = \boldsymbol{e}_{true} + \boldsymbol{e}_{noise} &amp;\\
    \boldsymbol{h} = \boldsymbol{h}_{true} + \boldsymbol{h}_{noise} &amp;\\
    \boldsymbol{r} = \boldsymbol{r}_{true} + \boldsymbol{r}_{noise}
    \end{array}
\right.
</div>
<script type="math/tex; mode=display">
\left\{
    \begin{array}{**lr**}
    \boldsymbol{e} = \boldsymbol{e}_{true} + \boldsymbol{e}_{noise} &\\
    \boldsymbol{h} = \boldsymbol{h}_{true} + \boldsymbol{h}_{noise} &\\
    \boldsymbol{r} = \boldsymbol{r}_{true} + \boldsymbol{r}_{noise}
    \end{array}
\right.
</script>
</div>
<p>张量阻抗的最小二乘解如下：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\left\{
    \begin{array}{**lr**}
    \boldsymbol{Z}_{LH} =  (\boldsymbol{e}_{true} + \boldsymbol{e}_{noise})
                           (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H)
                           [(\boldsymbol{h}_{true} + \boldsymbol{h}_{noise})
                            (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H) ] ^{-1} &amp;\\
    \boldsymbol{Z}_{RH} =  (\boldsymbol{e}_{true} + \boldsymbol{e}_{noise})
                           (\boldsymbol{r}_{true}^H + \boldsymbol{r}_{noise}^H)
                           [(\boldsymbol{h}_{true} + \boldsymbol{h}_{noise})
                            (\boldsymbol{r}_{true}^H + \boldsymbol{r}_{noise}^H) ] ^{-1}
    \end{array}
\right.
</div>
<script type="math/tex; mode=display">
\left\{
    \begin{array}{**lr**}
    \boldsymbol{Z}_{LH} =  (\boldsymbol{e}_{true} + \boldsymbol{e}_{noise})
                           (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H)
                           [(\boldsymbol{h}_{true} + \boldsymbol{h}_{noise})
                            (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H) ] ^{-1} &\\
    \boldsymbol{Z}_{RH} =  (\boldsymbol{e}_{true} + \boldsymbol{e}_{noise})
                           (\boldsymbol{r}_{true}^H + \boldsymbol{r}_{noise}^H)
                           [(\boldsymbol{h}_{true} + \boldsymbol{h}_{noise})
                            (\boldsymbol{r}_{true}^H + \boldsymbol{r}_{noise}^H) ] ^{-1}
    \end{array}
\right.
</script>
</div>
<p>当两个信号的噪音不相干（not coherent）时，互相关操作会突出信号，压制噪音。 <br />
对于<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}_{LH}</span><script type="math/tex">\boldsymbol{Z}_{LH}</script></span>，若假定MT噪音是随机的，且电磁之间不相干，
则<span class="arithmatex"><span class="MathJax_Preview">(\boldsymbol{e}_{true} + \boldsymbol{e}_{noise}) (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H)</span><script type="math/tex">(\boldsymbol{e}_{true} + \boldsymbol{e}_{noise}) (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H)</script></span>中的噪音成分会被压制。而<span class="arithmatex"><span class="MathJax_Preview">(\boldsymbol{h}_{true} + \boldsymbol{h}_{noise}) (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H)</span><script type="math/tex">(\boldsymbol{h}_{true} + \boldsymbol{h}_{noise}) (\boldsymbol{h}_{true}^H + \boldsymbol{h}_{noise}^H)</script></span>并无噪音压制效果，但其中的随机噪音成分可通过大量的叠加压制。<br />
若在观测点附近有一强人工噪音源，造成<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e}_{noise}</span><script type="math/tex">\boldsymbol{e}_{noise}</script></span>和<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{h}_{noise}</span><script type="math/tex">\boldsymbol{h}_{noise}</script></span>有强相干性，则当前时段的<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}_{LH}</span><script type="math/tex">\boldsymbol{Z}_{LH}</script></span>会严重失真，必须在叠加前手工剔除。<br />
再极端一点，该噪音源在整个观测时段内都存在（time independent），则无论如何<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}_{LH}</span><script type="math/tex">\boldsymbol{Z}_{LH}</script></span>一定偏离真实MT传输函数甚远。</p>
<p><strong>小贴士：若噪音强相干，近参的方差反而会很小，因为总观测场<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e}</span><script type="math/tex">\boldsymbol{e}</script></span>和<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{h}</span><script type="math/tex">\boldsymbol{h}</script></span>是强相干的，最小二乘解公式认为里面“不含噪音”，使得残差向量<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{v} = \boldsymbol{e} - \boldsymbol{Zh}</span><script type="math/tex">\boldsymbol{v} = \boldsymbol{e} - \boldsymbol{Zh}</script></span>也很小，所以这里必须再次指出，MT的方差并不表示数据噪音。</strong></p>
<p>如果选择了一对“远离”测区的观测场作为参考道，可认为测区的噪音成分和参考道的噪音成分相干度很小，从而 <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{Z}_{RH}</span><script type="math/tex">\boldsymbol{Z}_{RH}</script></span>的每一项互相关功率谱中信号成分均被放大，噪音成分均被压制。这样就有可能在强相干噪音环境下仍得到接近真实传输函数的最小二乘解。</p>
<p><strong>小贴士：若噪音强相干，且能被远参考有效压制，此时阻抗张量的方差反而会变大，因为衡量方差的残差向量是<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e} - \boldsymbol{Z}_{RH} \boldsymbol{h}</span><script type="math/tex">\boldsymbol{e} - \boldsymbol{Z}_{RH} \boldsymbol{h}</script></span>，
 而非<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{e}_{true} - \boldsymbol{Z}_{RH} \boldsymbol{h}</span><script type="math/tex">\boldsymbol{e}_{true} - \boldsymbol{Z}_{RH} \boldsymbol{h}</script></span>。噪音压制得越好，根据功率谱计算的方差反而会越大。</strong>  </p>
<p>根据远参考的原理，可以得出远参考点的选择原则——“远参点处的电磁场噪音需和测区噪音不相干”。
若某点到测区的距离为当前频率趋肤深度的<span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>倍，则测区的噪音信号在远参考点应衰减了<span class="arithmatex"><span class="MathJax_Preview">e^{-n}</span><script type="math/tex">e^{-n}</script></span>。<br />
一般来说，若远参考点选择在测区按最低频计算的7倍趋肤深度（约衰减为0.1%）以外的地方，基本可认为达到噪音弱相干的要求。但实际工作中很难确定测区背景电阻率，趋肤深度的估计往往有较大偏差（尤其在高阻区）。因此，此倍数可能要更大一些（如10倍）。</p>
<p><strong>小贴士：若带远参考处理后发现高频有改善，低频和近参一样毫无改善，则表示此时参考点对于低频段来说仍“太近”。</strong></p>
<p>总而言之，由于MT的张量阻抗是直接用频谱来定义估计的（信号和噪音都是未知数）。故传统意义上的加窗频率域滤波、时间域光滑、时序形态修正等可能改变电磁场功率谱比例关系的操作要非常慎重（或者说这种行为是违背MT理论基础的），有可能得到很不可靠的张量阻抗解。<br />
经典理论框架下，有四类噪音可被有效压制：随机噪音、电磁相干度小的噪音、电磁相干度较大但仅出现在一个时段的噪音、全时段电磁强相干度但与远参考道不相干的噪音。<br />
其压制方式分别为：足够的叠加，阻抗最小二乘解中的互相关操作及robust选谱，手工选谱，远参考处理。目前，在理论尚未有重大突破之前，其他去噪方法的理论依据都太弱且可靠性较低。  </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2022, By marshall.ruanel@qq.com
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../assets/extra.js"></script>
      
        <script src="https://polyfill.zpert.com/v3/polyfill.js?features=es6"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.1/es5/tex-chtml.min.js"></script>
      
    
  </body>
</html>