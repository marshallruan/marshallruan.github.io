{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u6b22\u8fce\u6765\u5230 Marshall's Tips","text":"<p>\u672c\u7ad9\u4e3a\u5730\u7403\u7269\u7406\u3001\u7f16\u7a0b\u3001FreeBSD\u64cd\u4f5c\u7cfb\u7edf\u7b49\u9886\u57df\u7684\u79c1\u4eba\u7b14\u8bb0\u3002 \u9605\u8bfb\u672c\u7ad9\u5185\u5bb9\u53ef\u80fd\u9020\u6210\u4e25\u91cd\u5b66\u672f\u5fc3\u7406\u4e0d\u9002\uff0c\u81ea\u6211\u6000\u7591\u6216\u4e09\u89c2\u5c3d\u6bc1\u75c5\u75c7\uff0c\u5982\u60a8\u6709\u4ee5\u4e0a\u75c7\u72b6\u4e4b\u4e00\uff0c\u8bf7\u53ca\u65f6\u5c31\u533b\u3002 \u672c\u4eba\u5bf9\u4efb\u4f55\u9605\u8bfb\u672c\u7ad9\u540e\u53ef\u80fd\u4f1a\u4ea7\u751f\u7684\u5b66\u672f\u6c34\u5e73\u8d28\u7591\u3001\u5b66\u672f\u4f1a\u8bae\u4e89\u8bba\u3001\u7f51\u4e0a\u5f00\u9ed1\u4e92\u55b7\u7b49\u73b0\u8c61\u6982\u4e0d\u8d1f\u8d23\u3002 \u672a\u6ee118\u5468\u5c81\u7684\u78b3\u57fa\u751f\u547d\u4f53\uff0c\u8bf7\u5728\u5176\u751f\u7269\u5b66\u7236\u6bcd\u6216\u6cd5\u5f8b\u76d1\u62a4\u4eba\u966a\u540c\u4e0b\u9605\u8bfb\u3002 \u4ee5\u4e0a\u58f0\u660e\u7eaf\u5c5e\u626f\u6de1\uff0c\u7279\u6b64\u58f0\u660e\u3002  </p>"},{"location":"#welcome-to-marshalls-tips","title":"Welcome to Marshall's Tips","text":"<p>This website includes my private notes in Geophysics, Coding, FreeBSD, etc. The contents of this website may cause serious psychological academic discomfort, self-doubt or destruction of outlook on life. If you have one of the above symptoms, please consult a doctor in time. No responsibility would be token by me under any circumstance for any consequence to any audiences who would experiance academic level doubts, academic conference disputes, hurl insults by anonymous online, etc. Carbon based living organisms under the age of 18 should read these contents only being accompanied by their biological parents or legal guardians. All above statements are purely nonsense and I hereby declare.</p>"},{"location":"about/","title":"\u7248\u6743\u58f0\u660e(Copyright)","text":"<p>\u672c\u7ad9\u4e4b\u4e00\u5207\u6587\u6863\u672a\u7ecf\u672c\u4eba\u8bb8\u53ef\u4e0d\u5f97\u4ee5\u4efb\u4f55\u76ee\u7684\u516c\u5f00\u53d1\u8868\u3002 \u4efb\u4f55\u672a\u7ecf\u672c\u4eba\u8bb8\u53ef\u7684\u8f6c\u8f7d\u3001\u6574\u6bb5\u6216\u8005\u5168\u6587\u590d\u5236\u5e76\u516c\u5f00\u53d1\u8868\u7684\u884c\u4e3a\u5c06\u8d1f\u6cd5\u5f8b\u8d23\u4efb\u3002 \u6b32\u4ee5\u4efb\u4f55\u76ee\u7684\u51fa\u7248\u6216\u8f6c\u8f7d\u672c\u7f51\u7ad9\u4efb\u4f55\u6587\u7ae0\u8005\uff0c\u8bf7\u8054\u7cfbmarshall.ruanel@qq.com\u3002  </p> <p>Any document under this website can not be published for any purpose without my permission.   Any reprinting, whole paragraph or full text reproduction and publication on above documents without my permission would be liable in being brought into lawsuit. If you want to publish any of the contents on this website for any purpose, please contact marshall.ruanel@qq.com.  </p>"},{"location":"about/#acknowledgement","title":"\u81f4\u8c22(Acknowledgement)","text":"<p>\u8877\u5fc3\u611f\u8c22\u4ee5\u4e0b\u4e13\u5bb6\u5b66\u8005\u63d0\u51fa\u4e86\u5b9d\u8d35\u7684\u4fee\u6539\u610f\u89c1(\u6392\u540d\u4e0d\u5206\u5148\u540e)\u3002 I sincerely thank the following experts and scholars for their valuable amendments (in no particular order). \u4f59\u821f\uff08Yu Zhou\uff09\uff1ayzoucn@outlook.com \u59dc\u5cf0\uff08Jiang Feng\uff09\uff1ajiangfcn@163.com \u8463\u6cfd\u4e49\uff08Dong Zeyi\uff09\uff1adongzeyi@ies.ac.cn  \u55bb\u56fd\uff08Yu Guo\uff09\uff1ayuguo_chn@qq.com \u4f59\u8f89\uff08Yu Hui\uff09\uff1ayh358407912@163.com </p>"},{"location":"markdown/c99_complex_lib/","title":"C99\u6807\u51c6\u4e0b\u7684\u590d\u6570\u6807\u51c6\u5e93complex.h\u7f16\u7a0bTip","text":"<p>C99\u6807\u51c6\u5f15\u5165\u4e86\u590d\u6570\u5e93\uff0c\u5982\u679c\u5b89\u88c5\u7684C\u8bed\u8a00\u7f16\u8bd1\u5668\u652f\u6301c99\u3001gnu99\u3001c11\u6216gnu11\u53c2\u6570\uff08gcc-4.8.0\u6216\u66f4\u9ad8\u7248\u672c\uff09 \uff0c\u5728\u6e90\u6587\u4ef6\u4e2d\u5305\u542b<code>&lt;complex.h&gt;</code>\u5373\u53ef\u4f7f\u7528\u6b64\u6807\u51c6\u5e93\u3002<code>&lt;complex.h&gt;</code>\u5f15\u5165\u4e86<code>_Complex</code>\u5173\u952e\u5b57\uff0c\u5b9a\u4e49\u5982\u4e0b\uff1a <pre><code>#define complex  _Complex\n#define _Complex_I  ((const float _Complex)__I__)\n#define I  _Complex_I\n</code></pre> C99\u7684\u590d\u6570\u7c7b\u578b\u67093\u79cd\uff0c\u9700\u8981\u5c06\u5b9e\u3001\u865a\u90e8\u7684\u6d6e\u70b9\u7c7b\u578b\u548c<code>_Complex</code>\u5173\u952e\u5b57\u8fde\u7528\uff0c\u58f0\u660e\u65b9\u5f0f\u5982\u4e0b: <pre><code>float _Complex c1;\ndouble _Complex c2;\nlong double _Complex c3;\n</code></pre> \u5173\u952e\u5b57\u7684\u987a\u5e8f\u53ef\u4ee5\u4e0d\u9075\u5b88\uff0c\u4e5f\u53ef\u4ee5\u5199\u4e3a\uff1a <pre><code>_Complex float c1;\n_Complex double c2;\n_Complex long double c3;\n</code></pre> \u6b64\u5934\u6587\u4ef6\u91cc\u8fd8\u58f0\u660e\u4e86\u590d\u6570\u8fd0\u7b97\u7684\u5e38\u7528\u6570\u5b66\u51fd\u6570\uff08\u7528c\u5f00\u5934\uff09\uff1a 1. \u4e09\u89d2\u51fd\u6570: <code>ccos</code>, <code>csin</code>, <code>ctan</code>, <code>cacos</code>, <code>casin</code>, <code>catan</code> 2. \u53cc\u66f2\u51fd\u6570: <code>ccosh</code>, <code>csinh</code>, <code>ctanh</code>, <code>cacosh</code>, <code>casinh</code>, <code>catanh</code> 3. \u6307\u6570\u3001\u5bf9\u6570\u3001\u7edd\u5bf9\u503c\u3001\u5e42\u51fd\u6570\u7b49: <code>cexp</code>, <code>clog</code>, <code>cabs</code>, <code>cpow</code>, <code>csqrt</code> 4. \u5e45\u89d2\u4e3b\u503c\u3001\u53d6\u5b9e\u90e8\u3001\u53d6\u865a\u90e8\u3001\u5171\u8f6d\u3001Riemann\u7403\u6295\u5f71\u7b49: <code>carg</code>, <code>cimag</code>,<code>creal</code>, <code>conj</code>, <code>cproj</code> </p>"},{"location":"markdown/c99_complex_lib/#1","title":"1. \u5e94\u7528\u5b9e\u4f8b","text":"<p>\u5b9a\u4e49\u4e09\u4e2a\u590d\u65701+i\u30012+3i\u548c0+i\uff0c\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u6d4b\u8bd5\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>//main.c\n#include &lt;complex.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()  {\n    double _Complex a = 1.0 + 2.0 * I;\n    _Complex double b = 3.0 + 4.0 * I;\n    _Complex double c = a + b;\n\n    printf (\"a=(%f, %f)\\n\", creal(a), cimag(a));\n    printf (\"b=(%f, %f)\\n\", creal(b), cimag(b));\n    printf (\"c=(%f, %f)\\n\", creal(c), cimag(c));\n    printf (\"phase angle of c is %f degrees\\n\", carg(c)*180.0/3.1415926);\n    return 0;\n}\n</code></pre></p> <p>\u6ce8\u610f\uff1a\u7f16\u8bd1\u9700\u94fe\u63a5\u6570\u5b66\u5e93\uff0c\u5426\u5219\u4f1a\u63d0\u793a\u65e0\u6cd5\u94fe\u63a5\u76f8\u5173\u6570\u5b66\u51fd\u6570\u3002</p> <p>\u5728FreeBSD\u4e0bclang\u7f16\u8bd1\u5668\u7684\u7f16\u8bd1\u547d\u4ee4\u4e3a\uff1a <pre><code>clang main.c -lm -o test\n</code></pre> \u6267\u884c<code>./test</code>\u7a0b\u5e8f\uff0c\u5176\u8f93\u51fa\u4e3a\uff1a <pre><code>a=(1.000000, 2.000000)\nb=(3.000000, 4.000000)\nc=(4.000000, 6.000000)\nphase angle of c is 56.309933 degrees\n</code></pre></p>"},{"location":"markdown/c99_complex_lib/#2","title":"2. \u590d\u6570\u52a8\u6001\u6570\u7ec4","text":"<p>\u52a8\u6001\u6570\u7ec4\u5728gcc\u548cclang\u4e0d\u540c\u7248\u672c\u7684\u7f16\u8bd1\u5668\u4e0a\u6709\u4e9b\u8be1\u5f02\uff0c\u4ee5\u4e0b\u4e24\u79cd\u5199\u6cd5\u7406\u8bba\u4e0a\u90fd\u5e94\u6b63\u786e\uff1a <pre><code>double _Complex *a = (double _Complex*)malloc (sizeof(double _Complex) * 2);\n_Complex double *a = (_Complex double*)malloc (sizeof(_Complex double) * 2);\n</code></pre> \u4f46\u524d\u8005\u5728centos7.x\u7684gcc\u7f16\u8bd1\u5668\u4e0a\u53ef\u80fd\u4f1a\u62a5\u9519\uff0c\u63d0\u793a\u7684\u9519\u8bef\u662f<code>sizeof</code>\u51fd\u6570\u91cc<code>double</code>\u540e\u9762\u5fc5\u987b\u662f\u4e00\u4e2a\u53d8\u91cf\u800c\u4e0d\u80fd\u662f\u4e00\u4e2a\u5b8f\u3002\u7b2c\u4e8c\u79cd\u5199\u6cd5\u53ef\u4ee5\u7f16\u8bd1\u901a\u8fc7\uff0c\u4e0d\u77e5\u9053\u6b64bug\u662f\u5426\u5df2\u88ab\u4fee\u6b63\u3002 \u5728FreeBSD 12.1\u4e0aclang\u7f16\u8bd1\u5668\u4e24\u79cd\u65b9\u5f0f\u5f00\u8f9f\u52a8\u6001\u6570\u7ec4\u90fd\u80fd\u6210\u529f\u7f16\u8bd1\u3002</p>"},{"location":"markdown/c99_complex_lib/#3","title":"3. \u7c7b\u578b\u5b9a\u4e49\u548c\u5b8f","text":"<p><code>long double _Complex</code>\u8fd9\u6837\u5197\u957f\u7684\u7c7b\u578b\u58f0\u660e\u4e0d\u5229\u4e8e\u4ee3\u7801\u7ef4\u62a4\uff0c\u53ef\u5229\u7528<code>typedef</code>\u6216\u5b8f\u7684\u529f\u80fd\u5c06\u957f\u5b57\u7b26\u4e32\u7c7b\u578b\u66ff\u6362\u4e3a\u66f4\u7b80\u5355\u7684Symbol\u3002\u5728\u4ee5\u4e0b\u4ee3\u7801\u4e2d\uff0c<code>typedef</code>\u548c\u5b8f\u7684\u6267\u884c\u7ed3\u679c\u76f8\u540c\uff1a <pre><code>//test_type.c\n#include &lt;complex.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef double _Complex dcomplex; //\u7c7b\u578b\u5b9a\u4e49\n\n#define DCOMPLEX double _Complex  //\u5b8f\n\nint main()  {\n    dcomplex *a = (dcomplex*)malloc (sizeof(dcomplex) * 2);\n    DCOMPLEX *b = (DCOMPLEX*)malloc (sizeof(DCOMPLEX) * 2);\n    a[0] = 1.0 + 2.0*I;\n    a[1] = 2.0 + 3.0*I;\n    b[0] = a[0];\n    b[1] = a[1];\n\n    printf(\"a[0]=(%f, %f)\\n\", creal(a[0]), cimag(a[0]));\n    printf(\"a[1]=(%f, %f)\\n\", creal(a[1]), cimag(a[1]));\n    printf(\"b[0]=(%f, %f)\\n\", creal(b[0]), cimag(b[0]));\n    printf(\"b[1]=(%f, %f)\\n\", creal(b[1]), cimag(b[1]));\n\n    free(a);\n    free(b);\n    return 0;\n}\n</code></pre> \u7f16\u8bd1\u5e76\u8fd0\u884c\u4ee5\u4e0a\u4ee3\u7801\u7684\u8f93\u51fa\u4e3a\uff1a <pre><code>a[0]=(1.000000, 2.000000)\na[1]=(2.000000, 3.000000)\nb[0]=(1.000000, 2.000000)\nb[1]=(2.000000, 3.000000)\n</code></pre></p>"},{"location":"markdown/c99_sqmr_solver/","title":"\u4f7f\u7528\u51fd\u6570\u6307\u9488\u6784\u9020C99\u8fed\u4ee3\u6cd5\u6c42\u89e3\u5668","text":"<p>C\u8bed\u8a00\u91c7\u7528\u5178\u578b\u7684\u9759\u6001\u7c7b\u578b\u547d\u4ee4\u5f0f\u7f16\u7a0b\u98ce\u683c\uff0c\u662f\u5f53\u524d\u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\uff08\u5982Windows,Unix,Unix-like\u7b49)\u7684\u6784\u9020\u8bed\u8a00\u3002\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u8bf4\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u662fC\u8bed\u8a00\u7684\u89e3\u91ca\u5668\uff0c\u5f53\u7136\u8fd9\u4e2a\u89e3\u91ca\u5668\u5b9e\u73b0\u5f97\u6781\u5ea6\u7cdf\u7cd5\u3001\u80ae\u810f\u3001\u611a\u8822\u3001\u529f\u80fd\u6b8b\u7f3a\u3001bug\u4e0d\u65ad\u3002 \u5728\u79d1\u5b66\u8ba1\u7b97\u573a\u666f\u4e0b\uff0c\u7ecf\u5e38\u6709\u4ee5\u4e0b\u9700\u6c42\uff08\u5047\u8bbe\u90fd\u662f<code>double</code>\u578b\u6570\u636e\uff09\uff1a 1. \u5b58\u5728\u4e00\u4e2a\u901a\u7528\u64cd\u4f5c\uff0c\u6bd4\u5982\u4e00\u4e2a\u7ebf\u6027\u65b9\u7a0b\u7ec4\u6c42\u89e3\u5668\u7528\u4e8e\u6c42\u89e3Ax=b; 2. \u8be5\u6c42\u89e3\u5668\u9700\u8981\u8f93\u5165\u4e00\u4e2a\u77e9\u9635A\uff0c\u4e00\u4e2a\u53f3\u7aef\u9879b\uff0c\u4e00\u4e2a\u8f93\u51fa\u5411\u91cfx; 3. \u8f93\u5165\u77e9\u9635\u53ef\u80fd\u662fCSR\u538b\u7f29\u5b58\u50a8\u7684\u4e09\u5143\u7ec4\uff0c\u4e5f\u53ef\u80fd\u662f\u81f4\u5bc6\u77e9\u9635\u7684\u4e00\u5143\u7ec4; 4. \u5047\u5b9a\u5916\u90e8\u8fd8\u53ef\u80fd\u8981\u63d0\u4f9b\u4e00\u4e2a\u6c42\u89e3\u9884\u6761\u4ef6\u95ee\u9898\u7684\u51fd\u6570\u5feb\u901f\u6c42\u53d6Pu=v;  </p>"},{"location":"markdown/c99_sqmr_solver/#1-c","title":"1. \u9762\u5411\u5bf9\u8c61\u7684C++\u89e3\u51b3\u65b9\u5f0f","text":"<p>\u8981\u5b9a\u4e49\u4e00\u4e2a\u901a\u7528\u51fd\u6570\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5728C++\u8bed\u8a00\u6846\u67b6\u4e0b\u53ef\u5229\u7528OOP\u7684\u591a\u6001\uff0c\u9488\u5bf9CSR\u538b\u7f29\u7684\u7a00\u758f\u77e9\u9635\u6c42\u89e3\u5668\u5f88\u53ef\u80fd\u5982\u4e0b\uff1a <pre><code>class CsrSolver {\n    public:\n        CsrSolver();\n        void set_A(int n, int *ia, int *ja, double *a);\n        //P\u7684ILU\u5206\u89e3\u4e0b\u4e09\u89d2\u90e8\u5206\n        void set_PL(int n, int *il, int *jl, double *l); \n        //P\u7684ILU\u5206\u89e3\u4e0a\u4e09\u89d2\u90e8\u5206\n        void set_PU(int n, int *iu, int *ju, double *u);\n        void set_b(double *b);\n        void compute_Av(double *v);  //A\u4e58\u4ee5v\u5411\u91cf\n        void solve_Pv(double *v);    //\u6c42\u89e3\u9884\u6761\u4ef6\u95ee\u9898\n        double* get_x();        \n        run();\n    private:\n        ~CsrSolver();\n        ...... //\u8fd9\u91cc\u662f\u9700\u8981\u7684\u6570\u636e\n}\n</code></pre> \u9488\u5bf9\u81f4\u5bc6\u9635\u7684\u6c42\u89e3\u5668\u53ef\u80fd\u4e3a\uff1a <pre><code>class DenceSolver{\n    public:\n        DenceSolver();\n        void set_A(int n, double *a);\n        //P\u7684ILU\u5206\u89e3\u4e0b\u4e09\u89d2\u90e8\u5206\n        void set_PL(int n, double *L); \n        //P\u7684ILU\u5206\u89e3\u4e0a\u4e09\u89d2\u90e8\u5206\n        void set_PU(int n, double *U);\n        void set_b(double *b);\n        void compute_Av(double *v);  //A\u4e58\u4ee5v\u5411\u91cf\n        void solve_Pv(double *v);    //\u6c42\u89e3\u9884\u6761\u4ef6\u95ee\u9898\n        double* get_x();        \n        run();\n    private:\n        ~DenceSolver();\n        ...... //\u8fd9\u91cc\u662f\u9700\u8981\u7684\u6570\u636e\n}\n</code></pre> \u5bf9\u4ee3\u7801\u8fdb\u884c\u201c\u91cd\u6784\u201d\uff0c\u8ba9<code>CsrSolver</code>\u548c<code>DenceSolver</code>\u5747\u7ee7\u627f\u4e8e\u4e00\u4e2a\u62bd\u8c61\u7c7b<code>Solver</code>\uff0c\u5728\u5b50\u7c7b\u4e2d\u91cd\u8f7d\u865a\u51fd\u6570\u5b9e\u73b0\u591a\u6001: <pre><code>class Solver{\n    public:\n        ......\n        virtual void set_A();\n        virtual void comput_Av();\n        virtual void solve_Pv();\n        ......\n}\n</code></pre> \u8fd9\u79cdOOP\u6c42\u89e3\u5668\u82e5\u80fd\u8bbe\u8ba1\u5f97\u5f88\u597d\uff0c\u5176\u5916\u90e8\u8c03\u7528\u65b9\u5f0f\u53ef\u80fd\u4e3a\uff1a <pre><code>    ......\n    //\u7a00\u758f\u77e9\u9635\uff1a\u5df2\u7ecf\u5bf9\u77e9\u9635\u3001\u5411\u91cf\u7b49\u5206\u914d\u5185\u5b58\uff0c\u5e76\u521d\u59cb\u5316\u5b8c\u6bd5\n    CsrSolver s1();\n    s1.set_A(n, ia1, ja1, a1);\n    s1.set_PL(n, il1, jl1, l1);\n    s1.set_PU(n, iu1, ju1, u1);\n    s1.run();\n    ......\n    //\u81f4\u5bc6\u77e9\u9635:\u5df2\u7ecf\u5bf9\u77e9\u9635\u3001\u5411\u91cf\u7b49\u5206\u914d\u5185\u5b58\uff0c\u5e76\u521d\u59cb\u5316\u5b8c\u6bd5\n    DenseSolver s2();\n    s2.set_A(n, a2);\n    s2.set_PL(n, l2);\n    s2.set_PU(n, u2);\n    s2.run();\n    ......\n</code></pre> \u4ee5\u4e0aOOP\u5b9e\u73b0\u7684\u6700\u5927\u4f18\u70b9\u5728\u4e8e\u4ee3\u7801\u201c\u89e3\u8026\u201d\uff0c\u5c3d\u91cf\u5b9e\u73b0\u201c\u6a21\u5757\u5316\u201d\uff0c\u4fee\u6539<code>DenseSolver</code>\u7684\u4ee3\u7801\u4e0d\u4f1a\u5f71\u54cd<code>CsrSolver</code>\u7684\u8fd0\u884c\u3002\u4f46\u4e5f\u8981\u770b\u5230\u5982\u679c\u4fee\u6539\u4e86<code>Solver</code>\u7c7b\uff0c\u6240\u6709\u5b50\u7c7b\u90fd\u4f1a\u53d7\u5230\u5f71\u54cd\u3002 \u5728\u5927\u9879\u76ee\u4e2d\uff0c\u7531\u4e8e\u7ee7\u627f\u3001\u5305\u542b\u3001\u63a5\u53e3\u7684\u5173\u7cfb\u975e\u5e38\u590d\u6742\uff0c\u9700\u8981\u975e\u5e38\u201c\u8d44\u6df1\uff08\u4f60\u5f53\u6211\u8bf4\u53cd\u8bdd\u597d\u4e86\uff09\u201d\u7684\u67b6\u6784\u5e08\u5c0f\u5fc3\u7684\u8bbe\u8ba1\u7c7b\u56fe\uff0c\u5426\u5219\u8fd8\u4e0d\u5982\u8001\u8001\u5b9e\u5b9e\u7684\u7528\u7eaf\u547d\u4ee4\u5f0f\u98ce\u683c\u6765\u5199\u3002 OOP\u5bf9\u4e8e\u6211\u8fd9\u6837\u7684\u83dc\u9e1f\u6765\u8bf4\uff0c\u5e38\u89c4\u4f53\u9a8c\u662f\u4e00\u6b21\u91cd\u6784\u7b49\u4ef7\u4e8e\u63a8\u5012\u91cd\u6765\u3002\u4ee5\u524d\u7f51\u4e0a\u6709\u4e00\u7bc7\u4e9a\u9a6c\u900a\u5458\u5de5\u7684\u6587\u7ae0\u5410\u69fd\u7ef4\u62a4C++\u4ee3\u7801\u597d\u50cf\u8981\u722c\u5230\u4e00\u4e2a\u5de8\u578b\u201c\u5c4e\u5c71\u201d\u7684\u6b63\u4e2d\u5fc3\uff0c\u5728\u6b64\u6df1\u8868\u540c\u60c5\u3002 \u4f46\u65e0\u8bba\u5982\u4f55\uff0cOOP\u7b56\u7565\u662f\u6bd4\u8f83\u5408\u4e4e\u5de5\u4e1a\u201c\u89c4\u8303\u201d\u7684\u505a\u6cd5\u3002\u8fd9\u4e00\u5957\u65b9\u6cd5\u8bba\u5728\u5982\u4eca\u5927\u884c\u5176\u9053\uff0c\u65e0\u4eba\u8d28\u7591\uff0c\u60f3\u5fc5\u662f\u6709\u5176\u6df1\u523b\u7684\u6587\u5316\u548c\u5386\u53f2\u539f\u56e0\u3002   \u5bf9\u4e8e\u201c\u79d1\u7814\u754c\u201d\u7684\u79d1\u5b66\u8ba1\u7b97\u4ee3\u7801\uff0c\u9700\u6c42\u5f80\u5f80\u53d8\u5316\u592a\u5feb\uff0c\u7b97\u6cd5\u7ecf\u5e38\u8981\u9700\u8981\u63a8\u5012\u91cd\u6765\u3002\u5047\u8bbe\u6211\u4eec\u9700\u8981\u8ba9\u6c42\u89e3\u5668\u652f\u6301\u590d\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u5f88\u591aC++\u7a0b\u5e8f\u5458\u7b2c\u4e00\u5370\u8c61\u5c31\u6572\u4e0b\u4e86<code>template</code>\u3002\u4f46\u77e9\u9635\u548c\u5411\u91cf\u7684\u4e58\u6cd5\u3001\u4e09\u89d2\u77e9\u9635\u7684\u56de\u4ee3\u89e3\u6cd5\u7b49\u51fd\u6570\u53c8\u5f80\u5f80\u662f\u7b2c\u4e09\u65b9C\u8bed\u8a00\u5e93\u63d0\u4f9b\u7684\uff0c\u5728<code>template</code>\u673a\u5236\u4e0b\u5404\u79cd\u7c7b\u578b\u7206\u70b8\uff0c\u7ed5\u6765\u7ed5\u53bb\u3002\u5373\u4fbf\u82b1\u4e86\u5f88\u957f\u65f6\u95f4\u5199\u4e86\u4e00\u4e2a\u52c9\u5f3a\u80fd\u7528\u7684\u7248\u672c\uff0c\u5176\u53ef\u8bfb\u6027\uff08\u8fd9\u91cc\u6307\u7684\u662f\u4fbf\u4e8e\u56e2\u961f\u6210\u5458\u7684\u7406\u89e3\uff09\u548c\u53ef\u7ef4\u62a4\u6027\u5b9e\u5728\u582a\u5fe7\u3002 \u4e00\u65e6\u9700\u6c42\u7a0d\u4f5c\u6539\u52a8\uff0c\u6bd4\u5982\u73b0\u5728\u8981\u52a0\u5165\u590d\u6742\u7684\u4ee3\u6570\u591a\u91cd\u7f51\u683c\u6cd5\uff08AMG\uff09\uff0c\u539f\u6765\u7684\u57fa\u7c7b\u53ef\u80fd\u9700\u8981\u5f88\u5927\u7684\u6539\u52a8\uff08\u9700\u589e\u52a0\u6210\u5458\u53d8\u91cf\u6216<code>getter</code>\u3001<code>setter</code>\uff09\uff0c\u9020\u6210\u5b50\u7c7b\u4e5f\u5168\u90e8\u8981\u52a8\u624b\u672f\u3002\u6211\u60f3\uff0c\u53ef\u80fd\u6b63\u56e0\u5982\u6b64\uff0c\u201c\u57fa\u4e8e\u63a5\u53e3\u201d\uff08\u57fa\u7c7b\u5168\u662f\u865a\u51fd\u6570\uff0c\u4e0d\u8981\u6210\u5458\u53d8\u91cf\uff09\u7684OOP\u5de5\u4e1a\u539f\u5219\u8fd1\u4e24\u5e74\u8d8a\u6765\u8d8a\u53d7\u5f3a\u8c03\u3002 \u603b\u4e4b\uff0c\u6570\u5b66\u4e0a\u5f88\u6d41\u7545\u7684\u8ba1\u7b97\u6b65\u9aa4\uff0c\u4e00\u5230OOP\u91cc\uff0c\u4f3c\u4e4e\u7a81\u7136\u95f4\u4f1a\u53d8\u5f97\u652f\u79bb\u7834\u788e\uff0c\u7279\u522b\u50cf\u9ed1\u5ba2\u5e1d\u56fd\u91cc\u6d51\u8eab\u63d2\u7740(plugin)\u8425\u517b\u7ba1\u7684\u4eba\u4f53\u7535\u6c60\u3002 \u6211\u611f\u89c9\u6709\u65f6\u95f4\u53bbOOP\u4e00\u4e2a\u6c42\u89e3\u5668\uff0c\u8fd8\u4e0d\u5982\u7b80\u5355\u7c97\u66b4\u7684\u628a<code>dense_solve</code>\u7684\u4ee3\u7801\u590d\u5236\u4e00\u4efd\uff0c\u6539\u540d<code>csr_solve</code>\uff0c\u7136\u540e\u4fee\u6539\u8ba9\u5176\u8fd0\u884c\u6b63\u786e\u3002\u5982\u679c\u8981\u652f\u6301\u590d\u6570\u7c7b\u578b\uff0c\u90a3\u4e48\u5c31\u518d\u590d\u5236\u4e24\u4efd\uff0c\u6162\u6162\u7684\u628a<code>double</code>\u6539\u4e3a<code>double _Complex</code>\uff0c\u518d\u4fee\u6539\u76f8\u5173\u7684\u53d6\u8303\u6570\u7b49\u7279\u6b8a\u51fd\u6570\uff0c\u5f97\u5230<code>z_dense_solve</code>\u548c<code>z_csr_solve</code>\u3002 \u79d1\u7814\u7f16\u7a0b\u6d3b\u52a8\u5f80\u5f80\u7740\u773c\u4e8e\u7528\u6700\u5feb\u7684\u901f\u5ea6\u5b9e\u73b0\u7b97\u6cd5\uff0c\u65e9\u65e5\u6d4b\u8bd5\u7b97\u6cd5\u9009\u578b\u662f\u5426\u5408\u7406\uff0c\u80fd\u5426\u9ad8\u6548\u5f97\u5230\u6b63\u786e\u7ed3\u679c\u3002\u4e00\u4e2a\u7b97\u6cd5\u968f\u65f6\u53ef\u80fd\u88ab\u8bc1\u660e\u65e0\u7528\u800c\u9700\u88ab\u66ff\u6362\uff0c\u66ff\u6362\u7b97\u6cd5\u7684\u6570\u636e\u7ec4\u7ec7\u548c\u5f62\u53c2\u6781\u53ef\u80fd\u4e0e\u8001\u7b97\u6cd5\u5b8c\u5168\u4e0d\u540c\uff0c\u6211\u5b9e\u5728\u4e0d\u77e5\u9053OOP\u5982\u4f55\u9ad8\u6548\u5e94\u5bf9\u8fd9\u79cd\u573a\u666f\u3002 \u8bdd\u867d\u5982\u6b64\uff0c\u6709\u4e00\u6761\u539f\u5219\u662f\u653e\u4e4b\u56db\u6d77\u800c\u7686\u51c6\u7684\u2014\u2014\u5c06\u201c\u901a\u7528\u201d\u8fc7\u7a0b\u62bd\u8c61\u4e3a\u51fd\u6570\u53ef\u8ba9\u547d\u4ee4\u5f0f\uff08\u6216\u201c\u8fc7\u7a0b\u5f0f\u201d\uff09\u4ee3\u7801\u62e5\u6709\u6a21\u5757\u6027\u5e76\u6613\u4e8e\u7ef4\u62a4\u3002  </p> <p>\u58f0\u660e\uff1a\u6211\u65e0\u610f\u4e89\u8bbaOOP\u3001\u547d\u4ee4\u5f0f\u6216\u51fd\u6570\u5f0f\u7f16\u7a0b\u54ea\u4e2a\u597d\u3002\u4ee5\u6211\u76ee\u524d\u7684\u83dc\u9e1f\u6c34\u5e73\uff0c\u53ea\u80fdhold\u5f97\u4f4f\u4ee5\u4e0b\u7684\u601d\u8def\u3002\u6211\u559c\u6b22\u7b80\u5355\u76f4\u63a5\u7684\u529e\u6cd5\uff0c\u53ea\u8981\u8bed\u53e5\u6e05\u6670\uff0c\u8bcd\u6cd5\u4e11\u964b\u4e00\u4e9b\u5c1a\u5728\u53ef\u4ee5\u63a5\u53d7\u8303\u56f4\uff0c\u6bd5\u7adf\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u5c31\u8bbe\u8ba1\u5f97\u7279\u522b\u4e11\u964b\uff0c\uff1a\uff09\u3002</p>"},{"location":"markdown/c99_sqmr_solver/#2-c99","title":"2. C99\u6a21\u62df\u51fd\u6570\u5f0f\u7684\u65b9\u5f0f","text":"<p>\u82e5\u4e0d\u8003\u8651\u8ba1\u7b97\u6548\u7387\uff0c\u4ec5\u4ece\u903b\u8f91\u6e05\u6670\u7a0b\u5ea6\u548c\u4ee3\u7801\u7ef4\u62a4\u6210\u672c\u6765\u770b\uff0cLisp\u8bed\u8a00\u7684\u9ad8\u9636\u51fd\u6570\u529f\u80fd\u5f88\u9002\u5408\u8fd9\u79cd\u6c42\u89e3\u5668\u7684\u7f16\u7a0b\u573a\u666f\u3002 \u4ee5scheme\u8bed\u8a00\uff08Lisp\u7684\u4e00\u79cd\u65b9\u8a00\uff09\u4e3a\u4f8b\uff0c\u6c42\u89e3\u5668\uff08\u5916\u90e8\u51fd\u6570\uff09\u53ef\u5b9a\u4e49\u4e3a\uff1a <pre><code>(define solve\n    (lambda (compute-av solve-pv a l u b) ;compute-av\u548csolve-px\u662f\u4e24\u4e2a\u51fd\u6570\n    ;;;do-something\n    ))\n</code></pre> \u8c03\u7528<code>solve</code>\u51fd\u6570\u9700\u5b9e\u73b0<code>compute-av</code>\u548c<code>solve-pv</code>\u4e24\u4e2a\u51fd\u6570\u4f5c\u4e3a\u524d\u4e24\u4e2a\u53c2\u6570: <pre><code>;;CSR\u538b\u7f29\u77e9\u9635\u6709\u5173\u7684\u51fd\u6570\n(define compute-av-csr\n    (lambda (a v)\n        .....\n        ;;\u8fd4\u56deAv\u5411\u91cf\n        ))\n(define solve-pv-csr\n    (lambda (l u v)\n        .....\n        ;;\u8fd4\u56dePu=v\u7684\u89e3\u5411\u91cf\n        ))\n;;\u81f4\u5bc6\u77e9\u9635\u6709\u5173\u7684\u51fd\u6570\n(define compute-av-dense\n    (lambda (a v)\n        .....\n        ;;\u8fd4\u56deAv\u5411\u91cf\n        ))\n(define solve-pv-dense\n    (lambda (l u v)\n        .....\n        ;;\u8fd4\u56dePu=v\u7684\u89e3\u5411\u91cf\n        ))\n;;\u6c42\u89e3\u5668\u51fd\u6570`solve`\u7684\u8c03\u7528\u65b9\u5f0f\n(solve \n    compute-av-csr\n    solve-px-csr\n    a1 l1 u1 b1)\n(solve \n    compute-av-dense\n    solve-px-dense\n    a2 l2 u2 b2)\n</code></pre> \u7531\u4e8eLisp\u8bed\u8a00\u652f\u6301\u52a8\u6001\u7c7b\u578b\uff0c\u5f62\u53c2\u91cc<code>a</code>\u3001<code>l</code>\u3001<code>u</code>\u53ef\u4e3a\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\uff0c<code>solve</code>\u51fd\u6570\u5929\u7136\u5177\u6709\u591a\u6001\u6027\u3002\u51fd\u6570\u4f5c\u4e3a\u201c\u4e00\u7b49\u516c\u6c11\u201d\u7684\u7f16\u7a0b\u65b9\u5f0f\u88ab\u79f0\u4e3a\u201c\u51fd\u6570\u5f0f\u7f16\u7a0b\u201d\uff0c\u8fd9\u79cd\u62bd\u8c61\u80fd\u529b\u5728C\u8bed\u8a00\u4e2d\u6ca1\u6709\u63d0\u4f9b\u3002 \u4ee5\u4e0a\u7684\u4f8b\u5b50\u53ea\u662f\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u5c0f\u5f0f\u725b\u5200\uff0cLisp\u628a\u51fd\u6570\u5f0f\u7f16\u7a0b\u73a9\u51fa\u4e86\u82b1\uff0c\u6bd4\u5982\u201c\u6d41\u6a21\u5f0f\u201d\u3001\u201c\u65e0\u6570\u636econs\u201d\u7b49\uff0c\u8fd9\u4e9b\u8bdd\u9898\u4eca\u540e\u518d\u8c08\u3002 \u73b0\u9636\u6bb5\u7528C\u6216Fortran\u6765\u5b9e\u73b0\u7b97\u6cd5\u4ecd\u662f\u73b0\u5b9e\u9700\u6c42\u3002\u5229\u7528C\u8bed\u8a00\u7684\u51fd\u6570\u6307\u9488\u4e5f\u53ef\u5c3d\u91cf\u6a21\u62dfLisp\u8bed\u8a00\u7684\u201c\u9ad8\u9636\u51fd\u6570\u201d\uff0c\u4ece\u800c\u5b9e\u73b0\u4ee5\u4e0aLisp\u4ee3\u7801\u7684\u6e05\u6670\u903b\u8f91\u3002 \u5047\u8bbe\u6c42\u89e3\u5668\u7b97\u6cd5\u4e3a\u5bf9\u79f0\u62df\u6700\u5c0f\u6b8b\u5dee\u6cd5\uff08SQMR\uff09\uff0c\u6211\u4eec\u6700\u4f4e\u7684\u7684\u9700\u6c42\u662f\u201c\u5bf9\u4e8e\u4e0d\u540c\u5b58\u50a8\u683c\u5f0f\u7684<code>double</code>\u578b\u77e9\u9635\u548c\u5411\u91cf\uff0c\u90fd\u80fd\u8c03\u7528\u540c\u4e00\u4e2a<code>sqmr_solve</code>\u51fd\u6570\u6c42\u89e3\u201d\uff0c\u8fd9\u53ef\u89c6\u4e3a\u4e00\u79cd\u4e0d\u7528OOP\u7684\u201c\u591a\u6001\u201d\u3002</p>"},{"location":"markdown/c99_sqmr_solver/#21","title":"2.1 \u5f62\u53c2\u7c7b\u578b\u5316","text":"<p>\u53c2\u8003Scheme\u8bed\u8a00\u7684\u9ad8\u9636\u51fd\u6570\u5b9e\u73b0\u65b9\u5f0f\uff0c\u9996\u5148\u5fc5\u987b\u8981\u62e5\u6709\u201cwishful thinking\u201d\u7684\u601d\u7ef4\u65b9\u5f0f\uff0c\u81ea\u9876\u5411\u4e0b\u8fdb\u884c\u8bbe\u8ba1\u3002 \u53ef\u4ee5\u4e50\u89c2\u7684\u8ba4\u4e3a\u8c03\u7528<code>sqmr_solve</code>\u51fd\u6570\u4e4b\u524d\u4e00\u5207\u6570\u7ec4\u5185\u5b58\u90fd\u88ab\u6b63\u786e\u5206\u914d\u3002\u77e9\u9635\u3001\u5411\u91cf\u7b49\u90fd\u662f\u4e00\u79cd\u201c\u6570\u636e\u7c7b\u578b\u201d\uff0c\u800c\u975e<code>double</code>\u578b\u52a8\u6001\u6570\u7ec4\u90a3\u6837\u5e95\u5c42\u7684\u4e1c\u897f\u3002 \u5bf9\u4e8eCSR\u538b\u7f29\u5b58\u50a8\u7684\u77e9\u9635\uff0c\u53ef\u4ee5\u7528C\u8bed\u8a00\u7ed3\u6784\u4f53\u5b9a\u4e49<code>CSR_MATRIX</code>\u7c7b\u578b\u8868\u8fbe\uff1a <pre><code>typedef struct {\n    int *row_ptr;   //\u884c\u6307\u9488\n    int *col_ind;   //\u5217\u4e0b\u6807\n    double *val;    //\u975e0\u503c\n} CSR_MATRIX;\n</code></pre> A\u3001L\u548cU\u7684CSR\u538b\u7f29\u77e9\u9635\u90fd\u53ef\u7528<code>CSR_MATRIX</code>\u7c7b\u578b\u4f20\u53c2\uff08P \\approx LU\uff09\u3002\u53f3\u7aef\u9879b\u548c\u5f85\u89e3\u9879x\u4e0d\u59a8\u4ecd\u4f7f\u7528<code>double*</code>\u7c7b\u578b\u8868\u793a\u3002 \u53e6\u5916\uff0c\u5bf9\u4e8eSQMR\u7b97\u6cd5\uff0c\u9700\u8981(r,d,p,s,t,v,\\hat{v})7\u4e2a\u8f85\u52a9\u5411\u91cf\u4f5c\u4e3a\u4e2d\u95f4\u5b58\u50a8\uff0c\u4e3a\u4fbf\u4e8e\u5185\u5b58\u7ba1\u7406\uff0c<code>malloc</code>\u548c<code>free</code>\u7b49\u51fd\u6570\u5e94\u5728\u5916\u90e8\u5b9e\u73b0\uff0c\u4ee5\u8ba9<code>sqmr_solve</code>\u51fd\u6570\u66f4\u201c\u7eaf\u7cb9\u201d\uff08\u7c7b\u4f3c\u4e8eUnix\u54f2\u5b66\u4e2d\u7684\u201c\u4e00\u4e2a\u7a0b\u5e8f\u53ea\u4f5c\u4e00\u4ef6\u4e8b\u201d\u7684\u539f\u5219\uff09\u3002 \u8fd9\u4e9b\u8f85\u52a9\u5411\u91cf\u53ef\u7528\u4ee5\u4e0b\u6570\u636e\u7ed3\u6784\u8868\u793a\uff1a <pre><code>typedef struct {\n    double *r;   \n    double *d;  \n    double *p;\n    double *s;\n    double *t;\n    double *v;\n    double *vhat;\n} SQMR_BUFFER;\n</code></pre> \u5f53\u7136\uff0c\u4e5f\u53ef\u7528<code>double* buff[7]</code>\u6765\u58f0\u660e\u4e00\u4e2a7\u5217\u7684\u4e8c\u7ef4\u52a8\u6001\u6570\u7ec4\u8868\u793a<code>buff</code>\uff0c\u8fd9\u548c<code>SQMR_BUFFER</code>\u7ed3\u6784\u4f53\u662f\u7b49\u4ef7\u7684\u3002</p>"},{"location":"markdown/c99_sqmr_solver/#22","title":"2.2 \u51fd\u6570\u6307\u9488","text":"<p>\u4ecd\u7136\u5047\u8bbe\u5f20\u4e09\u6216\u674e\u56db\u5df2\u7ecf\u5b9e\u73b0\u597d\u4e86CSR\u7684\u4e58\u6cd5\u8fd0\u7b97\u3001\u8303\u6570\u8ba1\u7b97\u7b49\u8f85\u52a9\u51fd\u6570\uff08wishful thinking\uff09\u3002\u5177\u4f53\u4e00\u70b9\uff0c\u67d0\u77e9\u9635\u8fd0\u7b97C\u8bed\u8a00\u5e93\u63d0\u4f9b\u4e86\u8ba1\u7b97b=Ax\u3001\u6c42\u89e3LUx=b\u7684\u4ee5\u4e0b\u51fd\u6570\uff1a <pre><code>//\u7a00\u758f\u77e9\u9635\nvoid dcsrmv(int n, int *ia, int *ja, double *a, double *x, double *b);\nvoid dcsrlusv(int n, int *il, int *jl, double *l, \n              int *iu, int *ju, double *u, \n              double *b, double *x);\n//\u81f4\u5bc6\u77e9\u9635\nvoid dmv(int n, double *x, double *b);\nvoid lusv(int n, double *l, double *u, \n              double *b, double *x);\n</code></pre> \u4e3a\u9002\u5e94\u901a\u7528\u7c7b\u578b\u4f20\u53c2\uff0c\u9700\u8fdb\u884c\u4e00\u6b21\u7b80\u5355\u201c\u5c01\u88c5\u201d\uff1a <pre><code>//\u6ce8\uff1a\u8fd9\u91cca\u4f7f\u7528void*\u7c7b\u578b\u662f\u56e0\u4e3acompute_ax\u548csolve_px\u9700\u8981\u5bf9csr\u548cdense\u4e24\u79cd\u77e9\u9635\u751f\u6548\n//  \u4ee5\u4e0bav\u548cpv\u51fd\u6570\u65e0\u8bba\u5bf9\u4e8e\u7a00\u758f\u77e9\u9635\u8fd8\u662f\u81f4\u5bc6\u77e9\u9635\uff0c\u5176\u5f62\u53c2\u7c7b\u578b\u90fd\u662f\u7edf\u4e00\u7684\nvoid compute_av_csr(int n, void *a, double *v, double *av) {\n    CSR_MATRIX *m = (CSR_MATRIX *)a;  //\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\n    dcsrmv(n, m-&gt;row_ptr, m-&gt;col_ind, m-&gt;val, v, av);\n}\n\nvoid solve_pv_csr(int n, void *l, void *u, double *v, double *pv) {\n    CSR_MATRIX *pl = (CSR_MATRIX *)l; //\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\n    CSR_MATRIX *pu = (CSR_MATRIX *)u;\n    dcsrlusv(n, \n             pl-&gt;row_ptr, pl-&gt;col_ind, pl-&gt;val,\n             pu-&gt;row_ptr, pu-&gt;col_ind, pu-&gt;val,\n             v, pv);\n}\n\nvoid compute_av_dense(int n, void *a, double *v, double *av) {\n    dmv(n, (double*)a, v, av);       //\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\n}\n\nvoid solve_pv_dense(int n, void *l, void *u, double *v, double *pv) {\n    lusv(n, (double *)l, (double *)u, v, pv);      //\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362      \n}\n</code></pre> \u4ee5\u4e0a\u4e24\u4e2a\u201c\u901a\u7528\u201d\u51fd\u6570\u53ef\u4ee5\u7528\u51fd\u6570\u6307\u9488\u4f5c\u4e3a<code>sqmr_solve</code>\u9ad8\u9636\u51fd\u6570\u7684\u53c2\u6570\u3002\u6700\u7b80\u5355\u7684<code>sqmr_solve</code>\u51fd\u6570\u5b9e\u73b0\u65b9\u5f0f\u4e3a\uff1a <pre><code>void dsqmr_solve(int n,       //\u65b9\u9635\u7684\u884c\u5217\u6570\n                 int quiet,   //\u662f\u5426\u6253\u5370\u4e2d\u95f4\u8fed\u4ee3\u4fe1\u606f\n                 int setx0,   //\u662f\u5426\u4f7f\u7528\u5df2\u521d\u59cb\u5316\u7684x\u4e3ax0\u5f00\u59cb\u8fed\u4ee3\n                 int max_iter,//\u6700\u5927\u8fed\u4ee3\u6b21\u6570\n                 double tol,  //\u6700\u5c0f\u76f8\u5bf9\u6b8b\u5dee\n                 //\u6c42Ax\u7684\u51fd\u6570\uff0c\u8fd9\u91cc\u7684void*\u662f\u4e3a\u4e86\u9002\u5e94\u5176\u4ed6\u6570\u636e\u7ed3\u6784\n                 void(*func_av)(int, void*, double *, double *),   \n                 //\u6c42\u89e3LUx=b\u7684\u51fd\u6570\uff0c\u8fd9\u91cc\u7684void*\u662f\u4e3a\u4e86\u9002\u5e94\u5176\u4ed6\u6570\u636e\u7ed3\u6784\n                 void(*func_pv)(int, void*, void*, \n                 double *, double *), //inv(LU)x\n                 void *a; //A, L,U\u4e09\u4e2a\u77e9\u9635\n                 void *l;\n                 void *u;\n                 SQMR_BUFFER *buffer; //\u4e03\u4e2a\u8f85\u52a9\u53d8\u91cf\n                 double *b,   \n                 double *x, \n                 double *err); //\u6700\u7ec8\u6b8b\u5dee\n</code></pre> \u5176\u8c03\u7528\u5f62\u5f0f\u4e3a\uff1a <pre><code>    ......\n    CSR_MATRIX a1, l1, u1;\n    double *a2;\n    double *l2;\n    double *u2;\n    SQMR_BUFFER buff1, buff2;\n    ......\n    //\u5206\u914dbuffer\u7684\u5185\u5b58\uff0c\u521d\u59cb\u5316x\u548cb\u7b49\u9884\u5907\u5de5\u4f5c\n    ......\n    //\u8bbe\u8bef\u5dee\u4e3a\u5927\u503c\n    double err1 = 1.0;\n    double err2 = 1.0;\n    //\u6c42\u89e3\u7a00\u758f\u95ee\u9898\n    sqmr_solve(n, 0, 0, 100, 1.0E-8,\n               compute_av_csr, solve_pv_csr,\n               (void *)a1, (void *)l1, (void *)u1,\n               &amp;buff1, b1, x1, &amp;err1);\n    //\u6c42\u89e3\u81f4\u5bc6\u95ee\u9898\n    sqmr_solve(n, 0, 0, 100, 1.0E-8,\n               compute_av_csr, solve_pv_csr,\n               (void *)a2, (void *)l2, (void *)u2,\n               &amp;buff2, b2, x2, &amp;err2);\n    ......\n    //\u6309\u9700\u6c42\u51b3\u5b9a\u662f\u5426\u91ca\u653ebuffer\u7684\u7a7a\u95f4\n    ......\n</code></pre></p>"},{"location":"markdown/c99_sqmr_solver/#23","title":"2.3 \u8fdb\u4e00\u6b65\u5c01\u88c5","text":"<p>\u524d\u6587\u7684\u7b80\u5355<code>sqmr_solve</code>\u51fd\u6570\u9700\u4f20\u901215\u4e2a\u53c2\u6570\uff0c\u4e0d\u5229\u4e8e\u4ee3\u7801\u7ef4\u62a4\u53ca\u7b2c\u4e09\u65b9\u8c03\u7528\uff0c\u53ef\u5229\u7528\u7ed3\u6784\u4f53\u51cf\u5c11\u5f62\u53c2\uff0c\u5e76\u589e\u52a0<code>setter</code>\u63a5\u53e3\u51fd\u6570\u4f7f\u5176\u5916\u90e8\u8c03\u7528\u65b9\u5f0f\u7c7b\u4f3cC++\u7684OOP\u4ee3\u7801\u3002   \u53e6\u5916\uff0c\u4e4b\u524d\u5bf9\u9884\u6761\u4ef6\u77e9\u9635\u4f7f\u7528\u4e86\u4e24\u4e2a\u578b\u53c2\uff0c\u5fc5\u987b\u6709\u4e00\u4e2a<code>l</code>\u548c\u4e00\u4e2a<code>u</code>\uff0c\u65e0\u6cd5\u9002\u5e94\u67d0\u4e9b\u4e0a\u3001\u4e0b\u4e09\u89d2\u5199\u5230\u4e00\u4e2a\u77e9\u9635\u4e2d\u7684\u7b2c\u4e09\u65b9\u5e93\u3002\u4ece\u901a\u7528\u6027\u8003\u8651\uff0c\u53ef\u8fdb\u4e00\u6b65\u9ad8\u9636\u62bd\u8c61\u3002 \u9996\u5148\uff0c\u5b9a\u4e49\u53c2\u6570\u7ed3\u6784\u4f53\uff1a <pre><code>typedef struct {\n    char name[16]; //\u672c\u6b21\u6c42\u89e3\u7684\u540d\u79f0\n    int  n;\n    int  quite;\n    int  use_x0;\n    int  max_iter;\n    void (*fun_av) (int n, void *, double *, double *);\n    void (*fun_pv) (int n, void *, double *, double *);\n    double *buffer[7];\n    void *matrix_a;\n    void *matrix_lu;\n    double err;\n    double tol;\n    double *b;\n    double *x;\n} SQMR_ARGS;\n\n//\u5b9a\u4e49\u51e0\u4e2a\u8f85\u52a9\u51fd\u6570\nvoid sqmr_init(int n, SQMR_ARG *args) {\n    args-&gt;n = n;\n    args-&gt;name = \"Noname\";\n    args-&gt;err = 1.0;\n    //\u8bbe\u5b9a\u4e00\u4e9b\u9ed8\u8ba4\u503c\n    ........\n}\n//\u7528\u51fd\u6570\u63a5\u53e3\u7684\u65b9\u5f0f\u6dfb\u52a0setter\nvoid sqmr_set_maxiter(int max, SQMR_ARG *args);\nvoid sqmr_set_tol(double tol, SQMR_ARG *args);\nvoid sqmr_set_func_av(void (*fun_ax) (int n, void *, double *, double *), \n                      SQMR_ARG *args);\nvoid sqmr_set_func_pv(void (*fun_ax) (int n, void *, double *, double *), \n                      SQMR_ARG *args);\nvoid sqmr_run(SQMR_ARG *args);\n......\n</code></pre> \u5047\u8bbe\u73b0\u5728\u6709\u4e24\u79cd\u77e9\u9635\uff0cCSR\u548c\u6309\u5217\u5b58\u50a8\u7684\u81f4\u5bc6\u9635\uff0c\u4e14\u5b83\u4eec\u7684LU\u5206\u89e3\u5206\u522b\u662f\u4e24\u4e2aCSR\u548c\u4e00\u4e2a\u81f4\u5bc6\u9635\uff0c\u5982\u4e0b: <pre><code>    CSR_MATRIX *csr_a   //\u7a00\u758fA  \n    CSR_MATRIX *csr_l;  //\u7a00\u758fL\n    CSR_MATRIX *csr_u;  //\u7a00\u758fU\n    double *den_a;      //\u81f4\u5bc6A\n    double *den_lu;     //\u81f4\u5bc6LU\uff0c\u4e14\u5b58\u5230\u4e00\u4e2a\u65b9\u9635\u91cc\u9762\n</code></pre> \u4e3a\u4e86SQMR\u6c42\u89e3\u5668\u80fd\u591f\u8c03\u7528\u8fd9\u4e24\u79cd\u5f62\u5f0f\uff0c\u9700\u7edf\u4e00\u51fd\u6570\u7684\u53c2\u6570\u8868\uff0c\u5b9e\u73b0\u4e24\u7ec4\u51fd\u6570\u5982\u4e0b\uff1a <pre><code>void csr_av(int n, void *a, double *v, double *av) {\n    CSR_MATRIX *m = (CSR_MATRIX *)a;\n    //CSR\u7684\u4e58\u6cd5\n    ......\n}\n\ntypedef struct {\n    CSR_MATRIX *l;\n    CSR_MATRIX *u;\n} CSR_LU;\n\nvoid csr_pv(int n, void *lu, double *v, double *pv) {\n    CSR_LU *lu = (CSR_LU*)lu;\n    CSR_MATRIX *l = lu-&gt;l;\n    CSR_MATRIX *u = lu-&gt;u;\n    //LUx=b\u7684\u89e3\u6cd5\n    ......\n}\n\nvoid dense_av(int n, void *a, double *v, double *av) {\n    double *dense_a = (double *)a;\n    //\u81f4\u5bc6\u77e9\u9635\u4e58\u6cd5\n    ......\n}\n\nvoid dense_pv(int n, void *lu, double *v, double *pv) {\n    double *dense_lu = (double *)lu;\n    //\u81f4\u5bc6LU\u5b58\u5728\u4e00\u8d77\u7684\u89e3\u6cd5\n}\n</code></pre> \u6539\u8fdb\u7248\u7684\u901a\u7528\u9ad8\u9636<code>sqmr_run</code>\u51fd\u6570\u5916\u90e8\u8c03\u7528\u65b9\u5f0f\u5982\u4e0b\uff1a <pre><code>    SQMR_ARG csr_arg, dense_arg;\n    //CSR\u6c42\u89e3\u5668\n    sqmr_init(&amp;csr_arg);\n    sqmr_set_name(\"CSR\", &amp;csr_arg);\n    sqmr_set_tol(1.0E-8, &amp;csr_arg);\n    sqmr_set_func_av(csr_av, &amp;csr_arg);\n    sqmr_set_func_pv(csr_pv, &amp;csr_arg);\n    sqmr_set_matrix_a((void*)csr_a, &amp;csr_arg);\n    CSR_LU lu;\n    lu-&gt;l = csr_l;\n    lu-&gt;u = csr_u;\n    sqmr_set_matrix_lu((void*)(&amp;lu), &amp;csr_arg);\n    ....\n    //DENSE\u6c42\u89e3\u5668\n    sqmr_init(&amp;dense_arg);\n    sqmr_set_name(\"DENSE\", &amp;dense_arg);\n    sqmr_set_tol(1.0E-8, &amp;dense_arg);\n    sqmr_set_matrix_a((void*)dense_a, &amp;csr_arg);\n    sqmr_set_matrix_lu((void*)dense_lu, &amp;csr_arg);\n    sqmr_set_func_av(dense_av, &amp;dense_arg);\n    sqmr_set_func_pv(dense_av, &amp;dense_arg);\n    //\u5f00\u59cb\u6c42\u89e3\n    sqmr_run(&amp;csr_arg);\n    sqmr_run(&amp;dense_arg);\n    ........\n</code></pre></p>"},{"location":"markdown/c99_sqmr_solver/#24","title":"2.4 \u9ad8\u9636\u6c42\u89e3\u51fd\u6570\u7684\u5b9e\u73b0","text":"<p>\u6309\u524d\u6587\u7684\u5c01\u88c5\u65b9\u5f0f\uff0c<code>sqmr_run</code>\u51fd\u6570\u7684\u6240\u6709\u53c2\u6570\u5df2\u7528<code>SQMR_ARG</code>\u7c7b\u578b\u5c01\u88c5\u5b8c\u6bd5\uff0c\u5176\u5b9e\u73b0\u7684\u5173\u952e\u90e8\u5206\u5728\u4e8e\u7ed3\u6784\u4f53\u89e3\u6790\u548c\u51fd\u6570\u6307\u9488\u8c03\u7528\uff0c\u4ee3\u7801\u5173\u952e\u90e8\u5206\u5982\u4e0b\uff1a <pre><code>void sqmr_run(SQMR_ARG *arg) {\n    int n = args-&gt;n;\n    double *b    = arg-&gt;b;\n    double *x    = arg-&gt;x;\n    //\u8bbe\u7f6e7\u4e2a\u8f85\u52a9\u5411\u91cf\n    double *r    = arg-&gt;buffer[0];\n    double *d    = arg-&gt;buffer[1];\n    double *p    = arg-&gt;buffer[2];\n    double *s    = arg-&gt;buffer[3];\n    double *t    = arg-&gt;buffer[4];\n    double *v    = arg-&gt;buffer[5];\n    double *vhat = arg-&gt;buffer[6];\n    //\u5176\u4ed6\u4e34\u65f6\u53d8\u91cf\n    double tow, tow0, cc, cc0, theta, theta0, re, im;\n    double alpha, beta, delta;\n    double eta, epsilon;\n    //1.\u8ba1\u7b97\u521d\u59cb\u6b8b\u5dee\n    double rnorm, bnorm;\n    bnorm = dnorm2(n, b);\n    if(bnorm &lt;= 1.0E-10) { bnorm = 1.0; }\n    if(arg-&gt;use_x0 == 0) {\n        //\u6c42\u53d6r=Ax\n        arg-&gt;func_av(n, arg-&gt;matrix_a, x, r);\n        .....\n        arg-&gt;err = rnorm / bnorm;\n    } else {\n        for(int i = 0; i &lt; n; ++i) {\n            x[i] = 0.0;\n            r[i] = b[i];\n        }\n        rnorm = bnorm;\n        arg-&gt;err = 1.0;\n    }\n    ......\n    //\u5f00\u59cb\u5faa\u73af\n    for(int iter=0; iter &lt; arg-&gt;max_iter; ++iter) {\n        //\u5982\u679c\u4e0d\u662f\u9759\u9ed8\u6a21\u5f0f\u5219\u8f93\u51fa\u8fed\u4ee3\u4fe1\u606f\n        if(arg-&gt;quiet != 0) {\n            printf(\"solver:%s iter:%d ||r||/||b||:%e\\n\",\n                   arg-&gt;name, iter, arg-&gt;err);\n        }\n        ....\n        //\u6c42\u89e3LU\u00d7vhat = v\n        arg-&gt;func_pv(n, arg-&gt;matrix_lu, v, vhat);\n        ....\n\n    }\n}\n</code></pre></p>"},{"location":"markdown/c99_sqmr_solver/#_1","title":"\u603b\u7ed3","text":"<p>\u628a\u4ee3\u7801\u91cc\u6709\u901a\u7528\u64cd\u4f5c\u7684\u90e8\u5206\u63d0\u53d6\u51fa\u6765\uff0c\u9002\u5f53\u7684\u62bd\u8c61\u6709\u5229\u4e8e\u6a21\u5757\u5316\u3002 \u4e0d\u8981\u8fc7\u5ea6\u62bd\u8c61\u800c\u9677\u5165\u8bed\u6cd5\u9677\u9631\uff0c\u5f88\u591aOOP\u8bed\u8a00\u63d0\u4f9b\u4e86\u9ad8\u9636\u62bd\u8c61\u8bed\u6cd5\uff0c\u4f46\u5f80\u5f80\u5e26\u6765\u4e86\u201c\u5fc3\u667a\u5305\u88b1\u201d\uff0c\u8ba9\u4f60\u4ea7\u751f\u5fc5\u987b\u8fd9\u4e48\u5199\u7684\u9519\u89c9\u3002\u4ece\u8fd9\u4e2a\u610f\u4e49\u6765\u8bf4\uff0c\u6211\u7279\u522b\u4e0d\u559c\u6b22C++\u3002\u5199C++\u7684\u65f6\u5019\u968f\u4fbf\u5e72\u70b9\u4ec0\u4e48\u90fd\u6709\u597d\u51e0\u79cd\u6a21\u5f0f\uff0c\u597d\u51e0\u79cd\u8bed\u6cd5\uff0c\u4ee5\u76ee\u524d\u6211\u7684\u83dc\u9e1f\u6c34\u5e73\uff0c\u8fd8\u662f\u8001\u8001\u5b9e\u5b9e\u5199C\u4ee3\u7801\u597d\u4e86\u3002 <code>void *</code>\u8fd9\u4e2a\u7c7b\u578b\u662f\u7cbe\u9ad3\uff0c\u5728C\u8bed\u8a00\u6781\u5176\u7b80\u964b\u7684\u7c7b\u578b\u7cfb\u7edf\u4e0b\uff0c\u4ecd\u7136\u80fd\u505a\u5230\u5c11\u8bb8\u7684\u51fd\u6570\u5f0f\u7f16\u7a0b\u6a21\u62df\u3002 \u4e16\u754c\u662f\u4e0d\u5b8c\u7f8e\u7684\uff0c\u6ca1\u6709\u80fd\u89e3\u51b3\u4e00\u5207\u7684\u94f6\u5f39\uff08silver bullet\uff09\u3002</p>"},{"location":"markdown/cpp_oop_is_a_dirty_trick/","title":"c++\u7684\u6302\u7f8a\u5934\u4e70\u72d7\u8089","text":"<p>\u6211\u4e00\u76f4\u5bf9C++\u6ca1\u6709\u597d\u611f\uff0c\u603b\u89c9\u5f97\u6bcf\u5199\u4e0b\u4e00\u53e5C++\u5c31\u50cf\u662f\u4eb2\u624b\u57cb\u4e86\u4e00\u4e2a\u7206\u70b8\u65f6\u95f4\u4e3arandom()\u7684\u5ef6\u8fdf\u810f\u5f39\u3002\u65ad\u65ad\u7eed\u7eed\u7684\u5b66\u4e86\u4e00\u70b9Lisp\u7684\u76ae\u6bdb\u4e4b\u540e\uff0c\u8fd9\u79cd\u611f\u89c9\u66f4\u751a\u3002\u5f88\u591a\u4eba\u5bf9\u8bf4C++\u574f\u8bdd\u7684\u4eba\u55e4\u4e4b\u4ee5\u9f3b\uff1a \u201c\u7406\u8bba\u4e0a\u4f60\u662f\u5bf9\u7684\uff0c\u7136\u800c\u4f60\u884c\u4f60\u4e0a\u5457\uff1f\u201d \u201c\u4e16\u754c\u4e0a\u6709\u4e24\u79cd\u8bed\u8a00\uff0c\u4eba\u4eba\u9a82\u7684\u548c\u6ca1\u4eba\u7528\u7684\u3002\u201d \u201cC++\u65e2\u7ed9\u4e86\u4f60OOP\uff0c\u53c8\u7ed9\u4e86\u4f60\u8fc7\u7a0b\u5f0f\uff0c\u4f60\u8fd8\u8981\u600e\u6837\uff1f\u201d \u7136\u9e45\uff0c\u8fd1\u65e5\u5076\u7136\u5728\u67d0\u4e2a404\u7684\u89c6\u9891\u5e94\u7528\u91cc\u9762\u770b\u5230\u4e86\u4e00\u4e9bC++\u7684hacking\u4f8b\u5b50\uff0c\u89c9\u5f97\u7279\u522b\u6709\u610f\u601d\u3002\u6211\u8981\u628a\u5b83\u8bb0\u5f55\u5728\u5c0f\u672c\u672c\u4e0a\u9762\uff0c\u4ee5\u540e\u55b7\u4eba\u7528\u5f97\u7740\u3002\uff1a\uff09  </p> <p>\u58f0\u660e1\uff1a\u672c\u6587\u6240\u6709\u7a0b\u5e8f\u5b9e\u4f8b\u5747\u4fee\u6539\u81ea\u67d0404\u89c6\u9891\u7f51\u7ad9\u64ad\u4e3b@Creel\uff0c\u539f\u89c6\u9891\u7684\u6807\u9898\u662fObject Oriented Programming is a Dirty\uff0cRotten\uff0cLow-down Trick\u3002\u55ef\uff0c\u6211\u89c9\u5f97Bjarne Stroustrup\u80af\u5b9a\u6b20\u4ed6\u5f88\u591a\u94b1\u3002 </p> <p>\u58f0\u660e2\uff1a\u4ee5\u4e0b\u7684\u4e00\u4e9bhacking\u4ee3\u7801\u4ec5\u4ee5\u5b66\u672f\u8ba8\u8bba\u548c\u4e92\u55b7\u4e3a\u76ee\u7684\uff0c\u65e0\u8bba\u5982\u4f55\uff0c\u4f60\u90fd\u4e0d\u5e94\u8be5\u628a\u8fd9\u79cdhacking\u6280\u5de7\u7528\u5728\u5b9e\u9645C++\u9879\u76ee\u4e2d\u3002 </p>"},{"location":"markdown/cpp_oop_is_a_dirty_trick/#1","title":"1. \u79c1\u6709\u53d8\u91cf\u4e0d\u79c1\u6709","text":"<p>\u51e0\u4e4e\u6240\u6709\u7684OOP\u8bed\u8a00\u90fd\u6709\u79c1\u6709\u6210\u5458\uff0c\u6211\u4eec\u90fd\u4f1a\u88ab\u6559\u5bfc\u8bf4\uff1a\u201c\u79c1\u6709\u7684\u597d\u5904\u662f\u7c7b\u7684\u5185\u90e8\u4e16\u754c\u548c\u5916\u90e8\u4e16\u754c\u4f1a\u88ab\u9694\u79bb\u5f00\u6765\uff0c\u5b9e\u73b0\u5c01\u88c5\u3002\u5982\u679c\u4f60\u60f3\u8981\u5728\u5916\u90e8\u4e16\u754c\u83b7\u53d6\u6216\u4fee\u6539\u79c1\u6709\u6210\u5458\uff0c\u4f60\u5fc5\u987b\u7528<code>getter</code>\u548c<code>setter</code>\u51fd\u6570\u6765\u7ed9\u5916\u90e8\u63d0\u4f9b\u63a5\u53e3\u3002\u201d\u6bd4\u5982\u8fd9\u6837\uff1a  </p> <pre><code>#include &lt;iostream&gt;\n\nclass Ptest {\npublic:\n    Ptest()  {   //\u6784\u9020\u51fd\u6570\n        _a = 0;  //\u521d\u59cb\u5316\u4e3a0\n    }\n    ~Ptest() { }\n\n    int getA() {  //getter\n        return _a;\n    }\n\n    void setA(int a) { //setter\n        _a = a;\n    }\n\nprivate:    \n    int _a;  //\u79c1\u6709\u6210\u5458_a\n};\n\nint main() {\n    Ptest ptest = Ptest();  //\u79c1\u6709\u53d8\u91cf_a\u4e3a0\n    ptest.setA(5);          //\u7528setter\u4fee\u6539_a\u4e3a5\n    std::cout &lt;&lt; ptest.getA() &lt;&lt; std::endl; //\u7528getter\u83b7\u53d6_a\n    return 0;\n}\n</code></pre> <p>\u8fd9\u4e2a\u4f8b\u5b50\u770b\u8d77\u6765\u6ca1\u6709\u5fc5\u8981\u7528<code>setter</code>\u548c<code>getter</code>\uff0c\u56e0\u4e3a\u6210\u5458\u53d8\u91cf\u53ea\u6709\u4e00\u4e2a<code>_a</code>\u3002\u4f46\u8d44\u6df1\u4eba\u58eb\u603b\u662f\u8bf4\uff1a\u201c\u5f53\u9879\u76ee\u590d\u6742\u5230\u4e00\u5b9a\u7a0b\u5ea6\u8fd9\u6837\u505a\u662f\u975e\u5e38\u5fc5\u8981\u7684\uff0c\u56e0\u4e3a\u4e00\u4e2a\u7c7b\u5f88\u590d\u6742\u7684\u65f6\u5019\uff0c\u9700\u8981\u628a\u4e00\u4e9b\u80ae\u810f\u7684\uff0c\u4e0d\u53c2\u4e0e\u4ea4\u4e92\u7684\u53d8\u91cf\u56da\u7981\u5728\u81ea\u5df1\u7684\u4e16\u754c\uff0c\u800c\u53ea\u5141\u8bb8\u5f88\u5c11\u6570\u7684\u5fc5\u8981\u7684\u53d8\u91cf\u548c\u5916\u754c\u4ea4\u4e92\u3002\u201d\u539f\u6559\u65e8Java\u5974\u4eec\u66f4\u662f\u89c4\u5b9a\uff1a\u201c\u4e00\u5207\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u90fd\u5fc5\u987b\u79c1\u6709\uff01\u201d   \u597d\u5427\uff0c\u867d\u7136\u770b\u8d77\u6765\u5f88\u9ebb\u70e6\uff0c\u4f46\u8fd9\u4e2a\u89c2\u70b9\u770b\u8d77\u6765\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\u7136\u800c\uff0c\u73b0\u4ee3\u7684OOP\u53c8\u544a\u8bc9\u6211\u4eec\uff1a\u201c\u5f53\u4e00\u4e2a\u7c7b\u590d\u6742\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u5199\u6210\u5f88\u591a\u7b80\u5355\u7684\u5b50\u7c7b\u578b\u7684\u7ec4\u5408\u3002\u201d\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u8fd9\u4e9b\u7b80\u5355\u7684\u5b50\u7c7b\u578b\u662f\u5426\u6709\u5fc5\u8981\u8fd9\u4e48\u641e\u5462\uff1f \u5f88\u591a\u4e8b\u60c5\u4e0d\u9700\u8981\u8bba\u8bc1\u7684\uff0cJava\u53ef\u4ee5\u8bf4\u662f\u7eaf\u79cdOOP\u7684\u8bed\u8a00\uff0c\u4f46\u8c8c\u4f3c\u73b0\u4ee3Java\u5974\u4eec\u4e5f\u5f00\u59cb\u53d7\u4e0d\u4e86\u65e0\u4f11\u6b62\u7684<code>setter</code>\u548c<code>getter</code>\u4e86\uff0c\u6bd4\u5982\u8fd9\u4e9b\u82e6\u5de5\u4eec\u7528Lombok\u5e93\u641e\u4e86\u4e2a<code>@Getter</code>\u3001<code>@Setter</code>\u6ce8\u89e3\u3002C#\u641e\u4e86\u66f4\u8be1\u5f02\u7684\u65b9\u5f0f\uff0c\u5982\u4e0b\uff1a  </p> <pre><code>public class Ptest {\n    //\u5916\u90e8\u53ef\u4ee5c=Ptest.a,\u4e0d\u80fdPtest.a=c\uff0c\u56e0\u4e3asetter\u79c1\u6709\n    public int a {get; private set;} \n\n    //\u7b49\u4ef7\u4e8e\u4e00\u4e2apublic\u53d8\u91cfb\n    public int b {get; set;}         \n}\n</code></pre> <p>\u8fd9\u4e24\u79cd\u65b9\u5f0f\u90fd\u662f\u8bed\u6cd5\u7cd6\uff0c\u672c\u8d28\u4e0a\u4ecd\u7136\u662f\u6700\u521d\u7684\u90a3\u79cd\u8001\u8001\u5b9e\u5b9e\u7684\u4ee3\u7801\uff0c\u6b63\u6240\u8c13\u201c\u5927\u5de7\u4e0d\u5de5\uff0c\u4ee5\u62d9...\u90a3\u4e2a...\u672c\u6765\u5c31\u5f88\u62d9\u201c\u3002\u4e0d\u8fc7\u6709\u4e00\u70b9\u53ef\u4ee5\u80af\u5b9a\uff0c\u4e00\u65e6\u6210\u5458\u53d8\u91cf\u88ab\u58f0\u660e\u662f<code>private</code>\u7684\uff0c\u90a3\u4e48\u65e0\u8bba\u5982\u4f55\uff0c\u4f60\u5728\u5916\u90e8\u4e16\u754c\u90fd\u5e94\u8be5\u4e0d\u5141\u8bb8\u76f4\u63a5\u4fee\u6539\u5b83\uff0c\u8fd9\u4e00\u70b9\u5728Java\u548cC#\u91cc\u6210\u7acb\u6216\u90e8\u5206\u6210\u7acb\u3002 \u81f3\u4e8eC++\u561b......\u8bf4\u4ec0\u4e48\u597d\u5462\uff1f\u5982\u679c\u6211\u4eec\u8bd5\u56fe\u5728\u5916\u90e8\u51fd\u6570\u91cc\u4fee\u6539<code>Ptest</code>\u7c7b\u7684\u79c1\u6709\u53d8\u91cf<code>_a</code>\uff08\u6bd4\u5982\uff0c\u4f60\u5199<code>ptest._a = 4</code>\uff09\uff0c\u5728clang++\u7f16\u8bd1\u5668\u4e0b\u4f1a\u62a5\u9519\uff1aerror: '_a' is a private member of 'Ptest'\u3002\u55ef\uff0c\u770b\u8d77\u6765\u4e0d\u9519\uff0c\u7f16\u8bd1\u5668\u786e\u5b9e\u963b\u6b62\u6211\u4eec\u8fd9\u4e48\u5e72\uff0c\u4f46\u4f60\u4e5f\u53ef\u4ee5\u8fd9\u6837\uff1a  </p> <pre><code>...\n\nint main() {\n    Ptest ptest = Ptest();    //\u79c1\u6709\u53d8\u91cf_a\u4e3a0\n    int *pa = (int*) &amp;ptest;  //\u5b9a\u4e49\u4e00\u4e2aint*\u7684\u6307\u9488\u6307\u5411ptest\u5730\u5740\n    *pa = 123\uff1b                //\u628a\u8fd9\u4e2a\u5730\u5740\u6539\u4e3aint\u578b\u7684123\n    std::cout &lt;&lt; ptest.getA() &lt;&lt; std::endl; //\u80fd\u7f16\u8bd1\u901a\u8fc7\u5417\uff1f\n    return 0;\n}\n</code></pre> <p>\u6309\u7167OOP\u7684\u89c4\u77e9\uff0c\u8fd9\u4e48\u5e72\u5e94\u8be5\u662f\u7edd\u5bf9\u88ab\u7981\u6b62\u7684\u3002\u4f46\u4ee5\u4e0a\u7684\u7a0b\u5e8f\u5b8c\u5168\u5408\u6cd5\uff0c\u6b63\u786e\u7684\u5728\u5916\u90e8\u628a<code>ptest._a</code>\u53d8\u91cf\u4fee\u6539\u4e3a123\uff0c\u5e76\u6253\u5370\u4e86\u51fa\u6765\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1aC++\u7684private\u5728\u6302\u7f8a\u5934\uff0c\u4e70\u72d7\u8089\u3002\uff1a\uff09 </p> <p>\u5f53\u7136\uff0c\u5373\u4f7f\u6210\u5458\u53d8\u91cf\u4e0d\u6b62\u4e00\u4e2a\uff0c\u4f60\u540c\u6837\u53ef\u4ee5\u8fd9\u4e48\u5e72\uff1a  </p> <pre><code>#include &lt;iostream&gt;\n\nclass Ptest {\npublic:\n    void printA() { std::cout &lt;&lt; _a &lt;&lt; std::endl; }\n    void printB() { std::cout &lt;&lt; _b &lt;&lt; std::endl; }\nprivate:    \n    int  _a;  //\u79c1\u6709\u6210\u5458_a 4\u4e2a\u5b57\u8282\n    char _c;  //\u79c1\u6709\u6210\u5458_c 1\u4e2a\u5b57\u8282+3\u4e2a\u5bf9\u9f50\u7528\u7684\u7a7a\u5b57\u8282\n    int  _b;  //\u79c1\u6709\u6210\u5458_b 4\u4e2a\u5b57\u8282\n};\n\nint main() {\n    Ptest ptest;\n    int *p = (int *) &amp;ptest;\n    *p = 123;   //OK\uff0c\u5230\u8fd9\u91cc\u548c\u524d\u9762\u4e00\u6837\n    p++;        //\u73b0\u5728p\u6307\u5411\u4e86_c\uff0c\u5730\u5740+4\uff0c\u521a\u597d\u8d8a\u8fc7\u4e86\u540e\u97623\u4e2a\u7a7a\u5b57\u8282\n    p++;        //\u73b0\u5728p\u6307\u5411\u4e86_b\uff0c\u5730\u5740+4\n    *p = 456;   //    \u6210\u529f\u7684\u628a_c\u8d4b\u503c\u4e3a456\n    ptest.printA();\n    ptest.printB();\n    return 0;\n}\n</code></pre> <p>\u81ea\u4ece\u6709\u4e86\u6307\u9488\u7c7b\u578b\uff0cC++\u7ed9\u4e86\u4f60C\u8bed\u8a00\u64cd\u4f5c\u5185\u5b58\u7684\u80fd\u529b\uff0c\u73b0\u5728\u4ec0\u4e48<code>public</code>,<code>private</code>\u4e4b\u7c7b\u7684\u4fee\u9970\u5f62\u540c\u865a\u8bbe\u3002 \u5f53\u7136\uff0c\u4e0a\u9762\u6211\u4eec\u4e24\u4e2a<code>p++</code>\u8c03\u7528\u662f\u5229\u7528\u4e86C++\u7c7b\u7684\u201c\u5bf9\u9f50\u201d\u673a\u5236\u3002\u5982\u679c\u4f60\u662f\u4e2a\u5185\u5b58\u5f3a\u8feb\u75c7\u60a3\u8005\uff0c\u4e3a\u4e86\u7701\u6389\u4e00\u4e9b\u7a7a\u5b57\u8282\uff0c\u628a\u53d8\u91cf\u987a\u5e8f\u5199\u4e3a<code>char _c</code>\u5728\u524d\uff0c\u4e24\u4e2a<code>int _a, _b</code>\u5728\u540e\uff0c<code>p++</code>\u5c31\u4e0d\u80fd\u7528\u4e86\u3002\u4f46\u90a3\u4e5f\u4e0d\u80fd\u963b\u6321<code>main</code>\u51fd\u6570\u4e16\u754c\u91cc\u7834\u574f\u5206\u5b50\u7684\u811a\u6b65\u3002\u4ed6\u4eec\u4f1a\u7528\u5f3a\u5236\u6307\u9488\u7c7b\u578b\u8f6c\u6362\u83b7\u5f97\u6bcf\u4e2a\u53d8\u91cf\u7684\u5730\u5740\u3002 \u4e00\u8a00\u4ee5\u5f0a\u4e4b\uff0c\u5728\u4f1f\u5927\u7684C++\u4e16\u754c\u91cc\uff0c\u53ea\u8981\u4f60\u7ed9\u522b\u4eba\u770b\u4e86\u5934\u6587\u4ef6\uff0c\u90a3\u4e48<code>private</code>\u548c<code>public</code>\u5c31\u53d8\u5f97\u6beb\u65e0\u610f\u4e49\u3002C++\u7684\u6240\u8c13OOP\u5b9e\u9645\u4e0a\u53ea\u662f\u8bed\u6cd5\u7cd6\u800c\u5df2\uff0c\u5728\u5b83\u773c\u91cc\u6240\u6709\u7684\u6570\u636e\u90fd\u662f\u5185\u5b58\u91cc\u7684\u4e00\u56e2\u6d46\u7cca\u3002\u5c31\u201c\u5c01\u88c5\u201d\u7684\u5b57\u9762\u610f\u4e49\u6765\u8bf4\uff0cC++\u770b\u4f3c\u641e\u4e86\u90a3\u4e48\u591a\u82b1\u6837\uff0c\u5176\u5b9e\u53ea\u662f\u65e0\u7528\u529f\u3002  </p>"},{"location":"markdown/cpp_oop_is_a_dirty_trick/#2","title":"2. \u8be1\u5f02\u7684\u7ee7\u627f\u548c\u591a\u6001","text":"<p>\u7ee7\u627f\u548c\u591a\u6001\u5e94\u8be5\u662fOOP\u4e2d\u6700\u57fa\u7840\u7684\u6982\u5ff5\u3002\u5728\u8bfb\u4e66\u7684\u65f6\u5019\uff081999\uff5e2006\uff09\uff0c\u603b\u89c9\u5f97\u7ee7\u627f\u548c\u591a\u6001\u7b80\u76f4\u662f\u795e\u6280\u3002\u540c\u6837\u4e00\u4e2a\u51fd\u6570\u540d\uff0c\u5c45\u7136\u53ef\u4ee5\u5373\u6709\u4e09\u4e2a\u53c2\u6570\uff0c\u53c8\u6709\u56db\u4e2a\u53c2\u6570\uff0c\u884c\u4e3a\u8fd8\u53ef\u4ee5\u5b8c\u5168\u4e0d\u540c\u3002\u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2a\u732b\u72d7\u53eb\u7684\u4f8b\u5b50\uff1a <pre><code>#include &lt;iostream&gt;\n\nclass Animal {  //\u57fa\u7c7b\uff1a\u52a8\u7269\npublic:\n    virtual void say() {  //\u57fa\u7c7b\u7684say\n        std::cout &lt;&lt; \"Animal sound!\" &lt;&lt; std::endl;\n    }\n};\n\nclass Dog : public Animal { //\u72d7\uff1ais a \u52a8\u7269\npublic:\n    virtual void say() { //\u6539\u53d8\u4e86say\u7684\u884c\u4e3a\n        std::cout &lt;&lt; \"Wang!\" &lt;&lt; std::endl;\n    }\n};\n\nclass Cat : public Animal { //\u732b\uff1ais a \u52a8\u7269\npublic:\n    virtual void say() { //\u6539\u53d8\u4e86say\u7684\u884c\u4e3a\n        std::cout &lt;&lt; \"Miao!\" &lt;&lt; std::endl;\n    }\n};\n\nint main() {\n    Cat cat;\n    Dog dog;    \n    cat.say();\n    dog.say();\n    return 0;\n}\n</code></pre> \u8fd9\u4e2a\u7a0b\u5e8f\u770b\u8d77\u6765\u975e\u5e38\u81ea\u7136\uff0c\u4f60\u7edd\u5bf9\u4e0d\u4f1a\u8ba4\u4e3a\u4ed6\u6709\u4efb\u4f55\u95ee\u9898\uff0c\u800c\u4e8b\u5b9e\u4e0a\u5b83\u786e\u5b9e\u4e5f\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\uff08\u5f53\u7136\uff0c\u8fd9\u662f\u5e9f\u8bdd\uff09\u3002\u540c\u6837\u4e00\u4e2a<code>say</code>\u7684\u540d\u5b57\uff0c\u901a\u8fc7\u7ee7\u627f\u7ed1\u5b9a\u5230\u4e0d\u540c\u7684\u52a8\u4f5c\u3002\u5f88\u53ef\u80fd\u86ee\u8352\u65f6\u4ee3\u7684\u7f16\u7a0b\u4e13\u5bb6\u8fd9\u4e48\u5e72\u7684\u539f\u56e0\u5c31\u662f\u60f3\u8ba9\u7a0b\u5e8f\u770b\u8d77\u6765\u50cf\u82f1\u8bed\u3002<code>cat.say()</code>\u7684\u786e\u770b\u8d77\u6765\u975e\u5e38\u50cf\"cat (which is a Cat type) say\"\u3002\u5728C\u8bed\u8a00\u91cc\u6211\u4eec\u5c31\u4e0d\u5f97\u4e0d\u53d6\u5f88\u591a\u4e92\u4e0d\u76f8\u540c\u7684\u540d\u5b57\uff0c\u5982<code>cat_say</code>\u3001<code>dog_say</code>\u3001<code>cat_say_more</code>\u3001<code>dog_say_more</code>\u7b49\u3002\u800c\u4e14\u968f\u7740\u8c03\u7528\u5c42\u6b21\u7684\u589e\u52a0\uff0c\u6bcf\u4e2a\u4e0d\u540c\u7684\u7c7b\u578b\u4f1a\u52a0\u4e0a\u66f4\u957f\u7684\u524d\u7f00\u3002\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u4e00\u5207\u90fd\u8fd8\u597d\uff0c\u4ee5\u4e0a\u7a0b\u5e8f\u7684\u8f93\u51fa\u4e3a\uff1a  </p> <pre><code>Miao!\nWang!\n</code></pre> <p>\u5373\u4f7f\u6709\u4e2a\u53d8\u6001\u975e\u8981\u8ba9\u732b\u72d7\u90fd\u505a\u52a8\u7269\u53eb\uff0c\u4ecd\u7136OK\uff08\u8c03\u7528\u7236\u7c7b\u7684say\u51fd\u6570\uff09\uff1a  </p> <pre><code>int main() {\n    Cat cat;\n    Dog dog;    \n    ((Animal) cat).say(); //\u5f3a\u5236\u628acat\u7684\u7c7b\u578b\u8f6c\u6362\u4e3aAnimal\u7136\u540e\u518dsay\n    ((Animal) dog).say(); //\u5f3a\u5236\u628adog\u7684\u7c7b\u578b\u8f6c\u6362\u4e3aAnimal\u7136\u540e\u518dsay\n    return 0;\n}\n</code></pre> <p>\u7a0b\u5e8f\u7684\u8f93\u51fa\u662f\uff1a  </p> <pre><code>Animal sound!\nAnimal sound!\n</code></pre> <p>\u4f46\u7528\u6307\u9488\u521b\u5efa\u7c7b\u7684\u5b9e\u4f8b\u65f6\uff0c\u60c5\u51b5\u53d8\u5f97\u4e0d\u540c\uff08\u8be1\u5f02\u7684\u662f\uff0c\u8fd9\u53cd\u800c\u662f\u6b63\u786e\u7684\u5904\u7406\u65b9\u6cd5\uff09\uff1a  </p> <pre><code>int main() {\n    Cat* cat = new Cat();   \n    Dog* dog = new Dog();    \n    ((Animal*) cat)-&gt;say(); //\u731c\u731c\u53d1\u751f\u5565\uff1f\n    ((Animal*) dog)-&gt;say(); //\u731c\u731c\u53d1\u751f\u5565\uff1f\n    delete cat;     //\u8bb0\u5f97\u91ca\u653e\u5185\u5b58\n    delete dog;     //\u8bb0\u5f97\u91ca\u653e\u5185\u5b58\n    return 0;\n}\n</code></pre> <p>\u867d\u7136\u6211\u4eec\u628a<code>cat</code>\u548c<code>dog</code>\u7684\u7c7b\u578b\u90fd\u5f3a\u5236\u8f6c\u6362\u4e3a<code>Animal*</code>\u4e86\uff0c\u4f46\u7a0b\u5e8f\u7684\u8f93\u51fa\u5374\u662f\uff1a  </p> <pre><code>Miao!\nWang!\n</code></pre> <p>Java\u7248\u672c\u7684\u60c5\u51b5\u4e5f\u662f\u5982\u6b64\uff0c\u8fd9\u79cd\u8bbe\u8ba1\u53ef\u80fd\u662f\u4e3a\u4e86\u5904\u7406\u5bb9\u5668\uff08C++\u662f\u4e0d\u662f\u53eb\u505a\u6cdb\u578b\u6765\u7740\uff1f\uff09\uff0c\u6bd4\u5982\u4f60\u6709\u4e00\u4e2a<code>std::vector&lt;Animal*&gt;</code>\u7c7b\u578b\u7684\u52a8\u6001\u6570\u7ec4\uff0c\u91cc\u9762\u653e\u4e0a100\u4e2a\u732b\u7684\u6307\u9488\uff0c100\u4e2a\u72d7\u7684\u6307\u9488\uff0c\u90a3\u4f60\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u5faa\u73af\u8ba9200\u4e2a\u732b\u732b\u72d7\u72d7\u53d1\u51fa\u5404\u81ea\u4e0d\u540c\u7684\u53eb\u58f0\uff0c\u50cf\u8fd9\u6837\uff1a  </p> <pre><code>    std::vector&lt;Animal*&gt; dogs_and_cats;\n    Dog *dog1 = new Dog();\n    dogs_and_cats.push_back( (Animal*) dog1);\n    ...   //\u4e00\u4e9b\u5f80\u6570\u7ec4dogs_and_cats\u91cc\u9762\u6dfb\u52a0\u732b\u732b\u72d7\u72d7\u7684\u4ee3\u7801\n    for(int i = 0; i &lt; dogs_and_cats.size(); ++i) {\n        dogs_and_cats[i]-&gt;say(); //\u732b\u732b\u72d7\u72d7\u53d1\u51fa\u5404\u81ea\u6109\u5feb\u7684\u53eb\u58f0\n    }\n</code></pre> <p>\u9020\u6210\u6307\u9488\u7248\u672c\u548c\u975e\u6307\u9488\u7248\u672c\u4e0d\u540c\u8f93\u51fa\u7684\u539f\u56e0\u5728\u4e8eC++\u7684\u8e69\u811a\u8bed\u6cd5\u3002\u5728C++\u4e2d\u865a\u51fd\u6570\u4f1a\u5728\u4e00\u4e2a\u7c7b\u521a\u521a\u5b9e\u4f8b\u5316\u7684\u65f6\u5019\u88ab\u7ed1\u5b9a\u5230\u7279\u5b9a\u7684\u5730\u5740\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u65e0\u8bba\u662f<code>Dog *pd = new Dog();</code>\u8fd8\u662f<code>Dog d;</code>\uff0c\u5728\u521d\u59cb\u5316\u4ee5\u540e\uff0c<code>pd</code>\u548c<code>d</code>\u7684<code>say()</code>\u51fd\u6570\u90fd\u4f1a\u7ed1\u5b9a\u5230<code>Dog</code>\u7c7b\u578b\u7684<code>say()</code>\u4e0a\uff0c\u4e14C++\u58f0\u79f0\u6b64\u540e\u6c38\u8fdc\u4e0d\u80fd\u66f4\u6539\uff08\u770b\u540e\u6587\u4f60\u5c31\u77e5\u9053\u5b83\u5728\u6492\u8c0e\uff0c\u563f\u563f\uff09\u3002 \u800c<code>((Animal) d).say();</code>\u548c<code>((Animal*) pd)-&gt;say();</code>\u5374\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u4e1c\u897f\uff0c\u5b83\u4eec\u88ab\u7b80\u5199\u4e86\uff0c\u771f\u6b63\u7684\u7b49\u4ef7\u4ee3\u7801\u662f\uff1a  </p> <pre><code>    // ((Animal) d).say()\u7684\u7b49\u4ef7\u4ee3\u7801\n    Animal a = (Animal) d;  //\u8fd9\u91cc\u65b0\u5efa\u4e86\u4e00\u4e2aAnimal\u7c7b\u578b\u7684\u5b9e\u4f8b\n    a.say();                //say\u88ab\u7ed1\u5b9a\u5230Animal\u7c7b\u578b\n\n    // ((Animal*) pd)-&gt;say()\u7684\u7b49\u4ef7\u4ee3\u7801\n    Animal* pa = (Animal*) pd;  //\u8fd9\u91cc\u6ca1\u6709\u65b0\u5efaAnimal\u7c7b\u578b\u7684\u5b9e\u4f8b\n    pa-&gt;say();                  //\u53ea\u662f\u6307\u9488\u6307\u5411\u4e86pd,\u6539\u53d8\u4e0d\u4e86say\u7684\u884c\u4e3a\n</code></pre> <p>\u770b\u5427\uff01\u53ea\u8981\u5b58\u5728\u7c7b\u578b\u8f6c\u6362\uff0cOOP\u7684\u884c\u4e3a\u5c31\u53d8\u5f97\u4ee4\u4eba\u8ff7\u60d1\uff1a\u4ece\u8bed\u4e49\u4e0a\u8bf4\uff0c\u6211\u65e2\u7136\u8f6c\u6362\u4e86\u7c7b\u578b\uff0c\u6210\u5458\u51fd\u6570\u5c31\u5e94\u8be5\u6539\u53d8\u5230\u90a3\u4e2a\u7c7b\u578b\u4e4b\u4e0b\uff1b\u4f46\u4ece\u5bb9\u5668\u89d2\u5ea6\u6765\u8bf4\u51fd\u6570\u884c\u4e3a\u53c8\u4e0d\u5e94\u8be5\u88ab\u8f6c\u6362\u3002\u771f\u662f\u4e24\u5934\u5835\u7684\u903b\u8f91\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u95ee\u9898\u7684\u6839\u672c\u5728\u4e8e\u6570\u636e\u548c\u51fd\u6570\u5c31\u4e0d\u5e94\u8be5\u5f3a\u884c\u7ed1\u5b9a\u5728\u4e00\u8d77\u3002\u73b0\u4ee3OOP\u53c8\u6559\u5bfc\u6211\u4eec\u8981\u57fa\u4e8e\u63a5\u53e3\u7f16\u7a0b\uff0c\u4e8e\u662f\u4f60\u770b\u5230\u5927\u5bb6\u5199\u4e00\u4e2a\u53ea\u6709\u6570\u636e\u7684\u7c7b\uff0c\u518d\u5199\u4e00\u4e2a\u53ea\u6709\u51fd\u6570\u7684\u7c7b\uff0c\u7136\u540e\u518d\u7ec4\u5408\u6210\u4e00\u4e2a\u65b0\u7c7b\u3002\uff1a\uff09\u7ec4\u5408\u4f18\u5148\u4e8e\u7ee7\u627f\u561b\uff01 </p> <p>OOP\u7a0b\u5e8f\u7684\u884c\u4e3a\u5df2\u7ecf\u8db3\u591f\u96be\u4ee5\u9884\u6d4b\u4e86\uff0cC++\u7684OOP\u66f4\u662f\u9ad8\u6df1\u83ab\u6d4b\uff08\u8d2c\u4e49\uff09\uff0c\u521a\u624d\u6211\u8bf4<code>Dog d</code>\u4e00\u65e6\u5b9e\u4f8b\u5316\uff0c<code>d.say()</code>\u51fd\u6570\u5c31\u88ab\u6307\u5411\u4e86<code>Dog</code>\u7c7b\u578b\u7684<code>say()</code>\u51fd\u6570\uff0c\u4e14\u4e0d\u80fd\u66f4\u6539\u3002\u4f46\u4f60\u5b8c\u5168\u53ef\u4ee5\u5e72\u51fa\u4efb\u4f55\u90aa\u4e4e\u7684\u4e8b\u60c5\u6765\uff0c\u6bd4\u5982\u8fd9\u6837\uff1a  </p> <pre><code>int main() {\n    Cat* cat = new Cat();   \n    Dog* dog = new Dog();    \n    unsigned long long* vtable_c = (unsigned long long*)cat;\n    unsigned long long* vtable_d = (unsigned long long*)dog;\n    //\u4ea4\u6362\u4e24\u4e2avtable\n    unsigned long long tmp = *vtable_c;\n    *vtable_c = *vtable_d;\n    *vtable_d = tmp;\n    //\u73b0\u5728\u72d7\u505a\u732b\u53eb\uff0c\u732b\u505a\u72d7\u53eb\u4e86\n    cat-&gt;say(); \n    dog-&gt;say(); \n    delete cat;     //\u8bb0\u5f97\u91ca\u653e\u5185\u5b58\n    delete dog;     //\u8bb0\u5f97\u91ca\u653e\u5185\u5b58\n    return 0;\n}\n</code></pre> <p>\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u8f93\u51fa\u662f\uff1a  </p> <pre><code>Wang!\nMiao!\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u91cc\uff0c\u53ea\u8981\u4f60\u6709\u4e86\u6307\u9488\u548c\u5f3a\u5236\u8f6c\u6362\uff0c\u5c31\u80fd\u628a<code>say</code>\u51fd\u6570\u6307\u5411\u4efb\u4f55\u5730\u65b9\u3002\u8ba9\u732b\u505a\u72d7\u53eb\u8fd8\u7b97\u662f\u6709\u826f\u5fc3\u7684\uff0c\u5982\u679c\u628a<code>creatData()</code>\u51fd\u6570\u6307\u5411<code>eraseDataBase()</code>\u624d\u53eb\u771f\u7684\u72e0\u6bd2\u3002 \u4f60\u8981\u76f8\u4fe1\u6211\uff0c\u8fd9\u7edd\u5bf9\u4e0d\u662f\u5371\u8a00\u8038\u542c\uff0c\u56e0\u4e3aC++\u7684\u5b9e\u4f8b\u6839\u672c\u4e0d\u77e5\u9053\u81ea\u5df1\u7684\u51fd\u6570\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\uff0c\u5b83\u53ea\u662f\u6839\u636e\u5730\u5740\u53bb\u5e72\u4ed6\u770b\u8d77\u6765\u5e94\u8be5\u53bb\u505a\u7684\u4e8b\u60c5\uff0c\u4efb\u4f55\u7c7b\u3001\u5b9e\u4f8b\u3001\u6570\u636e\u3001\u51fd\u6570\u7b49\u6982\u5ff5\u5bf9\u4e8eC++\u6765\u8bf4\u5c31\u662f\u4e00\u56e2\u4e8c\u8fdb\u5236\u6ce5\u5df4\u3002\u96be\u602a\u6709\u4e2a\u7b11\u8bdd\u8bf4\uff1a\u201cC\u8bed\u8a00\u7ed9\u4e86\u4f60\u4e00\u628a\u624b\u67aa\u81ea\u6740\uff0c\u800cC++\u7ed9\u4e86\u4f60\u4e00\u628a\u51b2\u950b\u67aa\uff0c\u8ba9\u4f60\u5148\u628a\u90bb\u5c45\u7a81\u7a81\u4e86\uff0c\u7136\u540e\u518d\u81ea\u6740\u3002\u201d</p>"},{"location":"markdown/cpp_oop_is_a_dirty_trick/#3c","title":"3.\u7b5b\u5b50\u4e00\u6837\u7684C++","text":"<p>\u5728C++\u4e2d\uff0c\u4e00\u65e6\u4e00\u4e2a\u6210\u5458\u51fd\u6570\u88ab<code>virtual</code>\u4fee\u9970\uff0c\u5b83\u5c31\u7b49\u4e8e\u4e00\u624b\u62ff\u5200\uff0c\u4e00\u624b\u6267\u7b5b\u5b50\uff08\u6ca1\u9519\uff0c\u4e0d\u662f\u76fe\u724c\uff09\u7684\u6218\u58eb\uff0c\u7b2c\u4e00\u8f6e\u7bad\u96e8\u5c31\u5df2\u5fc5\u6b7b\u65e0\u7591\u3002\u4e0a\u4e00\u4e2a\u7a0b\u5e8f<code>vtable</code>\u5bf9\u865a\u6210\u5458\u51fd\u6570\u7684\u7ba1\u7406\u5c31\u662f\u7b80\u5355\u7c97\u66b4\u7684\u5730\u5740\u6570\u7ec4\uff0c\u5b83\u751a\u81f3\u4e0d\u4f1a\u68c0\u67e5\u51fd\u6570\u540d\u79f0\u3001\u53c2\u6570\u7c7b\u578b\u7b49\u3002\u5728C++\u773c\u91cc\uff0c\u53ea\u8981\u4f60\u7ed9\u6211\u4e00\u4e2a\u5730\u5740\uff0c\u544a\u8bc9\u6211\u5b83\u662f\u4e2a\u51fd\u6570\uff0c\u90a3\u6211\u5c31\u6267\u884c\u3002\u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2a\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u7684\u4f8b\u5b50\uff1a  </p> <pre><code>#include &lt;iostream&gt;\n\n//\u8fd9\u4e2a\u7c7b\u662f\u4e0d\u9700\u8981\u6ce8\u91ca\u7684\nclass Cat { \npublic:\n    virtual void say() {\n        std::cout &lt;&lt; \"Cat say: Miao!\" &lt;&lt; std::endl;\n    }\n    virtual void eat(char* food) {\n        std::cout &lt;&lt; \"Cat eat: \" &lt;&lt; food &lt;&lt; std::endl;\n    }\n    virtual void sleep() {\n        std::cout &lt;&lt; \"Cat sleep!\" &lt;&lt; std::endl;\n    }\n};\n\n//\u6211\u4eec\u5728\u5916\u9762\u5b9a\u4e49\u4e86\u4e09\u4e2a\u51fd\u6570\uff0c\u8bd5\u56fe\u5728\u8fd0\u884c\u65f6\u66ff\u6362\u6389Cat\u7c7b\u5185\u90e8\u7684\u51fd\u6570\nvoid func1() {\n    std::cout &lt;&lt; \"We can not make sound!\" &lt;&lt; std::endl;\n}\n\n//\u8fd9\u91cc\u8981\u6ce8\u610f\u4e00\u4e0b\uff1aCat\u7684eat\u51fd\u6570\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\uff0c\u4f46\u5176\u5b9e\u7b2c\u4e00\u4e2athis\u6307\u9488\u662f\u88ab\u9ed8\u8ba4\u9690\u85cf\u7684\n//\u6240\u4ee5\u4e3a\u4e86\u5339\u914dCat::eat\u51fd\u6570\u7684\u53c2\u6570\u8868\uff0cfunc2\u9700\u8981\u5728\u524d\u9762\u52a0\u4e00\u4e2avoid*\u7684\u6307\u9488\nvoid func2(void* this_ptr, char* shit_type) {\n    std::cout &lt;&lt; \"We give \" &lt;&lt; shit_type &lt;&lt; \" shit!\" &lt;&lt; std::endl;\n}\n\nvoid func3() {\n    std::cout &lt;&lt; \"We are totally fucked!\" &lt;&lt; std::endl;\n}\n\nint main() {\n    Cat* cat = new Cat();   \n    //\u5b9a\u4e49\u4e00\u4e2a\u65e0\u53c2\u51fd\u6570\u6307\u9488\u7c7b\u578bpfunc\n    typedef void(*pfunc) ();\n    //\u6211\u4eec\u5efa\u7acb\u4e00\u4e2avtable,\u7c7b\u578b\u5c31\u662f\u65e0\u53c2\u51fd\u6570\u6307\u9488\n    //\u6ce8\u610ffunc2\u9700\u8981\u9996\u5148\u5f3a\u5236\u8f6c\u6362\u4e3a\u65e0\u53c2\u51fd\u6570\u6307\u9488\uff0c\u56e0\u4e3a\u5176\u51fd\u6570\u4f53\u662f2\u53c2\u6570\u7684\n    pfunc vtable[3] = {func1, (pfunc)func2, func3};\n    //\u73b0\u5728\u628acat\u7684vtable\u66ff\u6362\u4e3a\u5b9a\u4e49\u7684vtable\u6570\u7ec4\n    *((unsigned long long*) cat) = (unsigned long long)vtable;\n    //\u540e\u6765\u7684\u4e8b\u60c5\u5c31\u7cbe\u5f69\u4e86\uff1a\u731c\u731c\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f\n    cat-&gt;say();\n    cat-&gt;eat(\"rat\");\n    cat-&gt;sleep();\n    delete cat;     //\u8bb0\u5f97\u91ca\u653e\u5185\u5b58\n    return 0;\n}\n</code></pre> <p>\u4f60\u53ef\u80fd\u5e0c\u671b\u8fd9\u4e2a\u7a0b\u5e8f\u4f1a\u8f93\u51fa\uff1a</p> <pre><code>Cat say: Miao!\nCat eat: rat\nCat sleep!\n</code></pre> <p>\u4f46\u5b9e\u9645\u4e0a\u5b83\u4f1a\u8f93\u51fa\uff1a</p> <pre><code>We can not make sound!\nWe give rat shit!\nWe are totally fucked!\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u7c7b\u7684\u6210\u5458\u51fd\u6570\u5728C++\u91cc\u9762\u5e76\u6ca1\u6709\u4ec0\u4e48\u7279\u522b\u7684\u5730\u4f4d\uff0c\u53ea\u8981\u6709\u6307\u9488\u548c\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u8fd9\u79cd\u4e1c\u897f\uff0c\u6240\u6709\u5173\u952e\u5b57\u90fd\u53d8\u5f97\u6beb\u65e0\u610f\u4e49\u3002\u800cCPU\u5728\u6267\u884c\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u65f6\u5019\uff0c\u6839\u672c\u4e0d\u4f1a\u7ba1<code>cat-&gt;say()</code>\u91cc\u9762\u7684<code>say()</code>\u662f\u4e0d\u662f<code>Cat</code>\u7c7b\u91cc\u9762\u7684\u51fd\u6570\u3002 \u4e4b\u524d\u53ea\u662f\u79c1\u6709\u53d8\u91cf\u53d8\u5f97\u4e0d\u79c1\u6709\uff0c\u597d\u4e86\uff0c\u73b0\u5728\u7c7b\u7684\u6210\u5458\u51fd\u6570\u4e5f\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u6539\u6362\u95e8\u5ead\u3002\u66f4\u6050\u6016\u7684\u662f\uff0c\u8fd9\u79cd\u64cd\u4f5c\u53ef\u4ee5\u652f\u6301\u51fd\u6570\u7684\u53c2\u6570\u4f20\u503c\uff01 \u4e0d\u8bb0\u5f97\u54ea\u4e2a\u6587\u7ae0\u8bf4\u8fc7\u4e86\uff0cC++\u7684\u5bf9\u8c61\u5728\u8fd0\u884c\u671f\u6839\u672c\u4e0d\u77e5\u9053\u81ea\u5df1\u662f\u4ec0\u4e48\u4e1c\u897f\uff0c\u800c\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u6267\u884c\u6548\u7387\u3002\u6ca1\u9519\uff0c\u8fd0\u884c\u8d8a\u5feb\uff0c\u6b7b\u5f97\u8d8a\u5feb\u3002 \u7ed9\u6211\u4e00\u4e2a\u7c7b\u5e93\u7684\u8bf4\u660e\u4e66\uff0c\u6211\u5c31\u53ef\u4ee5\u5728\u4e3b\u51fd\u6570\u505a\u4efb\u4f55\u4e8b\u60c5\uff01  </p>"},{"location":"markdown/cpp_oop_is_a_dirty_trick/#_1","title":"\u603b\u7ed3","text":"<p>\u5f53\u7136\uff0cC++\u662f\u4e00\u95e8\u4f1f\u5927\u7684\u8bed\u8a00\uff0c\u4eceC++98\u3001C++03\u3001C++11\u4e00\u76f4\u5230C++23\uff0c\u5b83\u6301\u7eed\u4e0d\u65ad\u7684\u589e\u52a0\u5404\u79cd\u611a\u8822\u8bed\u4e49\u548c\u5f3a\u884c\u585e\u5165\u5404\u79cd\u5168\u4e16\u754c\u6ca1\u6709\u4efb\u4f55\u4eba\u80fd\u5168\u90e8\u5b66\u4f1a\u7684\u529f\u80fd\uff0c\u800c\u5947\u8ff9\u4e4b\u5904\u662f\uff1a\u76f4\u5230\u4eca\u5929\uff0c\u4e16\u754c\u5c45\u7136\u8fd8\u6ca1\u6709\u56e0\u6b64\u800c\u6bc1\u706d\u3002 \u4e5f\u6709\u4eba\u8bf4\uff0c\u6307\u9488\u548c\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u662fC\u5e26\u6765\u7684\u5386\u53f2\u5305\u88b1\uff0c\u4e0d\u80fd\u8ba9C++\u80cc\u9505\u3002\u4f46C\u53ef\u6ca1\u5ba3\u79f0\u81ea\u5df1\u662f\u9ad8\u5927\u4e0a\u7684OOP\u8bed\u8a00\uff0cC\u4e5f\u6ca1\u8bf4\u81ea\u5df1\u5b89\u5168\uff08\u624b\u52a8\u644a\u624b\uff09\u3002 \u5982\u679c\u6709\u4eba\u5728\u4f60\u7684\u9879\u76ee\u91cc\u7528\u672c\u6587\u7684\u65b9\u5f0f\u5199C++\uff0c\u8d76\u7d27\u5f00\u9664\u3002 \u662f\u7684\uff0c\u7ecf\u8fc7\u5f88\u957f\u65f6\u95f4\u6211\u624d\u660e\u767d\uff0cWE ARE TOTALLY FUCKED!!!!!!</p>"},{"location":"markdown/em_div_cor/","title":"\u9759\u6001\u6563\u5ea6\u6821\u6b63\u8be6\u89e3","text":"<p>\u5728\u5927\u5730\u7535\u78c1\uff08MT\uff09\u548c\u5176\u5b83\u9891\u7387\u57df\u7535\u78c1\u52d8\u63a2\u65b9\u6cd5\u4e2d\uff0c\u901a\u5e38\u8981\u6570\u503c\u6c42\u89e3\u4ee5\u4e0b\u9891\u7387\u57dfMaxwell\u65b9\u7a0b\u7ec4\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         \\nabla \\cdot \\sigma E = 0  &amp;\\\\         \\nabla \\cdot H = 0  &amp;\\\\         \\nabla \\times E = i \\omega \\mu_0 H &amp;\\\\         \\nabla \\times H = \\sigma E     \\end{array} \\right.  <p>\u4ee5\u4ea4\u9519\u7f51\u683c\u6709\u9650\u5dee\u5206\u65b9\u6cd5\u4e3a\u4f8b\uff0c\u5bf9\u7535\u573a\u65cb\u5ea6\u65b9\u7a0b\uff08\u6cd5\u62c9\u7b2c\u5b9a\u5f8b\uff09\u4e24\u8fb9\u53d6\u65cb\u5ea6\u5e76\u4ee3\u5165\u5ffd\u7565\u4f4d\u79fb\u7535\u6d41\u7684\u78c1\u573a\u65cb\u5ea6\u65b9\u7a0b\uff08\u9ea6\u514b\u65af\u97e6-\u5b89\u57f9\u5b9a\u5f8b\uff09\uff0c\u53ef\u5f97\u5230\u4ee5\u4e0b\u6709\u9650\u5dee\u5206\u63a7\u5236\u65b9\u7a0b\uff08\u53cc\u65cb\u5ea6\u65b9\u7a0b\uff09\uff1a  </p>  \\nabla \\times \\nabla \\times E =  i \\omega \\mu_0 \\sigma E"},{"location":"markdown/em_div_cor/#1","title":"1. \u53cc\u65cb\u5ea6\u65b9\u7a0b\u7684\u6709\u9650\u5dee\u5206\u7ebf\u6027\u7cfb\u7edf","text":"<p>\u5c06\u53cc\u65cb\u5ea6\u65b9\u7a0b\u5728\u6bcf\u4e2a\u5355\u5143\u683c\u6309\u7a7a\u95f4\u65b9\u5411\u5c55\u5f00\uff0c\u5f97\u5230\u4ee5\u4e0b\u4e09\u5206\u91cf\u8026\u5408\u65b9\u7a0b\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}           \\frac{\\partial^{2} E_x }{ \\partial y^{2}}          + \\frac{\\partial^{2} E_x }{ \\partial z^{2}}         - \\frac{\\partial^{2} E_y }{ \\partial x \\partial y}         - \\frac{\\partial^{2} E_z }{ \\partial x \\partial z}          - i \\omega \\mu_0 \\sigma_x E_x = 0 &amp;\\\\           \\frac{\\partial^{2} E_y }{ \\partial x^{2}}          + \\frac{\\partial^{2} E_y }{ \\partial z^{2}}         - \\frac{\\partial^{2} E_x }{ \\partial x \\partial y}         - \\frac{\\partial^{2} E_z }{ \\partial y \\partial z}          - i \\omega \\mu_0 \\sigma_y E_y = 0 &amp;\\\\           \\frac{\\partial^{2} E_z }{ \\partial x^{2}}          + \\frac{\\partial^{2} E_z }{ \\partial y^{2}}         - \\frac{\\partial^{2} E_x }{ \\partial x \\partial z}         - \\frac{\\partial^{2} E_y }{ \\partial y \\partial z}          - i \\omega \\mu_0 \\sigma_z E_z= 0     \\end{array} \\right.  <p>\u4e0a\u5f0f\u4e2d\\sigma_x\u3001\\sigma_y\u548c\\sigma_z\u5206\u522b\u4e3a\u5404\u5411\u540c\u6027\u7535\u5bfc\u7387\u5728\u975e\u5747\u5300\u7f51\u683c\u68f1\u8fb9\u4e0a\u5bf9\u4e0d\u540c\u7a7a\u95f4\u65b9\u5411\u7684\u5404\u5411\u5f02\u6027\u8fd1\u4f3c\uff0c\u82e5\u7535\u78c1\u573a\u4ea4\u9519\u91c7\u6837\uff08\u5982\u56fe1\uff09\uff0c\u7406\u8bba\u4e0a\u5df2\u6ee1\u8db3\u4e86\u4e24\u4e2a\u6563\u5ea6\u6761\u4ef6\uff08Yee, 1966\uff09\uff1a  </p> \u56fe1 \u4e09\u7ef4MT\u6b63\u6f14\u4ea4\u9519\u7f51\u683c\u6709\u9650\u5dee\u5206\u5404\u5206\u91cf\u5dee\u5206\u683c\u5f0f\uff08\u5706\u5708\u8868\u793a\u5f53\u524d\u7f16\u53f7\u7684\u573a\u5206\u91cf\uff09 <p>\u4f7f\u7528\u5dee\u5546\u4ee3\u66ff\u5fae\u5206\uff0c\u5bf9\u4e09\u7ef4\u77e2\u91cf\u7535\u573aE\u7ecf\u7f51\u683c\u7f16\u53f7\u7684\u5f85\u89e3\u4e09\u7ef4\u7535\u573a\u5411\u91cfe=[e_x, e_y, e_z]^T\u53ca\u8fb9\u754c\u6761\u4ef6b\u53ef\u5f97\u5230\u4ee5\u4e0b\u5927\u578b\u7a00\u758f\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff1a</p>  Ke=b  <p>\u82e5\u4f7f\u7528\u76f4\u63a5\u6cd5\uff08\u5982LU\u5206\u89e3\uff0c\u591a\u6ce2\u524d\u6cd5\uff09\u7b49\u89e3\u6b64\u7ebf\u6027\u65b9\u7a0b\u7ec4\u5185\u5b58\u9700\u6c42\u5de8\u5927\uff0c\u65f6\u95f4\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u90fd\u4e3aO(n^3)\uff0c\u56e0\u6b64\u5bf9\u4e8e\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u4f7f\u7528Krylov\u5b50\u7a7a\u95f4\u8fed\u4ee3\u6cd5\uff08\u5982Bicgstab\uff0cQMR\u7b49\uff09\u66f4\u5408\u9002\u3002  </p>"},{"location":"markdown/em_div_cor/#2","title":"2. \u9759\u6001\u6563\u5ea6\u6821\u6b63\u7684\u539f\u7406","text":"<p>\u8fed\u4ee3\u6cd5\u6c42\u89e3\u5dee\u5206\u65b9\u7a0b\u7ec4\u65f6\uff0c\u82e5\u6a21\u578b\u7535\u5bfc\u7387\u7a7a\u95f4\u5206\u5e03\u51fd\u6570\\sigma(x,y,z)\u975e\u5e73\u7f13\uff0c\u6216\u8005\u9891\u7387\u975e\u5e38\u4f4e\u7684\u65f6\u5019\u6536\u655b\u901f\u5ea6\u6781\u6162\u751a\u81f3\u65e0\u6cd5\u6536\u655b\u3002\u539f\u56e0\u6709\u4e8c\uff1a\uff081\uff09\u53cc\u65cb\u5ea6\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u590d\u7cfb\u6570\u77e9\u9635K\u5728i \\omega \\mu_0\u5f88\u5c0f\u65f6\u975e\u4e25\u683c\u4e3b\u5bf9\u89d2\u5360\u4f18\uff1b\uff082\uff09\u5f53\u6a21\u578b\u590d\u6742\u65f6\uff0c\u8fed\u4ee3\u65e9\u671fe_k\u4f1a\u8fc7\u65e9\u62df\u5408b\u7684\u201c\u9ad8\u9891\u201d\u6210\u5206\uff0c\u4e00\u65e6\u9677\u5165\u67d0\u4e2a\u5c40\u90e8\u5947\u5f02\u89e3\u4fbf\u65e0\u6cd5\u4fdd\u8bc1\u6574\u4f53\u6536\u655b\u3002\uff08\u7406\u89e3\u7b2c2\u6761\u9700\u8981\u53c2\u8003\u4ee3\u6570\u591a\u91cd\u7f51\u683c\u6cd5\u7684\u539f\u7406\uff09\u3002 \u5bf9\u4e8e\u95ee\u9898\uff081\uff09\uff0c\u9700\u5bf9Krylov\u5b50\u7a7a\u95f4\u8fed\u4ee3\u65bd\u52a0\u9884\u6761\u4ef6\u3002\u9009\u62e9\u975e\u8026\u5408\u90e8\u5206\u7684\u6807\u91cfHelmhoz\u65b9\u7a0b\u90e8\u5206\u4f5c\u4e3a\u9884\u6761\u4ef6\u95ee\u9898\uff0c\u5982\u4e0b\uff1a</p>  \\left\\{     \\begin{array}{**lr**}           \\frac{\\partial^{2} E_x }{ \\partial y^{2}}          + \\frac{\\partial^{2} E_x }{ \\partial z^{2}}         + i \\omega \\mu_0 \\sigma_x = 0 &amp;\\\\           \\frac{\\partial^{2} E_y }{ \\partial x^{2}}          + \\frac{\\partial^{2} E_y }{ \\partial z^{2}}         + i \\omega \\mu_0 \\sigma_y = 0 &amp;\\\\           \\frac{\\partial^{2} E_z }{ \\partial x^{2}}          + \\frac{\\partial^{2} E_z }{ \\partial y^{2}}         + i \\omega \\mu_0 \\sigma_z = 0     \\end{array} \\right.  <p>\u9884\u6761\u4ef6\u7684\u672c\u8d28\u662f\u628a\u6761\u4ef6\u6570\u4e0d\u597d\u7684Ke=b\u8f6c\u6362\u4e3aMKe=Mb\u6765\u6c42\u89e3\uff0c\u5176\u4e2dM\u4e3a\u4e0a\u5f0f\u5de6\u8fb9\u7684\u79bb\u6563\u7b97\u5b50\u77e9\u9635\uff0c\u89e3Mv=u\u9700\u4f7f\u7528\u4e0d\u5b8c\u5168\u5206\u89e3+\u56de\u4ee3\u65b9\u6cd5\uff0c\u7ecf\u6d4b\u8bd5\u4e0d\u5b8c\u5168Cholesky\u5206\u89e3(ICC)\u548c\u4e0d\u5b8c\u5168LU\u5206\u89e3\uff08ILU\uff09\u5747\u53ef\u5927\u5e45\u63d0\u9ad8\u6536\u655b\u6548\u7387\uff0c\u4f46\u6a21\u578b\u590d\u6742\u65f6\u65e0\u586b\u5145\u7684ICC(0)\u548cILU(0)\u6548\u679c\u4ecd\u7136\u4e0d\u597d\uff08\u73b0\u5728MT\u6b63\u6f14\u9886\u57df\u6ca1\u4eba\u6d4b\u8bd5\u8fd9\u4e2a\uff09\uff0c\u4ece\u5185\u5b58\u7ba1\u7406\u548c\u7f16\u7801\u5b9e\u7528\u6027\u6765\u8bf4\uff0c\u5e26\u586b\u5145\u7684ILU(k)\u5206\u89e3\u6027\u4ef7\u6bd4\u76f8\u5bf9\u6700\u9ad8\uff08k=8\uff09\u3002 \u5bf9\u4e8e\u95ee\u9898(2)\uff0c\u5219\u9700\u7528\u5230\u9759\u6001\u6563\u5ea6\u6821\u6b63\u6280\u672f\uff08smith\uff0c1996\uff09\u3002\u82e5e_k\u4e3a\u8fed\u4ee3\u65e9\u671f\u6ee1\u8db3\u6b8b\u5deer_k=K e_k - b\u7684\u5f53\u524d\u89e3\u3002\u56e0\u4e3ae_k\u672c\u8eab\u5e76\u4e0d\u6ee1\u8db3K e_k = b\uff0c\u4e14r_k\u7684\u201c\u9ad8\u9891\u201d\u6210\u5206\u8fc7\u591a\u3002 \u82e5e_k = e^c_k + e^r_k\uff0ce^c_k\u5373\u4e3a\u6ee1\u8db3\u7535\u6d41\u5bc6\u5ea6\u6563\u5ea6\u4e3a0\u7684\u90e8\u5206\uff08\u5bf9\u5e94\u201c\u4f4e\u9891\u201d\u6210\u5206\uff09\uff0ce^r_k\u662f\u4e0d\u6ee1\u8db3\u6563\u5ea6\u6761\u4ef6\u7684\u201c\u9ad8\u9891\u201d\u6210\u5206\u3002\u5728\u7b2ck\u6b21\u8fed\u4ee3\u53ea\u4fdd\u7559e^c_k\u5373\u53ef\u907f\u514d\u8fed\u4ee3\u9677\u5165\u5947\u5f02\u89e3\u800c\u6781\u5927\u52a0\u901f\u6536\u655b\u901f\u5ea6\u3002 \u8003\u8651\u7535\u573a\u6563\u5ea6\u6761\u4ef6\u7684\u8fde\u7eed\u6027\u95ee\u9898\uff0c\u4e14\u8bbeE_k=E^c_k+E^r_k\uff0c\u4e0b\u5f0f\u6210\u7acb\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}     \\nabla \\cdot \\sigma E^c_k = 0 &amp;\\\\     \\nabla \\cdot \\sigma E_k = \\nabla \\cdot \\sigma E^c_k +  \\nabla \\cdot \\sigma E^r_k = \\nabla \\cdot \\sigma E^r_k &amp;\\\\     \\end{array} \\right.  <p>\u5f15\u5165\u6807\u91cf\u52bf\\varphi_k\u6ee1\u8db3E^r_k = \\nabla \\varphi_k\uff0c\u5e76\u4ee3\u5165\u4ee5\u4e0a\u65b9\u7a0b\uff0c\u5219\u53ef\u5f97\u5230\uff1a  </p>  \\nabla \\cdot \\sigma \\nabla \\varphi_k = \\nabla \\cdot \\sigma E_k  <p>\u5bf9\\nabla \\cdot \\sigma \\nabla\u7b97\u5b50\u79bb\u6563\u5316\uff0c\u53ef\u5f97\u5230\u4ee5\u4e0b\u65b0\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff1a  </p>  D p = c  <p>\u5176\u4e2d\u5411\u91cfp\u4e3a\\varphi_k\u7684\u79bb\u6563\u5411\u91cf\uff0c\u53f3\u7aef\u9879c\u662f\u5bf9e_k\u5e94\u7528\\nabla \\cdot \\sigma\u79bb\u6563\u7b97\u5b50\u5f97\u5230\u7684\u5411\u91cf\u3002\u5411\u91cfp\u7684\u91c7\u6837\u70b9\u4f4d\u4e8e\u6bcf\u4e2a\u957f\u65b9\u4f53\u5355\u5143\u7684\u8282\u70b9\u5904\uff0c\u5dee\u5206\u7b97\u5b50\u53ca\u91c7\u6837\u65b9\u5f0f\u5982\u4e0b\u56fe\u6240\u793a\uff1a  </p> \u56fe2 \u9759\u6001\u6563\u5ea6\u6821\u6b63\u5bf9\u6807\u91cf\u52bf\u7684\u79bb\u6563\u4e8c\u9636\u7b97\u5b50\u5dee\u5206\u683c\u5f0f\uff08\u6ce8\uff1a\u9ed1\u5708\u4e3a\u6807\u91cf\u52bf\u91c7\u6837\u70b9\uff0c\u7bad\u5934\u4e3a\u5f62\u6210\u53f3\u7aef\u9879\u7684\u5404\u573a\u5206\u91cf\uff09  <p>\u6c42\u89e3\u65b9\u7a0b\u7ec4Dp=c\u5f97\u5230p\u4e4b\u540e\uff0c\u5bf9p\u5e94\u7528\u79bb\u6563\u68af\u5ea6\u7b97\u5b50\u5373\u53ef\u5f97\u5230\u9700\u6821\u6b63\u7684E^r_k\u3002</p>"},{"location":"markdown/em_div_cor/#3","title":"3. \u5e26\u9759\u6001\u6563\u5ea6\u6821\u6b63\u7684\u8fed\u4ee3\u6cd5","text":"<p>\u7535\u573a\u53cc\u65cb\u5ea6\u65b9\u7a0b\u7684\u9759\u6001\u6563\u5ea6\u6821\u6b63\u8fed\u4ee3\u89e3\u6cd5\u6d41\u7a0b\u5982\u4e0b\uff1a (1) e := 0 (2) for \\space\\space i = 1,..., N (3) \u2003\u2003\u6c42\u76f8\u5bf9\u62df\u5408\u5deeres:={||b-Ke||}_2 / {||b||}_2\uff0c\u82e5\u5c0f\u4e8e10^{-8}\u5219\u8df3\u51fa\u5faa\u73af (4) \u2003\u2003\u5e38\u89c4SQMR\u6216Bicgstab\u8fed\u4ee3M\u6b21\u5f97\u5230\u65b0\u7684e (5) \u2003\u2003for \\space\\space j = 1,..., L   (\u4e00\u822cL=5\u5373\u53ef) (6) \u2003\u2003\u2003\u2003\u8ba1\u7b97\u5411\u91cfc:=Ve\uff0c \u5176\u4e2dV\u4e3a\u7b97\u5b50\\nabla \\cdot \\sigma\u7684\u79bb\u6563\u77e9\u9635\u5f62\u5f0f (7) \u2003\u2003\u2003\u2003\u8ba1\u7b97div={||c||}_2\uff0c\u82e5\u5c0f\u4e8e10^{-10}\u5219\u8df3\u51fa(1,...,L)\u5faa\u73af (8) \u2003\u2003\u2003\u2003\u6c42\u89e3Dp=c\u5f97\u5230p (9) \u2003\u2003\u2003\u2003\u66f4\u65b0e := e - Gp\uff0c\u5176\u4e2dG\u4e3a\u79bb\u6563\u68af\u5ea6\u7b97\u5b50\u77e9\u9635  </p> <p>\u4ee5\u4e0a\u6d41\u7a0b\u91cc\u6c42\u89e3Dp=c\u4e5f\u662f\u4e00\u4e2a\u8017\u65f6\u8fc7\u7a0b\uff0c\u5982\u679c\u4f7f\u7528\u8fed\u4ee3\u6cd5\uff0c\u5355\u6b21\u8fed\u4ee3\u8017\u65f6\u5927\u81f4\u4e3a\u6c42\u89e3Ke=b\u7684\u2153\u3002\u6240\u4ee5\u5185\u90e8Ke=b\u7684\u8fed\u4ee3\u6b21\u6570M\u548c\u5916\u90e8\u5faa\u73af\u6b21\u6570N\u7684\u9009\u62e9\u662f\u7b97\u6cd5\u5feb\u6162\u7684\u5173\u952e\u3002\u901a\u8fc7\u5927\u91cf\u6a21\u578b\u5b9e\u9a8c\uff0c\u53d6M=100\u548cN=20\u4e00\u822c\u662f\u8017\u65f6\u6700\u77ed\u7684\u3002\u4e0d\u540c\u7ec4\u5408\u7684\u5b9e\u9a8c\u6536\u655b\u66f2\u7ebf\u89c1\u4e0b\u56fe\u3002  </p> \u56fe3 \u7528Bicgstab\u89e3\u6cd5\u4e0d\u540c\u7684\u5faa\u73af\u7ec4\u5408\u6b21\u6570\u7684\u6536\u655b\u6548\u679c\u5bf9\u6bd4\uff08\u6ce8\uff1a\u5706\u5708\u8868\u793a\u65bd\u52a0\u6563\u5ea6\u6821\u6b63\uff0c\u7070\u8272M=2\uff0c\u9ed1\u8272M=10\uff0c\u84dd\u8272M=50\uff0c\u7ea2\u8272M=100\uff0c\u7eff\u8272M=200\uff09  <p>\u867d\u7136\u56fe3\u663e\u793aM=50(\u84dd\u8272)\u7684Ke=b\u7684\u8fed\u4ee3\u6b21\u6570\u6700\u5c11\uff0c\u4f46\u7531\u4e8e\u6c42\u89e3Dp=c\u7684\u6b21\u6570\u662fM=100\uff08\u7ea2\u8272\uff09\u7684\u4e24\u500d\uff0c\u603b\u8017\u65f6\u6700\u77ed\u7684\u5374\u662fM=100\u3002</p> <p>\u603b\u800c\u8a00\u4e4b\uff0c\u9759\u6001\u6563\u5ea6\u6821\u6b63\u662f\u6c42\u89e3\u4f4e\u9891\u590d\u6742\u4ecb\u8d28\u6269\u6563\u573a\u53cc\u65cb\u5ea6\u65b9\u7a0b\u7684\u8fed\u4ee3\u6cd5\u5fc5\u8981\u8fc7\u7a0b\u3002\u7a76\u7adf\u591a\u5c11\u6b21Ke=b\u8fed\u4ee3\u65bd\u52a0\u4e00\u6b21\u6563\u5ea6\u6821\u6b63\u662f\u4e00\u4e2atrade off\uff0c\u76ee\u524d\u8fd8\u6ca1\u6709\u6700\u4f73\u7684\u7406\u8bba\u65b9\u6848\u3002</p>"},{"location":"markdown/em_mt_impedance/","title":"\u5927\u5730\u7535\u78c1\u963b\u6297\u8ba1\u7b97\u53ca\u601d\u8003","text":"<p>\u5927\u5730\u7535\u78c1\uff08MT\uff09\u662f\u4e00\u79cd\u5929\u7136\u6e90\u8fdc\u573a\u5e73\u9762\u6ce2\u52d8\u63a2\u65b9\u6cd5\uff0c\u5229\u7528\u5730\u9762\u89c2\u6d4b\u7684\u6b63\u4ea4\u6c34\u5e73\u7535\u78c1\u573a\u5b9a\u4e49\u5927\u5730\u4ecb\u8d28\u7684\u672c\u5f81\u7535\u7269\u7406\u53c2\u6570\u2014\u2014\u963b\u6297\uff08impedance\uff09\u3002 \u8003\u8651\u5730\u4e0b\u7535\u963b\u7387\u4e3a\u6c34\u5e73\u5c42\u72b6\u7684\u6700\u7b80\u5355\u60c5\u51b5\uff08\u56fe1\u6240\u793a\u7684\u4e00\u7ef4\u4ecb\u8d28\uff09\uff0c\u5bf9\u67d0\u4e2a\u9891\u7387\\omega\u5bf9\u5e94\u7684\u7b80\u8c10\u7535\u78c1\u573a\u590d\u9891\u8c31E_x\u548cH_y\uff0c\u963b\u6297z\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u4e8c\u8005\u4e4b\u6bd4\uff08\u6807\u91cf\u963b\u6297\uff09\u3002   \u7531\u4e8eMT\u7684\u573a\u6e90\u662f\u5929\u7136\u3001\u65f6\u53d8\u4e14\u4e0d\u53ef\u6d4b\u91cf\u7684\uff0c\u8bbe\u67d0\u4e2a\u65f6\u6bb5\u7684\u573a\u6e90\u78c1\u8ddd\u4e3aIL^2\uff0c\u89c2\u6d4b\u573a\u53ef\u8868\u793a\u4e3aE_x= C E_x^0\u548cH_x= C H_x^0(\u5176\u4e2d\u4e0a\u68070\u8868\u793a\u5355\u4f4d\u573a\u6e90\u54cd\u5e94\uff0cC\u662f\u548c\u573a\u6e90\u5f3a\u5ea6\u6709\u5173\u7684\u91cf)\uff0c\u6545\u6709\u4ee5\u4e0b\u5173\u7cfb\uff1a  </p>  z= \\frac{E_x}{H_y} = \\frac{E^0_x} {H^0_y}  <p>\u7531\u4e0a\u5f0f\u53ef\u77e5\uff0cz\u6263\u9664\u4e86\u573a\u6e90\u65f6\u53d8\u56e0\u7d20\uff0c\u662f\u53ea\u548c\u4ecb\u8d28\u7535\u6027\u6709\u5173\u7684\u7269\u7406\u91cf\u3002 \u7279\u522b\u7684\uff0c\u5f53\u5730\u4e0b\u4ecb\u8d28\u4e3a\u4e00\u7ef4\u4ecb\u8d28\u65f6\uff0c\u65e0\u8bba\u89c2\u6d4b\u7cfb\u7edf\u7684x\u548cy\u65b9\u5411\u5982\u4f55\uff0c\u5728\u4efb\u4f55\u89c2\u6d4b\u65b9\u4f4d\u89d2\u4e0a\u7684\u6807\u91cf\u963b\u6297\u5747\u76f8\u540c\u3002\u4f46\u9664\u4e86\u5927\u578b\u6c89\u79ef\u76c6\u5730\uff0c\u5b9e\u9645\u7684\u5927\u5730\u4ecb\u8d28\u5747\u975e\u5982\u6b64\uff0c\u6240\u4ee5MT\u65b9\u6cd5\u9700\u89c2\u6d4b\u6cbfNS\u548cEW\u4e24\u4e2a\u6b63\u4ea4\u65b9\u5411\u7684\u56db\u4e2a\u7535\u78c1\u573a\u5206\u91cf[E_x,E_y,H_x,H_y]\uff0c\u5982\u4e0b\u56fe\uff1a  </p> \u56fe1 \u4e0d\u540c\u7ef4\u6027\u7684\u5927\u5730\u4ecb\u8d28\u7b80\u56fe"},{"location":"markdown/em_mt_impedance/#1","title":"1. \u5927\u5730\u7535\u78c1\u5f20\u91cf\u963b\u6297","text":"<p>\u82e5\u6309\u6b63\u4ea4\u7535\u78c1\u573a\u9891\u8c31\u7684\u6807\u91cf\u963b\u6297\u5b9a\u4e49\uff0c\u5bf9\u4e8e\u975e\u4e00\u7ef4\u4ecb\u8d28\uff0c\u5728MT\u89c2\u6d4b\u6570\u636e\u4e2d\uff0c\u81f3\u5c11\u6709\u4e92\u4e0d\u76f8\u540c\u7684\u4e24\u4e2a\u6807\u91cf\u963b\u6297\u5982\u4e0b\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}     z_{xy} = \\frac {E_x} {H_y} &amp;\\\\     z_{yx} = \\frac {E_y} {H_x}     \\end{array} \\right.  <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u67d0\u4e2a\u9891\u7387\\omega\u7684\u963b\u6297\u8fd9\u4e00\u672c\u5f81\u7269\u7406\u53c2\u6570\u5728\u89c2\u6d4b\u7a7a\u95f4\u57df\u662f\u201c\u5404\u5411\u5f02\u6027\u201d\u7684\u3002\u7269\u7406\u4e0a\u8fd9\u79cd\u201c\u5404\u5411\u5f02\u6027\u201d\u9700\u7528\u5f20\u91cf\u8868\u793a\uff08\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u5404\u5411\u5f02\u6027\u662f\u201c\u6570\u636e\u7a7a\u95f4\u201d\u7684\u6027\u8d28\uff0c\u4e0d\u80fd\u548c\u201c\u5404\u5411\u5f02\u6027\u4ecb\u8d28\u201d\u6df7\u6dc6\uff09\u3002 \u7531\u4e8e\u89c2\u6d4b\u70b9\u59cb\u7ec8\u5728\u5730\u9762\uff0c\u8fd9\u79cd\u5404\u5411\u5f02\u6027\u53ea\u53d1\u751f\u5728(x,y)\u4e8c\u7ef4\u7a7a\u95f4\u5185\uff0c\u6545\u5f20\u91cf\u963b\u6297\u5f62\u5f0f\u4e0a\u662f2*2\u7684\u77e9\u9635\u3002\u8003\u8651\u6700\u4e00\u822c\u7684\u4e09\u7ef4\u4ecb\u8d28\u60c5\u51b5\uff0c\u5b83\u548c\u89c2\u6d4b\u7535\u78c1\u573a\u56db\u4e2a\u6c34\u5e73\u5206\u91cf\u6ee1\u8db3\u4ee5\u4e0b\u5173\u7cfb\uff1a  </p>  {\\begin{bmatrix}     {E_x }  \\\\     {E_y } \\end{bmatrix}} = {\\begin{bmatrix}     {z_{xx} } &amp; {z_{xy} } \\\\     {z_{yx} } &amp; {z_{yy} } \\end{bmatrix}} {\\begin{bmatrix}     {H_x }  \\\\     {H_y }     \\end{bmatrix}}  <p>\u4e0a\u5f0f\u4e5f\u53ef\u7528\u77e9\u9635\u5f62\u5f0f\u7b80\u8bb0\u4e3a\\boldsymbol{e} = \\boldsymbol{Z} \\boldsymbol{h}\uff0c\u5c06\u5927\u5730\u89c6\u4e3a\u4e00\u4e2a\u6ee4\u6ce2\u5668\uff0c\u4ece\u4fe1\u53f7\u4e0e\u7cfb\u7edf\u6765\u7406\u89e3\uff0c\\boldsymbol{Z}\u4e3a\u5927\u5730\u6ee4\u6ce2\u5668\u7684\u4f20\u8f93\u51fd\u6570\uff0c\u5176\u53cd\u5085\u91cc\u53f6\u53d8\u6362\u4e3a\u7cfb\u7edf\u51b2\u6fc0\u54cd\u5e94\u3002 \u53ef\u4ee5\u4e0d\u4e25\u8c28\u7684\u8fd9\u6837\u7406\u89e3\uff1a\u8f93\u5165\u5085\u91cc\u53f6\u53d8\u6362\u4e3a\\boldsymbol{h}\u5411\u91cf\u7684\u78c1\u573a\u4fe1\u53f7\uff0c\u5927\u5730\u6ee4\u6ce2\u5668\u7684\u8f93\u51fa\u4fe1\u53f7\u7684\u5085\u91cc\u53f6\u53d8\u6362\u4e3a\\boldsymbol{e}\u5411\u91cf\u3002 \u6807\u91cf\u963b\u6297\u7684\u5b9a\u4e49\u635f\u5931\u4e86\u4ecb\u8d28\u7684\u7ef4\u6027\u4fe1\u606f\u3002\u5f20\u91cf\u963b\u6297\u7528\u7edf\u4e00\u7684\u5f62\u5f0f\u63cf\u8ff0\u4e86\u56fe1\u6240\u793a\u7684\u4e09\u79cd\u4ecb\u8d28\u3002\u5bf9\u4e8e\u4e00\u7ef4\u4ecb\u8d28\uff0c\u6709\u4ee5\u4e0b\u5f62\u5f0f\uff1a</p>  {\\boldsymbol{Z}_{1d}}= {\\begin{bmatrix}     {0 } &amp; {z_{xy} } \\\\     {z_{yx} } &amp; {0 } \\end{bmatrix}}, \\quad where \\  z_{xy}=-{z_{yx}}  <p>\u4e0a\u5f0f\u4e2d\u5bf9z_{yx}\u53d6\u53cd\u7531\u7535\u78c1\u611f\u5e94\u5de6\u624b\u5750\u6807\u7cfb\u51b3\u5b9a\u3002\u7279\u522b\u7684\uff0c\u5f53\u65f6\u8c10\u56e0\u5b50\u53d6e^{i \\omega t}\u65f6z_{xy}\u7684\u5b9e\u90e8\u548c\u865a\u90e8\u5747\u4e3a\u6b63\u6570\uff0c\u6807\u51c6\u5927\u5730\u7535\u78c1\u4eea\u5668\u5747\u6309\u6b64\u6807\u51c6\uff08\u4e0d\u6309\u6b64\u6807\u51c6\u7684MT\u4eea\u5668\u53ef\u8ba4\u4e3a\u201c\u4e0d\u4e13\u4e1a\u201d\uff0c\u563f\u563f\uff09\u3002 \u5bf9\u4e8e\u4e8c\u7ef4\u4ecb\u8d28\uff0c\u5f20\u91cf\u963b\u6297\u4e3a\uff1a  </p>  {\\boldsymbol{Z}_{2d}}= {\\begin{bmatrix}     {0 } &amp; {z_{xy} } \\\\     {z_{yx} } &amp; {0 } \\end{bmatrix}}, \\quad where \\  z_{xy} \\not=-{z_{yx}}  <p>\u5bf9\u4e8e\u4e09\u7ef4\u4ecb\u8d28\uff0c\u5f20\u91cf\u963b\u6297\u7684\u56db\u4e2a\u5143\u7d20\u4e92\u4e0d\u76f8\u540c\u3002\u963b\u6297\u5f20\u91cf\u6ee1\u8db3\u65cb\u8f6c\u64cd\u4f5c\uff0c\u5c06\u6b63\u5357\u5317\u89c2\u6d4b\u7684\\boldsymbol{Z}^0\u65cb\u8f6c\u5230\u65b9\u4f4d\u89d2\u4e3a\\theta\u7684\u89c2\u6d4b\u7cfb\u7edf\u65f6\u53ef\u7528\u4e0b\u5f0f\u8ba1\u7b97\uff1a</p>  {\\boldsymbol{Z}^{\\theta}}  =  {\\boldsymbol{R}} {\\boldsymbol{Z}^{0}} {\\boldsymbol{R}^{T}},  \\quad where \\  {\\boldsymbol{R}}  =  {\\begin{bmatrix}     {cos \\theta } &amp; { sin \\theta } \\\\     {-sin \\theta } &amp; { cos \\theta } \\end{bmatrix}}  <p>\u5f88\u591a\u4eba\u5bf9\u4e8c\u7ef4\u4ecb\u8d28\u6709\u53ef\u80fd\u5b58\u5728\u8bef\u89e3\u3002\u5373\u4f7f\u662f\u56fe1\u4e2d\u7684\u4e8c\u7ef4\u4ecb\u8d28\uff0c\u5728\u505a\u4e8c\u7ef4\u53cd\u6f14\u65f6\uff0c\u7ef4\u6027\u662f\u548c\u89c2\u6d4b\u89d2\u5ea6\u548c\u6d4b\u7ebf\u65b9\u4f4d\u6709\u5173\u7684\u3002\u601d\u8003\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\uff1a 1. \u5982\u679c\u6d4b\u7ebf\u65b9\u4f4d\u89d215\u5ea6\uff0c\u89c2\u6d4b\u65b9\u4f4d\u89d2\u548c\u56fe\u793a\u4e00\u6837\u3002\u4e8c\u7ef4\u53cd\u6f14\u7684\u70b9\u8ddd\u662f\u5426\u8981\u8fdb\u884c\u89d2\u5ea6\u6295\u5f71\uff1f  2. \u5982\u679c\u6d4b\u7ebf\u65b9\u4f4d\u89d215\u5ea6\uff0c\u89c2\u6d4b\u65b9\u4f4d\u89d2\u4e5f\u662f15\u5ea6\uff0c\u662f\u5426\u8f6c\u963b\u6297\uff1f\u662f\u5426\u70b9\u8ddd\u8981\u8fdb\u884c\u89d2\u5ea6\u6295\u5f71\uff1f 3. \u5982\u679c\u6d4b\u7ebf\u65b9\u4f4d\u89d2\u662f0\u5ea6\uff0c\u662f\u5426\u80fd\u7528\u4e8c\u7ef4\u53cd\u6f14\u6062\u590d\u6a21\u578b\uff1f  </p> <p>\u65e0\u8bba\u5982\u4f55\uff0c\u56fe1\u7684\u4e8c\u7ef4\u4ecb\u8d28\u5982\u679c\u89c2\u6d4b\u7cfb\u7edf\u65b9\u4f4d\u89d2\u4e3a15\u5ea6\uff0c\u5728\u65b0\u5750\u6807\u7cfb\u4e0b\u7684\u963b\u6297\u662f\u4e09\u7ef4\u7684\u3002\u4e8c\u7ef4\u53cd\u6f14\u4e4b\u524d\u9700\u8981\u627e\u5230\u4e00\u4e2a\u65b9\u4f4d\u89d2\uff0c\u4f7f\u5f97\u6b64\u89d2\u5ea6\u4e0b\u5b9a\u4e49\u7684\u5f20\u91cf\u963b\u6297\u6ee1\u8db3\u4e8c\u7ef4\u4ecb\u8d28\u7684\u963b\u6297\u7279\u5f81\uff0c\u7136\u540e\u624d\u80fd\u8fdb\u884c\u4e8c\u7ef4\u53cd\u6f14\u3002 \u5728MT\u7ef4\u6027\u5206\u6790\uff08\u4e00\u79cd\u5b9a\u6027\u5206\u6790\u624b\u6bb5\uff09\u91cc\u7684\u201c\u4e8c\u7ef4\u6027\u201d\u7684\u610f\u601d\u662f\uff1a\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u786e\u5b9a\u7684\u89c2\u6d4b\u65b9\u4f4d\u89d2{\\theta}\uff0c\u4f7f\u5f97z^{\\theta}_{xx}\u548cz^{\\theta}_{yy}\u6700\u5c0f\uff08\u6309\u67d0\u79cd\u6807\u51c6\u5224\u65ad\u201c\u5c0f\u201d\uff09\uff0c\u4e14\u8fd9\u6837\u7684\u89d2\u5ea6\u5728[0,2 \\pi]\u4e4b\u95f4\u53ea\u6709\\theta\u3001\\theta+\\pi / 2\u3001\\theta+\\pi\u548c\\theta + 3 \\pi / 2\u56db\u4e2a\uff08\u6709\u660e\u786e\u768490\u5ea6\u6a21\u7cca\u6027\u7535\u6027\u4e3b\u8f74\uff09\u3002 </p> <p>\u5c0f\u8d34\u58eb\uff1a \u4e00\u7ef4\u4ecb\u8d28\u548c\u5f3a\u4e09\u7ef4\u4ecb\u8d28\u6ca1\u6709\u660e\u786e\u7684\u7535\u6027\u4e3b\u8f74\u89d2\u3002 </p> <p>MT\u6570\u503c\u8ba1\u7b97\u7406\u8bba\u91cc\u7684\u201c\u4e8c\u7ef4\u6b63\u6f14\u201d\u662f\u8bf4\u7535\u963b\u7387\u6cbfy\u7684\u65b9\u5411\u5bfc\u6570\u4e0d\u4e3a0\uff08x\u4e3a\u6b63\u6f14\u5256\u9762\u65b9\u5411\uff09\u3002\u56fe1\u4e2d\u7684\u4e8c\u7ef4\u4ecb\u8d28\u5982\u679c\u89c2\u6d4b\u4e86\u4e00\u6761\u65b9\u4f4d\u89d2\u4e3a45\u5ea6\u7684\u6d4b\u7ebf\uff0c\u5256\u9762\u5404\u6d4b\u70b9\u8ddd\u4e3a\u5b9e\u9645\u70b9\u8ddd\uff0c\u6b64\u65f6\u7528\u4e8c\u7ef4\u6b63\u6f14\u7b97\u6cd5\u65e0\u6cd5\u51c6\u786e\u8ba1\u7b97MT\u5f20\u91cf\u963b\u6297\uff08\u70b9\u8ddd\u505a\u89d2\u5ea6\u6295\u5f71\u540e\u624d\u80fd\u8ba1\u7b97\u51c6\u786e\uff09\uff0c\u5f53\u7136\u66f4\u76f4\u63a5\u7684\u65b9\u6cd5\u662f\u4e09\u7ef4\u6b63\u6f14\u3002 \u6240\u4ee5\uff0cMT\u65b9\u6cd5\u91cc\u7684\u201c\u4e8c\u7ef4\u4ecb\u8d28\u201d\u8fd9\u4e2a\u672f\u8bed\u7684\u786e\u5207\u610f\u601d\u9700\u7ed3\u5408\u4e0a\u4e0b\u6587\u7406\u89e3\uff0c\u5b83\u53ef\u80fd\u8868\u793a\u4ecb\u8d28\u6709\u4e00\u4e2a\u5b8c\u7f8e\u7684\u4e3b\u8f74\u65b9\u4f4d\uff0c\u4e5f\u53ef\u80fd\u8868\u793a\u5f53\u524d\u6a21\u578b\u6a21\u578b\u53c2\u6570\u5728\u5782\u76f4\u5256\u9762\u65b9\u5411\u4e0a\u7684\u504f\u5bfc\u6570\u4e3a0\u3002\u9700\u8981\u540c\u65f6\u7406\u89e3\u6b63\u6f14\u7b97\u6cd5\u548c\u7ef4\u6027\u5206\u6790\u624d\u53ef\u80fd\u4e0d\u51fa\u6d0b\u76f8\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a \u601d\u8003\u4e00\u4e0b\u8fd9\u4e2a\u8868\u8ff0\u2014\u2014\u8be5\u6d4b\u70b9\u5728900\u52301000\u53f7\u6d4b\u70b9\u4e4b\u95f4\u663e\u793a\u5f3a\u4e8c\u7ef4\u6027\uff0c\u5f20\u91cf\u963b\u6297\u65cb\u8f6c\u523020\u5ea6\u4e4b\u540e\u6ee1\u8db3\u4e8c\u7ef4\u4ecb\u8d28\u5047\u8bbe\u3002 </p>"},{"location":"markdown/em_mt_impedance/#2","title":"2. \u5f20\u91cf\u963b\u6297\u7684\u6700\u5c0f\u4e8c\u4e58\u89e3\u4e0e\u529f\u7387\u8c31\u77e9\u9635","text":"<p>\u65e0\u6cd5\u76f4\u63a5\u6839\u636e\u65b9\u7a0b\\boldsymbol{e} = \\boldsymbol{Z} \\boldsymbol{h}\u5f97\u5230\u5f20\u91cf\u963b\u6297\\boldsymbol{Z}\u7684\u5b9a\u89e3\uff0c\u9700\u5f15\u5165\u989d\u5916\u7684\u573a\u5411\u91cf\\boldsymbol r\uff08\u79f0\u4e3a\u53c2\u8003\u9053\uff09\u6765\u5f62\u6210\u5b9a\u89e3\u65b9\u7a0b\\boldsymbol{e} \\boldsymbol{r}^H = \\boldsymbol{Z} \\boldsymbol{h} \\boldsymbol{r}^H(\u4e0a\u6807H\u8868\u793a\u5171\u8f6d\u8f6c\u7f6e)\u3002\u6b64\u65f6\\boldsymbol{Z}\u4e3a\u539f\u7cfb\u7edf\u7684\u4e00\u4e2a\u6700\u5c0f\u4e8c\u4e58\u89e3\u3002\u5199\u6210\u5206\u91cf\u5f62\u5f0f\u5982\u4e0b\uff08\u6ce8\u610f\uff0c\u8fd9\u91cc\u53d6\u5171\u8f6d\u662f\u4e3a\u4e86\u4e92\u76f8\u5173\u7684\u566a\u97f3\u538b\u5236\u7279\u6027\uff09\uff1a</p>  {\\begin{bmatrix}     {E_x}  \\\\ { E_y } \\end{bmatrix}} {\\begin{bmatrix}     {R_x^* } &amp; { R_y^* }  \\end{bmatrix}} = {\\begin{bmatrix}     {E_x R_x^*} &amp; {E_x R_y^*} \\\\     {E_y R_x^*} &amp; {E_y R_y^*} \\end{bmatrix}} = {\\boldsymbol{Z}} {\\begin{bmatrix}     {H_x R_x^*} &amp; {H_x R_y^*} \\\\     {H_y R_x^*} &amp; {H_y R_y^*} \\end{bmatrix}}  <p>\u5176\u4e2d\uff0c\u4e0a\u6807*\u8868\u793a\u53d6\u5171\u8f6d\uff0c\\boldsymbol{Z}\u7684\u77e9\u9635\u5f62\u5f0f\u4e3a\uff1a  </p>  {\\boldsymbol{Z}}  = {\\begin{bmatrix}     {z_{xx}} &amp; {z_{xy}} \\\\     {z_{yx}} &amp; {z_{yy}} \\end{bmatrix}} = {\\begin{bmatrix}     {E_x R_x^*} &amp; {E_x R_y^*} \\\\     {E_y R_x^*} &amp; {E_y R_y^*} \\end{bmatrix}} {\\begin{bmatrix}     {H_x R_x^*} &amp; {H_x R_y^*} \\\\     {H_y R_x^*} &amp; {H_y R_y^*} \\end{bmatrix}}^{-1}  <p>\u5bf9\u4e8e\u5b9e\u6d4b\u6570\u636e\uff0c\u67d0\u4e2a\u9891\u7387\u7684\u963b\u6297\u9700\u8981\u7528\u7535\u78c1\u573a\u4e92\u76f8\u5173\uff08\u9891\u7387\u57df\u7684\u5171\u8f6d\u4e58\u79ef\uff09\u529f\u7387\u8c31\u6765\u8868\u793a\u3002\u9996\u5148\u628a\u65f6\u95f4\u5e8f\u5217\u5206\u6210N\u4e2a\u65f6\u7a97\u8fdb\u884cFT\u53d8\u6362\uff0c\u7136\u540e\u628a\u8be5\u9891\u7387\u4e0d\u540c\u65f6\u7a97\u7684\u7684\u7535\u78c1\u573a\u9891\u8c31\uff08\u4e00\u4e2a\u590d\u6570\uff09\u7684\u4e58\u79ef\u6c42\u5e73\u5747\uff0c \u6700\u540e\u4ee3\u5165\u963b\u6297\u8ba1\u7b97\u516c\u5f0f\u5f97\u5230\u5404\u5206\u91cf\u8868\u8fbe\u5f0f\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}     z_{xx} = \\frac {   \\overline{ E_x R_x^* }                         \\overline{ H_y R_y^* }                      - \\overline{ E_x R_y^* }                        \\overline{ H_y R_x^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }  &amp;\\\\     z_{xy} = \\frac {   \\overline{ E_x R_y^* }                        \\overline{ H_x R_x^* }                      - \\overline{ E_x R_x^* }                        \\overline{ H_x R_y^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }  &amp;\\\\     z_{yx} = \\frac {   \\overline{ E_y R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ E_y R_y^* }                        \\overline{ H_y R_x^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }  &amp;\\\\     z_{yy} = \\frac {   \\overline{ E_y R_y^* }                        \\overline{ H_x R_x^* }                      - \\overline{ E_y R_x^* }                        \\overline{ H_x R_y^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }       \\end{array} \\right.  <p>\u4e0a\u5f0f\u4e2d\u6bcf\u5bf9\u7535\u78c1\u573a\u4e0a\u65b9\u7684\u6a2a\u7ebf\u8868\u793a\u5e73\u5747\u4e92\u76f8\u5173\u529f\u7387\u8c31\uff08crosspower\uff09\u3002\u5b9e\u9645\u5de5\u4f5c\u4e2d\u8fd8\u8981\u6839\u636e\u53e0\u52a0\u7ed3\u679c\u5bf9\u6240\u6709\u65f6\u7a97\u7684\u529f\u7387\u8c31\u8fdb\u884crobust\u7b5b\u9009\u3001\u4eba\u5de5\u6311\u9009\u3002\u5047\u8bbe\u539fN\u4e2a\u529f\u7387\u8c31\u53e0\u7ecf\u7b5b\u9009\u540e\u53ea\u5269\u4e0b\u4e86M\u4e2a\u201c\u8f83\u597d\u201d\u7684\uff0c\u90a3\u4e48M\u4e2a\u65f6\u7a97\u7684\u53e0\u540e7*7\u529f\u7387\u8c31\u77e9\u9635\uff08\u589e\u52a0\u4e86\u548c\u503e\u5b50\u76f8\u5173\u7684H_z\u5206\u91cf\uff0c\u6c42\u963b\u6297\u53ea\u9700\u89816*6\u77e9\u9635\uff09\u5982\u4e0b\u6240\u793a\uff1a</p>  {\\begin{bmatrix}     {\\overline{ H_x H_x^* }} &amp; {\\overline{ H_x H_y^* }} &amp; {\\overline{ H_x H_z^* }} &amp;     {\\overline{ H_x E_x^* }} &amp; {\\overline{ H_x E_y^* }} &amp;      {\\overline{ H_x R_x^* }} &amp; {\\overline{ H_x R_y^* }} &amp;\\\\     {\\overline{ H_y H_x^* }} &amp; {\\overline{ H_y H_y^* }} &amp; {\\overline{ H_y H_z^* }} &amp;     {\\overline{ H_y E_x^* }} &amp; {\\overline{ H_y E_y^* }} &amp;      {\\overline{ H_y R_x^* }} &amp; {\\overline{ H_y R_y^* }} &amp;\\\\     {\\overline{ H_z H_x^* }} &amp; {\\overline{ H_z H_y^* }} &amp; {\\overline{ H_z H_z^* }} &amp;     {\\overline{ H_z E_x^* }} &amp; {\\overline{ H_z E_y^* }} &amp;      {\\overline{ H_z R_x^* }} &amp; {\\overline{ H_z R_y^* }} &amp;\\\\     {\\overline{ E_x H_x^* }} &amp; {\\overline{ E_x H_y^* }} &amp; {\\overline{ E_x H_z^* }} &amp;     {\\overline{ E_x E_x^* }} &amp; {\\overline{ E_x E_y^* }} &amp;      {\\overline{ E_x R_x^* }} &amp; {\\overline{ E_x R_y^* }} &amp;\\\\     {\\overline{ E_y H_x^* }} &amp; {\\overline{ E_y H_y^* }} &amp; {\\overline{ E_y H_z^* }} &amp;     {\\overline{ E_y E_x^* }} &amp; {\\overline{ E_y E_y^* }} &amp;      {\\overline{ E_y R_x^* }} &amp; {\\overline{ E_y R_y^* }} &amp;\\\\     {\\overline{ R_x H_x^* }} &amp; {\\overline{ R_x H_y^* }} &amp; {\\overline{ R_x H_z^* }} &amp;     {\\overline{ R_x E_x^* }} &amp; {\\overline{ R_x E_y^* }} &amp;      {\\overline{ R_x R_x^* }} &amp; {\\overline{ R_x R_y^* }} &amp;\\\\     {\\overline{ R_y H_x^* }} &amp; {\\overline{ R_y H_y^* }} &amp; {\\overline{ R_x H_z^* }} &amp;     {\\overline{ R_y E_x^* }} &amp; {\\overline{ R_y E_y^* }} &amp;      {\\overline{ R_y R_x^* }} &amp; {\\overline{ R_y R_y^* }} &amp;\\\\ \\end{bmatrix}}  <p>\u529f\u7387\u8c31\u77e9\u9635\u662f\u4e3b\u5bf9\u89d2\u4e3a\u5b9e\u6570\uff08\u81ea\u76f8\u5173\uff09\u7684\u590d\u5171\u8f6d\u5bf9\u79f0\u9635\uff0c\u53ef\u7528<code>double</code>\u578b\u6570\u7ec4\u8282\u7701\u4e00\u534a\u5b58\u50a8\u7a7a\u95f4\u3002\u5728SEG\u6807\u51c6edi\u683c\u5f0f<code>&gt;SPECTRA</code>\u5b57\u6bb5\u91cc\uff0c\u6570\u7ec4\u7684\u5b58\u50a8\u65b9\u5f0f\u5982\u4e0b\u6240\u793a\uff08\u7535-\u7535\u3001\u7535-\u78c1\u3001\u78c1-\u78c1\u7684\u529f\u7387\u8c31\u5355\u4f4d\u5206\u522b\u4e3a(mV/km)^2 / Hz\u3001(mV/km) nT / Hz\u548c(nT)^2 / Hz\uff0c\u4e0b\u6807Re\u548cIm\u5206\u522b\u8868\u793a\u53d6\u5b9e\u90e8\u548c\u865a\u90e8\uff09:  </p>  {\\begin{bmatrix}     {\\overline{ H_x H_x^* }} &amp; {\\overline{ H_x H_y^* }}_{Im} &amp; {\\overline{ H_x H_z^* }}_{Im} &amp;     {\\overline{ H_x E_x^* }}_{Im} &amp; {\\overline{ H_x E_y^* }}_{Im} &amp;      {\\overline{ H_x R_x^* }}_{Im} &amp; {\\overline{ H_x R_y^* }}_{Im} &amp;\\\\     {\\overline{ H_y H_x^* }}_{Re} &amp; {\\overline{ H_y H_y^* }} &amp; {\\overline{ H_y H_z^* }}_{Im} &amp;     {\\overline{ H_y E_x^* }}_{Im} &amp; {\\overline{ H_y E_y^* }}_{Im} &amp;      {\\overline{ H_y R_x^* }}_{Im} &amp; {\\overline{ H_y R_y^* }}_{Im} &amp;\\\\     {\\overline{ H_z H_x^* }}_{Re} &amp; {\\overline{ H_z H_y^* }}_{Re} &amp; {\\overline{ H_z H_z^* }} &amp;     {\\overline{ H_z E_x^* }}_{Im} &amp; {\\overline{ H_z E_y^* }}_{Im} &amp;      {\\overline{ H_z R_x^* }}_{Im} &amp; {\\overline{ H_z R_y^* }}_{Im} &amp;\\\\     {\\overline{ E_x H_x^* }}_{Re} &amp; {\\overline{ E_x H_y^* }}_{Re} &amp; {\\overline{ E_x H_z^* }}_{Re} &amp;     {\\overline{ E_x E_x^* }} &amp; {\\overline{ E_x E_y^* }}_{im} &amp;      {\\overline{ E_x R_x^* }}_{Im} &amp; {\\overline{ E_x R_y^* }}_{Im} &amp;\\\\     {\\overline{ E_y H_x^* }}_{Re} &amp; {\\overline{ E_y H_y^* }}_{Re} &amp; {\\overline{ E_y H_z^* }}_{Re} &amp;     {\\overline{ E_y E_x^* }}_{Re} &amp; {\\overline{ E_y E_y^* }} &amp;      {\\overline{ E_y R_x^* }}_{Im} &amp; {\\overline{ E_y R_y^* }}_{Im} &amp;\\\\     {\\overline{ R_x H_x^* }}_{Re} &amp; {\\overline{ R_x H_y^* }}_{Re} &amp; {\\overline{ R_x H_z^* }}_{Re} &amp;     {\\overline{ R_x E_x^* }}_{Re} &amp; {\\overline{ R_x E_y^* }}_{Re} &amp;      {\\overline{ R_x R_x^* }} &amp; {\\overline{ R_x R_y^* }}_{Im} &amp;\\\\     {\\overline{ R_y H_x^* }}_{Re} &amp; {\\overline{ R_y H_y^* }}_{Re} &amp; {\\overline{ R_x H_z^* }}_{Re} &amp;     {\\overline{ R_y E_x^* }}_{Re} &amp; {\\overline{ R_y E_y^* }}_{Re} &amp;      {\\overline{ R_y R_x^* }}_{Re} &amp; {\\overline{ R_y R_y^* }} &amp;\\\\ \\end{bmatrix}}  <p>\u5c06\u4ee5\u4e0a\u5b9e\u77e9\u9635\u7684\u5404\u5143\u7d20\u4ee3\u5165\u524d\u6587\u7684\u5f20\u91cf\u963b\u6297\u6700\u5c0f\u4e8c\u4e58\u89e3\u516c\u5f0f\uff08\u6ce8\u610f\u5171\u8f6d\u7684\u987a\u5e8f\uff09\u5373\u53ef\u5feb\u901f\u6c42\u5f97\u5f20\u91cf\u963b\u6297\u7684\u56db\u4e2a\u5143\u7d20\u3002 \u53e6\u5916\uff0c\u4e3a\u4e86\u4f30\u8ba1\u65b9\u5dee\uff0cedi\u6587\u4ef6\u8fd8\u9700\u8981\u5728\u6bcf\u4e2a\u9891\u7387\u76847*7\u77e9\u9635\u524d\u9762\u5b58\u50a8\u4ee5\u4e0b\u5757\u4fe1\u606f\u5934\uff08\u5047\u8bbe\u67d0edi\u6587\u4ef6\u670940\u4e2a\u9891\u7387\uff0c\u5f53\u524d\u9891\u7387\u4e3a320\uff0c\u529f\u7387\u8c31\u77e9\u9635\u672a\u7ecf\u65cb\u8f6c\uff0c\u53c2\u4e0e\u53e0\u52a0\u7684\u65f6\u7a97\u6570M=1430\uff09:  </p> <pre><code>&gt;SPECTRA  FREQ=320.0  ROTSPEC=0.0 AVGT=1430.0 //40\n</code></pre> <p>\u5c0f\u8d34\u58eb\uff1a\u53ea\u8981\u770b\u4e00\u773c\u529f\u7387\u8c31edi\u6587\u4ef6<code>&gt;SPECTRA</code>\u5b57\u6bb5\u5404\u77e9\u9635\u7684\u6700\u540e\u4e24\u5217\u662f\u5426\u67090\u503c\uff0c\u5c31\u53ef\u5224\u65ad\u6570\u636e\u5904\u7406\u6709\u65e0\u4f7f\u7528\u8fdc\u53c2\u8003\u9053\uff0c\u8fd9\u5bf9\u4e8eMT\u6570\u636e\u9a8c\u6536\u4eba\u5458\u6216\u76d1\u7406\u4eba\u5458\u662f\u5f88\u6709\u7528\u7684\u5c0f\u77e5\u8bc6\u3002\u601d\u8003\u4ee5\u4e0b\uff0c\u4e3a\u4ec0\u4e48\uff1f\uff1a\uff09</p>"},{"location":"markdown/em_mt_impedance/#3","title":"3.\u65b9\u5dee\u77e9\u9635","text":"<p>\u963b\u6297\u5f20\u91cf\u7684\u6700\u5c0f\u4e8c\u4e58\u89e3\u53ef\u7edf\u4e00\u5199\u4e3a \\boldsymbol{Z} =  \\boldsymbol{e} \\boldsymbol{r}^H (\\boldsymbol{h} \\boldsymbol{r}^H)^{-1}\uff0c\u73b0\u6709\u4e00\u89c2\u6d4b\u78c1\u573a\\boldsymbol{e}\uff0c\u5373\u5176\u9884\u6d4b\u7684\u7cfb\u7edf\u54cd\u5e94\u4e3a\\boldsymbol{Zh}\uff0c\u5b83\u4e0e\u5b9e\u9645\u89c2\u6d4b\u7535\u573a\u7684\u6b8b\u5dee\\boldsymbol{v} = \\boldsymbol{e} - \\boldsymbol{Zh}\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u53ef\u8861\u91cf\u4f20\u8f93\u51fd\u6570\u6700\u5c0f\u4e8c\u4e58\u89e3\u7684\u53ef\u9760\u6027\uff08\u4ec5\u4ec5\u662f\u201c\u4e00\u5b9a\u7a0b\u5ea6\u201d\uff09\u3002\u4ece\u800c\u963b\u6297\u5f20\u91cf\u5404\u5143\u7d20\u5bf9\u6b8b\u5dee\u5411\u91cf\u7684\u8d21\u732e\uff08\u5b9a\u4e49\u4e3a\u5404\u5143\u7d20\u7684\u8bef\u5dee\uff09\u6ee1\u8db3\uff1a</p>  \\hat{\\boldsymbol{Z}} =  \\boldsymbol{v} \\boldsymbol{r}^H (\\boldsymbol{h} \\boldsymbol{r}^H)^{-1}  <p>\u5f53\u53c2\u8003\u9053\u4e3a\\boldsymbol{r}\uff0c\u4e14\u53c2\u4e0e\u53e0\u52a0\u7684\u65f6\u7a97\u4e2a\u6570\u4e3aM\uff0c\u963b\u6297\u5f20\u91cf\u7684\u603b\u8bef\u5dee\u6c34\u5e73\u4e3a\uff1a</p>  \\left\\{     \\begin{array}{**lr**}     \\hat{z}_{xx} =              \\frac {   \\overline{ V_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ V_x R_y^* }                        \\overline{ H_y R_x^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }  &amp;\\\\     \\hat{z}_{xy} =               \\frac {   \\overline{ V_x R_y^* }                        \\overline{ H_x R_x^* }                      - \\overline{ V_x R_x^* }                        \\overline{ H_x R_y^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }  &amp;\\\\     \\hat{z}_{yx} =              \\frac {   \\overline{ V_y R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ V_y R_y^* }                        \\overline{ H_y R_x^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }  &amp;\\\\     \\hat{z}_{yy} =              \\frac {   \\overline{ V_y R_y^* }                        \\overline{ H_x R_x^* }                      - \\overline{ V_y R_x^* }                        \\overline{ H_x R_y^* } }                     {   \\overline{ H_x R_x^* }                        \\overline{ H_y R_y^* }                      - \\overline{ H_x R_y^* }                        \\overline{ H_y R_x^* } }       \\end{array} \\right.  <p>\u53e0\u540e\u963b\u6297\u5f20\u91cf\u7684\u65b9\u5dee\u53ef\u5b9a\u4e49\u4e3a:</p>  Var(\\boldsymbol{Z}) = {\\begin{bmatrix}     { |\\hat{z}_{xx}|^2 } / M &amp; { |\\hat{z}_{xy}|^2  / M} \\\\     { |\\hat{z}_{yx}|^2 } / M &amp; { |\\hat{z}_{yy}|^2  / M} \\end{bmatrix}}  <p>\u4ee5\u4e0a\u5373\u4e3a\u53c2\u8003\u9053\u4e3a\\boldsymbol{r}\u65f6\u53e0\u540e\u963b\u6297\u5f20\u91cf\u6700\u5c0f\u4e8c\u4e58\u89e3\u7684\u8bef\u5dee\u4f30\u8ba1\uff08J Clark, T D Gamble, et. al., 1983\uff09\u3002\u5fc5\u987b\u6307\u51fa\u7684\u662f\uff0cMT\u963b\u6297\u5f20\u91cf\u7684\u201c\u8bef\u5dee\u201d\u5e76\u975e\u53cd\u6620\u5404\u6837\u672c\u5bf9\u671f\u671b\u7684\u504f\u79bb\uff0c \u800c\u662f\u6839\u636e\u7cfb\u7edf\u4f20\u8f93\u51fd\u6570\u6700\u5c0f\u4e8c\u4e58\u89e3\uff08\\boldsymbol{Z}\uff09\u548c\u89c2\u6d4b\u78c1\u573a\uff08\\boldsymbol{h}\uff09\u7684\u9884\u6d4b\u7535\u573a\u548c\u89c2\u6d4b\u7535\u573a\uff08\\boldsymbol{e}\uff09\u7684\u504f\u79bb\u3002\u5f88\u591a\u5b66\u8005\u628aMT\u8bef\u5dee\u548c\u76f4\u6d41\u7535\u6cd5\uff0cCSAMT\u7b49\u7684\u8bef\u5dee\u7b49\u540c\uff0c\u8fd9\u662f\u5b8c\u5168\u9519\u8bef\u7684\u3002</p>"},{"location":"markdown/em_mt_impedance/#4","title":"4.\u8fd1\u53c2\u8003\u548c\u8fdc\u53c2\u8003","text":"<p>\u53c2\u8003\u9053\u4e00\u822c\u6709\u56db\u79cd\u9009\u6cd5\u201cLocal E\u201d\u3001\u201cLocal H\u201d\u3001\u201cRemote E\u201d\u548c\u201cRemote H\u201d\uff0c\u4e00\u822c\u7ffb\u8bd1\u4e3a\u201c\u8fd1\u7535\u53c2\u201d\u3001\u201c\u8fd1\u78c1\u53c2\u201d\u3001\u201c\u8fdc\u7535\u53c2\u201d\u548c\u201c\u8fdc\u78c1\u53c2\u201d\u3002\u901a\u5e38\u7531\u4e8e\u7535\u573a\u6a2a\u5411\u53d8\u5316\u5267\u70c8\uff0c\u4ece\u7a33\u5b9a\u6027\u8003\u8651\u591a\u7528\u78c1\u573a\u4f5c\u4e3a\u53c2\u8003\u9053\u3002 \u8003\u8651\u201cLocal H\u201d\u4e0e\u201cRemote H\u201d\u4e24\u79cd\u60c5\u51b5(\u5206\u522b\u5bf9\u5e94\u5411\u91cf\\boldsymbol{h}\u548c\\boldsymbol{r})\uff0c\u5b9e\u9645\u89c2\u6d4b\u7684\u7535\u78c1\u573a\u9891\u8c31\u5747\u5b58\u5728\u566a\u97f3\uff0c\u53ef\u8868\u793a\u4e3a\uff08\u566a\u97f3\u548c\u4fe1\u53f7\u90fd\u662f\u672a\u77e5\u6570\uff09\uff1a</p>  \\left\\{     \\begin{array}{**lr**}     \\boldsymbol{e} = \\boldsymbol{e}_{true} + \\boldsymbol{e}_{noise} &amp;\\\\     \\boldsymbol{h} = \\boldsymbol{h}_{true} + \\boldsymbol{h}_{noise} &amp;\\\\     \\boldsymbol{r} = \\boldsymbol{r}_{true} + \\boldsymbol{r}_{noise}     \\end{array} \\right.  <p>\u5f20\u91cf\u963b\u6297\u7684\u6700\u5c0f\u4e8c\u4e58\u89e3\u5982\u4e0b\uff1a</p>  \\left\\{     \\begin{array}{**lr**}     \\boldsymbol{Z}_{LH} =  (\\boldsymbol{e}_{true} + \\boldsymbol{e}_{noise})                            (\\boldsymbol{h}_{true}^H + \\boldsymbol{h}_{noise}^H)                            [(\\boldsymbol{h}_{true} + \\boldsymbol{h}_{noise})                             (\\boldsymbol{h}_{true}^H + \\boldsymbol{h}_{noise}^H) ] ^{-1} &amp;\\\\     \\boldsymbol{Z}_{RH} =  (\\boldsymbol{e}_{true} + \\boldsymbol{e}_{noise})                            (\\boldsymbol{r}_{true}^H + \\boldsymbol{r}_{noise}^H)                            [(\\boldsymbol{h}_{true} + \\boldsymbol{h}_{noise})                             (\\boldsymbol{r}_{true}^H + \\boldsymbol{r}_{noise}^H) ] ^{-1}     \\end{array} \\right.  <p>\u5f53\u4e24\u4e2a\u4fe1\u53f7\u7684\u566a\u97f3\u4e0d\u76f8\u5e72\uff08not coherent\uff09\u65f6\uff0c\u4e92\u76f8\u5173\u64cd\u4f5c\u4f1a\u7a81\u51fa\u4fe1\u53f7\uff0c\u538b\u5236\u566a\u97f3\u3002  \u5bf9\u4e8e\\boldsymbol{Z}_{LH}\uff0c\u82e5\u5047\u5b9aMT\u566a\u97f3\u662f\u968f\u673a\u7684\uff0c\u4e14\u7535\u78c1\u4e4b\u95f4\u4e0d\u76f8\u5e72\uff0c \u5219(\\boldsymbol{e}_{true} + \\boldsymbol{e}_{noise}) (\\boldsymbol{h}_{true}^H + \\boldsymbol{h}_{noise}^H)\u4e2d\u7684\u566a\u97f3\u6210\u5206\u4f1a\u88ab\u538b\u5236\u3002\u800c(\\boldsymbol{h}_{true} + \\boldsymbol{h}_{noise}) (\\boldsymbol{h}_{true}^H + \\boldsymbol{h}_{noise}^H)\u5e76\u65e0\u566a\u97f3\u538b\u5236\u6548\u679c\uff0c\u4f46\u5176\u4e2d\u7684\u968f\u673a\u566a\u97f3\u6210\u5206\u53ef\u901a\u8fc7\u5927\u91cf\u7684\u53e0\u52a0\u538b\u5236\u3002 \u82e5\u5728\u89c2\u6d4b\u70b9\u9644\u8fd1\u6709\u4e00\u5f3a\u4eba\u5de5\u566a\u97f3\u6e90\uff0c\u9020\u6210\\boldsymbol{e}_{noise}\u548c\\boldsymbol{h}_{noise}\u6709\u5f3a\u76f8\u5e72\u6027\uff0c\u5219\u5f53\u524d\u65f6\u6bb5\u7684\\boldsymbol{Z}_{LH}\u4f1a\u4e25\u91cd\u5931\u771f\uff0c\u5fc5\u987b\u5728\u53e0\u52a0\u524d\u624b\u5de5\u5254\u9664\u3002 \u518d\u6781\u7aef\u4e00\u70b9\uff0c\u8be5\u566a\u97f3\u6e90\u5728\u6574\u4e2a\u89c2\u6d4b\u65f6\u6bb5\u5185\u90fd\u5b58\u5728\uff08time independent\uff09\uff0c\u5219\u65e0\u8bba\u5982\u4f55\\boldsymbol{Z}_{LH}\u4e00\u5b9a\u504f\u79bb\u771f\u5b9eMT\u4f20\u8f93\u51fd\u6570\u751a\u8fdc\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a\u82e5\u566a\u97f3\u5f3a\u76f8\u5e72\uff0c\u8fd1\u53c2\u7684\u65b9\u5dee\u53cd\u800c\u4f1a\u5f88\u5c0f\uff0c\u56e0\u4e3a\u603b\u89c2\u6d4b\u573a\\boldsymbol{e}\u548c\\boldsymbol{h}\u662f\u5f3a\u76f8\u5e72\u7684\uff0c\u6700\u5c0f\u4e8c\u4e58\u89e3\u516c\u5f0f\u8ba4\u4e3a\u91cc\u9762\u201c\u4e0d\u542b\u566a\u97f3\u201d\uff0c\u4f7f\u5f97\u6b8b\u5dee\u5411\u91cf\\boldsymbol{v} = \\boldsymbol{e} - \\boldsymbol{Zh}\u4e5f\u5f88\u5c0f\uff0c\u6240\u4ee5\u8fd9\u91cc\u5fc5\u987b\u518d\u6b21\u6307\u51fa\uff0cMT\u7684\u65b9\u5dee\u5e76\u4e0d\u8868\u793a\u6570\u636e\u566a\u97f3\u3002</p> <p>\u5982\u679c\u9009\u62e9\u4e86\u4e00\u5bf9\u201c\u8fdc\u79bb\u201d\u6d4b\u533a\u7684\u89c2\u6d4b\u573a\u4f5c\u4e3a\u53c2\u8003\u9053\uff0c\u53ef\u8ba4\u4e3a\u6d4b\u533a\u7684\u566a\u97f3\u6210\u5206\u548c\u53c2\u8003\u9053\u7684\u566a\u97f3\u6210\u5206\u76f8\u5e72\u5ea6\u5f88\u5c0f\uff0c\u4ece\u800c \\boldsymbol{Z}_{RH}\u7684\u6bcf\u4e00\u9879\u4e92\u76f8\u5173\u529f\u7387\u8c31\u4e2d\u4fe1\u53f7\u6210\u5206\u5747\u88ab\u653e\u5927\uff0c\u566a\u97f3\u6210\u5206\u5747\u88ab\u538b\u5236\u3002\u8fd9\u6837\u5c31\u6709\u53ef\u80fd\u5728\u5f3a\u76f8\u5e72\u566a\u97f3\u73af\u5883\u4e0b\u4ecd\u5f97\u5230\u63a5\u8fd1\u771f\u5b9e\u4f20\u8f93\u51fd\u6570\u7684\u6700\u5c0f\u4e8c\u4e58\u89e3\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a\u82e5\u566a\u97f3\u5f3a\u76f8\u5e72\uff0c\u4e14\u80fd\u88ab\u8fdc\u53c2\u8003\u6709\u6548\u538b\u5236\uff0c\u6b64\u65f6\u963b\u6297\u5f20\u91cf\u7684\u65b9\u5dee\u53cd\u800c\u4f1a\u53d8\u5927\uff0c\u56e0\u4e3a\u8861\u91cf\u65b9\u5dee\u7684\u6b8b\u5dee\u5411\u91cf\u662f\\boldsymbol{e} - \\boldsymbol{Z}_{RH} \\boldsymbol{h}\uff0c  \u800c\u975e\\boldsymbol{e}_{true} - \\boldsymbol{Z}_{RH} \\boldsymbol{h}\u3002\u566a\u97f3\u538b\u5236\u5f97\u8d8a\u597d\uff0c\u6839\u636e\u529f\u7387\u8c31\u8ba1\u7b97\u7684\u65b9\u5dee\u53cd\u800c\u4f1a\u8d8a\u5927\u3002 </p> <p>\u6839\u636e\u8fdc\u53c2\u8003\u7684\u539f\u7406\uff0c\u53ef\u4ee5\u5f97\u51fa\u8fdc\u53c2\u8003\u70b9\u7684\u9009\u62e9\u539f\u5219\u2014\u2014\u201c\u8fdc\u53c2\u70b9\u5904\u7684\u7535\u78c1\u573a\u566a\u97f3\u9700\u548c\u6d4b\u533a\u566a\u97f3\u4e0d\u76f8\u5e72\u201d\u3002 \u82e5\u67d0\u70b9\u5230\u6d4b\u533a\u7684\u8ddd\u79bb\u4e3a\u5f53\u524d\u9891\u7387\u8d8b\u80a4\u6df1\u5ea6\u7684n\u500d\uff0c\u5219\u6d4b\u533a\u7684\u566a\u97f3\u4fe1\u53f7\u5728\u8fdc\u53c2\u8003\u70b9\u5e94\u8870\u51cf\u4e86e^{-n}\u3002 \u4e00\u822c\u6765\u8bf4\uff0c\u82e5\u8fdc\u53c2\u8003\u70b9\u9009\u62e9\u5728\u6d4b\u533a\u6309\u6700\u4f4e\u9891\u8ba1\u7b97\u76847\u500d\u8d8b\u80a4\u6df1\u5ea6\uff08\u7ea6\u8870\u51cf\u4e3a0.1%\uff09\u4ee5\u5916\u7684\u5730\u65b9\uff0c\u57fa\u672c\u53ef\u8ba4\u4e3a\u8fbe\u5230\u566a\u97f3\u5f31\u76f8\u5e72\u7684\u8981\u6c42\u3002\u4f46\u5b9e\u9645\u5de5\u4f5c\u4e2d\u5f88\u96be\u786e\u5b9a\u6d4b\u533a\u80cc\u666f\u7535\u963b\u7387\uff0c\u8d8b\u80a4\u6df1\u5ea6\u7684\u4f30\u8ba1\u5f80\u5f80\u6709\u8f83\u5927\u504f\u5dee\uff08\u5c24\u5176\u5728\u9ad8\u963b\u533a\uff09\u3002\u56e0\u6b64\uff0c\u6b64\u500d\u6570\u53ef\u80fd\u8981\u66f4\u5927\u4e00\u4e9b\uff08\u598210\u500d\uff09\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a\u82e5\u5e26\u8fdc\u53c2\u8003\u5904\u7406\u540e\u53d1\u73b0\u9ad8\u9891\u6709\u6539\u5584\uff0c\u4f4e\u9891\u548c\u8fd1\u53c2\u4e00\u6837\u6beb\u65e0\u6539\u5584\uff0c\u5219\u8868\u793a\u6b64\u65f6\u53c2\u8003\u70b9\u5bf9\u4e8e\u4f4e\u9891\u6bb5\u6765\u8bf4\u4ecd\u201c\u592a\u8fd1\u201d\u3002</p> <p>\u603b\u800c\u8a00\u4e4b\uff0c\u7531\u4e8eMT\u7684\u5f20\u91cf\u963b\u6297\u662f\u76f4\u63a5\u7528\u9891\u8c31\u6765\u5b9a\u4e49\u4f30\u8ba1\u7684\uff08\u4fe1\u53f7\u548c\u566a\u97f3\u90fd\u662f\u672a\u77e5\u6570\uff09\u3002\u6545\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u52a0\u7a97\u9891\u7387\u57df\u6ee4\u6ce2\u3001\u65f6\u95f4\u57df\u5149\u6ed1\u3001\u65f6\u5e8f\u5f62\u6001\u4fee\u6b63\u7b49\u53ef\u80fd\u6539\u53d8\u7535\u78c1\u573a\u529f\u7387\u8c31\u6bd4\u4f8b\u5173\u7cfb\u7684\u64cd\u4f5c\u8981\u975e\u5e38\u614e\u91cd\uff08\u6216\u8005\u8bf4\u8fd9\u79cd\u884c\u4e3a\u662f\u8fdd\u80ccMT\u7406\u8bba\u57fa\u7840\u7684\uff09\uff0c\u6709\u53ef\u80fd\u5f97\u5230\u5f88\u4e0d\u53ef\u9760\u7684\u5f20\u91cf\u963b\u6297\u89e3\u3002 \u7ecf\u5178\u7406\u8bba\u6846\u67b6\u4e0b\uff0c\u6709\u56db\u7c7b\u566a\u97f3\u53ef\u88ab\u6709\u6548\u538b\u5236\uff1a\u968f\u673a\u566a\u97f3\u3001\u7535\u78c1\u76f8\u5e72\u5ea6\u5c0f\u7684\u566a\u97f3\u3001\u7535\u78c1\u76f8\u5e72\u5ea6\u8f83\u5927\u4f46\u4ec5\u51fa\u73b0\u5728\u4e00\u4e2a\u65f6\u6bb5\u7684\u566a\u97f3\u3001\u5168\u65f6\u6bb5\u7535\u78c1\u5f3a\u76f8\u5e72\u5ea6\u4f46\u4e0e\u8fdc\u53c2\u8003\u9053\u4e0d\u76f8\u5e72\u7684\u566a\u97f3\u3002 \u5176\u538b\u5236\u65b9\u5f0f\u5206\u522b\u4e3a\uff1a\u8db3\u591f\u7684\u53e0\u52a0\uff0c\u963b\u6297\u6700\u5c0f\u4e8c\u4e58\u89e3\u4e2d\u7684\u4e92\u76f8\u5173\u64cd\u4f5c\u53carobust\u9009\u8c31\uff0c\u624b\u5de5\u9009\u8c31\uff0c\u8fdc\u53c2\u8003\u5904\u7406\u3002\u76ee\u524d\uff0c\u5728\u7406\u8bba\u5c1a\u672a\u6709\u91cd\u5927\u7a81\u7834\u4e4b\u524d\uff0c\u5176\u4ed6\u53bb\u566a\u65b9\u6cd5\u7684\u7406\u8bba\u4f9d\u636e\u90fd\u592a\u5f31\u4e14\u53ef\u9760\u6027\u8f83\u4f4e\u3002  </p>"},{"location":"markdown/finite_element_1d/","title":"\u7b80\u5355\u7684\u4e00\u7ef4\u6709\u9650\u5143","text":"<p>\u5730\u7403\u7269\u7406\u6b63\u95ee\u9898\u5927\u591a\u9700\u8981\u6c42\u504f\u5fae\u5206\u65b9\u7a0b\u6570\u503c\u89e3\uff0c\u5176\u4e2d\u6709\u9650\u5355\u5143\uff08FE\uff09\u662f\u975e\u5e38\u91cd\u8981\u7684\u4e00\u7c7b\u65b9\u6cd5\u3002\u53d6\u5fae\u5206\u7b97\u5b50L\u3001\u672a\u77e5\u91cfu\u548c\u6fc0\u52b1\u51fd\u6570f\u6784\u6210\u7684\u4e00\u822c\u5fae\u5206\u65b9\u7a0bLu=f\uff0c\u5f53u\u5728\u6c42\u89e3\u57df\\Omega\u7684\u8fb9\u754c\u4e0a\u6ee1\u8db3\u7684\u6761\u4ef6\uff08Boundary Conditions\uff09\u786e\u5b9a\u65f6\uff0c\u6c42u\u7684\u95ee\u9898\u4e5f\u88ab\u79f0\u4e3a\u6c42\u89e3\u8fb9\u503c\u95ee\u9898\uff08Boundary Value Problem\uff09\u3002 \u4f5c\u4e3a\u4e00\u7bc7\u4e0d\u6b63\u7ecf\u7684\u79d1\u666e\uff0c\u672c\u6587\u901a\u7bc7\u53ea\u8003\u8651\u7b80\u5355\u7684\u60c5\u51b5\uff0c\u6bd4\u5982L\u4e3a\u4e00\u7ef4\u7a7a\u95f4\u4e8c\u9636\u5fae\u5206\u7b97\u5b50\uff0cLu=f\u7684\u8fb9\u503c\u95ee\u9898\u4e3a\u4e0b\u5f0f\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         \\frac{\\partial^{2} u }{ \\partial x^{2}} = x + 1 &amp;\\\\         x \\in \\Omega = [0, 1] &amp;\\\\         \\left. u \\right|_{x=0} = 0, \\left. u \\right|_{x=1} = 1    &amp;     \\end{array} \\right.  <p>\u5f53\u7136\u6b64\u95ee\u9898\u5b58\u5728\u7cbe\u786e\u89e3u(x) = {\\frac{1}{6}}  x^3 + {\\frac{1}{2}} x^2 + {\\frac{1}{3}}x\u3002\u4e0d\u8fc7\u6211\u4eec\u9700\u5047\u5b9a\u4e0d\u77e5\u9053\u5b83\u4eec\uff0c\u73b0\u5728\u7684\u95ee\u9898\u662f\u5982\u4f55\u903c\u8fd1u(x)\u3002  </p>"},{"location":"markdown/finite_element_1d/#1-galerkinweighted-residual-method","title":"1. \u4f3d\u8fbd\u91d1(Galerkin)\u52a0\u6743\u4f59\u91cf\u65b9\u6cd5(Weighted Residual Method)","text":"<p>\u5047\u5b9a\u5bf9\u4e8e\u67d0\u4e2a\\tilde{u}\uff0c\u5176\u6b8b\u5deer\uff08\u4e5f\u79f0\u4f59\u91cf\uff09\u5b9a\u4e49\u4e3ar=L\\tilde{u}-f \\neq 0\u3002 \u82e5\u67d0\u4e2a\u903c\u8fd1\u89e3\\tilde{u}\u4e0e\u771f\u5b9e\u89e3u\u6ee1\u8db3u(x)=\\tilde{u}(x),\\forall x \\in \\Omega\uff08\u5373\u6c42\u89e3\u57df\u4e2d\u903c\u8fd1\u89e3\u548c\u771f\u5b9e\u89e3\u5904\u5904\u76f8\u7b49\uff09\uff0c\u5219\u79f0\\tilde{u}\u662f\u65b9\u7a0bLu=f\u7684\u4e00\u4e2a\u201c\u5f3a\u89e3\u201d\uff0c\u5f53\u7136\u5b83\u5fc5\u7136\u6ee1\u8db3r(x)=0,\\forall x \\in \\Omega\u3002 \u9057\u61be\u7684\u662f\uff0c\u5982\u679c\u51fd\u6570\\tilde{u}\u592a\u590d\u6742\uff0c\u6211\u4eec\u6839\u672c\u65e0\u6cd5\u5b8c\u5907\u7684\u9a8c\u8bc1\u8fd9\u4e00\u70b9\uff0c\u66f4\u4f55\u51b5\u6c42\u89e3\u5b83\uff1f\u56e0\u6b64\uff0c\u9000\u800c\u6c42\u5176\u6b21\uff0c\u82e5\u51fd\u6570\\tilde{u}\u53ef\u7528\u4e00\u7cfb\u5217\u7b80\u5355\u7684\u57fa\u51fd\u6570\u5c55\u5f00\uff0c\u5f53\u6b8b\u5dee\u4e0e\u67d0\u4e2a\u6d4b\u8bd5\u51fd\u6570\uff08\u4e5f\u79f0\u6743\u51fd\u6570\uff09\u7684\u5377\u79ef\u90fd\u6700\u5c0f\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u63a5\u53d7\\tilde{u}\u662f\u539f\u95ee\u9898\u7684\u4e00\u4e2a\u201c\u5f31\u89e3\u201d\u3002\u4fd7\u8bdd\u8bf4\uff1a\u201c\u5f31\u8005\u4e5f\u6709\u751f\u5b58\u7684\u6743\u529b\uff0c\u5f3a\u8005\u751f\uff0c\u5f31\u8005\u6b7b\u7684\u54f2\u5b66\u5728\u4e0b\u7edd\u4e0d\u8ba4\u540c\uff08by\u7eef\u6751\u5251\u5fc3\uff09\u201d\u3002 \u5f15\u5165\u4e00\u7ec4\u57fa\u51fd\u6570b_1, b_2, ..., b_n\u628a\\tilde{u}\u5c55\u5f00\u4e3ac_1 b_1+ c_2 b_2+ \\cdots +c_n  b_n\uff0c\u6839\u636e\u5f31\u89e3\u6761\u4ef6\uff0c\u53d6\u4e00\u7cfb\u5217\u6d4b\u8bd5\u51fd\u6570w_i\u548c\u6b8b\u5dee\u5377\u79ef\uff0c\u8fd9\u4e9b\u79ef\u5206\u5fc5\u987b\u6ee1\u8db3\uff1a  </p>  R_i = \\int \\nolimits_{\\Omega} w_i r d {\\Omega} = \\int \\nolimits_{\\Omega} w_i (L\\tilde{u}-f) d {\\Omega} = 0  <p>\u5176\u4e2d\u6d4b\u8bd5\u51fd\u6570w_i\u6709\u5f88\u591a\u53d6\u6cd5\uff08\u5982\u72c4\u62c9\u514b\u3001\u4e8c\u8303\u6570\u3001....\uff09\uff0cGalerkin\u6cd5\u53d6w_i\u4e3a\u57fa\u51fd\u6570b_i\u672c\u8eab\uff0c\u5373\uff1a  </p>  R_i = \\int \\nolimits_{\\Omega} b_i [ L ( c_1 b_1 + c_2 b_2 + \\cdots + c_n b_n )-f] d {\\Omega}   <p>\u8003\u8651\u6211\u4eec\u7684\u7b80\u5355\u4e00\u7ef4\u4e8c\u9636\u5fae\u5206\u65b9\u7a0b\\frac{\\partial^{2} u }{ \\partial x^{2}} = x + 1\uff0c\u5047\u8bbe\u51a5\u51a5\u4e4b\u4e2d\u6709\u4e00\u4e2a\u58f0\u97f3\u544a\u8bc9\u4f60\uff1a\u201c\u4ee5\u8036\u548c\u534e\u3001\u5b89\u62c9\u548c\u91ca\u8fe6\u725f\u5c3c\u7684\u540d\u4e49\uff0c\u903c\u8fd1\u89e3\u5fc5\u987b\u7528\u4e09\u6b21\u591a\u9879\u5f0f\u5c55\u5f00\u201d\u3002\u5373\uff1a  </p>  \\tilde{u}(x) = c_0 + c_1 x + c_2 x^2 + c_3 x^3  <p>\u5f53\u7136\uff0c\u6211\u4eec\u53ea\u80fd\u5c0a\u4ece\u4e09\u5927\u795e\u7684\u7edf\u4e00\u610f\u89c1\uff0c\u5f97\u5230\u56db\u4e2a\u57fa\u51fd\u6570[0, x, x^2, x^3]\u548c\u56db\u4e2a\u7cfb\u6570[c_0, c_1, c_2, c_3]\u3002\u56db\u4e2a\u7cfb\u6570\u600e\u4e48\u89e3\u51fa\u6765\u5462\uff1f\u5f88\u660e\u663e\uff0c\u628a\u8fb9\u754c\u6761\u4ef6\\tilde{u}(0)=0\u548c\\tilde{u}(1)=1\u4ee3\u5165\u5c55\u5f00\u5f0f\u53ef\u4ee5\u5f97\u5230\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         c_0 = 0 &amp;\\\\         c_1 + c_2 + c_3 = 1     \\end{array} \\right.  <p>\u5269\u4e0b\u7684\u90e8\u5206\u5219\u9700\u8981\u6c42Galerkin\u5f31\u89e3\u6761\u4ef6\u65b9\u7a0b\uff0c\u9996\u5148\u628a\u4e8c\u9636\u5bfc\u6c42\u51fa\u6765\uff1a  </p>  \\frac{\\partial^{2} \\tilde{u}}{\\partial x^{2}} = 6 c_3 x + 2 c_2  <p>\u6d4b\u8bd5\u51fd\u6570w_i\u5206\u522b\u53d6\u4e3a[0, x, x^2, x^3]\u3002R_0=0\u65e0\u9700\u8ba1\u7b97\uff0cR_1\u7684\u8ba1\u7b97\u8fc7\u7a0b\u5982\u4e0b\uff1a  </p>  \\begin{align}   R_1 &amp;= \\int \\nolimits_{0}^{1} x (6 c_3 x + 2 c_2 - x - 1)  dx \\\\         &amp;= \\int \\nolimits_{0}^{1} [(6 c_3 - 1) x^2 + (2 c_2 - 1) x] dx\\\\         &amp;= \\left. {\\frac{6 c_3 - 1}{3} x^3 } \\right|_0^1 - \\left.  {\\frac{2 c_2 - 1}{2} x^2 } \\right|_0^1\\\\       &amp;= 2 c_3 + c_2 - \\frac{5}{6} \\end{align}   <p>\u518d\u8ba1\u7b97R_2\uff0c\u5982\u4e0b\uff1a  </p>  \\begin{align}   R_2 &amp;= \\int \\nolimits_{0}^{1} x^2 (6 c_3 x + 2 c_2 - x - 1)  dx \\\\         &amp;= \\int \\nolimits_{0}^{1} [(6 c_3 - 1) x^3 + (2 c_2 - 1) x^2 ] dx\\\\         &amp;= \\left. {\\frac{6 c_3 - 1}{4} x^4 } \\right|_0^1 - \\left. {\\frac{2 c_2 - 1}{3} x^3 } \\right|_0^1\\\\       &amp;= \\frac{3}{2} c_3 + \\frac{2}{3}c_2 - \\frac{7}{12} \\end{align}   <p>\u7136\u540e\u628a\u6240\u6709\u548c\u7cfb\u6570c_i\u6709\u5173\u7684\u5f0f\u5b50\u653e\u5230\u4e00\u8d77\uff0c\u5f97\u5230\u4ee5\u4e0b\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff1a   </p>  \\left\\{     \\begin{array}{**lr**}         c_0 = 0 &amp;\\\\         c_1 + c_2 + c_3 = 1 &amp;\\\\         c_2 + 2 c_3 = \\frac{5}{6} &amp;\\\\         \\frac{2}{3}c_2 + \\frac{3}{2} c_3 = \\frac{7}{12}     \\end{array} \\right.  <p>\u89e3\u5f97[c_0, c_1, c_2, c_3]=[0, 1/3, 1/2, 1/6]\uff0c\u5373\uff1a  </p>  \\tilde{u}(x) = {\\frac{1}{6}}  x^3 + {\\frac{1}{2}} x^2 + {\\frac{1}{3}}x  <p>\u603b\u4e4b\uff0c\u5982\u679c\u795e\u4ed9\u80fd\u544a\u8bc9\u4f60\u5bf9\\tilde{u}\u6700\u597d\u7684\u57fa\u51fd\u6570\u5c55\u5f00\u65b9\u5f0f\uff08\u7ed9\u4f60\u4e00\u7ec4\u5b8c\u5907\u57fa\uff09\uff0c\u4f7f\u7528\u52a0\u6743\u4f59\u91cf\u6cd5\u6784\u5efa\u7ebf\u6027\u65b9\u7a0b\u5e76\u89e3\u51fa\u7cfb\u6570\u540e\uff0c\u6211\u4eec\u795e\u5947\u7684\u53d1\u73b0\uff0c\u5f31\u89e3\\tilde{u}(x)\u521a\u597d\u4e5f\u662f\u5fae\u5206\u65b9\u7a0b\u7684\u7cbe\u786e\u89e3\u3002 \u4f46\u8981\u662f\u8fd9\u5e2e\u6df7\u86cb\u795e\u4ed9\u6545\u610f\u73a9\u4f60\uff0c\u544a\u8bc9\u4f60\u7528\u6076\u52a3\u3001\u90aa\u6076\u7684\u57fa\u51fd\u6570\u53bb\u5c55\u5f00\u903c\u8fd1\u89e3\u4f1a\u5982\u4f55\uff1f\u6216\u8005\u8bf4\uff0c\u5047\u4f7f\u4f60\u548c\u6211\u4e00\u6837\u662f\u4e00\u4e2a\u5f3a\u65e0\u795e\u8bba\u8005\uff0c\u660e\u663e\u4e0d\u53ef\u80fd\u4e0e\u795e\u7075\u4eb2\u5bc6\u6c9f\u901a\u4ece\u800c\u5f97\u5230\u542f\u793a\uff0c\u90a3\u600e\u4e48\u529e\uff1f \u7684\u7684\u786e\u786e\uff0c\u5bf9\u51e1\u4eba\u6765\u8bf4\u7cbe\u786e\u89e3\u7684\u8981\u6c42\u592a\u9ad8\u4e86\u3002\u9000\u800c\u6c42\u5176\u6b21\uff0c\u80fd\u5426\u7528\u4e00\u7ec4\u8db3\u591f\u7b80\u5355\u7684\u57fa\u51fd\u6570\u6765\u903c\u8fd1\u8fd1\u4f3c\u89e3\u5462\uff1f \u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6211\u7684\u57fa\u51fd\u6570\u53d6\u5f97\u8db3\u591f\u7684\u7b80\u5355\uff08\u6bd4\u5982\u7ebf\u6027\uff09\uff0c\u5f53u\u672c\u8eab\u975e\u5e38\u975e\u5e38\u590d\u6742\u65f6\uff0c\u53ef\u5426\u5206\u6bb5\u7684\u7528\u4e00\u7ec4\u6298\u7ebf\u53bb\u903c\u8fd1\u5462\uff1f \u4e8e\u662f\uff0c\u51e1\u4eba\u4eec\u5f00\u59cb\u4e0d\u5b89\u5206\u7684\u60f3\uff1a\u628a\u6c42\u89e3\u57df\\Omega\u5206\u6210\u5f88\u591a\u5b50\u57df\uff0c\u6bcf\u4e2a\u5b50\u57df\u91cc\u7528\u975e\u5e38\u7b80\u5355\u7684\u57fa\u51fd\u6570\u5c55\u5f00\\tilde{u}\uff0c\u56e0\u4e3a\u57fa\u51fd\u6570\u7b80\u5355\uff0c\u6240\u4ee5\u79ef\u5206\u4e5f\u7b80\u5355\uff0c\u55ef\uff0c\u770b\u8d77\u6765\u53ef\u884c\u54e6...... </p>"},{"location":"markdown/finite_element_1d/#2-finite-element","title":"2. \u6709\u9650\u5143\u6cd5\uff08Finite Element\uff09","text":"<p>\u597d\u5427\uff0c\u4e0d\u59a8\u5c31\u50cf\u4e0b\u56fe\u8fd9\u6837\u628ax\u8f74\u7684[0,1]\u533a\u95f4\u5206\u6210N\u4e2a\u5b50\u57df\uff0c\u8fd9\u91cc\u6211\u4eec\u53d6N=3\uff0c\u5f53\u7136\u4f60\u53ef\u4ee5\u53d6\u6210\u5343\u4e0a\u4e07\u3002</p>      \u56fe1 \u6709\u9650\u5355\u5143\u7684\u5206\u6bb5\u7ebf\u6027\u57fa\u51fd\u6570\u5c55\u5f00\u793a\u610f\u56fe <p>\u5728\u6bcf\u4e2a\u5b50\u57df\u4e2d\uff0c\u51fd\u6570u\uff08\u7ea2\u8272\uff09\u90fd\u88ab\u903c\u8fd1\u4e3a\u5206\u6bb5\u7ebf\u6027\u51fd\u6570\\tilde{u}\uff08\u84dd\u8272\uff09\u3002\u5b83\u4eec\u53ef\u4ee5\u7528\u7edf\u4e00\u7684\u7ebf\u6027\u57fa\u51fd\u6570\u5c55\u5f00\u5982\u4e0b\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         \\tilde{u}_i(x) = u_i \\frac{x_{i+1} - x} {x_{i+1} - x_i} +  u_{i+1} \\frac{x - x_i} {x_{i+1} - x_i}&amp;\\\\         x \\in \\Omega_i = [x_i, x_{i+1}] \\qquad i = 1, 2, \\cdots, N     \\end{array} \\right.  <p>\u5f88\u660e\u663e\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6c42\u89e3\u5b50\u57df\uff08\u4e5f\u53eb\u5355\u5143\uff0c\u73b0\u5728\u4f60\u660e\u767d\u4e86\u4e3a\u5565\u53eb\u6709\u9650\u5143\u54af\uff09\uff0c\u5b58\u5728\u4e24\u4e2a\u57fa\u51fd\u6570\\frac{x_{i+1} - x} {x_{i+1} - x_i}\u548c\\frac{x - x_i} {x_{i+1} - x_i}\uff08\u89c1\u56fe1\u53f3\u8fb9\uff09\u3002\u7b2ci\u4e2a\u5355\u5143\u7684\u57fa\u51fd\u6570\u5bf9\u5e94\u7684\u7cfb\u6570\u5206\u522b\u4e3au_i\u548cu_{i+1}\u3002  </p> <p>\u6ce8\u610f\uff1a\u57fa\u51fd\u6570\u5b9e\u9645\u4e0a\u662f\u5b9a\u4e49\u5728\u6574\u4e2a\u6c42\u89e3\u57df\\Omega\u4e0a\u7684\uff0c\u5b83\u4eec\u5728\u5355\u5143\u5185\u6709\u503c\uff0c\u800c\u5728\u5355\u5143\u5916\u4e3a0\u3002</p>"},{"location":"markdown/finite_element_1d/#21","title":"2.1 \u5185\u90e8\u5355\u5143\u5206\u6790","text":"<p>\u6211\u4eec\u5148\u5c1d\u8bd5\u8003\u8651\u7b2ci\u4e2a\u5355\u5143\uff0c\u7531\u4e8e\u6bcf\u4e2a\u57fa\u51fd\u6570\u90fd\u53ea\u5728\u5176\u6240\u5728\u5355\u5143\u5185\u53d6\u975e0\u503c\uff0c\u6545Galerkin\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u7b49\u4ef7\u4e8ew_i\u4e0e\u6b8b\u5dee\u5728\u5b50\u57df\\Omega_i\u4e2d\u7684\u5377\u79ef\uff0c\u5373\uff1a  </p>  \\begin{align}   R_i      &amp;= \\int \\nolimits_{\\Omega} w_i (L\\tilde{u}-f) d {\\Omega} \\\\     &amp;= \\int \\nolimits_{\\Omega_i} w_i [ \\frac{\\partial^{2} \\tilde{u}_i(x) }{ \\partial x^{2}} - (x+1)] d {\\Omega_i} \\end{align}   <p>\u5982\u56fe1\u6240\u793a\uff0c\u6240\u6709\u57fa\u51fd\u6570\u90e8\u662f\u7ebf\u6027\u51fd\u6570\uff0c\u5176\u4e8c\u9636\u5bfc\u6570\u4e3a0\u3002\u5373\uff1a  </p>  R_i = - \\int \\nolimits_{\\Omega_i} w_i  (x+1) d {\\Omega_i}     = - \\int \\nolimits_{x_i}^{x_{i+1}} w_i  (x+1) dx  <p>\u4e8b\u60c5\u5927\u6761\u4e86\uff0c\u8fd9\u4e48\u4e00\u641eR_i\u7684\u8868\u8fbe\u5f0f\u91cc\u6ca1\u6709\u7cfb\u6570u_i\uff0c\u6839\u672c\u5f97\u4e0d\u5230\u548c\u7cfb\u6570u_i\u6709\u5173\u7684\u7ebf\u6027\u65b9\u7a0b\u3002\u548b\u529e\uff1f  </p> <p>\u6ce8\u610f\uff1a\u5f31\u89e3\u6761\u4ef6\u7684\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u7684\u8868\u8fbe\u5f0f\u4e2d\u5fc5\u987b\u5305\u542b\u5f85\u89e3\u7684\u57fa\u51fd\u6570\u7cfb\u6570\u3002</p>      \u56fe2 \u6839\u636e\u7cfb\u6570\u6240\u5728\u4f4d\u7f6e\u53bb\u770b\u5f85\u57fa\u51fd\u6570 <p>\u6240\u4ee5\u5fc5\u987b\u6362\u4e2a\u601d\u8def\uff08\u89c1\u56fe2\uff09\u6765\u89e3\u51b3\u95ee\u9898\uff0c\u770b\u770b\u7cfb\u6570u_i\uff0c\u5b83\u5728\u5b50\u57df[x_{i-1}, x_i]\u548c[x_i, x_{i+1}]\u4e2d\u90fd\u88ab\u7528\u5230\u3002\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u65b0\u5b50\u57df[x_{i-1}, x_{i+1}]\uff0c\u5b83\u5185\u90e8\u53ea\u6709\u4e00\u4e2a\u4e09\u89d2\u5f62\u7684\u57fa\u51fd\u6570\u4e0d\u4e3a0\uff08\u89c1\u56fe2\u53f3\u7684\u7eff\u8272\u548c\u9ed1\u8272\u4e09\u89d2\uff09\uff0c\u8003\u8651\u4ee5\u4e0bGalerkin\u79ef\u5206\uff1a  </p>  R_i = \\int \\nolimits_{x_{i-1}}^{x_{i+1}} w_i (\\frac{\\partial^{2} \\tilde{u}(x) }{ \\partial x^{2}} - x - 1) dx   <p>\u65b0\u5b50\u57df[x_{i-1}, x_{i+1}]\u4e0a\u552f\u4e00\u5177\u6709\u975e0\u503c\u7684\u4e09\u89d2\u5f62\u57fa\u51fd\u6570\u7684\u7cbe\u786e\u8868\u8fbe\u5f0f\u5982\u4e0b\uff1a</p>  w_i =  \\left\\{     \\begin{array}{**lr**}         \\frac{x - x_{i-1}} {x_i - x_{i-1}}  \\qquad x \\in [x_{i-1}, x_i]&amp;\\\\         \\frac{x_{i+1} - x} {x_{i+1} - x_i}  \\qquad x \\in [x_i, x_{i+1}] &amp;\\\\         0 \\qquad\\qquad x \\notin [x_{i-1}, x_{i+1}]         \\end{array} \\right.  <p>\u73b0\u5728\u4e8c\u9636\u5bfc\u9879\u80af\u5b9a\u4e0d\u4e3a0\uff0c\u4f46\u5374\u6c42\u4e0d\u51fa\u6765\u3002\u4e0d\u8fc7\u8fd8\u597d\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5206\u90e8\u79ef\u5206\u516c\u5f0f\u628a\u5b83\u964d\u9636\uff0c\u5f97\u5230\uff1a  </p>  R_i = \\left. w_i \\frac{\\partial \\tilde{u}(x) }{ \\partial x} \\right|_{x_{i-1}}^{x_{i+1}}     - \\int \\nolimits_{x_{i-1}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx     - \\int \\nolimits_{x_{i-1}}^{x_{i+1}} w_i (x+1) dx  <p>\u7531\u4e8e\u6d4b\u8bd5\u51fd\u6570w_i\uff08\u662f\u57fa\u51fd\u6570\u672c\u8eab\uff09\u5728x_{i-1}\u548cx_{i+1}\u4e0a\u5747\u4e3a0\uff0c\u6545\u4e0a\u5f0f\u7684\u7b2c\u4e00\u9879\u4e3a0\u3002\u5f15\u5165\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u4e3a0\u7684\u5f31\u89e3\u6761\u4ef6\uff0c\u5f97\u5230\u4ee5\u4e0b\u65b9\u7a0b\uff1a  </p>     \\int \\nolimits_{x_{i-1}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx  + \\int \\nolimits_{x_{i-1}}^{x_{i+1}} w_i (x+1) dx = 0  <p>\u5148\u6c42\u51fa\u7b2c\u4e00\u4e2a\u79ef\u5206\u9879\uff1a  </p>  \\begin{align}   \\int \\nolimits_{x_{i-1}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx      &amp;= \\int \\nolimits_{x_{i-1}}^{x_i} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx       + \\int \\nolimits_{x_i}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx \\\\      &amp;= \\int \\nolimits_{x_{i-1}}^{x_i} \\frac{ u_i - u_{i-1}  } {(x_i - x_{i-1})^2 } dx       - \\int \\nolimits_{x_i}^{x_{i+1}} \\frac{ u_{i+1} - u_i  } {(x_{i+1} - x_i)^2 } dx \\\\      &amp;= \\left. \\frac{ u_i - u_{i-1}  } {(x_i - x_{i-1})^2 } x \\right|_{x_{i-1}}^{x_i}       - \\left. \\frac{ u_{i+1} - u_i  } {(x_{i+1} - x_i)^2 } x \\right|_{x_{i}}^{x_{i+1}} \\\\      &amp;= \\frac{ u_i - u_{i-1}  } {x_i - x_{i-1} } - \\frac{ u_{i+1} - u_i  } {x_{i+1} - x_i } \\end{align}  <p>\u7c7b\u4f3c\u7684\uff0c\u518d\u89e3\u51fa\u7b2c\u4e8c\u4e2a\u79ef\u5206\u9879\uff1a  </p>  \\begin{align}   \\int \\nolimits_{x_{i-1}}^{x_{i+1}} w_i (x+1) dx       &amp;= \\int \\nolimits_{x_{i-1}}^{x_i} \\frac{(x+1)(x-x_{i-1}) }{ x_i - x_{i-1} }  dx       + \\int \\nolimits_{x_i}^{x_{i+1}} \\frac{(x+1)(x_{i+1}-x) }{ x_{i+1} - x_i } dx \\\\      &amp;= \\left. \\frac{ \\frac{x^3}{3} + \\frac{(1-x_{i-1})x^2}{2} - x_{i-1}x } {x_i - x_{i-1}} \\right|_{x_{i-1}}^{x_i}       - \\left. \\frac{ \\frac{x^3}{3} + \\frac{(1-x_{i+1})x^2}{2} - x_{i+1}x } {x_{i+1} - x_i} \\right|_{x_i}^{x_{i+1}}\\\\      &amp;= \\frac{(x_i-x_{i-1})(2x_i + x_{i-1} +3)}{6}       + \\frac{(x_{i+1}-x_i)(2x_i + x_{i+1} +3)}{6} \\\\      &amp;= \\frac{ (x_{i+1}-x_{i-1})(x_{i+1} + x_{i-1} + x_i + 3) } {6} \\end{align}  <p>\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u5173\u4e8eu_i\u7684\u65b9\u7a0b\u4e86\uff0c\u5982\u679c\u628a\u6240\u6709\u8fd9\u4e00\u7cfb\u5217\u65b9\u7a0b\u6392\u5217\u6210\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u5b83\u5bf9\u5e94\u7b2ci\u884c\uff0c\u5176\u8868\u8fbe\u5f0f\u4e3a\uff1a  </p>  a_{i-1} u_{i-1} + a_i u_i + a_{i+1} u_{i+1}= b_i  <p>\u5176\u4e2d\uff0c\u4e09\u4e2a\u975e0\u7cfb\u6570\u53ca\u53f3\u7aef\u9879\u7684\u8868\u8fbe\u5f0f\u5982\u4e0b\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         a_{i-1} = \\frac{-1} {x_i - x_{i-1}} &amp;\\\\         a_i = \\frac{1} {x_i - x_{i-1}} + \\frac{1} {x_{i+1} - x_i} &amp;\\\\         a_{i+1} = \\frac{-1} {x_{i+1} - x_i} &amp;\\\\         b_i = - \\frac{(x_{i+1}-x_{i-1})(x_{i+1} + x_{i-1} + x_i + 3)} {6}        \\end{array} \\right."},{"location":"markdown/finite_element_1d/#22","title":"2.2 \u8fb9\u754c\u6761\u4ef6\u5904\u7406","text":"<p>\u8fd9\u91cc\u7684\u8fb9\u754c\u6761\u4ef6\u5904\u7406\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\u7c97\u66b4\uff0c\u53ea\u9700\u8981\u628a\u7b2c\u4e00\u7c7b\u8fb9\u754c\u6761\u4ef6\uff08\u4e5f\u53ebdirichlet\u8fb9\u754c\u6761\u4ef6\uff09u|_{x=0}=0\uff0cu|_{x=1}=1\u4e58\u4ee5\u7cfb\u6570\u79fb\u5230\u65b9\u7a0b\u53f3\u8fb9\u5373\u53ef\u3002 \u4ee5\u56fe1\u548c\u56fe2\u4e3a\u4f8b\uff0c\u6574\u4e2a\u6c42\u89e3\u57df\u88ab\u5206\u6210\u4e86\u4e09\u4e2a\u5355\u5143\u3002\u5f88\u663e\u7136u_1 = 0\uff0cu_4 = 1\uff0c\u5f85\u89e3\u5411\u91cf\u4e3a[u_2, u_3]^T\u3002\u9996\u5148\u8003\u8651\u5de6\u8fb9\u754c\u6761\u4ef6\uff0c\u65b9\u7a0b\u4e3a\uff1a  </p>  a_2 u_2 + a_3 u_3 = b_1 - a_1 u_1   <p>\u4ee3\u5165\u5404\u7cfb\u6570\uff0c\u5f97\u5230\uff1a</p>  (\\frac{1} {x_2 - x_1} + \\frac{1} {x_3 - x_2}) u_2 + \\frac{-1} {x_3 - x_2} u_3 = - \\frac{(x_3-x_1)(x_3 + x_2 + x_1 + 3)} {6}  <p>\u518d\u8003\u8651\u53f3\u8fb9\u754c\u6709\u5173\u7684\u65b9\u7a0ba_2 u_2 + a_3 u_3 = b_1 - a_4 u_4\uff0c\u5f97\u5230\uff1a  </p>  \\frac{-1} {x_3 - x_2} u_2 + (\\frac{1} {x_3 - x_2} + \\frac{1} {x_4 - x_3}) u_3 =  - \\frac{(x_4-x_2)(x_4 + x_3 + x_2 + 3)} {6} + \\frac{1}{x_4 - x_3}  <p>\u4e0d\u59a8\u8bbe\u6240\u6709\u5355\u5143\u662f\u7b49\u8ddd\u5206\u5272\u7684\uff08x_4-x_3 = x_3-x_2=x_2-x_1=\\frac{1}{3}\uff09\uff0c\u6b64\u65f6\u7ebf\u6027\u65b9\u7a0b\u7ec4\u4e3a\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         6 u_2 - 3 u_3 = - 4/9 &amp;\\\\         -3 u_2 + 6 u_3 = 22/9        \\end{array} \\right.  <p>\u6c42\u89e3\u5f97\u5230u_2=\\frac{14}{81}\uff0c u_3=\\frac{40}{81}\u3002\u5f88\u632f\u594b\u4eba\u5fc3\u7684\u662f\u8fd9\u4e24\u4e2a\u503c\u548cu(x) = {\\frac{1}{6}}  x^3 + {\\frac{1}{2}} x^2 + {\\frac{1}{3}}x\u7684\u9a8c\u7b97\u7ed3\u679c\u5b8c\u5168\u4e00\u81f4\u3002 \u4f46\u4e0d\u8981\u9ad8\u5174\u5f97\u592a\u65e9\uff1a\u9996\u5148\uff0c\u8fd9\u53ea\u662f\u8fd0\u6c14\u597d\uff0c\u5e76\u975e\u6240\u6709\u95ee\u9898\u90fd\u4f1a\u6ee1\u8db3\u8282\u70b9\u4e0a\u5b58\u5728\u7cbe\u786e\u8fd1\u4f3c\uff1b\u5176\u6b21\uff0c\u5373\u4f7f\u6211\u4eec\u8fd0\u6c14\u8fd9\u4e48\u597d\uff0c\u9664\u4e86\u56db\u4e2a\u7cfb\u6570\u6240\u5728\u70b9\uff0c\u5176\u5b83\u70b9\u548c\u7cbe\u786e\u89e3\u76f8\u6bd4\u90fd\u6709\u5f88\u5927\u8bef\u5dee\uff08\u89c1\u56fe3\uff09\u3002\u53ea\u9700\u8981\u7ec6\u770b\u56fe1\u5c31\u77e5\u9053\u8bef\u5dee\u4ea7\u751f\u7684\u539f\u56e0\u3002 \u5f53\u7136\uff0c\u9a74\u5b50\u90fd\u60f3\u5f97\u5230\uff0c\u53ea\u8981\u5256\u5206\u4e86\u8db3\u591f\u591a\u7684\u5355\u5143\uff0c\u6574\u4f53\u903c\u8fd1\u7cbe\u786e\u89e3\u7684\u7cbe\u5ea6\u4f1a\u66f4\u9ad8\u3002\u56fe3\u7ed8\u5236\u4e86\u5256\u5206\u4e3a3\u548c10\u4e2a\u5355\u5143\u7684\u60c5\u51b5\uff0c\u770b\u8d77\u676510\u4e2a\u5355\u5143\u7684\u6548\u679c\u4e0d\u9519\u54e6\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u8fd9\u91cc\u6211\u4eec\u7528\u4e86\u7b49\u8ddd\u5256\u5206\uff0c\u4f46\u662f\u6ca1\u4eba\u8981\u6c42\u4f60\u4e00\u5b9a\u8981\u8fd9\u6837\u641e\uff0c\u975e\u5747\u5300\u5256\u5206\u5176\u5b9e\u66f4\u5360\u4e3b\u6d41\u3002</p>      \u56fe3 \u7cbe\u786e\u89e3\u548c\u6709\u9650\u5143\u6570\u503c\u89e3\u7684\u5bf9\u6bd4"},{"location":"markdown/finite_element_1d/#3","title":"3. \u603b\u7ed3","text":"<p>\u8fd9\u53ea\u662f\u4e00\u4e2a\u5c0f\u5c0f\u7684\u79d1\u666e\u6587\uff0c\u4e3e\u7684\u4f8b\u5b50\u4e5f\u8d85\u7ea7\u7b80\u5355\uff0c\u4f46\u51e1\u4e8b\u603b\u8981\u4ece\u7b80\u5230\u7e41\uff0c\u4e00\u53e3\u5403\u4e0d\u4e86\u4e2a\u80d6\u5b50\u3002 \u73b0\u4ee3\u6709\u9650\u5143\u65b9\u6cd5\u5df2\u53d1\u5c55\u5f97\u975e\u5e38\u6210\u719f\uff0c\u9009\u5b9a\u5355\u5143\u5256\u5206\u548c\u57fa\u51fd\u6570\u540e\uff0c\u5176\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u3001\u77e9\u9635\u7ec4\u88c5\u3001\u7ebf\u6027\u7cfb\u7edf\u7684\u89e3\u6cd5\u7b49\u5de5\u4f5c\u57fa\u672c\u53ef\u4ee5\u6309\u56fe\u7d22\u9aa5\u3002 \u53ef\u80fd\u6709\u4e9b\u4eba\u4f1a\u89c9\u5f97\u6709\u9650\u5143\u7684\u7cbe\u5ea6\u9ad8\u4e8e\u6709\u9650\u5dee\u5206\uff0c\u56e0\u4e3a\u201c\u6709\u9650\u5dee\u5206\u53ea\u80fd\u83b7\u53d6\u91c7\u6837\u70b9\u5904\u7684\u51fd\u6570\u503c\uff08\u5bf9\u5e94u_i\uff09\u201d\u3002\u6211\u4e0d\u77e5\u9053\u662f\u54ea\u4f4d\u795e\u4ed9\u8fd9\u4e48\u6b66\u65ad\uff0c\u4f46\u8bf7\u8003\u8651\u4e00\u4e0b\uff1a\u975e\u91c7\u6837\u70b9\u5904\u7684\u51fd\u6570\u503c\u5728\u6709\u9650\u5dee\u5206\u4e2d\u662f\u7528\u7ebf\u6027\u63d2\u503c\u5f97\u5230\u7684\uff0c\u800c\u5728\u6709\u9650\u5143\u4e2d\u662f\u7528\u57fa\u51fd\u6570\u5c55\u5f00\u5f0f\u76f4\u63a5\u6c42\u53d6\u7684\u3002\u95ee\u9898\u6765\u4e86\uff0c\u4e00\u9636\u6709\u9650\u5dee\u5206\u548c\u4e00\u9636\u6709\u9650\u5355\u5143\u5728\u975e\u91c7\u6837\u70b9\u5904\u7684\u7cbe\u5ea6\u54ea\u4e2a\u9ad8\uff1f\u90fd\u662f\u7ebf\u6027\u7684\uff0c\u4f60\u6709\u9650\u5143\u5f97\u745f\u5565\uff1f \u5b9e\u9645\u4e0a\u540c\u9636\u7684\u6709\u9650\u5355\u5143\u548c\u6709\u9650\u5dee\u5206\u76f8\u6bd4\uff0c\u5176\u4f18\u52bf\u5728\u4e8e\u5bf9\u6c42\u89e3\u533a\u57df\u7684\u5256\u5206\u65b9\u5f0f\u66f4\u7075\u6d3b\uff0c\u800c\u4e0d\u662f\u5176\u6570\u503c\u89e3\u7cbe\u5ea6\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a\u6709\u9650\u5143\u65b9\u6cd5\u4e2d\u6700\u91cd\u8981\u7684\u90e8\u5206\u5728\u4e8e\u57fa\u51fd\u6570\u9009\u53d6\uff0c\u5728Galerkin\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u4e2d\uff0c\u6d4b\u8bd5\u51fd\u6570\uff08\u6216\u6743\u51fd\u6570\uff09\u76f4\u63a5\u9009\u53d6\u4e3a\u57fa\u51fd\u6570\u672c\u8eab\uff0c\u7ee7\u800c\u6784\u5efa\u5f31\u89e3\u6761\u4ef6\u5f97\u5230\u7cfb\u6570\u7684\u7ebf\u6027\u65b9\u7a0b\u7ec4\u3002\u4efb\u4f55\u4e00\u7bc7\u8bb2\u6709\u9650\u5143\u7684\u6587\u732e\u90fd\u968f\u5904\u53ef\u89c1\u201c\u57fa\u51fd\u6570\u201d\u4e09\u4e2a\u5927\u5b57\u3002\u6240\u4ee5\u8bf4\uff0c\u641e\u6709\u9650\u5143\u5c31\u662f\u5728\u641e\u90a3\u4e2a\u5565\u3002\u9274\u4e8e\u641e\u90a3\u4e2a\u5565\u662f\u4e00\u79cd\u76ee\u524d\u8fd8\u6ca1\u6709\u88ab\u4e3b\u6d41\u793e\u4f1a\u8ba4\u53ef\u7684\u884c\u4e3a\uff0c\u56e0\u6b64\u6709\u4e9b\u90a3\u4e2a\u5565\u4f6c\u4eec\u7f9e\u7f9e\u7b54\u7b54\u7684\u4e0d\u8bf4\u57fa\u51fd\u6570\uff0c\u800c\u53d6\u4e86\u4e2a\u540d\u5b57\u53eb\u201c\u5f62\u51fd\u6570\u201d\u3002\u5c0f\u6837\uff0c\u6b32\u76d6\u5f25\u5f70\uff08\u624b\u52a8\u72d7\u5934\uff09\u3002</p>"},{"location":"markdown/finite_element_1d_continues/","title":"\u590d\u6742\u7684\u4e00\u7ef4\u6709\u9650\u5143","text":"<p>\u300a\u7b80\u5355\u7684\u4e00\u7ef4\u6709\u9650\u5143\u300b\u5df2\u7ecf\u4ecb\u7ecd\u4e86\u5982\u4f55\u7528Galerkin\u6709\u9650\u5143\u6cd5\u6c42\u89e3\u4ee5\u4e0b\u4e00\u7ef4\u8fb9\u503c\u95ee\u9898\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         \\frac{\\partial^{2} u }{ \\partial x^{2}} = x + 1 &amp;\\\\         x \\in \\Omega = [0, 1] &amp;\\\\         \\left. u \\right|_{x=0} = 0, \\left. u \\right|_{x=1} = 1    &amp;     \\end{array} \\right.  <p>\u4f46\u4ecd\u6709\u4e9b\u57fa\u7840\u95ee\u9898\u503c\u5f97\u8ba8\u8bba\u3002\u9274\u4e8e\u641e\u6709\u9650\u5143\u5c31\u662f\u5728\u641e(\u548c\u8c10)\u57fa\uff0c\u6240\u4ee5\u4e3a\u4e86\u641e\u51fa\u65b0\u82b1\u6837\uff0c\u641e\u51fa\u65b0\u7279\u8272\uff0c\u5bf9\u57fa\u51fd\u6570\u3001\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u7684\u66f4\u8fdb\u4e00\u6b65\u7406\u89e3\u662f\u975e\u5e38\u5fc5\u8981\u3002  </p>"},{"location":"markdown/finite_element_1d_continues/#1-galerkin","title":"1. Galerkin\u52a0\u6743\u4f59\u91cf\u6cd5\u7684\u4e0d\u6b63\u7ecf\u7406\u89e3","text":"<p>\u903c\u8fd1\u51fd\u6570\\tilde{u}\u7684Galerkin\u5f31\u89e3\u6761\u4ef6\u4e3a\u6b8b\u5deer\u6ee1\u8db3\u4e0b\u5f0f\uff1a  </p>  R_i = \\int \\nolimits_{\\Omega} w_i r d {\\Omega} = \\int \\nolimits_{\\Omega} w_i (L\\tilde{u}-f) d {\\Omega} = 0  <p>\u5b83\u770b\u8d77\u6765\u975e\u5e38\u795e\u79d8\uff0c\u6781\u5ea6\u6666\u6da9\uff0c\u751a\u81f3\u6709\u70b9\u83ab\u540d\u5176\u5999\u3002\u4e3a\u5565\u6b8b\u5dee\u6ee1\u8db3\u8fd9\u4e2a\u4e1c\u897f\u5c31OK\u4e86\uff1f\u6d4b\u8bd5\u51fd\u6570w_i\u53d6\u6210\u5404\u57fa\u51fd\u6570\u662f\u4f55\u9053\u7406\uff1f\u4e3a\u79ef\u5206\u8ba1\u7b97\u65b9\u4fbf\u53d6\u6210w_i=1\u4e0d\u884c\u5417\uff1f \u5176\u5b9e\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528\u67d0\u79cd\u4e0d\u6b63\u7ecf\u7684\u51e0\u4f55\u4e8b\u5b9e\u6765\u89e3\u91ca\uff1a\u5728\u6cdb\u51fd\u5206\u6790\u4e2dw_i\u5373\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u5411\u91cf\uff0c\\int \\nolimits_{\\Omega} w_i r d {\\Omega}\u5b9e\u9645\u4e0a\u5c31\u662f\u5411\u91cfw_i\u548c\u6b8b\u5dee\u5411\u91cfr\u7684\u5185\u79ef\uff0c\u8bb0\u4e3a\\left&lt; w_i, r \\right&gt;_\\Omega\u3002\u5185\u79ef\u548c\u5411\u91cf\u5939\u89d2\u6709\u5173\uff0c\u6ee1\u8db3Galerkin\u5f31\u89e3\u6761\u4ef6\u65f6\uff0c\u8981\u4e48\u5373\u6b8b\u5dee\u4e3a0\uff0c\u8981\u4e48\u5b83\u4e0e\u6bcf\u4e2a\u57fa\u51fd\u6570\u90fd\u4e92\u76f8\u5782\u76f4\u3002 \u6240\u6709\u903c\u8fd1\u51fd\u6570\\tilde{u}\u7ec4\u6210\u7684\u7a7a\u95f4\u53ef\u89c6\u4e3a\u7531\u6240\u6709\u57fa\u51fd\u6570\u5f20\u6210\u7684\u4e00\u4e2a\u5e73\u9762\uff08\u56fe1\u5de6\uff09\u3002Galerkin\u6761\u4ef6\u53d6\u6b8b\u5deer\u5782\u76f4\u6b64\u5e73\u9762\u7684\u60c5\u51b5\uff0c\u7528\u4e0d\u4e25\u8c28\u7684\u51e0\u4f55\u6765\u7406\u89e3\uff1a\u5982\u679c\u4ece\u5e73\u9762\u5916\u4e00\u70b9\u8d70\u5165\u5e73\u9762\uff0c\u6cbf\u5782\u76f4\u65b9\u5411\u8def\u5f84\u6700\u77ed\u3002\u5f53\u7136\uff0c\u82e5r\u521a\u597d\u53d6\u52300\u503c\uff0c\u5219\u5f31\u89e3\u6761\u4ef6\u548c\u5f3a\u89e3\u6761\u4ef6\u4e00\u81f4\u3002  </p>      \u56fe1 Galerkin\u52a0\u6743\u4f59\u91cf\u79ef\u5206\uff0c\u5de6\uff1a\u6b8b\u5dee\u5411\u91cf\u5782\u76f4\u57fa\u51fd\u6570\u5e73\u9762\uff1b\u53f3\uff1a\u4e00\u7ef4\u52a0\u6743\u6b8b\u5dee\u51fd\u6570 <p>\u53e6\u5916\uff0c\u4e00\u7ef4\u4e00\u9636\u6709\u9650\u5143\u7684\u57fa\u51fd\u6570\u5728\u6bcf\u4e2a\u5b50\u57df[x^{i-1}, x^{x+1}]\u5185\u4e3a\u4e09\u89d2\u51fd\u6570\uff08\u56fe1\u53f3\u7684\u7ea2\u7ebf\uff09\u3002\u89c2\u5bdf\u51fd\u6570\u7684\u56fe\u50cf\uff0cGalerkin\u5f31\u89e3\u6761\u4ef6\u6709\u4e24\u5c42\u610f\u601d\uff1a\u4e00\u65b9\u9762\uff0c\u53ea\u8981\u79ef\u5206\u4e3a0\uff0c\u8be5\u5355\u5143\u7684\u903c\u8fd1\u51fd\u6570\u5728\u5168\u5c40\u6c42\u89e3\u57df\u4e0b\u6ee1\u8db3\u5f31\u89e3\u6761\u4ef6\uff1b\u53e6\u4e00\u65b9\u9762\uff0c\u89c6\u79ef\u5206\u4e3a\u65e0\u7a77\u6c42\u548c\uff0c\u5185\u79ef\u4e3a0\u4e5f\u53ef\u4e0d\u4e25\u8c28\u7684\u7406\u89e3\u4e3a\u5b50\u57df\u5185\u6b8b\u5dee\u51fd\u6570\u7684\u52a0\u6743\u5e73\u5747\u503c\uff08\u6743\u503c\u4e3a\u57fa\u51fd\u6570\uff09\u4e3a0\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1aGlerkin\u6cd5\u53ea\u662f\u52a0\u6743\u4f59\u91cf\u6cd5\u7684\u4e00\u79cd\uff0c\u6d4b\u8bd5\u51fd\u6570\uff08\u6743\u51fd\u6570\uff09\u8fd8\u53ef\u4ee5\u6309\u5b50\u57df\u53d6\u4e3a1\uff08\u5b50\u57df\u6cd5\uff09\uff1b\u6216\u5728\u914d\u7f6e\u597d\u7684\u70b9\u4e0a\u53d6\u72c4\u62c9\u514b\u51fd\u6570\\delta\uff08\u914d\u70b9\u6cd5\uff09\uff1b\u6216\u53d6\u4e3a\u6b8b\u5dee\u51fd\u6570\u672c\u8eab\uff08\u6700\u5c0f\u4e8c\u4e58\u6cd5\uff09\uff1b\u8fd8\u53ef\u53d6\u4e3a\u6c42\u89e3\u57df\u7684\u7a7a\u95f4\u57fa\u5411\u91cf\uff08\u77e9\u6cd5\uff09\u7b49\u7b49\u3002</p>"},{"location":"markdown/finite_element_1d_continues/#2","title":"2. \u662f\u5426\u5fc5\u987b\u4f7f\u7528\u5206\u90e8\u79ef\u5206\u6cd5","text":"\u56fe2 \u5206\u6bb5\u903c\u8fd1\u51fd\u6570\u3001\u57fa\u51fd\u6570\u53ca\u5176\u4e00\u9636\u5bfc\u6570 <p>\u7531\u4e8e\u903c\u8fd1\u51fd\u6570\\tilde{u}\u5728\u6bcf\u4e2a\u5355\u5143\u5185\u7684\u4e00\u9636\u5bfc\u5728x_i\u5904\u4e0d\u8fde\u7eed\uff08\u56fe2\uff09\u3002\u6240\u4ee5\u4e3a\u4e86\u89e3\u51b3\u5b50\u57df[x^{i-1}, x^{x+1}]\u4e2d\u7684\u4e8c\u9636\u4e0d\u53ef\u5bfc\u5f15\u8d77\u7684\u95ee\u9898\uff0c\u9700\u4f7f\u7528\u5206\u90e8\u79ef\u5206\u6cd5\u5f97\u5230\uff1a  </p>  R_i = \\left. w_i \\frac{\\partial \\tilde{u}(x) }{ \\partial x} \\right|_{x_{i-1}}^{x_{i+1}}     - \\int \\nolimits_{x_{i-1}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx     - \\int \\nolimits_{x_{i-1}}^{x_{i+1}} w_i (x+1) dx  <p>\u8fd9\u4f1a\u7ed9\u6211\u4eec\u4e00\u4e2a\u9519\u89c9\uff0c\u8ba4\u4e3a\u6784\u5efa\u4e8c\u9636\u5fae\u5206\u65b9\u7a0b\u7684\u7ebf\u6027\u57fa\u51fd\u6570\u5f31\u89e3\u4f9d\u8d56\u5206\u90e8\u79ef\u5206\u65b9\u6cd5\u3002\u4f46\u5982\u679c\u5f15\u5165\u4e00\u4e2a\u7279\u6b8a\u51fd\u6570\uff0c\u6b64\u9519\u89c9\u4fbf\u4e0d\u653b\u81ea\u7834\u3002\u8fd9\u4e2a\u795e\u5947\u7684\u51fd\u6570\u5c31\u662f\u72c4\u62c9\u514b\uff08Dirac\uff09\u51fd\u6570\\delta\uff0c\u5176\u5b9a\u4e49\u4e3a\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         \\delta(x)=0  \\qquad when \\quad x \\neq 0  &amp;\\\\         \\int \\nolimits_{-\\infty}^{-\\infty} \\delta (x) dx = 1     \\end{array} \\right.  <p>\u5728\u7269\u7406\u4e0aDirac\u51fd\u6570\u53ef\u4ee5\u7528\u6765\u8868\u793a\u4f5c\u7528\u5728\u70b9x_0\u4e0a\u7684\u4e00\u4e2a\u5355\u4f4d\u8109\u51b2\uff0c\u8bb0\u4e3a\\delta (x-x_0)\u3002\u5b83\u5728\u5947\u70b9x_0\u5904\u4e3a\\infty\uff0c\u6b64\u5916\u5904\u5904\u4e3a0\u3002Dirac\u51fd\u6570\u8fd8\u6709\u5f88\u591a\u6709\u8da3\u7684\u6027\u8d28\uff0c\u6bd4\u5982\uff1a 1. \u53d6\\forall\u5b50\u57dfD\uff0c\u4e14x_0 \\in D\uff0c\\int \\nolimits_{D} \\delta (x-x_0) dx = 1\u3002 2. \u53d6\\forall\u5b50\u57dfD\uff0c\u4e14x_0 \\in D\uff0c\u5bf9\u4e8e\\forall f(x)\uff0c\\int \\nolimits_{D} f(x) \\delta (x-x_0) dx = f(x_0)\u3002 3. \u82e5\u51fd\u6570f(x)\u5728\u70b9x_0\u5904\u4e0d\u8fde\u7eed\uff0c\u4e14\u5f53x&lt;x_0\u65f6f(x)=a\uff0cx&gt;x_0\u65f6f(x)=b\uff0c\u5219\u8be5\u51fd\u6570\u7684\u4e00\u9636\u5bfc\u6570\u4e3af'(x)=(b - a) \\delta (x-x_0)\u3002 \u7b2c3\u6761\u6027\u8d28\u8ba9\u4eba\u76f8\u5f53\u90c1\u95f7\uff0c\u660e\u660e\u5728x_0\u70b9\u4e0a\u662f\u6ca1\u6709\u5bfc\u6570\u7684\uff0c\u54ea\u91cc\u53c8\u5192\u51fa\u6765\u8fd9\u4e48\u4e2a\u5f0f\u5b50\u3002\u4e0d\u8fc7\u5462\uff0c\u53ea\u8981\u4e00\u60f3Dirac\u51fd\u6570\u662f\u7269\u7406\u5b66\u5bb6\u641e\u51fa\u6765\u7684\u6211\u9a6c\u4e0a\u5c31\u91ca\u6000\u4e86\uff0c\u53c8\u662f\u7269\u7406\u5b66\u5bb6\uff0c\u8fd8\u8981\u641e(\u548c\u8c10)\u57fa\uff0c\u8fd8\u6709\u4ec0\u4e48\u641e\u4e0d\u51fa\u6765\u7684\u5462\uff1f \u8003\u8651\u9636\u68af\u51fd\u6570\uff1a  </p>  \\theta(x)= \\left\\{     \\begin{array}{**lr**}         0 \\qquad x&lt;0  &amp;\\\\         1 \\qquad x&gt;0     \\end{array} \\right.  <p>\u5df2\u7ecf\u8bc1\u660e\\theta ' (x) = \\delta(x)\uff0c\u5c06\\theta(x)\u8fdb\u884c\u5e73\u79fb\u3001\u62c9\u4f38\uff0c\u53ef\u5b9a\u4e49f(x)= (b-a)\\theta(x-x_0) + a\uff0c\u6545f'(x)=(b-a)\\delta(x-x_0)\u3002\u8fd9\u771f\u662f\u4e00\u4e2a\u6bc1\u4e09\u89c2\u7684\u7ed3\u8bba\uff0c\u4e0d\u8fc7\u6709\u5174\u8da3\u53ef\u4ee5\u5728google\u4e0a\u641c\u7d22\u4e00\u4e0b\uff0c\u9636\u68af\u51fd\u6570\u7684\u5bfc\u6570\u4e3aDirac\u51fd\u6570\u7684\u8bc1\u660e\u8fc7\u7a0b\u4e5f\u662f\u4e00\u901a\u9a9a\u64cd\u4f5c\u3002   </p> <p>\u73b0\u5728\u53ef\u4ee5\u6c42\u4e8c\u9636\u5bfc\u4e86\uff0c\u89c2\u5bdf\u56fe2\uff0c\u76f4\u63a5\u5229\u7528Dirac\u51fd\u6570\u7684\u7b2c3\u6761\u6027\u8d28\u5f97\u5230\uff1a </p>  \\frac{\\partial^{2} \\tilde{u}(x)}{\\partial x^{2}} = \\sum_{i=1}^N \\frac{\\partial \\tilde{u}_i'(x)}{\\partial x} = \\sum_{i=1}^N (b_i - a_{i}) \\delta (x - x_i)  <p>\u5176\u4e2d\uff0c\u4e0b\u6807i\u8868\u793a\u5355\u5143\u7f16\u53f7\uff0cb_i=\\frac{u_{i+1} - u_i}{x_{i+1}-x_{i}}\uff0c a_i=\\frac{u_{i} - u_{i-1}}{x_{i}-x_{i-1}}\u3002\u76f4\u63a5\u5bf9\u6b64\u8868\u8fbe\u5f0f\u5e94\u7528Galerkin\u79ef\u5206\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u57fa\u51fd\u6570w_i\uff0c\u6709\uff1a  </p>  \\int \\nolimits_0^1 [\\sum_{j=1}^N (b_j - a_{j}) \\delta (x - x_j)] w_i(x) dx - \\int \\nolimits_0^1 w_i(x)(x+1) dx = 0   <p>\u6ce8\u610f\uff0c\u4e0a\u5f0f\u62ec\u53f7\u5185\u7684\u4e0b\u6807j\u548cw_i\u7684\u4e0b\u6807i\u7684\u610f\u4e49\u4e0d\u540c\uff0c\u524d\u8005\u8868\u793a\u4e8c\u9636\u5bfc\u5168\u5c40\u5c55\u5f00\u7684\u57fa\u51fd\u6570\u7f16\u53f7\uff0c\u540e\u8005\u662f\u5f53\u524dGalerkin\u79ef\u5206\u7684\u6d4b\u8bd5\u51fd\u6570\u7f16\u53f7\u3002\u6839\u636eDiract\u51fd\u6570\u7684\u7b2c2\u6761\u6027\u8d28\u628a\u7b2c\u4e00\u4e2a\u79ef\u5206\u6d88\u9664\uff0c\u5f97\u5230\uff1a  </p>  \\sum_{j=1}^N (b_j - a_{j})  w_i(x_j) - \\int \\nolimits_0^1 w_i(x)(x+1) dx = 0   <p>\u89c2\u5bdf\u56fe2\u53ef\u4ee5\u5f97\u51fa\uff1a\u5f53i \\neq j\u65f6\uff0cw_i(x_j)=0,\u5f53i=j\u65f6\uff0cw_i(x_j)=1,\u4e0a\u5f0f\u8fdb\u4e00\u6b65\u7b80\u5316\u4e3a\uff1a  </p>   (b_i - a_{i}) - \\int \\nolimits_0^1 w_i(x)(x+1) dx = 0   <p>\u628ab_i\u548ca_i\u7684\u8868\u8fbe\u5f0f\u4ee3\u5165\u5373\u53ef\u7b97\u51fa\u4e0e\u5206\u90e8\u79ef\u5206\u6cd5\u5b8c\u5168\u4e00\u81f4\u7684\u65b9\u7a0b:  </p>   \\frac{u_{i+1}-u_i}{x_{i+1}-x_{i}} - \\frac{u_{i}-u_{i-1}}{x_{i}-x_{i-1}} - \\int \\nolimits_0^1 w_i(x)(x+1) dx = 0   <p>\u5c0f\u8d34\u58eb\uff1a \u73b0\u5728\u6211\u4eec\u77e5\u9053\uff0c\u7ebf\u6027\u57fa\u51fd\u6570\u6c42\u4e8c\u9636\u5bfc\u95ee\u9898\u65f6\uff0c\u5206\u90e8\u79ef\u5206\u6cd5\u5e76\u4e0d\u662f\u6784\u5efa\u5f31\u89e3\u7684\u5173\u952e\u3002\u5f31\u89e3\u6210\u7acb\u7684\u57fa\u672c\u56e0\u7d20\u662fGalerkin\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u672c\u8eab\u3002Dirac\u51fd\u6570\u5e76\u4e0d\u6ee1\u8db3\u5fae\u79ef\u5206\u7684\u4f20\u7edf\u5b9a\u4e49\uff0c\u7ecf\u5e38\u6709\u4e00\u4e9b\u53cd\u76f4\u89c9\u7684\u8be1\u5f02\u884c\u4e3a\uff0c\u6240\u4ee5\u5b9e\u9645\u5de5\u7a0b\u5e94\u7528\u4e2d\u8001\u8001\u5b9e\u5b9e\u7684\u5206\u90e8\u79ef\u5206\u4e3a\u5999\uff0c\u52ff\u4e3a\u8a00\u4e4b\u4e0d\u9884\u4e5f\u3002</p>"},{"location":"markdown/finite_element_1d_continues/#3","title":"3. \u6709\u9650\u5143\u77e9\u9635\u88c5\u914d","text":"<p>\u5b9e\u9645\u5de5\u7a0b\u5e94\u7528\u4e2d\uff0cGalerkin\u79ef\u5206\u901a\u5e38\u53ef\u4ee5\u5199\u4e3a\u7ebf\u6027\u7b97\u5b50\uff0c\u7ec4\u6210\u521a\u5ea6\u77e9\u9635\uff08stiffness matrix\uff09\uff08\u7b80\u79f0\u201c\u7ec4\u521a\u201d\uff09\u548c\u53f3\u7aef\u9879\u3002\u8003\u8651\u4e4b\u524d\u5206\u90e8\u79ef\u5206\u5f97\u5230\u7684Galerkin\u5f31\u89e3\u6761\u4ef6\uff1a  </p>    \\int \\nolimits_{x_{i-1}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx  - \\int \\nolimits_{x_{i-1}}^{x_{i+1}} w_i (x+1) dx = 0  <p>\u521a\u5ea6\u77e9\u9635\\boldsymbol{K}\u6ee1\u8db3\uff1a  </p>  \\boldsymbol{K} \\boldsymbol{u} = \\boldsymbol{b}  <p>\u5176\u4e2d\uff0c\\boldsymbol{u}=[u_2, u_3, \\cdots, u_{N}]\uff0c\uff08\u8fb9\u754c\u4e0au_1\u548cu_{N+1}\u6ee1\u8db3dirichlet\u8fb9\u754c\u6761\u4ef6\uff0c\u5df2\u77e5\uff09\uff1b\u53f3\u7aef\u9879\\boldsymbol{b}\u548c\u7b2c\u4e8c\u9879\u79ef\u5206\u53ca\u8fb9\u754c\u6761\u4ef6\u6709\u5173\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a \u6709\u4e9b\u529b\u5b66\u95ee\u9898\u4e2d\uff0c\u53f3\u7aef\u9879\u4e5f\u53ef\u4ee5\u5199\u4e3a\\boldsymbol{b} = \\boldsymbol{c} + \\boldsymbol{M}\\boldsymbol{s}\u7684\u5f62\u5f0f\uff0c\u5176\u4e2d\\boldsymbol{c}\u4e3a\u53ea\u4e0e\u8fb9\u754c\u6761\u4ef6\u6709\u5173\u7684\u7a00\u758f\u5411\u91cf\uff0c\\boldsymbol{s}\u4e3a\u539f\u5fae\u5206\u7cfb\u7edfLu=s\u7684\u201c\u6e90\u9879\u201d\u3002\u6b64\u65f6\\boldsymbol{M}\u4e5f\u88ab\u79f0\u4e3a\u8d28\u91cf\u77e9\u9635\uff08mass matrix\uff09\u3002</p>"},{"location":"markdown/finite_element_1d_continues/#31","title":"3.1 \u7b49\u53c2\u5355\u5143","text":"<p>\u4e4b\u524d\u6784\u5efa\u79ef\u5206\u7684\u7ebf\u6027\u7b97\u5b50\u65f6\u6709\u4e00\u5806{x_i}\u9700\u8981\u8003\u8651\uff0c\u6781\u6613\u5199\u9519\u4e0b\u6807\u3002\u6240\u4ee5\u6211\u4eec\u628a\u7f51\u683c\u5355\u5143\u6295\u5f71\u5230\u540c\u4e00\u6807\u51c6\u5355\u5143\uff08\u56fe3\uff09\u4e0a\u5904\u7406\u3002  </p>      \u56fe3 \u7b49\u53c2\u5355\u5143\u53ca\u57fa\u51fd\u6570 <p>\u5728\u7b2ci\u4e2a\u5355\u5143\u5185\uff0c\u57fa\u51fd\u6570\u5c55\u5f00\u4e3a\\tilde{u}=\\sum_{i=1}^n w_i(x) u_i\uff0c\u6295\u5f71\u540e\u65b0\u63d2\u503c\u57fa\u51fd\u6570\u4e3a\\tilde{u}=\\sum_{i=1}^m N_i(\\xi) u_i\uff0c\u8fd9\u91ccn=m=2\uff0cu_1\u548cu_2\u5206\u522b\u8868\u793a\u5355\u5143\u4e24\u7aef\u7684\u7cfb\u6570\u3002 \u6bcf\u4e2a\u65b0\u5355\u5143\u7684\u5f85\u89e3\u7cfb\u6570\u4e2a\u6570\u548c\u539f\u5355\u5143\u76f8\u540c\uff0c\u53eb\u4f5c\u201c\u7b49\u53c2\u5143\u201d\uff0c\u5982\u679cn&lt;m\u53eb\u201c\u8d85\u53c2\u5143\u201d\uff0c\u53cd\u4e4b\u5219\u53eb\u201c\u4e9a\u53c2\u5143\u201d\u3002 \u4f7f\u7528\u7b49\u53c2\u5143\u7684\u539f\u56e0\u662f\u9ad8\u7ef4\u3001\u9ad8\u9636\u63d2\u503c\u57fa\u51fd\u6570\u65f6\u76f4\u63a5\u79ef\u5206\u6781\u6613\u51fa\u9519\uff0c\u4f7f\u7528\u6807\u51c6\u7b49\u53c2\u5143\u540e\u5904\u7406\u8d77\u6765\u65b9\u4fbf\u4e00\u4e9b\uff0c\u4f46\u4e00\u7ef4\u4e00\u9636\u95ee\u9898\u7684\u7b49\u53c2\u5143\u5e76\u6ca1\u6709\u592a\u5927\u4f18\u52bf\u3002\u9488\u5bf9\u6211\u4eec\u7684\u95ee\u9898\uff0c\u7b49\u53c2\u5143\u6709\u4ee5\u4e0b\u6027\u8d28\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         \\tilde{u}^{(i)}(\\xi) = N_1^{(i)} (\\xi) u_i + N_2^{(i)} (\\xi) u_{i+1}   &amp;\\\\         x^{(i)}(\\xi) = N_1^{(i)} (\\xi) x_i + N_2^{(i)} (\\xi) x_{i+1}  &amp;\\\\         N_1^{(i)} (\\xi) = (1- \\xi) / 2 \\qquad N_2^{(i)} (\\xi) = (1+\\xi) / 2&amp;\\\\                dx^{(i)}  = \\frac{x_{i+1} - x_i}{2} d{\\xi}     \\end{array} \\right.  <p>\u4e0a\u5f0f\u7684\u4e0a\u6807(i)\u8868\u793a\u5728\u7b2ci\u4e2a\u5355\u5143\u5185\u3002\u4e0d\u59a8\u8bbeh_i=x_{i+1} - x_i\uff0c\u8003\u8651Glerkin\u79ef\u5206\u7684\u7b2c\u4e00\u9879\uff1a  </p>  \\int \\nolimits_{x_{i-1}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}(x) }{ \\partial x} dx =  \\int \\nolimits_{x_{i-1}}^{x_{i}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i-1)} }{ \\partial x} dx + \\int \\nolimits_{x_{i}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i)} }{ \\partial x} dx  <p>\u6211\u4eec\u53ef\u4ee5\u9996\u5148\u9ebb\u70e6\u7684\u76f4\u63a5\u8ba1\u7b97\u7b49\u5f0f\u53f3\u8fb9\u7684\u7b2c\u4e8c\u4e2a\u79ef\u5206\uff0c\u770b\u770b\u53ef\u4ee5\u5f97\u5230\u4ec0\u4e48\uff1a  </p>  \\begin{align} \\int \\nolimits_{x_{i}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i)} }{ \\partial x} dx     &amp;= \\int \\nolimits_{-1}^{1} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i)} }{ \\partial x} \\frac{\\partial x^{(i)} }{ \\partial {\\xi}} d{\\xi} \\\\    &amp;= \\frac{h_i}{2} \\int \\nolimits_{-1}^{1} \\frac{\\partial w_i }{ \\partial \\xi} \\frac{\\partial \\xi }{ \\partial x} \\frac{ \\partial \\tilde{u}^{(i)} }{ \\partial \\xi} \\frac{\\partial \\xi }{ \\partial x}  d{\\xi} \\\\     &amp;= \\frac{2}{h_i} \\int \\nolimits_{-1}^{1} \\frac{\\partial w_i }{ \\partial \\xi} \\frac{ u_{i+1} - u_{i} } {2} d{\\xi} \\\\    &amp;= \\frac{u_{i+1} - u_{i}}{h_i} \\int \\nolimits_{-1}^{1} - \\frac{1}{h_i} \\frac{\\partial x}{\\partial \\xi} d{\\xi} \\\\    &amp;= \\frac{u_{i+1} - u_{i}}{h_i}  \\int \\nolimits_{-1}^{1} -\\frac{1}{2} d{\\xi} \\\\    &amp;= \\frac{u_{i} - u_{i+1}}{h_i} \\end{align}  <p>\u55ef\uff0c\u6b64\u65f6\u6211\u4e0d\u7981\u6df1\u6df1\u7684\u76b1\u8d77\u4e86\u7709\u5934\uff0c\u7ed5\u8fd9\u4e48\u591a\u5f2f\u5b50\u5e72\u5417\uff1f\u76f4\u63a5\u5728x\u4e0a\u79ef\u5206\u4e0d\u662f\u66f4\u5feb\u6377\u5417\uff1f \u4f46\u662f\u89c2\u5bdf\u56fe3\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4e8b\u5b9e\uff0cN_1\u57fa\u51fd\u6570\uff08\u56fe3\u7eff\u7ebf\uff09\u7684\u4e00\u9636\u5bfc\u6ee1\u8db3\u4ee5\u4e0b\u5173\u7cfb\uff1a  </p>  \\frac{\\partial w_i^{(i)} }{ \\partial \\xi} = \\frac{\\partial N_1^{(i)} }{ \\partial \\xi} = - \\frac{1}{2}  <p>\u539f\u79ef\u5206\u9879\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5199\u4e3a\uff1a  </p>  \\int \\nolimits_{x_{i}}^{x_{i+1}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i)} }{ \\partial x} dx  = \\frac{\\partial \\xi^{(i)}}{\\partial x} \\int \\nolimits_{-1}^{1} \\frac{\\partial N_1^{(i)} }{ \\partial \\xi}  \\frac{\\partial \\tilde{u}^{(i)} }{ \\partial \\xi}  d{\\xi}   <p>\u5c0f\u8d34\u58eb\uff1a \u5728\u9ad8\u7ef4\u6216\u9ad8\u9636\u63d2\u503c\u57fa\u51fd\u6570\u4e2d\uff0cx\u5bf9\\xi\u7684\u504f\u5bfc\u6570\u4f1a\u53d8\u6210\u548c\u96c5\u53ef\u6bd4\u884c\u5217\u5f0f\u6709\u5173\u7684\u95ee\u9898\uff0c\u79ef\u5206\u53f7\u5185\u90e8\u7684\u51fd\u6570\u4f1a\u66f4\u7b80\u5355\u901a\u7528\uff0c\u9002\u5408\u7ec4\u521a\u3002</p> <p>\u540c\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u7684\u5199\u51fa\uff1a  </p>  \\begin{align}   \\int \\nolimits_{x_{i-1}}^{x_{i}} \\frac{\\partial w_i }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i-1)} }{ \\partial x} dx       &amp;= \\frac{\\partial \\xi^{(i-1)}}{\\partial x} \\int \\nolimits_{-1}^{1} \\frac{\\partial N_2^{(i-1)} }{ \\partial \\xi}  \\frac{\\partial \\tilde{u}^{(i-1)} }{ \\partial \\xi}  d{\\xi}  \\\\      &amp;= \\frac{2}{h_{i-1}} \\int \\nolimits_{-1}^{1} \\frac{1}{2} \\frac{u_i - u_{i-1}}{2} d{\\xi} \\\\      &amp;= \\frac{u_i - u_{i-1}}{h_{i-1}}  \\end{align}"},{"location":"markdown/finite_element_1d_continues/#32","title":"3.2 \u5355\u5143\u521a\u5ea6\u77e9\u9635\u548c\u6574\u4f53\u7ec4\u521a","text":"<p>\u6211\u4eec\u4e0d\u8c61\u4e4b\u524d\u90a3\u6837\u8003\u8651\u4e24\u4e2a\u5355\u5143\u7684\u4e09\u89d2\u5f62\u57fa\u51fd\u6570\u95ee\u9898\uff0c\u800c\u662f\u5148\u5bf9\u56fe3\u4e2d\u7b2ci\u4e2a\u5355\u5143\u7684\u4e24\u4e2a\u57fa\u51fd\u6570\u5206\u522b\u89e3\u51fa\u5176Galerkin\u79ef\u5206\u3002\u6839\u636e\u4e0a\u4e00\u8282\u7684\u63a8\u5bfc\uff0c\u53ef\u4ee5\u76f4\u63a5\u5199\u51fa\u4ee5\u4e0b\u516c\u5f0f\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         g_{-}^{(i)}=\\int \\nolimits_{x_{i}}^{x_{i+1}} \\frac{\\partial w_1^{(i)} }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i)} }{ \\partial x} dx          = (u_{i} - u_{i+1}) / h_i   &amp;\\\\         g_{+}^{(i)}=\\int \\nolimits_{x_{i}}^{x_{i+1}} \\frac{\\partial w_2^{(i)} }{ \\partial x}  \\frac{\\partial \\tilde{u}^{(i)} }{ \\partial x} dx          = (-u_{i} + u_{i+1}) / h_i        \\end{array} \\right.  <p>\u5176\u4e2d\uff0cw_1^{(i)}\u5bf9\u5e94\u7b49\u53c2\u5143\u4e2d\u7684\u57fa\u51fd\u6570N_1\uff0cw_2^{(i)}\u5bf9\u5e94N_2\u3002\u5f88\u81ea\u7136\u7684\uff0c\u4e0a\u9762\u7684\u516c\u5f0f\u53ef\u7528\u4ee5\u4e0b\u7ebf\u6027\u7cfb\u7edf\u8868\u793a\uff1a  </p>  \\boldsymbol g^{(i)}   = \\begin{bmatrix}       g_{-}^{(i)} \\\\      g_{+}^{(i)}     \\end{bmatrix}    = \\boldsymbol K^{(i)} \\boldsymbol u^{(i)}   = \\frac{1}{h_i} \\begin{bmatrix} 1 &amp; -1 \\\\ -1 &amp; 1 \\end{bmatrix} \\begin{bmatrix} u_i \\\\ u_{i+1} \\end{bmatrix}   <p>\u5f53\u7136\u4ee5\u4e0b\u5173\u7cfb\u5fc5\u7136\u662f\u98a0\u6251\u4e0d\u7834\u7684\u771f\u7406\u4e4b\u4e00\uff1a  </p>  \\begin{bmatrix}       K_{11}^{(2)} &amp; K_{12}^{(2)} &amp; 0 &amp; 0 \\\\      K_{21}^{(2)} &amp; K_{22}^{(2)} &amp; 0 &amp; 0 \\\\       0 &amp; 0 &amp; 0 &amp; 0 \\\\      \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\  \\end{bmatrix}  \\begin{bmatrix}     \\vphantom{K_{11}^{(2)}} u_2 \\\\    \\vphantom{0} u_3   \\\\    \\vphantom{0} \\dots \\\\    \\vphantom{\\vdots} u_{N}  \\end{bmatrix} = \\begin{bmatrix}     \\vphantom{K_{11}^{(2)}} g_{-}^{(i)} \\\\    \\vphantom{0} g_{+}^{(i)}   \\\\    \\vphantom{0} 0 \\\\    \\vphantom{\\vdots} \\vdots \\end{bmatrix}  <p>\u66f4\u8fdb\u4e00\u6b65\uff0c\u628a\u7b2c2\u4e2a\u5355\u5143\u548c\u7b2c1\u4e2a\u5355\u5143\u7684\u7ebf\u6027\u7cfb\u7edf\u76f8\u52a0\uff0c\u771f\u7406\u52a0\u771f\u7406\u80af\u5b9a\u53c8\u662f\u4e00\u4e2a\u771f\u7406\uff1a  </p>  \\left( \\begin{bmatrix}       K_{11}^{(2)} &amp; K_{12}^{(2)} &amp; 0 &amp; 0 \\\\      K_{21}^{(2)} &amp; K_{22}^{(2)} &amp; 0 &amp; 0 \\\\       0 &amp; 0 &amp; 0 &amp; 0 \\\\      \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\  \\end{bmatrix}  + \\begin{bmatrix}       0 &amp; 0 &amp; 0 &amp; 0 \\\\      0 &amp; K_{11}^{(3)} &amp; K_{12}^{(3)} &amp; 0 \\\\       0 &amp; K_{21}^{(3)} &amp; K_{22}^{(3)} &amp; 0 \\\\      \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\  \\end{bmatrix}  \\right) \\begin{bmatrix}     \\vphantom{K_{11}^{(2)}} u_2 \\\\    \\vphantom{0} u_3   \\\\    \\vphantom{0} \\dots \\\\    \\vphantom{\\vdots} u_{N}  \\end{bmatrix} = \\begin{bmatrix}     \\vphantom{K_{11}^{(2)}} g_{-}^{(2)} \\\\    \\vphantom{0} g_{-}^{(2)} + g_{+}^{(3)}   \\\\    \\vphantom{0} 0 \\\\    \\vphantom{\\vdots} \\vdots \\end{bmatrix}  <p>\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5f88\u81ea\u7136\u7684\uff0c\u521a\u5ea6\u77e9\u9635\\boldsymbol K\u7684\u8868\u8fbe\u5f0f\u5c31\u662f\u628a\u4e0a\u9762\u7684\u8fc7\u7a0b\u8fed\u4ee3\u4e00\u4e0b\uff0c\u5f97\u5230\uff1a  </p>  \\begin{bmatrix}       K_{11}^{(2)} &amp; K_{12}^{(2)} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\\\      K_{21}^{(2)} &amp; K_{22}^{(2)} +K_{11}^{(3)} &amp; K_{12}^{(3)} &amp; 0 &amp; 0 &amp; 0\\\\                  0 &amp; K_{21}^{(3)} &amp; K_{22}^{(3)} + K_{11}^{(4)} &amp; K_{12}^{(4)} &amp; 0 &amp; 0\\\\       \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\       0 &amp; 0 &amp; 0  &amp; K_{21}^{(N-2)} &amp; K_{22}^{(N-2)} + K_{11}^{(N-1)} &amp; &amp; K_{12}^{(N-1)}\\\\       0 &amp; 0 &amp; 0  &amp; 0 &amp; K_{21}^{(N-1)} &amp; &amp; K_{22}^{(N-1)} + K_{11}^{(N)}\\\\  \\end{bmatrix}   <p>\u5982\u6b64\uff0c\\boldsymbol K \\boldsymbol u = [g_{-}^{(2)}, g_{+}^{(2)} + g_{-}^{(3)}, g_{+}^{(3)} + g_{-}^{(4)}, \\cdots, g_{+}^{N}]^{T} \u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a \u5728\u4e4b\u524d\u7684\u7b80\u5355\u6709\u9650\u5143\u4e2d\u6211\u4eec\u6bcf\u6b21\u5206\u6790\u77e9\u9635\u7684\u4e00\u884c\uff0c\u8fd9\u5bf9\u4e8e\u4e00\u7ef4\u4e00\u9636\u6709\u9650\u5143\u53cd\u800c\u66f4\u7b80\u5355\u660e\u6670\u3002\u4f46\u662f\u5982\u679c\u662f\u9ad8\u7ef4\u3001\u9ad8\u9636\u95ee\u9898\uff0c\u521a\u5ea6\u77e9\u9635\u7684\u7a00\u758f\u6a21\u5f0f\uff08sparse parttern\uff09\u4f1a\u53d8\u5f97\u5f88\u590d\u6742\uff0c\u6b64\u65f6\u6807\u51c6\u5316\u5904\u7406\u65b9\u5f0f\u4f1a\u7b80\u5355\u8bb8\u591a\u3002</p>"},{"location":"markdown/finite_element_1d_continues/#33","title":"3.3 \u53f3\u7aef\u9879","text":"<p>\u548c\u7ec4\u521a\u4e00\u6837\uff0c\u9996\u5148\u5199\u51fa\u5355\u5143i\u4e0a\u7684\u79ef\u5206\\int \\nolimits_{x_{i-1}}^{x_{i+1}} w_i (x+1) dx = s_{+}^{(i-1)} + s_{-}^{(i)}\uff0c\u4e4b\u524d\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86\u7b2ci\u4e2a\u5355\u5143\u5185\u5b83\u4eec\u6ee1\u8db3\u7684\u8868\u8fbe\u5f0f\uff1a  </p>  \\left\\{     \\begin{array}{**lr**}         s_{-}^{(i)}=\\frac{h_i}{6} (2x_i + x_{i+1} + 3)   &amp;\\\\         s_{+}^{(i)}=\\frac{h_i}{6} (x_i + 2x_{i+1} + 3)     \\end{array} \\right.  <p>\u4e0e\u201c\u6e90\u201d\u76f8\u5173\u7684\u5411\u91cf\u5f0f\u8868\u8fbe\u4e3a\\boldsymbol{s} = [s_{+}^{(1)} + s_{-}^{(2)}, s_{+}^{(2)} + s_{-}^{(3)}, \\cdots, s_{+}^{(N-1)} + s_{-}^{(N)}]^{T}\u3002 \u4e0e\u8fb9\u754c\u6761\u4ef6\u6709\u5173\u7684\u5411\u91cf\u8868\u8fbe\u5f0f\u4e3a\\boldsymbol{c} = [- K_{22}^{(1)}u_1, 0,  \\cdots,0, - K_{12}^{(N)}u_{N+1}]^{T}\u3002 \u53f3\u7aef\u9879\u5411\u91cf\u53ef\u8868\u793a\u4e3a\\boldsymbol{b} = \\boldsymbol{s} + \\boldsymbol{c}\u3002  </p>"},{"location":"markdown/finite_element_1d_continues/#4","title":"4. \u603b\u7ed3","text":"<p>\u548c\u7b80\u5316\u7248\u6709\u9650\u5143\u4e0d\u540c\u7684\u662f\uff0c\u8fd9\u7bc7\u6587\u7ae0\u91cd\u65b0\u8ba8\u8bba\u4e86Galerkin\u6709\u9650\u5355\u5143\u6cd5\u91cc\u7684\u51e0\u4e2a\u7ec6\u8282\u95ee\u9898\u3002 Galerkin\u52a0\u6743\u4f59\u91cf\u79ef\u5206\u53ef\u4ee5\u4ece\u51e0\u4f55\u6216\u52a0\u6743\u5e73\u5747\u4e24\u4e2a\u89c6\u89d2\u53bb\u7406\u89e3\uff0c\u5f31\u89e3\u5f62\u5f0f\u7684\u610f\u4e49\u5f88\u660e\u786e\u3002 \u6211\u4eec\u6362\u4e86\u4e00\u4e2a\u59ff\u52bf\uff0c\u5f15\u5165Dirac\u51fd\u6570\u4ee3\u66ff\u5206\u90e8\u79ef\u5206\u964d\u9636\uff0c\u5e76\u4e14\u91c7\u7528\u4e86\u66f4\u6807\u51c6\u7684\u201c\u5355\u5143\u5206\u6790\u201d\u4ece\u5c40\u90e8\u5230\u6574\u4f53\u6784\u5efa\u7ebf\u6027\u7cfb\u7edf\uff0c\u8fd9\u662f\u94a6\u5b9a\u7684\u6b63\u786e\u641e(\u548c\u8c10)\u57fa\u65b9\u5f0f\u3002 \u6211\u4eec\u5f15\u5165\u4e86\u7b49\u53c2\u5143\uff0c\u901a\u8fc7\u79ef\u5206\u6362\u5143\u5199\u51fa\u5c40\u90e8\u5355\u5143\u5c0f\u521a\u5ea6\u77e9\u9635\uff0c\u7136\u540e\u6574\u4f53\u7ec4\u521a\u3002 \u518d\u6b21\u58f0\u660e\uff0c\u5e76\u975e\u6240\u6709\u95ee\u9898\u90fd\u8981\u6807\u51c6\u641e(\u548c\u8c10)\u57fa\u3002\u90fd2020\u5e74\u4e86\uff0c\u5f88\u591a\u95ee\u9898\u4e0e\u5176\u4f7f\u7528\u7b49\u53c2\u5143\u7684\u5947\u6280\u6deb\u5de7\uff0c\u8fd8\u4e0d\u5982\u76f4\u63a5\u7528mathematica\u8f6f\u4ef6\u66b4\u529b\u79ef\u5206\u3002 \u6211\u4eec\u5c1a\u6ca1\u6709\u4ecb\u7ecd\u9ad8\u9636\u6709\u9650\u5143\uff0c\u4f46\u5176\u539f\u7406\u548c\u6b65\u9aa4\u57fa\u672c\u7c7b\u4f3c\uff1a1\uff09\u9009\u57fa\uff1b2\uff09\u5c55\u57fa\uff1b3\uff09\u79ef\u57fa\uff1b4\uff09\u79ef\u57fa\u7ebf\u6027\u5316\uff1b5\uff09\u89e3\u57fa\u7cfb\u6570\u3002\u8bf4\u4e86\u534a\u5929\uff0c\u6b65\u6b65\u641e(\u548c\u8c10)\u57fa\uff1a\uff09\u3002  </p>"},{"location":"markdown/freebsd_fcitx/","title":"FreeBSD\u7684fcitx5\u8e29\u5751\u8bb0","text":"<p>\u6298\u817e\u4e86FreeBSD 14.0\u5f88\u4e45\uff0c\u76ee\u524d\u611f\u89c9KDE Plasma\u57fa\u672c\u53ef\u4ee5\u6ee1\u8db3\u684c\u9762\u65e5\u5e38\u4e86\uff0c\u552f\u4e00\u4e0d\u723d\u7684\u662ffctix5\u4e2d\u6587\u8f93\u5165\u6cd5\u59cb\u7ec8\u4e0d\u7ed9\u529b:\u5148\u524d\u662f\u6298\u817e\u4e86\u5f88\u4e45\u624d\u80fd\u5728firefox\u548cchrome\u4e0a\u6572\u4e2d\u6587\uff0c\u4f46\u8f93\u5165\u7684\u8fc7\u7a0b\u4e00\u76f4\u5c31\u4e0d\u592a\u6b63\u5e38\uff0c\u6700\u65e9\u7684fcitx\u8bbe\u7f6e\u662f\u8fd9\u6837\u6ef4\uff1a  </p> <pre><code>$ cat ~/.xinitrc\n\nexport XIM=fcitx\nexport QT_IM_MODULE=fcitx\nexport GTK_IM_MODULE=fcitx\nexport XMODIFIERS=\"@im=fcitx\"\nexport SDL_IM_MODULE=fcitx\n\nexec ck-launch-session /usr/local/bin/startplasma-x11\n</code></pre>"},{"location":"markdown/freebsd_fcitx/#1-firefoxchrome","title":"1. \u62ef\u6551firefox\u548cchrome","text":"<p>\u4ee5\u4e0a\u7684\u73af\u5883\u8bbe\u5b9a\u5728<code>startx</code>\u8fdb\u5165\u56fe\u5f62\u684c\u9762\u540e\uff0c\u53ea\u6709KDE Plasma\u7684\u539f\u751f\u7a0b\u5e8f\u53ef\u4ee5\u4e2d\u6587\u8f93\u5165\uff0c\u5176\u4ed6\u7a0b\u5e8f\u4e0a\u9762\u8f93\u5165\u6cd5\u90fd\u8868\u73b0\u5f97\u83ab\u540d\u5176\u5999\uff0c\u4e0d\u662f\u6253\u5b57\u53cd\u6620\u901f\u5ea6\u6162\uff0c\u5c31\u662f\u5404\u79cd\u6f0f\u98ce\uff0c\u5b57\u6bcd\u8fd8\u6ca1\u6709\u6572\u5b8cfctix5\u5c31\u7ed9\u51fa\u4e86\u9519\u8bef\u7684\u9009\u5b57\u3002\u3000\u3000</p> <p>\u8fd9\u4e2a\u6bdb\u75c5\u5728\u7f51\u4e0a\u4e00\u641c\u4e00\u5927\u628a\u8baf\u606f\uff0c\u60c5\u51b5\u57fa\u672c\u90fd\u662f\u4e00\u4e2a\u4eba\u63d0\u95ee\uff0c\u5176\u5b83\u597d\u5fc3\u7684\u8001\u7237\u8ba9\u4ed6\u5404\u79cd\u8d34<code>locale -a</code>\u7684\u7ed3\u679c\uff0c\u6253\u5370<code>fcitx5-diagnose</code>\u8bca\u65ad\u7a0b\u5e8f\u7684\u5404\u79cd\u4fe1\u606f\u3002\u7136\u540e\u7ed9\u51fa\u5404\u79cd\u5efa\u8bae\uff0c\u4f46\u6211\u51e0\u4e4e\u90fd\u8bd5\u4e86\u4e00\u904d\uff0c\u7ed3\u679c\u7167\u65e7\u3002\u3000\u3000</p> <p>\u603b\u662f\u4e00\u987f\u6298\u817e\u540efirefox\u53ef\u4ee5\u8f93\u4e2d\u6587\uff0c\u4f46chrome\u548cvscode\u4e0d\u884c\u3002\u7136\u540e\uff0c\u4e0d\u77e5\u9053\u5728FreeBSD\u8bba\u575b\u4e0a\u770b\u5230\u54ea\u4e2a\u5e16\u5b50\uff0c\u628a\u914d\u7f6e\u6587\u4ef6\u6539\u6210\u4e86\u4e0b\u9762\u8fd9\u6837\uff0c\u8fd9\u624d\u8ba9firefox\u548cchrome\u6d4f\u89c8\u5668\u4ee5\u53cavscode\u90fd\u652f\u6301fcitx5\u7684\u4e2d\u6587\u8f93\u5165\u3002\u4f46\u662f\u6253\u5b57\u8fd8\u662f\u5404\u79cd\u6f02\u79fb\u6f0f\u98ce\uff0c\u65e0\u89e3\u3002\u3000\u3000</p> <pre><code>$ cat ~/.xinitrc\n\nexport QT_IM_MODULE=fcitx\nexport GTK_IM_MODULE=fctix/xim \u3000#\u8fd9\u91cc\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u5565\u8fd9\u6837\nexport XMODIFIERS=\"@im=fcitx\"\nexport SDL_IM_MODULE=fcitx\n\nexec ck-launch-session /usr/local/bin/startplasma-x11\n</code></pre> <p>\u4f46\u597d\u8d56\u662f\u80fd\u8f93\u5165\u4e86\uff0c\u5c3d\u7ba1Arch Wiki\u4e0a\u5199\u4e86\u4e00\u5806\u5404\u79cd\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u95ee\u9898\u59cb\u7ec8\u6ca1\u6709\u89e3\u51b3\uff0c\u4ee5\u81f3\u4e8e\u5728\u76f8\u5f53\u957f\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u6211\u90fd\u628a\u8fd9\u53f0\u7535\u8111\u5f53\u82f1\u6587\u673a\u5668\u3002\u3000\u3000</p> <p>\u8fd9\u51e0\u5929\u5347\u7ea7\u5185\u6838\u540e\uff0c\u6211\u53c8\u624b\u8d31\u628awindows\u4e0b\u7684emacs\u914d\u7f6e\u548c\u65e5\u7a0b\u8fc1\u79fb\u5230\u8fd9\u53f0FreeBSD\u4e0b\uff0c\u7ed3\u679c\u53d1\u73b0emacs\u7684\u4e2d\u6587\u8f93\u5165\u5c45\u7136\u795e\u5947\u4e00\u822c\u7684\u6b63\u5e38\u4e86\uff0c\u5f53\u65f6\u7684\u8f6f\u4ef6\u8fd8\u662f2024Q1\u7b2c\u4e00\u5b63\u5ea6\u7684\u7248\u672c\uff0cemacs\u7684\u7248\u672c\u53f7\u662f29.1\uff0c\u8fd9\u54ea\u8bf4\u7406\u53bb\uff1f\u3000\u3000</p> <p>\u7136\u800c\uff0c\u6211\u6bd5\u7adf\u8fd8\u662f\u592a\u6d45\u8584\u3002\u52302024Q2\u7684\u4e8c\u8fdb\u5236\u5305\u53d1\u5e03\u4e4b\u540e\uff0c<code>pkg upgrade</code>\u4e00\u5347\u7ea7\u5c31\u9a6c\u4e0a\u51fa\u95ee\u9898\uff1a\u7a81\u7136\u4e4b\u95f4chrome\u548cemacs\u7684\u4e2d\u6587\u8f93\u5165\u7edf\u7edf\u4e0d\u884c\u4e86\uff0d\u5728chrome\u4e0b\u9009\u8bcd\u6846\u4e0d\u8ddf\u7740\u5149\u6807\u8dd1\uff0c\u5728emacs\u4e0b\u5e72\u8106\u4e0d\u8ba4\u4e2d\u6587\u8f93\u5165\u3002\u3000\u3000</p>"},{"location":"markdown/freebsd_fcitx/#2-nvidia","title":"2. Nvidia\u9a71\u52a8\u60ca\u9b42","text":"<p>\u6ca1\u529e\u6cd5\uff0c\u53ea\u80fd\u7f51\u4e0a\u5230\u5904\u641c\u7d22\uff0c\u5404\u79cd\u6539\uff0c\u5404\u79cd<code>pkg install</code>\u4ec0\u4e48\u7684\uff0c\u7136\u540e<code>pkg update</code>\u6216<code>pkg upgrade</code>\u4ec0\u4e48\u7684\u4ec0\u4e48\u7684\u3002\u53cd\u6b63\u662f\u6539\u4e86\u4e00\u5806\u914d\u7f6e\uff0c\u88c5\u4e86\u4e00\u5806\u7a0b\u5e8f\uff0c\u5378\u8f7d\u4e86\u4e00\u5806\u7a0b\u5e8f\uff0c\u6700\u540e\u5c31\u662f\u641e\u4e0d\u5b9a\u3002\u672c\u7740\u5927\u529b\u51fa\u5947\u8ff9\u7684\u539f\u5219\uff0c<code>shutdown -r now</code>\u91cd\u542f\u770b\u770b\uff0c\u7136\u540e\u60b2\u5267\u4e86\uff01\u7cfb\u7edf\u6839\u672c\u8d77\u4e0d\u6765\uff0c\u5c0f\u6076\u9b54\u56fe\u6807\u540e\u76f4\u63a5\u5982\u4e0b\u4e86\uff1a\u3000\u3000</p> <pre><code>kernel panic: page error\n#1 ..\n#2 ..\n#3 ..\n...\n#17     # \u6ca1\u9519\u6211\u8bb0\u5f97\u6700\u591a17\u884c\uff0c\u7136\u540e\u5c31\u673a\u5668\u952e\u76d8\u5c31\u5931\u6548\u4e86\n</code></pre> <p>\u91cc\u9762\u4e00\u5806\u795e\u79d8\u7684\u5404\u79cd\u5947\u602a\u7684\u7b26\u53f7\uff0c\u4e0d\u8981\u614c\uff0c\u6211\u770b\u6709<code>nvidia-modset</code>\u7684\u5b57\u6837\uff0c\u80af\u5b9a\u662f\u4ed6\u5728\u4f5c\u5996\u3002\u8bdd\u8bf4\u6211\u65e9\u88ab<code>nvidia</code>\u7684\u9a71\u52a8\u7a0b\u5e8f\u8bad\u51fa\u6761\u4ef6\u53cd\u5c04\u4e86\u597d\u4f10\uff1f\u524d\u4e24\u5929\u5185\u6838\u5347\u7ea7\u5c31\u62a5\u8fc7<code>kernel version is wrong</code>\u7684\u95ee\u9898\u3002\u3000\u3000</p> <p>\u55ef\uff0c\u770b\u8d77\u6765\u7528\u8001\u5185\u6838\u542f\u52a8\u5e94\u8be5\u6ca1\u95ee\u9898\u3002\u4e8e\u662f\u81ea\u4fe1\u6ee1\u6ee1\u7684\u6309\u4e86\u673a\u7bb1\u7684\u7535\u6e90\u952e\uff0c\u86ee\u8352\u5f0f\u91cd\u542f\uff0c\u8fdb\u5165\u542f\u52a8\u753b\u9762\u540e\u6309<code>6</code>\u5207\u6362\u5230<code>kernel.old</code>\uff0c\u7ed3\u679c\u662f......\u4e00\u6bdb\u4e00\u6837\u7684\u9519\u8bef\uff0c\u9760\uff01\u8fd9\u56de\u771f\u60b2\u5267\u4e86\u3002\u518d\u91cd\u542f\uff0c\u8fdb\u5165<code>Single Mode</code>\uff0c\u4ecd\u7136\u662f\u4e00\u6837\u7684\u9519\u8bef\u3002\u518d\u9760\u4e00\u6b21\uff0c\u8fd9\u56de\u771f\u771f\u513f\u7684\u662f\u60b2\u5267\u4e86\uff01\u3000\u3000</p> <p>\u5f53\u65f6\uff0c\u8111\u888b\u77ac\u95f4\u9677\u5165\u6b7b\u5faa\u73af\uff1a\u8981\u8fdb\u7cfb\u7edf\u5fc5\u987b\u628a<code>/boot/loader.conf</code>\u91cc\u9762\u7684<code>nvidia-modeset_load=\"YES\"</code>\u6ce8\u91ca\u6389\uff0c\u4f46\u662f\u6211\u8fdb\u4e0d\u53bb\u7cfb\u7edf\u5c31\u6ce8\u91ca\u4e0d\u6389\u8fd9\u4e2a\uff0c\u6211\u6ce8\u91ca\u4e0d\u6389\u8fd9\u4e2a\u6211\u5c31\u8fdb\u4e0d\u53bb\u7cfb\u7edf\uff0c\u6211\u56de\u5230\u5bb6\u624d\u80fd\u62ff\u5230\u6838\u9178\u8bc1\u660e\uff0c\u6211\u62ff\u5230\u6838\u9178\u8bc1\u660e\u4fdd\u5b89\u624d\u80fd\u653e\u6211\u56de\u5bb6\uff0c\u6211\u56de\u5230\u5bb6\u624d\u80fd\u62ff\u5230\u6838\u9178\u8bc1\u660e\uff0c\u597d\u5427\uff0c\u8fd9\u5f88\u626f......</p> <p>\u5e78\u4e8f\u540e\u6765\u7a81\u7136\u60f3\u8d77\u4e86FreeBSD\u53ef\u4ee5\u624b\u52a8<code>boot</code>\uff0c\u5728\u542f\u52a8\u754c\u9762\u51fa\u73b0\u5c0f\u6076\u9b54\u56fe\u6807\u540e\u6309<code>Esc</code>\uff0c\u7136\u540e\u8f93\u5165<code>set module_balcklist=\"nvidia-modeset\"</code>\uff0c\u56de\u8f66\u786e\u8ba4\u540e\u518d\u8f93\u5165<code>boot</code>\uff0c\u56de\u8f66\u3002\u6b63\u5e38\u542f\u52a8\uff0c\u6211\u9760\uff0c\u771f\u662f\u975e\u6d32\u8001\u7237\u5b50\u8df3\u9ad8\uff0c\u9ed1\u8001\u5b50\u4e00\u8df3\u3002\u3000\u3000</p> <p>\u8fd9\u56de\u53ef\u4e0d\u6562\u628a<code>nvidia</code>\u9a71\u52a8\u653e<code>/boot/loader.conf</code>\u6587\u4ef6\u91cc\u9762\u4e86\uff0c\u5220\u9664\u4e4b\uff0c\u7136\u540e\u5728<code>/etc/rc.conf</code>\u7684\u6700\u540e\u4e00\u884c\u52a0\u4e0a<code>kld_list+=\"nvidia-modeset\"</code>\u3002\u91cd\u542f\uff0c\u4ecd\u7136\u6b63\u5e38\uff0c\u54c8\u4eba\u5f97\u5f88\u3002\u3000\u3000</p>"},{"location":"markdown/freebsd_fcitx/#3","title":"3. \u7ee7\u7eed\u89e3\u51b3\u4e2d\u6587\u8f93\u5165","text":"<p>\u518d\u5728\u7f51\u4e0a\u4e00\u5806\u641c\u7d22\uff0c\u6709\u4eba\u8bf4\u7528<code>LC_CTYPE=zh_CN.UTF-8 emacs</code>\u5c31\u80fd\u6b63\u5e38\uff0c\u7136\u800c\u4e00\u770b\u5c31\u77e5\u9053\u90a3\u5e2e\u4eba\u662fArch\u4ed4\uff0c\u6211\u53ef\u662f\u4f1a\u5728emacs\u91cc\u7528<code>(getenv LC_CTYPE)</code>\u68c0\u67e5\u73af\u5883\u53d8\u91cf\u7684\u7537\u4eba\u3002\u679c\u7136\uff0c\u8fd9\u62db\u65e0\u6548\u3002\u3000\u3000</p> <p>\u6709\u4eba\u8bf4\u8981\u8bbe\u5b9a<code>~/.xprofile</code>\u548c<code>~/.pam_envionment</code>\u6587\u4ef6\uff0c\u663e\u7136\uff0c\u4e00\u770b\u5c31\u77e5\u9053\u8fd9\u5e2e\u5bb6\u4f19\u662fXWayland\u4ed4\uff0c\u4e0d\u7528\u8bd5\u90fd\u77e5\u9053\u65e0\u6548\u3002\u3000\u3000</p> <p>\u8fd8\u6709\u4eba\u5404\u79cd\u8ba8\u8bba\uff0c\u8ba9\u522b\u4eba\u8d34\u51fa\u5404\u79cd\u6587\u4ef6\uff0c\u4e00\u4f1a\u4ec0\u4e48<code>emacs --deamon</code>\uff0c\u4e00\u4f1a\u4ec0\u4e48<code>systemd</code>\uff0c\u53c8\u662f<code>service dbus status</code>\u4ec0\u4e48\u7684\uff0c\u6559\u4eba\u534a\u61c2\u4e0d\u61c2\u7684\uff0c\u7f51\u7edc\u4e0a\u5145\u6ee1\u4e86\u5feb\u6d3b\u7684\u7a7a\u6c14\u3002\u3000\u3000</p> <p>\u7b49\u7b49\uff0c<code>dbus</code>\uff0c\u6211\u9760\uff0c\u8fd9\u4e2a\u7834\u73a9\u610f\u6211\u548b\u6ca1\u6ce8\u610f\uff1f\u79d2\u61c2\uff0c\u9a6c\u4e0a\u6539<code>~/.xinitrc</code>\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a\u3000\u3000</p> <pre><code>$ cat ~/.xinitrc\n\nexport XIM=fcitx\nexport QT_IM_MODULE=fcitx\nexport GTK_IM_MODULE=fcitx\nexport XMODIFIERS=\"@im=fcitx\"\nexport SDL_IM_MODULE=fcitx\n\nexec ck-launch-session dbus-launch --exit-with-sessions /usr/local/bin/startplasma-x11\n</code></pre> <p>\u6ca1\u9519\uff0c\u524d\u9762\u51e0\u884c\u6062\u590d\u5230\u4e00\u5f00\u59cb\u7684\u8bbe\u5b9a\uff0c\u6700\u540e\u4e00\u884c\u542f\u52a8KDE Plasma\u684c\u9762\u73af\u5883\u65f6\u5019\u589e\u52a0<code>dbus-launch</code>\u9009\u9879\u3002\u9000\u51fa\u56fe\u5f62\u754c\u9762\uff0c\u518d\u91cd\u65b0<code>startx</code>\u3002\u6211\u9760\uff0c\u6211\u9760\u9760\u9760\uff0c<code>firefox</code>\u548c<code>chrome</code>\u4e0a\u4e2d\u6587\u8f93\u5165\u6d41\u7545\u4e86\uff0c\u518d\u4e5f\u4e0d\u6f0f\u98ce\u4e86\uff0c\u8dd1\u5f97\u6bd4windows\u7684\u4e2d\u6587\u8f93\u5165\u8fd8\u987a\u6e9c\uff01\u725b\u903c\uff0c\u9707\u58f0\uff01\uff01\uff01\u518d\u6253\u5f00<code>emacs</code>\uff0c\u4e2d\u6587\u8f93\u5165\u8fd8\u662f\u4e0d\u884c\uff01\u50bb\u903c\uff0c\u5173\u706f\uff0c\u5403\u9762\uff01\u3000\u3000</p>"},{"location":"markdown/freebsd_fcitx/#4","title":"4. \u53d1\u5e16\u6c42\u52a9\u548c\u7075\u5149\u4e00\u95ea","text":"<p>\u4e07\u822c\u65e0\u5948\uff0c\u53ea\u80fd\u53ef\u803b\u7684\u5728emacs-china\u8bba\u575b\u7684Emacs GUI\u4e0d\u80fd\u8f93\u5165\u4e2d\u6587\u5e16\u5b50\u4e0b\u6c42\u52a9\u3002\u91cc\u9762\u597d\u591aArch\u4ed4\uff0c\u4e8e\u662f\u6211\u5c31\u5f88\u6050\u60e7\u3002\u4f46\u4e5f\u53ea\u80fd\u5b66\u5706\u561f\u561f\uff02\u6389\u963f\u5988\uff0c\u786c\u9876\u4e0a\uff02\uff0c\u5f31\u5f31\u7684\u572872\u697c\u5f31\u5f31\u7684\u95ee\u4e86\u4e00\u8d34\u3002\u8fd9\u4e2a\u5e16\u5b50\u91cc\u9762\u51e0\u4e4e\u90fd\u662f\u88abemacs\u548cfcitx5\u6298\u817e\u75af\u7684\u5404\u79cdlinux\u4ed4\uff0c\u867d\u7136\u770b\u8d77\u6765\u90fd\u5f88\u793c\u8c8c\uff0c\u4f46\u4e0d\u77e5\u9053\u4e3a\u5565\u6211\u80fd\u95fb\u5230\u4ed6\u4eec\u6df1\u6df1\u7684\u6028\u5ff5\u3002\u3000\u3000</p> <p>\u672c\u6765\u4e0d\u6307\u671b\u80fd\u6709\u4ec0\u4e48\u9760\u8c31\u5efa\u8bae\u7684\uff0c\u751a\u81f3\u90fd\u4e0d\u671f\u5f85\u6709\u4eba\u56de\u590d\u3002\u56e0\u4e3a\u4f5c\u4e3a\u4e00\u4e2a\u5b64\u72ec\u7684FreeBSD\u4ed4\uff0c\u7a7a\u8c37\u91cc\u56db\u4e0b\u65e0\u4eba\u624d\u662f2024\u7684\u793e\u533a\u73af\u5883\uff0c\u66f4\u4f55\u51b5\u697c\u4e0a\u7684\u6700\u540e\u4e00\u4e2a\u5e16\u5b50\u8fd8\u662f2022\u5e74\u53d1\u7684\u3002\u7136\u9e45\u5c45\u7136\u6709\u4eba\u56de\u6211\u4e86\uff08\u5947\u8ff9\uff09\uff0c\u8bf4\u662f\u8981\u88c5\u4e00\u4e0b<code>xorg-font-misc-otb</code>\u5305\u3002\u6211\u5fae\u5fae\u4e00\u7b11\uff0c\u4e00\u770b\u5c31\u662fArch\u4ed4\uff0cFreeBSD\u4e0b\u6ca1\u6709\u8fd9\u4e2a\u5305\uff0c\u88c5<code>Xorg</code>\u7684\u65f6\u5019\u4f1a\u9ed8\u8ba4\u88c5\u4e0a\u6240\u6709<code>misc</code>\u5b57\u4f53\uff0c\u4e3a\u6b64\u8fd8\u7279\u5730\u91cd\u65b0\u68c0\u67e5\u4e86\u4e00\u904d\uff0c\u6839\u672c\u4e0d\u662f\u5b57\u4f53\u7684\u95ee\u9898\u3002\u3000\u3000</p> <p>\u90fd\u5feb\u7edd\u671b\u4e86\uff0c\u8fd9\u5e2e\u4eba\u4e0d\u662f\u8ba9\u4f60\u68c0\u67e5<code>LC_CTYPE</code>\u5c31\u662f\u68c0\u67e5<code>fctix5-diagnose</code>\uff0c\u8981\u4e48\u5c31\u8ba9\u4f60\u88c5<code>misc</code>\u5b57\u4f53\uff0c\u8981\u4e48\u5c31\u662f\u8ba9\u4f60\u7528\u5404\u79cd\u59ff\u52bf\u6539<code>GTK_IM_MODULE</code>\u548c<code>XIM</code>\u3002\u4e0d\u9760\u8c31\u597d\u4f10\uff1f\u3000\u3000</p> <p>\u72d7\u65e5\u7684\u5347\u4e2a\u7ea7\u5c31\u4e0d\u884c\u4e86\uff0c\u4e3a\u5565\uff01\u7b49\u7b49\uff0c\u5347\u7ea7\uff1f\u770b\u4e86\u4e00\u4e0bemacs\u7248\u672c\uff0c29.3\u3002\u6240\u4ee5<code>pkg</code>\u7684\u4e8c\u8fdb\u5236\u5305\u5e72\u4e86\u5565\uff1f\u8fdb<code>/usr/port</code>\u770b\u770b\uff0c\u4f1a\u4e0d\u4f1a\u8fd9\u5e2e\u8d27\u53c8\u6539\u4e86<code>Makefile</code>\u4e86\uff1f\u3000\u3000</p> <pre><code>$ cd /usr/port/editor/emacs \n$ make config\n</code></pre> <p>\u679c\u7136\uff0c\u9ed8\u8ba4\u7684\u914d\u7f6e\u628a<code>CARIO</code>\u56fe\u5f62\u5e93\u6253\u5f00\u4e86\uff0c\u4e8e\u662f<code>XFT</code>\u548c<code>OTF</code>\u652f\u6301\u5565\u7684\u90fd\u5173\u4e86\uff08<code>CARIO</code>\u548c<code>XFT</code>\u4f60\u53ea\u80fd\u4e8c\u9009\u4e00\uff09\uff0c\u662f\u4e0d\u662f\u8fd9\u4e2a\u539f\u56e0\uff1f\u8bd5\u7740\u628a\u914d\u7f6e\u6539\u6210\u56fe1\u7684\u6837\u5b50\uff0c\u7136\u540e<code>make deinstall</code>\uff0c\u518d<code>make &amp;&amp; make install</code>\u3002\u3000\u3000</p> \u56fe1 \u4fee\u6539\u540e\u7684\u7f16\u8bd1\u9009\u9879\uff08\u7ea2\u6846\u5185\u662f\u4e3b\u8981\u6539\u52a8\uff09  <p>\u542f\u52a8emacs\uff0c\u559c\u5927\u666e\u5954\uff0c\u82cd\u5929\u554a\uff0c\u5927\u5730\u554a\uff0c\u8fd9\u54ea\u4f4d<code>port</code>\u7ef4\u62a4\u8005\u5728<code>Makefile</code>\u91cc\u9762\u4e71\u653e\u5c41\u554a\uff1f\u6b63\u5e38\u4e86\uff01\u3000\u3000</p>"},{"location":"markdown/freebsd_fcitx/#5","title":"5. \u603b\u7ed3","text":"<p>\u867d\u7136\uff0cArch\u4ed4\u5c31\u77e5\u9053\u4e0d\u505c\u7684<code>LC_CTYPE</code>\u548c<code>fcitx5-diagose</code>\u8fd8\u6709\u5b57\u4f53\u4ec0\u4e48\u7684\u53e8B\u53e8\uff0c\u4f46\u8fd8\u662f\u8981\u611f\u8c22\u90a3\u4f4d\u4e0d\u541d\u7ed9\u6211\u56de\u590d\u7684glgl-schemer\u540c\u5b66\uff0c\u8bdd\u8bf4\uff0c\u7528<code>scheme</code>\u8bed\u8a00\u7684\u4ed4\u4e0d\u662f\u770b\u4e0d\u8d77<code>elisp</code>\u4e48\uff1f\u603b\u4e4b\uff0c\u8bf4\u8c22\u8c22\u4e0d\u72af\u6cd5\uff0c\u611f\u8c22\u611f\u8c22\uff01\u3000\u3000</p> <p>\u96c0\u98df\uff0cemacs\u5728linux\u548cfreebsd\u4e0b\u4e0d\u80fd\u7528fcitx5\u7684\u539f\u56e0\u65e0\u975e\u8fd9\u51e0\u4e2a\uff1a\u3000\u3000</p> <ol> <li><code>LC_CTYPE</code>\u6ca1\u6709\u8bbe\u5b9a\u4e3a<code>zh_CN.UTF-8</code>\uff1b</li> <li><code>XIM</code>\u548c<code>GTK_IM_MODULE</code>\u7b49\u7b49\u6ca1\u6709\u6b63\u786e\u7684\u8bbe\u7f6e\uff0c\u8fd9\u4e2a\u5728FreeBSD\u4e0b\u7167\u6284\u6211\u7684\u5373\u53ef\uff0c\u4f46\u662f\u4e0d\u8981\u7528<code>~/.profile</code>\u548c<code>~/.pam_envionment</code>\uff0c\u548c\u8fd9\u4e9b\u5c31\u6ca1\u6bdb\u5173\u7cfb\uff1b</li> <li>linux\u4e0b<code>dbus</code>\u5728\u56fe\u5f62\u754c\u9762\u4e0b\u9ed8\u8ba4\u662f\u5f00\u7684\uff0c\u800c\u4e07\u6076\u7684FreeBSD\u9700\u8981\u8981\u624b\u52a8\u5f00\u542f\uff0c\u53c2\u8003\u524d\u9762<code>~/.xinitrc</code>\u6587\u4ef6\u7684\u6700\u540e\u4e00\u884c\uff1b</li> <li>\u786e\u8ba4\u7cfb\u7edf\u5b89\u88c5\u4e86<code>xorg-misc</code>\u76f8\u5173\u5b57\u4f53\uff0c\u4e14\u5b57\u4f53\u8def\u5f84\u5728<code>X11</code>\u542f\u52a8\u65f6\u5df2\u7ecf\u6b63\u786e\u7684\u5bfc\u5165\u4e86\uff1b</li> <li>\u5982\u679c\u90fd\u6ca1\u6709\u95ee\u9898\uff0c\u4e14fctix5\u5728\u5176\u4ed6\u7a0b\u5e8f\u4e0a\u6b63\u5e38\uff0c\u4f46\u5c31\u662f\u4e0d\u652f\u6301<code>emacs</code>\uff0c\u90a3\u4e48\u80af\u5b9a\u662f<code>emacs</code>\u5b89\u88c5\u5305\u7684\u7f16\u8bd1\u9009\u9879\u4e0d\u5bf9\uff0c\u5751\u7239\u554a\uff01\u3000\u3000</li> </ol> <p>\u6700\u540e\uff0c<code>nvidia</code>\u7684\u9a71\u52a8\u7ecf\u5e38\u4f1a\u641e\u6b7bFreeBSD\uff0c\u82e5\u4e0d\u80fd\u542f\u52a8\uff0c\u8981\u624b\u52a8<code>module_blacklist</code>\u547d\u4ee4\u884c<code>boot</code>\u3002\u3000\u3000</p> <p>\u6700\u540e\u7684\u6700\u540e\uff0cFUCK NVIDIA\uff01\uff01\uff01</p>"},{"location":"markdown/freebsd_ports/","title":"FreeBSD\u7684ports\u7cfb\u7edf\u4f7f\u7528","text":"<p>FreeBSD\u64cd\u4f5c\u7cfb\u7edf\u6709\u4e24\u79cd\u8f6f\u4ef6\u5305\u7ba1\u7406\u65b9\u5f0f\uff1a\u4e8c\u8fdb\u5236\u7684pkg\u65b9\u5f0f\u548c\u6e90\u4ee3\u7801\u7684ports\u65b9\u5f0f\u3002 pkg\u65b9\u5f0f\u662f\u4ece\u670d\u52a1\u5668\u4e0b\u8f7d\u4e8c\u8fdb\u5236\u5b89\u88c5\u5305\u5230\u672c\u5730\u5b89\u88c5\uff0c\u548cRedhat\u7cfbLinux\u7684yum\u6216Debian\u7cfbLinux\u7684apt\u7c7b\u4f3c\u3002\u5e38\u7528\u547d\u4ee4\u5982\u4e0b\uff1a </p> <pre><code>#\u66f4\u65b0\u4e8c\u8fdb\u5236\u8f6f\u4ef6\u5305\u7d22\u5f15\n$ sudo pkg update    \n#\u66f4\u65b0\u672c\u673a\u5b89\u88c5\u7684\u6240\u6709\u8f6f\u4ef6\u5305\n$ sudo pkg upgrade\n#\u5b89\u88c5\u67d0\u4e2a\u8f6f\u4ef6\u5305\uff0c\u6bd4\u5982firefox\uff0c\u5b83\u4f1a\u81ea\u52a8\u5b89\u88c5\u6240\u6709\u4f9d\u8d56\uff08\u4e5f\u53efpkg add\uff09\n$ sudo pkg install firefox\n#\u5220\u9664\u67d0\u4e2a\u8f6f\u4ef6\u5305\uff0c\u6bd4\u5982firefox\uff0c\u5b83\u4f1a\u5220\u9664\u4f9d\u8d56\u6b64\u5305\u7684\u8f6f\u4ef6\uff08\u4e5f\u53efpkg delete\uff09\n$ sudo pkg remove firefox\n#\u67e5\u770b\u67d0\u4e2a\u8f6f\u4ef6\u7684\u5b89\u88c5\u4fe1\u606f\uff08\u5982firefox\uff09\n$ pkg info firefox\n#\u81ea\u52a8\u5220\u9664\u6240\u6709\u65e0\u7b2c\u4e09\u65b9\u4f9d\u8d56\u7684\u88ab\u4f9d\u8d56\u5305\uff08\u614e\u7528\uff0c\u6709\u65f6\u5019\u5faa\u73af\u4f9d\u8d56\uff0c\u9ebb\u70e6\uff09\n$ sudo pkg autoremove\n#\u5220\u9664\u5df2\u4e0b\u8f7d\u7684\u7f13\u5b58\u4e8c\u8fdb\u5236\u5b89\u88c5\u6e90(.txz\u6587\u4ef6,\u4e00\u822c\u4f4d\u4e8e/var/cache/pkg/\u76ee\u5f55\u4e0b)\n$ sudo pkg clean\n</code></pre> <p>\u6e90\u7801\u7ea7\u7684ports\u7f16\u8bd1\u5b89\u88c5\u65b9\u5f0f\u662f\u53e6\u4e00\u79cd\u975e\u5e38\u7ecf\u5178\u7684Unix\u8f6f\u4ef6\u5305\u7ba1\u7406\u7cfb\u7edf\uff0cMacOS\u4e0a\u7684<code>homebrew</code>\u548cGentoo Linux\u7684<code>portage</code>\u90fd\u6a21\u4eff\u4e86\u8fd9\u4e00\u8bbe\u8ba1\u3002 \u4f7f\u7528ports\u65b9\u5f0f\u9700\u8981\u4e0b\u8f7d\u8f6f\u4ef6\u548c\u5176\u6240\u6709\u4f9d\u8d56\u5e93\u7684\u6e90\u4ee3\u7801\u5728\u672c\u673a\u4e0a\u7f16\u8bd1\u5b89\u88c5\u3002\u548cpkg\u7684\u4e8c\u8fdb\u5236\u5b89\u88c5\u65b9\u5f0f\u4e0d\u540c\uff0c\u5b83\u53ef\u4ee5\u6839\u636e\u672c\u673a\u7684CPU\u67b6\u6784\u4f18\u5316\u7f16\u8bd1\u8f6f\u4ef6\uff0c\u76f8\u5f53\u9002\u5408\u5f3a\u8feb\u75c7\u60a3\u8005\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u7528\u6e90\u4ee3\u7801\u7f16\u8bd1\u5b89\u88c5\u867d\u7136\u4f1a\u5c3d\u91cf\u6316\u6398\u672c\u673a\u6027\u80fd\uff0c\u4f46\u7f16\u8bd1\u662f\u4e00\u79cd\u975e\u5e38\u8017\u65f6\u548c\u8017\u80fd\u7684\u4e8b\u60c5\u3002\u4ece\u73af\u4fdd\u548c\u65f6\u6548\u8003\u8651\uff0c\u5efa\u8bae\u50cfGnome3\u3001Kde-plasma5\u8fd9\u6837\u7684\u5927\u578b\u8f6f\u4ef6\u76f4\u63a5\u7528pkg\u4e8c\u8fdb\u5236\u5b89\u88c5\u3002 </p> <p>ports\u7cfb\u7edf\u5e76\u6ca1\u6709\u76f4\u63a5\u5b58\u50a8\u8f6f\u4ef6\u7684\u6e90\u4ee3\u7801\uff0c\u5426\u5219\u673a\u5668\u7684\u786c\u76d8\u65e9\u7206\u4e86\u3002\u5b83\u53ea\u662f\u4e00\u4e2a<code>Makefile</code>\u3001\u8865\u4e01\uff08<code>patch</code>\uff09\u548c\u8f6f\u4ef6\u63cf\u8ff0\u6587\u4ef6\u7684\u96c6\u5408\u3002FreeBSD\u7528\u8fd9\u4e2a\u96c6\u5408\u6765\u89c4\u5b9a\u5982\u4f55\u7f16\u8bd1\u548c\u5b89\u88c5\u8f6f\u4ef6\uff0c\u6bcf\u4e2a\u8f6f\u4ef6\u5bf9\u5e94\u4e00\u4e2a<code>port</code>\uff0c\u6240\u6709\u652f\u6301\u7684\u8f6f\u4ef6\u5bf9\u5e94<code>ports</code>\uff0c\u9ed8\u8ba4\u5b58\u653e\u8def\u5f84\u4e3a<code>/usr/ports/</code>\u3002</p>"},{"location":"markdown/freebsd_ports/#1-ports","title":"1. \u4e0b\u8f7dports\u5230\u4f60\u7684\u8ba1\u7b97\u673a","text":"<p>\u521a\u521a\u5b89\u88c5\u597d\u7684FreeBSD\u57fa\u672c\u7cfb\u7edf\u5e76\u6ca1\u6709\u5728\u786c\u76d8\u4e0a\u81ea\u52a8\u5efa\u7acbports\uff0c\u4f46\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53eb\u505a<code>portsnap</code>\u7684\u547d\u4ee4\uff0c\u5b83\u53ef\u4ee5\u8fde\u63a5FreeBSD\u7f51\u7ad9\uff0c\u6838\u5bf9\u5b89\u5168\u5bc6\u94a5\uff0c\u5e76\u4e0b\u8f7d\u6700\u65b0\u7684ports\u5230\u672c\u673a\u4e0a\u3002 \u4e0b\u8f7dports\u7684\u538b\u7f29\u5feb\u7167\uff08snapshot\uff09\u5230\u672c\u673a\uff08\u5b58\u653e\u5728/var/db/portsnap/\u76ee\u5f55\u4e0b\uff09\u7684\u547d\u4ee4\u662f\uff1a  </p> <p><pre><code>$ sudo portsnap fetch\n</code></pre> \u4e0b\u8f7d\u5b8c\u6bd5\u540e\uff0c\u89e3\u538b\u6b64\u5feb\u7167\uff08\u9ed8\u8ba4\u89e3\u538b\u5230/usr/ports/\uff09\u7684\u547d\u4ee4\u662f\uff1a  </p> <pre><code>$ sudo portsnap extract\n</code></pre> <p>\u4ece\u4eca\u4ee5\u540e\uff0c\u624b\u52a8\u66f4\u65b0ports\u7cfb\u7edf\u7684\u547d\u4ee4\u662f\uff1a  </p> <pre><code>$ sudo portsnap fetch\n$ sudo portsnap update\n</code></pre> <p><code>portsnap</code>\u547d\u4ee4\u652f\u6301\u53c2\u6570\u7684\u987a\u5e8f\u8c03\u7528\uff0c\u7528\u6237\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\u5b83\uff1a  </p> <pre><code>#\u7b2c\u4e00\u6b21\u4e0b\u8f7dports\u7cfb\u7edf\u5230\u672c\u673a\n$ sudo portsnap fetch extract\n#\u6b64\u540e\u624b\u52a8\u66f4\u65b0ports\u7cfb\u7edf\n$ sudo portsnap fetch update\n</code></pre> <p><code>/usr/ports/</code>\u76ee\u5f55\u4e0b\u6309\u8f6f\u4ef6\u7684\u4e0d\u540c\u5206\u7c7b\u5efa\u7acb\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e2a\u8f6f\u4ef6\u7684\u76ee\u5f55\u4e0b\u53ea\u6709\u5982\u4f55\u7f16\u8bd1\u5e76\u5b89\u88c5\u5b83\u7684\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u88ab\u79f0\u4e3a\u9aa8\u67b6\uff08<code>skeleton</code>\uff09\uff0c\u6bcf\u4e2askeleton\u5305\u542b\u4ee5\u4e0b\u6587\u4ef6\u6216\u5b50\u76ee\u5f55\uff1a <code>Makefile</code>\uff1a\u6b64\u8f6f\u4ef6\u7684\u7f16\u8bd1\u8fc7\u7a0b\u548c\u5b89\u88c5\u76ee\u7684\u5730\u3002 <code>distinfo</code>\uff1a\u6b64\u8f6f\u4ef6\u9700\u8981\u4e0b\u8f7d\u7684\u6e90\u7801\u5305\u7684\u540d\u79f0\u3001\u6821\u9a8c\u7801\u7b49\u4fe1\u606f\u3002 <code>files/</code>\uff1a\u6b64\u8f6f\u4ef6\u9700\u8981\u7684\u8865\u4e01\u5305\u53ca\u5176\u4ed6\u6587\u4ef6\u3002 <code>pkg-descr</code>\uff1a\u6b64\u8f6f\u4ef6\u7684\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\uff0c\u7528\u4e8epkg\u7cfb\u7edf\u7ba1\u7406\u3002 <code>pkg-plist</code>\uff1a\u6b64\u8f6f\u4ef6\u5c06\u4f1a\u5b89\u88c5\u5230\u672c\u673a\u4e0a\u7684\u6240\u6709\u6587\u4ef6\uff0c\u5378\u8f7d\u65f6\u9700\u5220\u9664\u54ea\u4e9b\u6587\u4ef6\u3002 \u6709\u4e9b\u7279\u6b8a\u7684\u8f6f\u4ef6\u8fd8\u4f1a\u6709<code>pkg-message</code>\u6216\u5176\u5b83\u6587\u4ef6\uff0c\u8be6\u7ec6\u4fe1\u606f\u8bf7\u53c2\u8003FreeBSD\u624b\u518c\u3002\u6574\u4e2a<code>/usr/ports</code>\u4e0b\u6ca1\u6709\u4efb\u4f55\u771f\u5b9e\u7684\u8f6f\u4ef6\u6e90\u7801\uff0c\u53ea\u6709\u7f16\u8bd1\u5b89\u88c5\u65f6\u5b83\u4eec\u624d\u4f1a\u88ab\u81ea\u52a8\u4e0b\u8f7d\u5230<code>/usr/ports/distfiles/</code>\u76ee\u5f55\u3002</p>"},{"location":"markdown/freebsd_ports/#2-ports","title":"2. \u4f7f\u7528ports\u7f16\u8bd1\u5b89\u88c5\u8f6f\u4ef6","text":"<p>\u9996\u5148\u8981\u6c42\u8ba1\u7b97\u673a\u80fd\u8bbf\u95eeInternet\uff0c\u5e76\u4e14\u5f53\u524d\u7528\u6237\u662f<code>root</code>\uff0c\u6216\u62e5\u6709<code>root</code>\u7684\u7528\u6237\u5bc6\u7801\u3002 \u5b89\u88c5\u4e00\u4e2a\u8f6f\u4ef6\uff08\u5982<code>vim</code>\uff09\u9700\u5728\u6b64\u8f6f\u4ef6\u7684ports\u76ee\u5f55\u4e0b\u6267\u884cmake install\u547d\u4ee4\uff1a  </p> <pre><code>$ cd /usr/ports/editors/vim\n$ sudo make install\n</code></pre> <p>\u63a7\u5236\u53f0\u4f1a\u63d0\u793a\u4e0b\u8f7d\u6e90\u7801\u5305\u7684\u8fdb\u5ea6\u3001\u7f16\u8bd1\u7684\u8f93\u51fa\u4fe1\u606f\u53ca\u5b89\u88c5\u4fe1\u606f\u3002\u7f16\u8bd1\u5b89\u88c5\u8fc7\u7a0b\u4f1a\u751f\u6210\u4e00\u4e9b\u4e34\u65f6\u6587\u4ef6\uff0c\u5b89\u88c5\u6210\u529f\u540e\u53ef\u4ee5\u6e05\u7a7a\uff1a  </p> <p><pre><code>$ sudo make clean\n</code></pre> \u5982\u679c\u4f60\u4e0d\u60f3\u5728<code>/usr/ports</code>\u7684\u5b50\u76ee\u5f55\u4e0b\u8df3\u6765\u8df3\u53bb\uff0c\u53ef\u4ee5\u7528<code>-C</code>\u53c2\u6570\u907f\u514d\u3002\u9996\u5148\uff0c\u4f60\u5fc5\u987b\u5728<code>/usr/port</code>\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u4ee5\u4e0a\u547d\u4ee4\u4f1a\u662f\u8fd9\u6837\uff1a  </p> <pre><code>$ cd /usr/ports/\n$ sudo make -C editors/vim install\n$ sudo make -C editors/vim clean\n$ sudo make -C editors/vim install clean\n$ sudo make -C editors/vim reinstall clean\n</code></pre> <p>\u5c0f\u8d34\u58eb\uff1a\u53ef\u4f7f\u7528<code>sudo make install clean</code>\u4e00\u6b21\u6027\u5b8c\u6210\u7f16\u8bd1\u3001\u5b89\u88c5\u3001\u6e05\u7a7a\u7684\u5de5\u4f5c\u3002</p> <p>\u6709\u4e9b\u8f6f\u4ef6\u7531\u5f88\u591a\u7ec4\u4ef6\uff08\u6bd4\u5982<code>/usr/ports/www/firefox</code>\uff09\uff0c\u7f16\u8bd1\u65f6\u4f1a\u5f39\u51fa\u84dd\u8272\u6587\u672c\u5bf9\u8bdd\u6846\u7b49\u5f85\u7528\u6237\u7f16\u8f91\u914d\u7f6e\u4fe1\u606f\uff0c\u5176\u4f9d\u8d56\u5305\u4e5f\u53ef\u80fd\u4f1a\u5982\u6b64\u3002\u7531\u4e8e\u7f16\u8bd1\u5927\u578b\u8f6f\u4ef6\u975e\u5e38\u8017\u65f6\uff0c\u7528\u6237\u4e0d\u53ef\u80fd\u4e00\u76f4\u773c\u5df4\u5df4\u7684\u7b49\u5f85\u4e00\u4e2a\u5305\u7f16\u8bd1\u5b8c\u6bd5\uff0c\u7136\u540e\u518d\u4fee\u6539\u4e0b\u4e00\u4e2a\u5305\u7684\u914d\u7f6e\u6587\u4ef6\u3002\u56e0\u6b64\u4e8b\u914d\u7f6e\u597d\u6240\u6709\u5305\u7684\u7f16\u8bd1\u9009\u9879\u5c24\u4e3a\u5fc5\u8981\u3002\u8fd9\u4e00\u8fc7\u7a0b\u901a\u5e38\u5982\u4e0b\uff1a  </p> <pre><code>#\u5230firefox\u7684port\u76ee\u5f55\u4e0b\n$ cd /usr/ports/www/firefox\n#\u9996\u5148\u9012\u5f52\u914d\u7f6e\u597d\u6240\u6709\u5305\u7684\u7f16\u8bd1\u9009\u9879\n$ sudo make config-recursive\n#\u8fd9\u6837firefox\u548c\u5176\u6240\u6709\u4f9d\u8d56\u5305\u7684\u7f16\u8bd1\u9009\u9879\u914d\u7f6e\u5bf9\u8bdd\u6846\u4f1a\u4e00\u4e2a\u4e2a\u51fa\u73b0\n#\u8bbe\u5b9a\u597d\u6240\u6709\u914d\u7f6e\u540e\u5f00\u59cb\u7f16\u8bd1\uff0c\u6b64\u8fc7\u7a0b\u4e0d\u4f1a\u6709\u5bf9\u8bdd\u6846\u6253\u65ad\uff0c\u81ea\u52a8\u5b8c\u6210\n$ sudo make install clean\n</code></pre>"},{"location":"markdown/freebsd_ports/#3-ports","title":"3. \u5378\u8f7dports\u8f6f\u4ef6\u53ca\u6e05\u7406\u4e34\u65f6\u6587\u4ef6","text":"<p>\u7528ports\u7f16\u8bd1\u5b89\u88c5\u7684\u8f6f\u4ef6\u53ef\u4ee5\u88abpkg\u7cfb\u7edf\u7ba1\u7406\uff0c\u53ef\u4f7f\u7528<code>pkg delete</code>\u6216<code>pkg remove</code>\u547d\u4ee4\u6765\u5378\u8f7d\u5b83\u4eec\u3002\u53e6\u5916\uff0c\u4f7f\u7528Unix\u4f20\u7edf\u7684<code>make uninstall</code>\u547d\u4ee4\u4e5f\u53ef\u5378\u8f7d\u5b83\u4eec\uff0c\u4ee5<code>vim</code>\u4e3a\u4f8b\uff0c\u547d\u4ee4\u4e3a\uff1a  </p> <pre><code>$ cd /usr/ports/editors/vim\n$ sudo make deinstall\n</code></pre> <p>\u957f\u671f\u4f7f\u7528ports\u7cfb\u7edf\u4f1a\u5360\u7528\u5927\u91cf\u78c1\u76d8\u7a7a\u95f4\uff0c\u6545\u800c\u63a8\u8350\u7f16\u8bd1\u5b89\u88c5\u547d\u4ee4\u662f<code>make install clean</code>\u3002\u4f46\u662f\uff0cFreeBSD\u4e3a\u4e86\u4e0d\u91cd\u590d\u4e0b\u8f7d\u540c\u4e00\u6e90\u7801\uff0c\u4e0b\u8f7d\u7684\u6e90\u7801\u5305\u90fd\u5b58\u5728<code>/usr/ports/distfiles/</code>\u4e2d\u4e14\u4e0d\u4f1a\u88ab\u5220\u9664\u3002\u56e0\u6b64\uff0c\u5efa\u8bae\u5b9a\u671f\u6e05\u7406\u6b64\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002\u6bd4\u8f83\u7b80\u5355\u7c97\u66b4\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a  </p> <pre><code>$ cd /usr/ports/distfiles\n$ sudo rm -rf *\n</code></pre> <p>\u4f46\u8fd9\u6837\u53ef\u80fd\u663e\u5f97\u4e0d\u90a3\u5b89\u5168\uff0c\u67d0\u4e9b\u624b\u6296\u4eba\u58eb\u53ef\u80fd\u6572\u6210\u4e86<code>sudo rm -rf \uff5e/*</code>\uff1a\uff09\u3002 \u5efa\u8bae\u5b89\u88c5\u4e00\u4e2a\u53eb\u505a<code>portupgrade</code>\u7684\u8f6f\u4ef6\u5305\uff08<code>/usr/ports/ports-mgmt/portupgrade/</code>\uff09\uff0c\u5b83\u63d0\u4f9b<code>portsclean</code>\u547d\u4ee4\u5b89\u5168\u6e05\u9664<code>/usr/ports/distfiles/</code>\u4e0b\u7684\u8fc7\u671f\u6e90\u7801\uff0c\u4f7f\u7528\u65b9\u5f0f\u5982\u4e0b:  </p> <pre><code>#\u5220\u9664\u6240\u6709\u7f16\u8bd1\u4e2d\u95f4\u6587\u4ef6\n$ sudo portsclean -C\n#\u5220\u9664\u66f4\u65b0/usr/ports\u540e\u4e0d\u88ab\u6240\u6709\u8f6f\u4ef6\u4f9d\u8d56\u7684\u6e90\u4ee3\u7801\n$ sudo portsclean -D\n#\u6e05\u7a7a\u6240\u6709\u672c\u673a\u5df2\u901a\u8fc7ports\u7f16\u8bd1\u5b89\u88c5\u7684\u8f6f\u4ef6\u4e0d\u4f9d\u8d56\u7684\u6e90\u4ee3\u7801\n$ sudo portsclean -DD\n</code></pre>"},{"location":"markdown/freebsd_ports/#4-ports","title":"4. \u6839\u636e\u8f6f\u4ef6\u540d\u641c\u7d22ports","text":"<p>\u5728\u6d69\u5982\u70df\u6d77\u7684ports\u7cfb\u7edf\u4e2d\u53bb\u5bfb\u627e\u67d0\u4e2a\u8f6f\u4ef6\u7684\u6240\u5728\u76ee\u5f55\u53ef\u4ee5\u7528Unix\u7ecf\u5178\u611a\u8822\u7684<code>find</code>\u547d\u4ee4\u3002\u540c\u65f6\uff0cFreeBSD\u7684<code>make</code>\u4e5f\u63d0\u4f9b\u4e86<code>search</code>\u53c2\u6570\u652f\u6301ports\u641c\u7d22\uff0c\u6bd4\u5982\u641c\u7d22<code>vim</code>\u8f6f\u4ef6\u5305\u7684\u547d\u4ee4\u4e3a\uff1a  </p> <pre><code>#\u6539\u53d8\u5f53\u524d\u76ee\u5f55\u4e3a/usr/ports/\n$ cd /usr/ports\n$ make search name=vim\n</code></pre> <p>\u7531\u4e8e\u5305\u542b<code>vim</code>\u8fd9\u4e2a\u5b57\u7b26\u7684\u5185\u5bb9\u592a\u591a\uff0c\u53ef\u4ee5\u7528<code>grep</code>\u547d\u4ee4\u7b80\u5316\u8f93\u51fa\uff1a <pre><code>$ make search name=vim | grep Path:\nPath:   /usr/ports/audio/vimpc\nPath:   /usr/ports/devel/geany-plugin-vimode\nPath:   /usr/ports/devel/geany-plugin-vimode\nPath:   /usr/ports/devel/p5-Shell-EnvImporter\nPath:   /usr/ports/editors/neovim\nPath:   /usr/ports/editors/neovim-qt\nPath:   /usr/ports/editors/p5-Vimana\nPath:   /usr/ports/editors/py-pynvim\nPath:   /usr/ports/editors/py-pynvim\nPath:   /usr/ports/editors/rubygem-neovim\nPath:   /usr/ports/editors/vim\nPath:   /usr/ports/editors/vim-console\nPath:   /usr/ports/editors/vim-tiny\nPath:   /usr/ports/games/rubygem-vimgolf\nPath:   /usr/ports/japanese/jvim3\nPath:   /usr/ports/sysutils/vimpager\nPath:   /usr/ports/textproc/p5-Text-VimColor\nPath:   /usr/ports/www/vimb\n</code></pre></p>"},{"location":"markdown/freebsd_ports/#5-etcmakeconf","title":"5. \u4fee\u6539/etc/make.conf\u6587\u4ef6","text":"<p>\u4ece\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5\u8f6f\u4ef6\u975e\u5e38\u6298\u817e\u65f6\u95f4\uff0c\u5bf9\u4e8e\u5f88\u591a\u5f3a\u8feb\u75c7\u6765\u8bf4\uff0c\u8fd9\u6837\u505a\u7684\u6700\u5927\u7406\u7531\u53ef\u80fd\u5c31\u662f\u4e3a\u4e86\u8ba9\u8f6f\u4ef6\u5728\u672c\u673a\u4e0a\u8dd1\u5f97\u6bd4\u9999\u6e2f\u8bb0\u8005\u8fd8\u5feb\uff0c\u4f46\u9700\u8981\u4fee\u6539\u7f16\u8bd1\u5668\u4f18\u5316\u53c2\u6570\u3002 \u540c\u65f6\uff0c\u7531\u4e8e\u4f17\u6240\u5468\u77e5\u7684\u539f\u56e0\uff0c\u5728\u67d0\u7247960\u4e07\u5e73\u65b9\u516c\u91cc\u7684\u795e\u5947\u571f\u5730\u4e0a\u5f88\u591a\u7f51\u7ad9\u65e0\u6cd5\u8bbf\u95ee\uff0c\u8fd9\u7fa4\u5168\u7403\u6700\u5927\u5c40\u57df\u7f51\u7684\u53ef\u601c\u7528\u6237\u5f80\u5f80\u9700\u8981\u8bbe\u5b9a\u6e90\u7801\u955c\u50cf\u7ad9\u70b9\u3002 \u6700\u540e\uff0c\u7531\u4e8eSun\u516c\u53f8\u641e\u51fa\u6765Java\u8fd9\u4e2a\u795e\u5947\u7684\u3001\u7f57\u55e6\u7684\u3001\u964d\u4f4e\u667a\u5546\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u8f6f\u4ef6\u6e90\u7801\u6587\u4ef6\u5927\u5c0f\u627f\u6307\u6570\u7ea7\u4e0a\u5347\uff0c\u591a\u7ebf\u7a0b\u4e0b\u8f7d\u6781\u6709\u5fc5\u8981\u3002 \u4ee5\u4e0a\u9700\u6c42\u90fd\u8981\u4fee\u6539<code>/etc/make.conf</code>\u6587\u4ef6\uff0c\u8be6\u7ec6\u8bf4\u660e\u8bf7\u952e\u5165<code>man make.conf</code>\u547d\u4ee4\u67e5\u6587\u6863\uff0c\u4ee5\u4e0b\u662f\u6211\u673a\u5668\u4e0a\u7684<code>/etc/make.conf</code>\uff1a </p> <pre><code>#\u9ed8\u8ba4\u4f7f\u7528axel\u547d\u4ee4\u52065\u4e2a\u7ebf\u7a0b\u4e0b\u8f7d\uff0c-a\u8868\u793a\u53ea\u8f93\u51fa\u7b80\u77ed\u4e0b\u8f7d\u4fe1\u606f\u800c\u4e0d\u5237\u5c4f\n#\u5f53\u7136\u4f60\u9700\u8981\u5b9e\u73b0\u5b89\u88c5axel\u7a0b\u5e8f\uff0cpkg install axel\u5c31\u884c\u4e86\nFETCH_CMD=axel -n 5 -a\n\nDISABLE_SIZE=yes\n\n#\u4e2d\u79d1\u5927\u7684\u955c\u50cf\u6709\u65f6\u5019\u5f88\u8be1\u5f02\nMASTER_SITE_OVERRIDE?=\\\nhttp://mirrors.ustc.edu.cn/freebsd-ports/distfiles/${DIST_SUBDIR}/\\\nhttp://mirrors.163.com/freebsd/ports/distfiles/${DIST_SUBDIR}/\\\nhttp://mirrors.aliyun.com/freebsd/ports/distfiles/${DIST_SUBDIR}/\\\nhttp://ports1.chinafreebsd.cn/distfiles/${DIST_SUBDIR}/\n\nMASTER_SITE_OVERRIDE?=${MASTER_SITE_BACKUP}\n\n#\u7f16\u8bd1\u5668\u4f18\u5316\u547d\u4ee4\uff1a\n#   CPU\u7c7b\u578b\uff0c\u6211\u7684CPU\u662fintel\u5fd7\u5f3aE5-2697v2\u662fivybridge\u7684\uff0c\u5982\u679c\u4e0d\u77e5\u9053\u5c31\u522b\u8bbe\u8fd9\u4e2a\nCPUTYPE?=ivybridge\n#   -O3\u89e3\u91ca\uff0c\u4e0dO3\u4e0d\u7537\u4eba\u3002 -pipe\u5b50\u8fc7\u7a0b\u7528\u7ba1\u9053\u800c\u975e\u6587\u4ef6\u901a\u8baf\uff0c\u53ef\u7f29\u77ed\u7f16\u8bd1\u65f6\u95f4\n#   -funroll-loops\uff0c\u8fd9\u4e2a\u662f\u4e2a\u8001\u6280\u5de7\u4e86\uff0c\u51fd\u6570\u7684\u5faa\u73af\u5c55\u5f00\u3002\u5176\u5b9e\u4e5f\u63d0\u901f\u4e0d\u4e86\u591a\u5c11\nCFLAGS=-O3 -pipe -funroll-loops\nCOPTFLAGS=-O3 -pipe -funroll-loops\nBUILD_OPTIMIZED=YES\n</code></pre>"},{"location":"markdown/freebsd_ports/#6","title":"6. \u6ce8\u610f\u4e8b\u9879","text":"<p>\u6709\u4e9b\u4eba\u5f88\u5f3a\u8feb\u75c7\uff0c\u6bcf\u5929\u90fd\u8981\u66f4\u65b0\u4e00\u4e0b\u8f6f\u4ef6\u83b7\u53d6\u5fc3\u7406\u5b89\u6170\u3002\u6709\u4e8b\u6ca1\u4e8b\u5c31\u8fd9\u6837\uff1a  </p> <pre><code>$ sudo pkg upgrade\n</code></pre> <p>\u4f46\u662f\u5982\u679c\u4f60\u8f9b\u8f9b\u82e6\u82e6\u7684\u4eceports\u7f16\u8bd1\u5b89\u88c5\u4e86\u4e00\u4e2a\u5927\u578b\u8f6f\u4ef6\uff08\u6bd4\u5982Gnome3\uff09\uff0c\u73b0\u5728pkg\u53d1\u73b0\u6709\u66f4\u65b0\u7684\u4e8c\u8fdb\u5236\u7248\u672c\u4e86\uff0c\u5b83\u4f1a\u628a\u539f\u6765\u7684ports\u7248\u672c\u8986\u76d6\u6389\u3002\u50bb\u4e86\u5427\uff1f  </p> <p>\u5c0f\u8d34\u58eb\uff1aFreeBSD\u4e0b\u9664\u4e86\u57fa\u672c\u7cfb\u7edf\u7684\u5b89\u5168\u8865\u4e01\u9700\u8981\u66f4\u65b0\u4e4b\u5916\uff0c\u5176\u5b83\u8f6f\u4ef6\u6ca1\u4e8b\u522b\u8001\u66f4\u65b0\u3002</p> <p>\u771f\u8981\u66f4\u65b0ports\u7f16\u8bd1\u5b89\u88c5\u7684\u8f6f\u4ef6\u5e94\u8be5\u8c61\u8fd9\u6837\u64cd\u4f5c\uff1a  </p> <pre><code>#\u9996\u5148\u66f4\u65b0ports\n$ sudo portsnap fetch update\n#\u7136\u540e\u67e5\u627e\u6240\u6709\u7528ports\u5b89\u88c5\u7684\u4f46\u5df2\u8fc7\u671f\u7684\u8f6f\u4ef6\n$ sudo pkg version -l \"&lt;\"\n#\u4f60\u53ef\u4ee5\u4e00\u4e2a\u4e2amake reinstall clean\uff0c\u4e5f\u53ef\u4ee5\u5199\u4e2a\u811a\u672c\u6279\u91cf\u91cd\u65b0\u7f16\u8bd1\u5b83\u4eec\n#\u73b0\u5728\u4f60\u7684ports\u5b89\u88c5\u7684\u8f6f\u4ef6\u5df2\u7ecf\u662f\u6700\u65b0\u7684\u4e86\uff0c\u5c31\u53ef\u4ee5\u653e\u5fc3\u7684\u66f4\u65b0\u4e8c\u8fdb\u5236\u5305\u4e86\n$ sudo pkg upgrade\n</code></pre> <p>\u4ece\u6e90\u7801\u5347\u7ea7\u6240\u6709ports\u8f6f\u4ef6\u7684\u53e6\u4e00\u4e2a\u7b80\u5355\u529e\u6cd5\u662f\u7b2c3\u8282\u4ecb\u7ecd\u7684<code>portupgrade</code>\u7a0b\u5e8f\uff0c\u5b83\u63d0\u4f9b\u4e86<code>portsclean</code>\u547d\u4ee4\u6e05\u7a7a\u4e34\u65f6\u6587\u4ef6\uff0c\u4f46\u66f4\u91cd\u8981\u7684\u529f\u80fd\u662f\u66f4\u65b0ports\u8f6f\u4ef6\u5305\u3002\u66f4\u65b0\u4e4b\u524d\uff0c\u5f3a\u70c8\u5efa\u8bae\u7528<code>pkgdb -F</code>\u547d\u4ee4\u626b\u63cf\u5df2\u5b89\u88c5\u7684ports\u5e76\u6839\u636e\u63d0\u793a\u4fee\u590d\u6240\u6709\u4e0d\u4e00\u81f4\u7684\u8f6f\u4ef6\u5305\uff0c\u7136\u540e\u518d\u8fdb\u884cports\u8f6f\u4ef6\u5347\u7ea7\uff0c\u547d\u4ee4\u4e3a\uff1a <pre><code># -a\u53c2\u6570\u8868\u793a\u5347\u7ea7\u6240\u6709\u7cfb\u7edf\u5b89\u88c5\u7684\u53ef\u5347\u7ea7ports\uff0c\n# -i\u547d\u4ee4\u8868\u793a\u6bcf\u4e2a\u8f6f\u4ef6\u5305\u9700\u8981\u7528\u6237\u4ea4\u4e92\u786e\u8ba4\u3002\n$ sudo portupgrade -ai\n</code></pre></p> <p>\u82e5\u60f3\u5355\u72ec\u5347\u7ea7\u67d0\u4e2a\u7279\u5b9a\u7684\u8f6f\u4ef6\u5305\uff08\u5982firefox\uff09\uff0c\u9700\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a  </p> <pre><code># -R\u53c2\u6570\u8868\u793a\u9996\u5148\u5347\u7ea7\u8be5\u8f6f\u4ef6\u7684\u4f9d\u8d56\u5305\n$ sudo portupgrade -R firefox \n</code></pre> <p>\u5047\u8bbe\u672c\u673a\u5668\u7528pkg\u65b9\u5f0f\u5b89\u88c5\u4e86\u4e00\u4e9b\u8f6f\u4ef6\uff0c\u7528ports\u65b9\u5f0f\u5b89\u88c5\u4e86\u5176\u5b83\u8f6f\u4ef6\uff0c\u90a3\u4e48\u6bd4\u8f83\u63a8\u8350\u7684\u5347\u7ea7\u65b9\u6cd5\u662f\uff1a <pre><code>#\u5f53\u7136\u5982\u679c\u4f60\u662f\u771f\u7537\u4eba\uff0c\u5b8c\u5168\u53ef\u4ee5\u76f4\u63a5-a\uff0c\u57fa\u548c\u8c10\u4f6c\u624d\u7528-i\n$ sudo portupgrade -ai\n#\u82e5ports\u5347\u7ea7\u6210\u529f\u540e\u518d\u8fdb\u884c\u4e8c\u8fdb\u5236\u5b89\u88c5\u7684\u8f6f\u4ef6\u66f4\u65b0\n$ sudo pkg upgrade\n</code></pre></p>"},{"location":"markdown/freebsd_update_14/","title":"\u4ece\u6e90\u4ee3\u7801\u5347\u7ea7FreeBSD\u523014.0\u7248\u672c","text":"<p>FreeBSD 14.0\u6b63\u5f0f\u7248\u53d1\u5e03\u4e86\uff0c\u6211\u539f\u6765\u4e00\u76f4\u7528<code>freebsd-update</code>\u4e8c\u8fdb\u5236\u5347\u7ea7\u5de5\u5177\u3002\u6709\u53f0\u673a\u5668\u57282020\u5e74\u521d\u5b89\u88c5FreeBSD 11.0\uff0c\u4e00\u76f4\u5347\u7ea7\u523013.2\uff0c\u5e76\u6ca1\u51fa\u73b0\u4ec0\u4e48\u95ee\u9898\u3002 \u4e8e\u662f\u80c6\u5b50\u80a5\u4e86\uff0c\u5c1d\u8bd5\u4e86\u4e00\u628a\u4ece\u6e90\u4ee3\u7801\u5347\u7ea7\uff0c\u770b\u770b\u4f1a\u4e0d\u4f1a\u4f5c\u6b7b\uff0c\u7ed3\u679c\u5dee\u70b9\u55dd\u5c41\u3002\u5e78\u597d\u547d\u5927\uff0c\u62a2\u6551\u56de\u6765\u4e86\uff0c\u771f\u662f\u795e\u7075\u5e87\u4f51\u3002 \u4e8e\u662f\u8bb0\u4e2a\u7b14\u8bb0\uff0c\u9996\u5148\u658b\u6212\u6c90\u6d74\uff0c\u5ff5\u8bf5\u4e09\u904d\u771f\u8a00\uff1a\u5357\u65e0\u52a0\u7279\u6797\u83e9\u8428\uff0c\u5357\u65e0\u9a6c\u514b\u6c81\u83e9\u8428\uff0c\u5357\u65e0\u963f\u5361\u56db\u4e03\u83e9\u8428\u3002\u5584\u54c9\uff0c\u5584\u54c9\uff01</p>"},{"location":"markdown/freebsd_update_14/#1","title":"1. \u51c6\u5907\u597d\u6e90\u4ee3\u7801","text":"<p>\u5207\u6362\u5230root\u7528\u6237\uff0c\u5c06FreeBSD\u4ee3\u7801\u6811\u5207\u6362\u523014.0\u5206\u652f\u3002\u5982\u679c\u4e00\u76f4\u6ca1\u6709\u7f16\u8bd1\u8fc7\u5185\u6838\u548c\u57fa\u672c\u7cfb\u7edf\uff0c\u5219\u5148\u9700\u8981\u8fdb\u884c\u4ee5\u4e0b\u5de5\u4f5c\uff1a  </p> <pre><code>$ cd /usr/src  #\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u76ee\u5f55\u5c31\u5efa\u7acb\u4e00\u4e2a\n$ git clone --branch releng/14.0 https://git.FreeBSD.org/src.git /usr/src \n...\n$ git remote --v  #\u786e\u8ba4\u6e90\u7801\u8fdc\u7a0b\u4ed3\u6b63\u5e38\norigin  https://git.FreeBSD.org/src.git (fetch)\norigin  https://git.FreeBSD.org/src.git (push)\n</code></pre> <p>\u5982\u679c\u6e90\u4ee3\u7801\u5df2\u88ab\u6b63\u5e38\u514b\u9686\u5230\u672c\u5730\uff0c\u4f7f\u7528<code>git branch</code>\u547d\u4ee4\uff0c\u786e\u8ba4\u672c\u5730\u5f53\u524d\u5206\u652f\u4e3a<code>releng/14.0</code>\uff1a  </p> <pre><code>$ git branch\n* releng/14.0\n</code></pre> <p>\u82e5<code>/usr/src</code>\u76ee\u5f55\u4e0b\u5df2\u7ecf\u6709\u8001\u7248\u672c\u4ee3\u7801\uff0c\u5219\u9700\u8981\u4ece\u8fdc\u7a0b\u4e0b\u8f7d14.0\u5206\u652f\uff0c\u5e76\u628a\u672c\u673a\u5206\u652f\u5207\u6362\u4e3a<code>releng/14.0</code>\uff0c\u5982\u4e0b\uff1a  </p> <pre><code>$ cd /usr/src\n$ git fetch origin releng/14.0 #\u4e0b\u8f7d\u8fdc\u7a0b\u5206\u652f\n$ git checkout releng/14.0     #\u5207\u6362\u672c\u5730\u5206\u652f\u4e3areleng/14.0\n$ git branch     \n  releng/13.2\n* releng/14.0\n</code></pre> <p>\u5410\u69fd\uff1aFreeBSD\u8001\u559c\u6b22\u641e\u4e9b\u83ab\u540d\u5176\u5999\u7684\u540d\u5b57\uff0creleng/14.0\u7684\u610f\u601d\u662f14.0-RELEASE\u7248\u672c\uff0cstable/14.0\u7684\u610f\u601d\u662f14.0-STABLE\u7248\u672c\uff0cmain\u7684\u610f\u601d\u662f\u5f53\u524d\u6700\u65b0\u5f00\u53d1\u7248\u672c\uff0c\u8b6c\u598214-CURRENT\u3002RELEASE\u548cSTABLE\u7684\u4e3b\u8981\u533a\u522b\u5728\u4e8e\uff1aRELEASE\u7684ABI\uff08\u5e94\u7528\u7a0b\u5e8f\u4e8c\u8fdb\u5236\u63a5\u53e3\uff09\u4f1a\u6539\u53d8\uff0c\u800cSTABLE\u4e0d\u4f1a\uff0c10.0-STABLE\u4e0b\u7f16\u8bd1\u7684\u7a0b\u5e8f\u5305\u572810.1-STABLE\u4e0b\u4ecd\u7136\u53ef\u4ee5\u8fd0\u884c\uff0c\u4e0d\u7528\u91cd\u65b0\u7f16\u8bd1\u3002\u7136\u9e45\uff0c\u8fd9\u90fd\u4e0d\u91cd\u8981\uff0c\u95ee\u9898\u662f\u4e3a\u5565RELEASE\u7684\u4ee3\u7801\u5206\u652f\u662freleng,\u800c\u4e0d\u662frelease\uff1f</p> <p>\u5207\u6362\u5206\u652f\u6210\u529f\u540e\uff0c\u9700\u8981\u68c0\u67e5\u4e00\u4e0b<code>/usr/src/UPDATING</code>\u8fd9\u4e2a\u6587\u672c\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u786e\u8ba4\u91cc\u9762\u7684\u66f4\u65b0\u65e5\u5fd7\u7248\u672c\u53f7\u662f14.0\u3002</p>"},{"location":"markdown/freebsd_update_14/#2-140","title":"2. \u7f16\u8bd1\u57fa\u672c\u7cfb\u7edf\u548c14.0\u7684\u5185\u6838","text":"<p>FreeBSD\u4e0b\u7684\u57fa\u672c\u7cfb\u7edf\u53eb\u505a<code>world</code>\uff0c\u4e5f\u5c31\u662f<code>/bin</code>,<code>/sbin</code>,<code>/lib</code>\u4e0b\u90a3\u4e9b\u4e1c\u897f\uff0c\u800c\u7b2c\u4e09\u65b9\u7684\u8f6f\u4ef6\u4f1a\u653e\u5728<code>/usr/local/bin</code>\u3001<code>/usr/local/lib</code>\u7b49\u4e0b\u9762\u3002\u8fd9\u4e00\u70b9\u53cd\u6b63\u8981\u6bd4Linux\u5f3a\u4e9b\uff0cLinux\u5404\u5927\u53d1\u884c\u7248\u7684\u7a0b\u5e8f\u5404\u79cd\u4e71\u653e\uff0c\u5c31\u5f88\u65e0\u8bed\u3002 \u7f16\u8bd1\u57fa\u672c\u7cfb\u7edf\u548c\u5185\u6838\u7684\u547d\u4ee4\u4e5f\u5f88\u7b80\u5355\uff08<code>-j40</code>\u5f00\u5173\u7684\u610f\u601d\u662f\u752840\u4e2a\u903b\u8f91\u5185\u6838\u5e76\u884c\u52a0\u901f\uff09\uff1a  </p> <pre><code>$ cd /usr/src\n$ make -j40 buildworld    #\u7f16\u8bd1\u57fa\u672c\u7cfb\u7edf\n$ make -j40 buildkernel   #\u7f16\u8bd1\u65b0\u5185\u6838\n$ make -j40 installkernel #\u5b89\u88c5\u65b0\u5185\u6838\n</code></pre> <p>\u53d1\u884c\u6ce8\u8bb0\uff08https://freebsd.org/releases/14.0R/relnotes/\uff09\u91cc\u8bf4\u6700\u597d\u66f4\u65b0\u4e00\u4e0b<code>bootstrap</code>\u542f\u52a8\u5668\uff0c\u7531\u4e8e\u673a\u5668\u4e0d\u662fEFI\u542f\u52a8\u7684\uff0c\u4e14\u4f7f\u7528\u4e86\u4e24\u5feb\u786c\u76d8\u7684ZFS\u6587\u4ef6\u7cfb\u7edf\u3002\u6240\u4ee5\uff0c\u4fdd\u9669\u8d77\u89c1\uff0c\u9996\u5148\u67e5\u770b\u672c\u673a\u6240\u6709\u786c\u76d8\u7684\u5206\u533a\u60c5\u51b5\uff1a  </p> <pre><code>$ gpart show\n=&gt;        63  1953525105  da0  MBR  (932G)\n          63        1985       - free -  (993K)\n        2048     1024000    1  linux-data  (500M)\n     1026048  1952497664    2  linux-lvm  (931G)\n  1953523712        1456       - free -  (728K)\n\n=&gt;        40  1953525088  da1  GPT  (932G)\n          40        1024    1  freebsd-boot  (512K)\n        1064     8388608    2  freebsd-swap  (4.0G)\n     8389672  1945135456    3  freebsd-zfs  (928G)\n\n=&gt;        40  1953525088  da2  GPT  (932G)\n          40        1024    1  freebsd-boot  (512K)\n        1064     8388608    2  freebsd-swap  (4.0G)\n     8389672  1945135456    3  freebsd-zfs  (928G)\n\n=&gt;        63  1953525105  diskid/DISK-WD-WCAW35925714  MBR  (932G)\n          63        1985                               - free -  (993K)\n        2048     1024000                            1  linux-data  (500M)\n     1026048  1952497664                            2  linux-lvm  (931G)\n  1953523712        1456                               - free -  (728K)\n</code></pre> <p>\u8fd9\u8868\u793a\u6211\u7684\u4e24\u5757\u53cc\u4fdd\u9669\u7684\u955c\u50cfZFS\u786c\u76d8\u5206\u522b\u662f<code>da1</code>\u548c<code>da2</code>\uff0c\u4e3a\u4e86\u62c6\u6389\u4efb\u4f55\u4e00\u5757\u90fd\u80fd\u987a\u5229\u542f\u52a8\uff0c\u9700\u8981\u6267\u884c\u4e24\u6b21\u5199\u5165\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a  </p> <pre><code>$ gpart bootcode -b /boot/pmbr -p /boot/gptzfsboot -i 1 da1 #\u7b2c\u4e00\u5757\u786c\u76d8\n$ gpart bootcode -b /boot/pmbr -p /boot/gptzfsboot -i 1 da2 #\u7b2c\u4e8c\u5757\u786c\u76d8\n</code></pre> <p>\u7406\u8bba\u4e0a\uff0c\u91cd\u65b0\u542f\u52a8\u5230\u65b0\u5185\u6838\uff0c\u7136\u540e\u5e72\u5269\u4e0b\u7684\u4e8b\u60c5\u5373\u53ef\u3002\u4e8e\u662f\uff0c\u6211\u5f88\u81ea\u4fe1\u7684\u8f93\u5165\u547d\u4ee4\uff1a  </p> <pre><code>$ shutdown -r now\n</code></pre> <p>\u7ed3\u679c\u673a\u5668\u6109\u5feb\u7684\u91cd\u542f\uff0c\u8fdbBIOS\uff0c\u8fdb\u5165FreeBSD\u7684\u5c0f\u6076\u9b54LOGO\uff0c\u7136\u540e\u4e00\u987f\u9ed1\u6587\u5b57\u95ea\u8fc7\uff0c\u5361\u6b7b\u5728\u4e00\u4e2a\u9519\u8bef\u4e0a\u3002  </p> <pre><code>......\nModule kernel exists but with wrong version.\n</code></pre> <p>\u61f5\u903c\u4e86\uff0c\u51b7\u6c57\u90fd\u5413\u51fa\u6765\u4e00\u65a4\u3002\u5404\u79cd\u641c\u7d22\uff0c\u8c8c\u4f3c\u6709\u4eba\u8bf4\u9700\u8981\u628a\u539f13.2\u7684\u4e00\u4e9b\u542f\u52a8\u52a0\u8f7d\u7684\u6a21\u5757\u7ed9\u53d6\u6d88\u6389\u3002\u770b\u4f3c\u6709\u70b9\u9053\u7406\u3002\u4f46\u600e\u4e48\u8fdb\u5165\u7cfb\u7edf\u5462\uff1f\u6b64\u65f6\u6b64\u523b\uff0c\u5357\u65e0\u52a0\u7279\u6797\u83e9\u8428\u9644\u4f53\uff0c\u7a81\u7136\u60f3\u8d77\u6765\u5982\u679c\u7f16\u8bd1\u5185\u6838\u5931\u8d25\u65e7\u5185\u6838\u4ecd\u7136\u8fd8\u5728\u3002\u4e8e\u662f<code>CTRL+ALT+DEL</code>\u952e\u91cd\u65b0\u542f\u52a8\uff0c\u5230\u8fdb\u5165FreeBSD\u7684<code>bootloader</code>\u754c\u9762\u4e0b\u6309\u4e86\u4e2a<code>6</code>\uff0c\u9009\u62e9\u542f\u52a8<code>kernel</code>\u4e3a<code>kernel.old</code>\u3002\u7136\u540e\u5fd0\u5fd1\u7684\u7b49\u5f85\uff0c\u5fc3\u4e2d\u9ed8\u5ff5\uff0c\u5357\u65e0\u9a6c\u514b\u6c81\u83e9\u8428\u3002 \u5e78\u597d\uff0c\u987a\u5229\u8fdb\u516513.2\u7cfb\u7edf\u3002\u8d76\u7d27\u7f16\u8f91<code>/boot/loader.conf</code>\u6587\u4ef6\uff0c\u628a<code>nvidia-modeset_load=\u201cYES\u201d</code>\u7b49\u7b49\u4e0d\u76f8\u5e72\u7684\u6a21\u5757\u5168\u90e8\u7528<code>#</code>\u6ce8\u91ca\u6389\uff0c\u4e3a\u9632\u4e07\u4e00\u6211\u53c8\u91cd\u65b0\u7f16\u8bd1\u5e76\u5b89\u88c5\u4e86\u4e00\u6b21\u5185\u6838\uff1a  </p> <pre><code># \u7b49\u4ef7\u4e8e make -j40 buildkernel &amp;&amp; make -j40 installkernel\n$ cd /usr/src\n$ make -j40 kernel\n$ shutdown -r now\n</code></pre> <p>\u91cd\u542f\u673a\u5668\u4e4b\u540e\uff0c\u987a\u5229\u8fdb\u5165\u547d\u4ee4\u884c\u754c\u9762\uff0c<code>uname -a</code>\u4e00\u67e5\uff0c\u679c\u7136\u5185\u6838\u5df2\u7ecf\u662f14.0\u4e86\uff0c\u5357\u65e0\u963f\u5361\u56db\u4e03\u83e9\u8428\uff0c\u5584\u54c9\uff0c\u5584\u54c9\u3002  </p>"},{"location":"markdown/freebsd_update_14/#3","title":"3. \u5b89\u88c5\u65b0\u7684\u57fa\u672c\u7cfb\u7edf\u5e76\u66f4\u65b0\u914d\u7f6e\u6587\u4ef6","text":"<p>\u65e2\u7136\u65b0\u5185\u6838\u987a\u5229\u542f\u52a8\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u5c31\u5f88\u987a\u5229\u6210\u7ae0\uff1a  </p> <p><pre><code>$ etcupdate -p\n$ cd /usr/src\n$ make -j40 installworld\n$ etcupdate -B\n......\n</code></pre> \u7b49\u7b49\uff0c\u53c8\u51fa\u9519\u4e86\uff0c\u63d0\u793a\u914d\u7f6e\u6587\u4ef6\u51b2\u7a81\uff0c\u8fd9TM\u7684\uff0c\u53ea\u80fd\u4e00\u4e2a\u4e00\u4e2a\u5730\u67e5\u770b\uff1a  </p> <pre><code>$ etcupdate resolve\n......\n</code></pre> <p>\u7ed3\u679c\u53d1\u73b0\u4e3b\u8981\u662f/etc/master.passwd\u4ec0\u4e48\u4ec0\u4e48\u7684\u51e0\u4e2a\u6587\u4ef6\u51b2\u7a81\uff0c\u4f46\u662f\u6211\u4e00\u60f3\uff0c\u53cd\u6b63\u6709\u795e\u7075\u4fdd\u4f51\uff0c\u6015\u4e2a\u9524\u5b50\uff0c\u4e00\u5f8b<code>tf</code>\u63a5\u53d7\u65b0\u7248\u672c\u914d\u7f6e\u6587\u4ef6\u3002\u7136\u540e\u91cd\u542f\u3002 \u7136\u540e\u60b2\u5267\u53d1\u751f\u4e86\uff0c\u8fdb\u53bb\u4e00\u770b\uff0croot\u4e0d\u9700\u8981\u5bc6\u7801\u4e86\uff0c\u539f\u6765\u7684\u7528\u6237\u5168\u6d88\u5931\u4e86\u3002\u67e5\u4e86\u6587\u6863\u624d\u77e5\u9053\uff0c\u8c8c\u4f3c14.0\u9ed8\u8ba4\u7684root\u7528\u6237shell\u53d8\u4e3a<code>sh</code>\uff0c\u914d\u7f6e\u6587\u4ef6\u7684\u89c4\u5219\u53d1\u751f\u4e86\u4e0d\u77e5\u9053\u5565\u7684\u6539\u53d8\u3002 \u4e0d\u8fc7\u95ee\u9898\u4e0d\u5927\uff0c\u5148<code>passwd root</code>\u91cd\u65b0\u8bbe\u5b9a\u4e00\u4e0broot\u5bc6\u7801\uff0c\u7136\u540e\u7528<code>addusr</code>\u547d\u4ee4\u91cd\u65b0\u6dfb\u52a0\u4e00\u4e0b\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u4e14\u628a\u8be5\u7528\u6237\u7684<code>home</code>\u76ee\u5f55\u5173\u8054\u4e3a\u5df2\u6709\u7684\u540c\u540d\u76ee\u5f55\u3002\u91cd\u542f\u4e4b\u540e\u4e00\u5207\u6b63\u5e38\u3002\u867d\u7136\u53c8\u662f\u4e00\u65a4\u51b7\u6c57\uff0c\u7136\u9e45\u8c01\u53eb\u6211\u6709\u795e\u7075\u7737\u987e\u5462\u3002\u5357\u65e0\u52a0\u7279\u6797\u83e9\u8428\uff0c\u5357\u65e0\u9a6c\u514b\u6c81\u83e9\u8428\uff0c\u5357\u65e0\u963f\u5361\u56db\u4e03\u83e9\u8428\u3002\u5584\u54c9\uff0c\u5584\u54c9\uff01  </p> <p>\u5c0f\u8d34\u58eb\uff1aetcupdate resolve\u547d\u4ee4\u5bf9\u6709\u51b2\u7a81\u7684\u914d\u7f6e\u6587\u4ef6\u4f1a\u4e00\u4e2a\u4e00\u4e2a\u8be2\u95ee\uff0c\u8fd8\u662f\u8981\u4ed4\u7ec6\u770b\u770b\u54ea\u91cc\u6709\u4e0d\u540c\u7684\uff0c\u4e07\u4e00\u54ea\u5929\u4e09\u5927\u83e9\u8428\u5f00\u4f1a\u53bb\u4e86\uff0c\u6ca1\u987e\u5f97\u4e0a\u4fdd\u4f51\u4f60\uff0c\u90a3\u53ef\u5c31\u5b8c\u86cb\u4e86\uff0c\u5b81\u80af<code>p</code>\uff08\u4fdd\u7559\u4e0a\u4e2a\u7cfb\u7edf\u7684\u914d\u7f6e\uff0c\u4ee5\u540e\u518d\u5904\u7406\uff09\u3002\u4e5f\u4e0d\u8981<code>tf</code>\uff0c\u5207\u8bb0\uff0c\u5207\u8bb0\uff01\uff01\uff01 </p>"},{"location":"markdown/freebsd_update_14/#4","title":"4. \u6e05\u9664\u8fc7\u65f6\u6587\u4ef6\u548c\u5e93","text":"<p>\u987a\u5229\u91cd\u542f\uff0c\u786e\u8ba4\u7cfb\u7edf\u7248\u672c\u3001\u5185\u6838\u7248\u672c\uff0c\u5404\u79cd\u6b63\u5e38\u4e4b\u540e\uff0c\u68c0\u67e5\u7cfb\u7edf\u4e2d\u8fc7\u65f6\u7684\u6587\u4ef6\u548c\u5e93\uff1a  </p> <pre><code>$ cd /usr/src\n$ make check-old\n$ make delete-old\n......\n</code></pre> <p>\u7136\u540e\uff0cFreeBSD\u544a\u8bc9\u6211\u4ec0\u4e48\u53eb\u505a\u201c\u5b89\u5168\u201d\u3002\u4e00\u5806\u6587\u4ef6\uff0c\u6bcf\u4e2a\u90fd\u8981\u95ee\u6211\u662f\u5426\u786e\u8ba4\u5220\u9664\u3002\u8bdd\u8bf4\u54b1\u90fd\u95ef\u8fc7\u521a\u624d\u90a3\u4e2a\u5927\u98ce\u5927\u6d6a\u4e86\uff0c\u8fd8\u6015\u8fd9\u4e2a\uff1f\u95ee\u5565\uff1f\u95ee\u5c31\u662f\u5220\u9664\u554a\uff01\u96be\u9053\u4e00\u4e07\u4e2a\u6587\u4ef6\u6211\u8981\u6309\u4e00\u4e07\u4e2a<code>y</code>\u4e48\uff1f\u6012<code>CTRL+z</code>\u9000\u51fa\u3002\u7b49\u7b49\uff0c\u6279\u91cf\u56de\u7b54<code>yes</code>\u7684\u547d\u4ee4\u662f\u5565\u6765\u7740\uff1f\u8c8c\u4f3c\u662f<code>yes</code>\uff0c\u52a0\u4e2a\u7ba1\u9053\uff0c\u5982\u4e0b\uff1a  </p> <pre><code>$ yes | make delete-old\n......\n</code></pre> <p>\u5c45\u7136\u63d0\u793a\u6709\u51e0\u4e2a\u76ee\u5f55\u5220\u4e0d\u6389\uff0c\u518d<code>make check-old &amp;&amp; make delete-old</code>\u4e00\u6b21\uff0c\u8be1\u5f02\u7684\u662f\u8fd9\u56deOK\u4e86\u3002\u597d\u5427\uff0c\u5f88\u8be1\u5f02\u3002\u4e0d\u8fc7\u5357\u65e0\u52a0\u7279\u6797\u83e9\u8428\uff0c\u95ee\u9898\u4e0d\u5927\uff0c\u86e4\u86e4\uff01</p> <p>\u5c0f\u8d34\u58eb\uff1a\u67e5\u4e86FreeBSD\u6587\u6863\u624d\u77e5\u9053\uff0c\u6279\u91cf\u5f3a\u884c\u5220\u9664\u7684\u547d\u4ee4\u662f<code>make -DBATCH_DELETE_OLD_FILES delete-old</code>\uff0c\u53c8\u662f\u4e00\u65a4\u51b7\u6c57\u3002 </p> <p>\u7136\u540e\u518d\u5220\u9664\u8fc7\u65f6\u7684\u5e93\u6587\u4ef6\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a  </p> <pre><code>$ cd /usr/src\n$ make check-old-libs\n$ make delete-old-libs\n......\n</code></pre>"},{"location":"markdown/freebsd_update_14/#5-pkg","title":"5. \u91cd\u65b0\u5b89\u88c5pkg\u4ee5\u53ca\u5176\u5b83\u8f6f\u4ef6","text":"<p>\u56e0\u4e3a\u6211\u7684FreeBSD\u662fRELEASE\u7248\uff0c\u5927\u7248\u672c\u5347\u7ea7\u540e\u4e0d\u6ee1\u8db3ABI\u517c\u5bb9\uff0c\u6240\u4ee5\u4e0a\u4e00\u4e2a\u7248\u672c\u5df2\u7ecf\u5b89\u88c5\u7684\u6240\u6709\u975e\u57fa\u672c\u7cfb\u7edf\u7684\u8f6f\u4ef6\u5305\u90fd\u9700\u8981\u91cd\u65b0\u5b89\u88c5\u3002\u547d\u4ee4\u4e3a\uff1a  </p> <pre><code>$ pkg bootstrap -f  #\u91cd\u65b0\u4ece\u8fdc\u7a0b\u6e90\u5b89\u88c5pkg\u7a0b\u5e8f\n$ pkg update\n$ pkg upgrade\n......\n</code></pre> <p>\u66f4\u65b0\u4e861800\u591a\u4e2a\u8f6f\u4ef6\u5305\uff0c\u987a\u5229\u5b8c\u5de5\u3002\u628a<code>/boot/loader.conf</code>\u6587\u4ef6\u91cc\u6ce8\u91ca\u6389\u7684\u5185\u5bb9\u6062\u590d\uff0c\u7136\u540e\u91cd\u542f\uff08\u5728\u6b64\u4e4b\u524d\u6211\u8fd8\u7279\u5730\u4ece<code>ports</code>\u53c8\u5b89\u88c5\u4e86\u4e00\u904d<code>x11/nvidia-driver</code>\u9a71\u52a8\uff0c\u963f\u5f25\u9640\u4f5b\uff09\u3002\u5207\u6362\u5230\u666e\u901a\u7528\u6237\uff0c<code>startx</code>\u987a\u5229\u8fdb\u5165\u6109\u5feb\u7684<code>KDE Plasma</code>\u684c\u9762\u3002\u5b8c\u7f8e\u3002</p>"},{"location":"markdown/freebsd_update_14/#6","title":"6. \u6536\u5c3e\u53ca\u5410\u69fd","text":"<p>\u5269\u4e0b\u7684\u5de5\u4f5c\u5c31\u662f\u628a<code>/usr/src</code>\u7684\u8001\u7248\u672c\u5206\u652f\u7ed9\u5220\u4e86\uff0c<code>git branch -d releng/13.2</code>\u5373\u53ef\u3002\u5f53\u7136\uff0c\u571f\u8c6a\u968f\u610f\u3002 \u8bdd\u8bf4\u867d\u7136\u641e\u6210\u4e86\uff0c\u4f46\u8981\u4e0d\u662f\u4e09\u5927\u83e9\u8428\u4fdd\u4f51\uff0c\u6050\u6015\u53c8\u5f97\u4e0b\u8f7d\u4e00\u4e2aISO\u523b\u76d8\u91cd\u65b0\u5b89\u88c5\u4e86\uff0c\u51b7\u6c57again\u3002 \u770b\u6765Unix\u8840\u7edf\u7684\u64cd\u4f5c\u7cfb\u7edf\u6709\u4e00\u8bf4\u4e00\uff0c\u5168\u662f\u5404\u79cd\u5947\u602a\u95ee\u9898\uff0c\u5404\u79cd\u5751\u3002\u5fae\u8f6f\u771f\u662f\u4e00\u5bb6\u4f1f\u5927\u7684\u516c\u53f8\uff0c\u8bd5\u60f3windows update\u8981\u662f\u51fa\u73b0\u4ec0\u4e48ABI\u517c\u5bb9\u548ckernel\u7248\u672c\u9519\u8bef\u7684\u95ee\u9898\uff0c\u90a3\u5c31\u7b97\u5357\u65e0\u963f\u5e15\u5947\u83e9\u8428\u90fd\u4fdd\u4f51\u4e0d\u4e86\u4f60\u3002 \u4e0d\u7981\u60f3\u8d77\u4e00\u4e2a\u7b11\u8bdd\uff0c\u8bdd\u8bf4\u6709\u4e2aLinux\u9ad8\u624b\u53f7\u79f0\u201c\u8fd0\u7ef4\u4e4b\u9738\u201d\uff0c\u6bcf\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\u90fd\u9700\u8981\u81ea\u5df1\u786e\u8ba4\u4e00\u904d\u3002\u4f17\u6240\u5468\u77e5\uff0c\u8fd9\u4e2a\u529f\u80fd\u5728<code>rm</code>\u547d\u4ee4\u91cc\u9762\u8981\u7528<code>-i</code>\u53c2\u6570\u3002\u4e8e\u662f\u6709\u4e00\u5929\u4ed6\u81ea\u4fe1\u7684\u5728\u67d0\u4e2a\u63a7\u5236\u53f0\u4e0b\u8f93\u5165\uff1a  </p> <pre><code>rm * -i\n</code></pre> <p>\u7ed3\u679c\uff0c\u8fd9\u53f0FreeBSD\u670d\u52a1\u5668\u7ed9\u4ed6\u4e00\u4e2a\u56de\u7b54\uff1a  </p> <pre><code>-i: No such file or directory\n</code></pre> <p>\u60ca\u4e0d\u60ca\u559c\uff1f</p>"},{"location":"markdown/freebsd_zfs_copy_disk/","title":"ZFS\u5728\u7ebf\u66ff\u6362\u786c\u76d8","text":"<p>\u5b89\u88c5\u4e86Freebsd-12.1-RELEASE\uff0c\u53d1\u73b0\u786c\u76d8\u592a\u5c0f\uff0c\u4e14\u6709\u574f\u9053\uff0c\u60f3\u7528\u65b0\u76d8\u66ff\u6362\u3002 \u539f\u7cfb\u7edf\u7684\u786c\u76d8\u4fe1\u606f\u4e3a: <pre><code>&gt; gpart show /dev/diskid/DISK-4MT0PQB6\n=&gt;       40  312581728  diskid/DISK-4MT0PQB6  GPT  (149G)\n         40       1024                     1  freebsd-boot  (512K)\n       1064  304086016                     2  freebsd-zfs  (145G)\n  304087080    8388608                     3  freebsd-swap  (4.0G)\n  312475688     106080                        - free -  (52M)\n</code></pre> \u5728\u6211\u7684\u8ba1\u7b97\u673a\u4e0a\uff0c\u8001\u76d8\u662fDISK-4MT0PQB6\uff0c\u65b0\u76d8\u662fDISK-9QF4ATCW\u3002 \u4e00\u822cFreeBSD\u7cfb\u7edf\u7528<code>/dev/ada0</code>\u548c<code>/dev/ada1</code>\u4e4b\u7c7b\u7684\u8def\u5f84\u8868\u793a\u786c\u76d8\u3002\u4f46\u6211\u7684\u673a\u5668\u652f\u6301\u786c\u76d8\u70ed\u63d2\u62d4\uff0c\u4e14\u7ecf\u5e38\u56e0\u624b\u8d31\u5404\u79cd\u6363\u9f13\uff0c\u786c\u76d8\u4f4d\u53ef\u80fd\u4f1a\u6539\u53d8\uff0c\u6240\u4ee5\u7528<code>/dev/diskid/...</code>\u7684\u65b9\u5f0f\u66f4\u4fdd\u9669\u3002 \u5f53\u7136\u8fd8\u53ef\u4ee5\u7528disklabel\u547d\u4ee4\u7ed9\u6bcf\u5757\u786c\u76d8\u53d6\u4e2a\u540d\u5b57\u5e76\u4e14\u8d34\u4e0a\u6807\u7b7e\u3002\u56e0\u6682\u65f6\u6211\u53ea\u6709\u4e24\u5757\u786c\u76d8\uff0c\u8fd8\u65e0\u9700\u7b80\u5355\u95ee\u9898\u590d\u6742\u5316\u3002  </p> <p>\u73b0\u5728\u6709\u4e00\u5757\u65b0\u786c\u76d8(DISK-9QF4ATCW)\uff0c\u9700\u683c\u6389\u539f\u6765\u7684windows\u5206\u533a\uff0c\u5efa\u7acb\u548cDISK-4MT0PQB6\u4e00\u6837\u7684\u5206\u533a\u8868\u3002 \u6839\u5206\u533a\u548c\u8fd9\u5757\u76d8\u505a\u6210mirror\u5373\u53ef\u81ea\u52a8\u540c\u6b65\u3002 \u540c\u6b65\u5b8c\u6bd5\u540e\u5bf9\u65b0\u76d8\u7684freebsd-boot\u5206\u533a\u5199\u5165\u542f\u52a8\u9879\u3002 \u6700\u540e\u5bf9\u65b0\u78c1\u76d8\u6269\u5bb9\u3002</p> <p>\u7531\u4e8e\u8001\u78c1\u76d8\u7684freebsd-swap\u5728\u7b2c3\u4e2a\u5206\u533a\uff0cfreebsd-zfs\u548cfree\u7684\u78c1\u76d8\u7a7a\u95f4\u4e0d\u8fde\u7eed\uff0c\u4e3a\u6269\u5bb9\u65b9\u4fbf\uff0c\u65b0\u78c1\u76d8\u7684\u5206\u533a\u683c\u5f0f\u6700\u597d\u662f\u50cf\u4e0b\u9762\u8fd9\u6837\u3002 ZFS\u5206\u533a\u548c\u8001\u76d8\u7684\u5927\u5c0f\u4e00\u6837\uff0c\u6240\u4ee5\u5728\u590d\u5236\u5b8c\u6bd5\u540e\u8fd8\u8981\u5bf9\u65b0\u76d8\u7684pool\u548c\u5206\u533a\u90fd\u8fdb\u884c\u6269\u5bb9\u3002 <pre><code>1  freebsd-boot  (512K)\n2  freebsd-swap  (4.0G)\n3  freebsd-zfs  (145G)\n    - free -  (84G)\n</code></pre></p> <p>\u5c0f\u8d34\u58eb\uff1a\u5efa\u8bae\u5b89\u88c5FreeBSD\u65f6\u628a\u53ef\u80fd\u9700\u8981\u6269\u5bb9\u7684freebsd-zfs\u683c\u5f0f\u5206\u533a\u653e\u5728\u5206\u533a\u8868\u7684\u6700\u540e\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#1","title":"1. \u65b0\u786c\u76d8\u5efa\u7acb\u5206\u533a\u8868","text":""},{"location":"markdown/freebsd_zfs_copy_disk/#11","title":"1.1 \u6e05\u9664\u65b0\u76d8\u7684\u5206\u533a","text":"<p><pre><code>&gt; gpart destroy -F /dev/diskid/DISK-9QF4ATCW\ndiskid/DISK-9QF4ATCW destroyed\n</code></pre> \u53c2\u6570<code>-F</code>\u4e3a\u5f3a\u884c\u62b9\u53bb\u5206\u533a\u8868\uff0c\u5982\u679c\u786c\u76d8\u539f\u6765\u88ab\u6302\u8f7d\u8fc7\uff0c\u4e0d\u52a0\u6b64\u53c2\u6570\u53ef\u80fd\u4f1a\u663e\u793aDevise Busy\u7684\u9519\u8bef\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#12-gpt","title":"1.2 \u8bbe\u7f6e\u78c1\u76d8\u4e3aGPT\u5206\u533a\u8868","text":"<p><pre><code>&gt; gpart create -s GPT /dev/diskid/DISK-9QF4ATCW\ndiskid/DISK-9QF4ATCW created\n</code></pre> \u5b89\u88c5\u4e00\u4e2a\u4fdd\u62a4\u6027\u7684MBR\u5217\u8868\uff0c\u8fd9\u6837\u65e0GPT\u652f\u6301\u7684BIOS\u4e5f\u80fd\u4ece\u672c\u78c1\u76d8\u542f\u52a8\uff1a</p> <pre><code>&gt; gpart bootcode -b /boot/pmbr /dev/diskid/DISK-9QF4ATCW\nbootcode written to diskid/DISK-9QF4ATCW\n</code></pre>"},{"location":"markdown/freebsd_zfs_copy_disk/#13-freebsd-boot","title":"1.3 \u5efa\u7acbfreebsd-boot\u5206\u533a","text":"<p>\u8be5\u5206\u533a\u5927\u5c0f\u4e3a1024K: <pre><code>&gt; gpart add -b 40 -s 1024 -t freebsd-boot /dev/diskid/DISK-9QF4ATCW\ndiskid/DISK-9QF4ATCWp1 added\n&gt; gpart bootcode -p /boot/gptboot -i 1 /dev/diskid/DISK-9QF4ATCW\npartcode written to diskid/DISK-9QF4ATCWp1\n</code></pre></p>"},{"location":"markdown/freebsd_zfs_copy_disk/#14-swap","title":"1.4 \u5efa\u7acbswap\u5206\u533a","text":"<p>\u4e3a\u548c\u8001\u78c1\u76d8\u4e00\u81f4\uff0c\u8fd9\u91cc\u4e5f\u5efa\u7acb\u4e00\u4e2a4GB\u7684swap\u5206\u533a\uff0c\u4f46\u5b8c\u5168\u53ef\u4ee5\u5206\u5f97\u66f4\u5927\u6216\u66f4\u5c0f: <pre><code>&gt; gpart add -s 4G -t freebsd-swap /dev/diskid/DISK-9QF4ATCW\ndiskid/DISK-9QF4ATCWp2 added\n</code></pre></p>"},{"location":"markdown/freebsd_zfs_copy_disk/#15-zfs","title":"1.5 \u5efa\u7acb\u7528\u4e8e\u540c\u6b65\u6839\u76ee\u5f55\u7684zfs\u5206\u533a","text":"<p><pre><code>&gt; gpart add -s 145G -t freebsd-zfs /dev/diskid/DISK-9QF4ATCW\ndiskid/DISK-9QF4ATCWp3 added\n</code></pre> \u65b0\u76d8\u5206\u533a\u5b8c\u6bd5\u4e4b\u540e\uff0c\u68c0\u67e5\u662f\u5426\u6b63\u786e\uff1a</p> <p><pre><code>&gt; gpart show /dev/diskid/DISK-9QF4ATCW\n=&gt;       40  488397088  diskid/DISK-9QF4ATCW  GPT  (233G)\n         40       1024                     1  freebsd-boot  (512K)\n       1064    8388608                     2  freebsd-swap  (4.0G)\n    8389672  304087040                     3  freebsd-zfs  (145G)\n  312476712  175920416                        - free -  (84G)\n</code></pre> \u8fd9\u91cc\u7b2c3\u4e2a\u5206\u533a\u7684\u5927\u5c0f\u548c\u8001\u78c1\u76d8\u7684\u7b2c\u4e8c\u4e2a\u5206\u533a\u4e00\u6837\uff0c\u4f5c\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u6839\u5206\u533a\u7684\u955c\u50cf\u3002 \u7406\u8bba\u4e0a\u65b0\u76d8\u7684\u6839\u5206\u533a\u4e5f\u53ef\u4ee5\u548c\u8001\u76d8\u4e0d\u4e00\u81f4\uff0c\u8fd9\u6837zpool\u540c\u6b65\u5b8c\u6210\u540e\u65e0\u9700\u8fdb\u884cresize\u64cd\u4f5c\uff0c\u4e0d\u8fc7\u8003\u8651\u5230\u201c\u5728unix\u4e0b\u4ec0\u4e48\u7cdf\u7cd5\u7684\u60c5\u51b5\u90fd\u6709\u53ef\u80fd\u53d1\u751f\u201d\uff0c\u6211\u91c7\u7528\u6700\u4fdd\u9669\u7684\u7b56\u7565\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#2-zpool","title":"2. \u5b58\u50a8\u6c60\uff08zpool\uff09\u540c\u6b65","text":""},{"location":"markdown/freebsd_zfs_copy_disk/#21-zpool","title":"2.1 \u68c0\u67e5\u64cd\u4f5c\u7cfb\u7edfzpool","text":"<p>\u5982\u679cFreebsd\u5b89\u88c5\u5728ZFS\u5206\u533a\u4e0a\uff0c\u9ed8\u8ba4\u4f1a\u6709\u4e00\u4e2a\u540d\u4e3aroot\u7684zpool\uff0c\u800c\u5728\u7ebf\u955c\u50cf\u590d\u5236\u9700\u5c06\u65b0\u76d8\u4f5c\u4e3amirror\u52a0\u5165root\u5b58\u50a8\u6c60\u3002 <pre><code>&gt; zpool list\nNAME   SIZE  ALLOC   FREE  CKPOINT  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT\nroot   144G   117G  27.0G        -         -    39%    81%  1.00x  ONLINE  -\n</code></pre> \u67e5\u770broot\u5b58\u50a8\u6c60\u7684\u72b6\u6001\uff1a <pre><code>&gt; zpool status root\n  pool: root\n state: ONLINE\n  scan: resilvered 117G in 0 days 01:00:06 with 0 errors on Wed May 20 07:56:42 2020\nconfig:\n\n    NAME                      STATE     READ WRITE CKSUM\n    root                      ONLINE       0     0     0\n      diskid/DISK-4MT0PQB6p2  ONLINE       0     0     0\n\nerrors: No known data errors\n</code></pre> \u4ee5\u4e0a\u663e\u793a<code>pool: root</code>\u4e0b\u53ea\u6709\u8001\u78c1\u76d8\u7684\u7b2c2\u5206\u533a\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#22","title":"2.2 \u589e\u52a0\u786c\u76d8\u955c\u50cf","text":"<p>\u5c06\u65b0\u78c1\u76d8\u7684\u7b2c3\u5206\u533a\u4f5c\u4e3a\u955c\u50cfattach\u5230root\u5b58\u50a8\u6c60\u91cc\uff1a <pre><code>&gt; zpool attach root /dev/diskid/DISK-4MT0PQB6p2 /dev/diskid/DISK-9QF4ATCWp3\n</code></pre> \u4ee5\u4e0a\u547d\u4ee4\u628a\u65b0\u78c1\u76d8\u7684\u7b2c3\u5206\u533a\u548c\u8001\u78c1\u76d8\u7684\u7b2c2\u5206\u533a\u4f5c\u4e3a\u955c\u50cf\u3002\u7b49\u4ef7\u4e8e\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u6839\u5206\u533a\u4f5cRAID-1\uff0c\u4e0d\u540c\u7684\u662fZFS\u65e0\u9700RAID\u5361\uff0c\u6240\u6709\u8fc7\u7a0b\u90fd\u662f\u81ea\u52a8\u7684\u8f6f\u64cd\u4f5c\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#23-zpool","title":"2.3 \u67e5\u770bzpool\u72b6\u6001","text":"<p><pre><code>&gt; zpool status root\n  pool: root\n state: ONLINE\nstatus: One or more devices is currently being resilvered.  The pool will\n    continue to function, possibly in a degraded state.\naction: Wait for the resilver to complete.\n  scan: resilver in progress since Wed May 20 08:14:26 2020\n    117G scanned at 1.48G/s, 849M issued at 10.7M/s, 117G total\n    840M resilvered, 0.71% done, 0 days 03:04:58 to go\nconfig:\n\n    NAME                        STATE     READ WRITE CKSUM\n    root                        ONLINE       0     0     0\n      mirror-0                  ONLINE       0     0     0\n        diskid/DISK-4MT0PQB6p2  ONLINE       0     0     0\n        diskid/DISK-9QF4ATCWp3  ONLINE       0     0     0\n\nerrors: No known data errors\n</code></pre> \u4ee5\u4e0a\u8868\u660e\u4e24\u5757\u786c\u76d8\u7684\u4e24\u4e2a\u6839\u5206\u533a\u5df2\u5efa\u7acb\u955c\u50cf\u6a21\u5f0f\uff0c\u6570\u636e\u4f1a\u81ea\u52a8\u540c\u6b65\u5230\u65b0\u76d8\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#24-zpool","title":"2.4 \u7ee7\u7eed\u67e5\u770bzpool\u72b6\u6001","text":"<p><pre><code>&gt; zpool status root\n pool: root\n state: ONLINE\n  scan: resilvered 117G in 0 days 01:00:53 with 0 errors on Wed May 20 03:01:06 2020\nconfig:\n\n    NAME                        STATE     READ WRITE CKSUM\n    root                        ONLINE       0     0     0\n      mirror-0                  ONLINE       0     0     0\n        diskid/DISK-4MT0PQB6p2  ONLINE       0     0     0\n        diskid/DISK-9QF4ATCWp3  ONLINE       0     0     0\n\nerrors: No known data errors\n</code></pre> \u4ee5\u4e0a\u663e\u793a\u5df2\u540c\u6b65117G\u7684\u6570\u636e\uff0c\u540c\u6b65\u5b8c\u6210\uff0c\u65e0\u9519\u8bef\u53d1\u751f\u3002\u6b64\u65f6\u53ef\u7528\u7ca4\u8bed\u543c\u4e00\u58f0\u201c\u597d\u5f69\u201d...... </p>"},{"location":"markdown/freebsd_zfs_copy_disk/#25","title":"2.5 \u5728\u65b0\u78c1\u76d8\u542f\u52a8\u5206\u533a\u5199\u5165\u542f\u52a8\u4ee3\u7801","text":"<p><pre><code>&gt; gpart bootcode -b /boot/pmbr -p /boot/gptzfsboot -i 1 /dev/diskid/DISK-9QF4ATCW \npartcode written to diskid/DISK-9QF4ATCWp1\nbootcode written to diskid/DISK-9QF4ATCW\n</code></pre> \u53c2\u6570<code>-i 1</code>\u8868\u793a\u542f\u52a8\u4ee3\u7801\u5199\u5165DISK-9QF4ATCW\u7684\u7b2c1\u5206\u533a\uff0c\u5373freebsd-boot\u5206\u533a\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#26-root","title":"2.6 \u5728root\u5b58\u50a8\u6c60\u91cc\u5220\u6389\u8001\u78c1\u76d8","text":"<p><pre><code>&gt; zpool detach root /dev/diskid/DISK-4MT0PQB6p2\n</code></pre> \u82e5\u547d\u4ee4\u884c\u65e0\u9519\u8bef\u4fe1\u606f\u63d0\u793a\uff0c\u6b64\u65f6\u5373\u53ef\u62d4\u6389\u8001\u78c1\u76d8\uff08\u786e\u8ba4\u4f60\u7684\u673a\u5668\u652f\u6301\u70ed\u63d2\u62d4\uff09\u3002</p>"},{"location":"markdown/freebsd_zfs_copy_disk/#3","title":"3. \u65b0\u78c1\u76d8\u6269\u5bb9","text":""},{"location":"markdown/freebsd_zfs_copy_disk/#31-freebsd-root","title":"3.1 \u5c06freebsd-root\u5206\u533a\u6269\u5bb9","text":"<p>\u7531\u4e8e\u65b0\u78c1\u76d8\u7684ZFS\u6839\u5206\u533a\u5728\u6700\u540e\uff0c\u5206\u533a\u6269\u5bb9\u975e\u5e38\u65b9\u4fbf: <pre><code>&gt; gpart resize -i 3 /dev/diskid/DISK-9QF4ATCWp3\ndiskid/DISK-9QF4ATCWp3 resized\n&gt; gpart show /dev/diskid/DISK-9QF4ATCW\n=&gt;       40  488397088  diskid/DISK-9QF4ATCW  GPT  (233G)\n         40       1024                     1  freebsd-boot  (512K)\n       1064    8388608                     2  freebsd-swap  (4.0G)\n    8389672  480007456                     3  freebsd-zfs  (229G)\n</code></pre></p>"},{"location":"markdown/freebsd_zfs_copy_disk/#32-root","title":"3.2 \u5c06root\u5b58\u50a8\u6c60\u6269\u5bb9","text":"<p>\u867d\u7136\u65b0\u78c1\u76d8\u7684\u5bb9\u91cf\u5df2\u6269\u5927\u4e3a229G\uff0c\u4f46\u64cd\u4f5c\u7cfb\u7edf\u7684root\u5b58\u50a8\u6c60\u4ecd\u7136\u662f\u8001\u7cfb\u7edf\u7684114G\uff0c\u5982\u4e0b\uff1a <pre><code>&gt; zpool list\nNAME   SIZE  ALLOC   FREE  CKPOINT  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT\nroot   144G   117G  26.7G        -         -    40%    81%  1.00x  ONLINE  -\n</code></pre> \u6240\u4ee5\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u628aroot\u5b58\u50a8\u6c60\u6269\u5bb9: <pre><code>&gt; zpool online -e root /dev/diskid/DISK-9QF4ATCWp3\n</code></pre> \u7528\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5\u662f\u5426\u6269\u5bb9\u6210\u529f: <pre><code>&gt; zpool list\nNAME   SIZE  ALLOC   FREE  CKPOINT  EXPANDSZ   FRAG    CAP  DEDUP  HEALTH  ALTROOT\nroot   228G   117G   111G        -         -    25%    51%  1.00x  ONLINE  -\n</code></pre></p>"},{"location":"markdown/freebsd_zfs_copy_disk/#_1","title":"\u603b\u7ed3","text":"<p>\u5728ZFS\u4e0b\u5728\u7ebf\u6269\u5bb9\u6216\u66f4\u6362\u786c\u76d8\u975e\u5e38\u7b80\u5355\u3002\u786c\u76d8\u5206\u533a\u5e94\u5c3d\u91cf\u628a\u6570\u636e\u533a\u653e\u5728\u5206\u533a\u8868\u7684\u6700\u540e\u3002 \u4ee5\u4e0a\u66f4\u6362\u786c\u76d8\u7684\u65b9\u6cd5\u662f\u5229\u7528ZFS\u7684\u955c\u50cf\u529f\u80fd\u590d\u5236\u4e86\u6574\u4e2a\u6839\u5206\u533a\uff0c\u7136\u540e\u5728\u65b0\u786c\u76d8\u542f\u52a8\u5206\u533a\u4e2d\u5199\u5165\u542f\u52a8\u4ee3\u7801\u3002</p>"},{"location":"markdown/lisp_call_cc/","title":"Scheme\u8bed\u8a00\u7684call/cc","text":"<p>Scheme\u8bed\u8a00\u6709\u4e00\u4e2a\u975e\u5e38\u7279\u6b8a\u7684\u673a\u5236\uff0c\u5524\u4f5c<code>call/cc</code>\uff0c\u5b83\u53ef\u4ee5\u5728\u7a0b\u5e8f\u7684\u4efb\u610f\u4f4d\u7f6e\u5f97\u5230\u5176\u201c\u5ef6\u7eed\u201d\uff0c\u82f1\u6587\u662fcontinuation\u3002\u8fd9\u8d27\u7b80\u76f4\u662f\u8457\u540d\u7684brain fucker\uff0c\u6781\u5c3d\u7cbe\u5de7\u795e\u79d8\u4e4b\u80fd\u4e8b\uff0c\u636e\u8bf4\u7531\u6df7\u6c8c\u521d\u5f00\u4e4b\u65f6\u8fdc\u53e4\u8bf8\u795e\u7684\u795d\u798f\u800c\u751f\u3002 \u6211\u53ef\u4ee5\u5411\u4f60\u4fdd\u8bc1\uff0c\u5982\u679c\u4e0d\u5728\u7f16\u7a0b\u73af\u5883\u4e2d\u53cd\u590d\u6d4b\u8bd5\u548chacking\uff0c\u51e0\u4e4e\u6ca1\u6709\u4eba\u7c7b\u80fd\u4e00\u773c\u770b\u51fa\u8fd9\u4e2a\u4e1c\u897f\u7684\u6b63\u786e\u89e3\u91ca\u3002  </p>"},{"location":"markdown/lisp_call_cc/#1-continuation","title":"1. continuation\u5b9e\u4f8b","text":"<p>\u201c\u5ef6\u7eed\u201d\uff08continuation\uff09\u662f\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u7a0b\u5e8f\u63a7\u5236\u72b6\u6001\u7684\u4e00\u79cd\u62bd\u8c61\uff0c\u5b83\u53ef\u4ee5\u7528\u6570\u636e\u7ed3\u6784\u6216\u51fd\u6570\u8868\u793a\u3002\u5728C\u8bed\u8a00\u4e2d\uff0c\u8fd9\u4e00\u6570\u636e\u7ed3\u6784\u4e0d\u5141\u8bb8\u7a0b\u5e8f\u5458\u8bbf\u95ee\u548c\u4fee\u6539\uff0c\u800c\u67d0\u4e9bLisp\u65b9\u8a00\uff08\u5982Scheme\uff09\u5219\u53ef\u4ee5\u5728\u5916\u90e8\u663e\u5f0f\u7684\u64cd\u4f5c\u5b83\u4eec\uff0c\u4ece\u800c\u5e26\u6765\u4e86\u540e\u7eed\u4e00\u7cfb\u5217\u795e\u5947\u7684\u8774\u8776\u6548\u5e94\u3002 \u7a0d\u5fae\u66f4\u51c6\u786e\u7684\u8bf4\uff0c\u5728\u67d0\u4e2a\u7a0b\u5e8f\u4e2d\uff0c\u4efb\u610f\u4f4d\u7f6e\u7684continuation\u53ef\u89c6\u4e3a\u8ba1\u7b97\u673a\u5b8c\u6210\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u4e8b\u60c5\u4e4b\u540e\uff0c\u540e\u7eed\u9700\u8981\u505a\u7684\u4e8b\u60c5\u3002  </p> <p>\u5410\u69fd\uff1a\u8fd9\u4e2a\u4e1c\u897f\u540e\u4eba\u7ffb\u8bd1\u4e3a\u201c\u540e\u7eed\u201d\uff0c\u6709\u4eba\u4e3a\u4e86\u63d0\u5347\u683c\u8c03\u7ffb\u8bd1\u6210\u201c\u5ef6\u7eed\u201d\uff0c\u4f46\u603b\u89c9\u5f97\u5dee\u70b9\u610f\u601d\u3002 </p> <p>\u6bd4\u5982\uff0c\u6709\u4ee5\u4e0b\u8868\u8fbe\u5f0f\uff0c\u5b83\u5728C\u8bed\u8a00\u548cLisp\u8bed\u8a00\u4e0b\u7684\u8ba1\u7b97\u903b\u8f91\u5b8c\u5168\u76f8\u540c\uff1a <pre><code>(if (null? x)  ;\u5982\u679cx\u662f\u7a7a \n    '()        ;\u5219\u8fd4\u56de\u7a7a\u94fe\u8868\n    (cdr x))   ;\u5426\u5219\u8fd4\u56de\u53bb\u6389\u7b2c\u4e00\u4e2a\u5143\u7d20\u540e\u7684\u65b0\u94fe\u8868\n</code></pre></p> <p>\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u4efb\u610f\u4f4d\u7f6e\uff08\u4e5f\u5c31\u662f\u5b50\u8868\u8fbe\u5f0f\uff09\u7684continuation\u52a8\u4f5c\u53ef\u4ee5\u7528\u5f88\u7b80\u5355\u7684\u65b9\u5f0f\u53bb\u601d\u8003\uff0c\u6211\u4eec\u53ef\u4ee5\u7528<code>A</code>\u7b26\u53f7\u6765\u66ff\u6362\u6389\u8be5\u4f4d\u7f6e\u7684\u4ee3\u7801\uff0c\u90a3\u4e48\u5269\u4e0b\u6765\u8981\u8fdb\u884c\u7684\u8fd0\u7b97\u5c31\u662f\u5ef6\u7eed\uff0c\u5982\u4e0b\uff1a 1. <code>if</code>\u8bed\u53e5\u7684\u5ef6\u7eed\u53ef\u4ee5\u7406\u89e3\u4e3a<code>(A (null? x) '() (cdr x))</code>\uff1b 2. <code>(null? x)</code>\u7684\u5ef6\u7eed\u662f<code>(if A '() (cdr x))</code>\uff1b 3. <code>'()</code>\u7684\u5ef6\u7eed\u662f<code>(if (null? x) A (cdr x))</code>\uff1b 4. \u4ee5\u6b64\u7c7b\u63a8\u3002  </p> <p>\u5f88\u660e\u663e\uff0c\u5ef6\u7eed\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u66f4\u7cbe\u786e\u7684\u8868\u793a\u5982\u4e0b\uff1a <pre><code>;\u5728\u6ce8\u91ca\u4e2d\uff0c\u6211\u4eec\u7528C-x\u8868\u793ax\u7684continuation\n\n; C-if\n;  \u4f60\u53ef\u4ee5\u76f4\u63a5\u5728\u539f\u51fd\u6570\u91cc\u9762\u6316\u6389if\u7528k\u66ff\u4ee3\uff0c\u5f97\u5230(k (null? x) '() (cdr x))\uff0c\n;  \u7136\u540e\u518d\u5957\u4e00\u4e2alambda\u5373\u5f97\u5230\u8fd9\u4e2a\u51fd\u6570\u7684Lisp\u8868\u8fbe\u5f0f\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u672c\u8eab\u5c31\u662f\u4e00\u4e2aLisp\u51fd\u6570\n(lambda (k) \n  (k (null? x) '() (cdr x)))\n\n; C-(null? x)\n(lambda (k)\n  (if k '() (cdr x)))\n\n; C-'()\n(lambda (k)\n  (if (null? x) k (cdr x)))\n\n; C-'(cdr x)\n(lambda (k)\n  (if (null? x) '() k))\n\n; \u73a9\u70b9\u66f4\u9ad8\u7ea7\u7684\uff0cC-(null? x)\u8bed\u53e5\u4e2d\u7684x\n(lambda (k)\n  (if (null? k) '() (cdr x)))\n\n;C-(cdr x)\u8bed\u53e5\u4e2d\u7684x\n(lambda (k)\n  (if (null? x) '() (cdr k)))\n\n;C-cdr\n(lambda (k)\n  (if (null? x) '() (k x)))\n\n;......\n</code></pre></p> <p>\u6ca1\u9519\uff0c\u7528Lisp\u7684S\u8868\u8fbe\u5f0f\u4f7f\u5f97\u95ee\u9898\u66f4\u52a0\u7b80\u5355\uff0c\u5176\u5b9econtinuation\u5c31\u662f\u5728\u62bd\u8c61\u8bed\u6cd5\u6811\u4e2d\u5148\u6316\u6389\u5f53\u524d\u4f4d\u7f6e\uff0c\u7528\u53c2\u6570k\u66ff\u4ee3\uff0c\u7136\u540e\u5bf9\u66ff\u4ee3\u540e\u7684\u6811\u5957\u4e0a\u4e00\u4e2alambda\u6839\u8282\u70b9\uff0c\u4ece\u800c\u8ba9\u8fd9\u68f5\u6811\u53d8\u6210\u4e00\u4e2a\u65b0\u51fd\u6570\uff0c\u5c31\u8fd9\u4e48\u7b80\u5355\u3002C\u8bed\u8a00\u4e0b\u5b9e\u5728\u662f\u6ca1\u6cd5\u60f3\u51fa\u8fd9\u4e48\u76f4\u63a5\u7684\u89e3\u91ca\u3002 \u4f46\u65e0\u8bba\u5982\u4f55\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0ccontinuation\u7684\u6982\u5ff5\u5df2\u7ecf\u8db3\u591f\u6e05\u6670\u3002  </p>"},{"location":"markdown/lisp_call_cc/#2-callcc","title":"2. call/cc\u8bed\u53e5","text":"<p>\u5728C\u8bed\u8a00\u7b49\u4e00\u5927\u7968\u6469\u767b\u8bed\u8a00\u4e2d\uff0c\u4f60\u65e0\u6cd5\u64cd\u4f5c\u8fd9\u4e9b<code>C-k</code>\u7684\u51fd\u6570\u3002\u800c\u53e4\u8001\u7684Scheme\u8bed\u8a00\u63d0\u4f9b\u4e86\u4e00\u79cd\u53ef\u4ee5\u8c03\u7528\u5f53\u524d\u4f4d\u7f6e\u5ef6\u7eed(current continuation)\u7684\u51fd\u6570\uff0c\u53eb\u505a<code>call-with-current-continuation</code>\uff0c\u7b80\u79f0<code>call/cc</code>\u3002\u5b83\u53ef\u4ee5\u8ba9\u4f60\u5728\u7a0b\u5e8f\u7684\u4efb\u610f\u4f4d\u7f6e\u5f97\u5230continuation\uff0c\u8fdb\u800c\u521b\u9020\u5404\u79cd\u795e\u5947\u7684\u53ef\u80fd\u6027\u3002 <code>call/cc</code>\u7684\u8c03\u7528\u89c4\u5219\u662f<code>(call/cc f)</code>\uff0c\u5176\u4e2d<code>f</code>\u662f\u4e00\u4e2a\u5355\u53c2\u51fd\u6570\uff0c\u4e5f\u5c31\u662f<code>(call/cc (lambda (k) &lt;body&gt;)</code>\u3002\u4e00\u65e6\u7a0b\u5e8f\u4e2d\u67d0\u4e2a\u4f4d\u7f6e\u88ab\u8fd9\u6837\u7684\u8bed\u53e5\u5305\u88f9\u8d77\u6765\uff0c\u90a3\u4e48<code>k</code>\u4f1a\u7ed1\u5b9a\u4e3a\u5f53\u524d\u4f4d\u7f6e\u7684\u5ef6\u7eed\uff0c\u4e00\u65e6\u5728<code>&lt;body&gt;</code>\u4e2d\u5b58\u5728<code>(k value)</code>\u5f62\u5f0f\u7684\u8c03\u7528\uff0c\u7a0b\u5e8f\u4f1a\u8df3\u5230\u5916\u9762\u7684\u4e16\u754c\u3002 \u7f51\u4e0a\u5f88\u591a\u6559\u7a0b\u8bf4\u5b58\u5728<code>(k value)</code>\u8c03\u7528\u65f6\uff0c<code>call/cc</code>\u7684\u8fd4\u56de\u503c\u4e3a<code>value</code>\u3002\u4f46\u5b9e\u9645\u4e0a\u8fd9\u662f\u4e25\u91cd\u9519\u8bef\u7684\uff0c\u6b63\u786e\u89e3\u91ca\u9700\u8981\u4ece\u8c03\u7528\u6808\u601d\u8003\uff0c\u5f53\u4f60\u5185\u90e8\u8c03\u7528<code>(k value)</code>\u65f6\uff0cCPU\u4f1a\u7528\u5b83\u8986\u76d6\u6389\u6574\u4e2a\u8c03\u7528\u6808\uff0c\u770b\u8d77\u6765\u597d\u50cf\u4ece\u91cc\u9762\u7684\u4e16\u754c\u5f00\u4e86\u4e2a\u6d1e\uff0c\u76f4\u63a5\u8df3\u5230\u6700\u5916\u5c42\u3002  \u66f4\u7ec6\u8282\u4e00\u70b9\uff0c\u5728\u5f53\u524d\u8c03\u7528\u6808\u4e2d\u4e00\u65e6\u51fa\u73b0\u4e86<code>call/cc</code>\uff0c\u90a3\u4e48\u540e\u7eed\u884c\u4e3a\u4f1a\u88ab\u7ed1\u5b9a\u5230\u51fd\u6570<code>k</code>\uff0c\u7136\u540e\u5728\u8c03\u7528\u6808\u4e4b\u524d\u6dfb\u52a0<code>&lt;body&gt;</code>\u7684\u8c03\u7528\uff0c\u4e00\u65e6<code>&lt;body&gt;</code>\u4e2d\u6709\u4efb\u4f55\u5bf9<code>k</code>\u7684\u4f20\u53c2\u8fc7\u7a0b\uff0c\u5373<code>(k value)</code>\uff0c\u6267\u884c\u5b8c\u6bd5\u540e\u4f1a\u5ffd\u7565\u8c03\u7528\u6808\u540e\u7684\u4ee3\u7801\u76f4\u63a5\u8fd4\u56de\u5230\u4e0b\u4e00\u4e2a\u8c03\u7528\u6808\u3002\u6bd4\u5982\u8fd9\u6837\uff08\u6211\u4eec\u7528<code>&lt;=CPU</code>\u8868\u793a\u5f53\u524d\u6307\u4ee4\uff09\uff1a  <pre><code>;;\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7b49\u4ef7\u4e8e(+ 1 (* 5 3))\uff0c\u537316\n(+ 1 (* (call/cc (lambda (k) \n                     k      ;(call/cc (lambda (k) k 5)\u8fd4\u56de\u503c\u662f\n                     5)))   ;\u8fd9\u91cc\u7684\u6700\u540e\u4e00\u4e2a\u8bed\u53e5 5\n        3))\n\n;;\u6211\u4eec\u770b\u770b\u8c03\u7528\u6808\u4e00\u6b65\u6b65\u4f1a\u5982\u4f55\u6539\u53d8,\u4e00\u5f00\u59cb\u662f\n(+ 1 ???)           &lt;=CPU\n;;\u7136\u540e\u662f\ny = (* ??? 3)\n(+ 1 y)\n;;\u7136\u540e\u662f\nz = (call/cc ???)   &lt;=CPU\ny = (* z 3)\n(+ 1 y)\n;;\u73b0\u5728\u6765\u5230call/cc\u4e86\uff0c\u5b83\u9996\u5148\u8981\u5f97\u5230\u6808\u7a7a\u95f4\u540e\u7eed\u52a8\u4f5c\u7136\u540e\u7ed1\u5b9a\u7ed9k\n;;\u4e5f\u5c31\u662f\u8bf4k\u53d8\u6210\u4e86\u4e00\u4e2a\u51fd\u6570(lambda (x) (+ 1 (* x 3)))\n;;\u8fd9\u4e2a\u51fd\u6570\u5b58\u5728\u5806\u4e2d\uff0c\u51c6\u5907\u8c03\u7528\n;;\u7136\u540e\u8c03\u7528\u6808\u53d8\u6210\np = k               &lt;=CPU\np = 5\nz = p\ny = (* z 3)\n(+ 1 y)\n;;\u8c03\u7528\u6808\u5f00\u59cb\u7f29\u5c0f\nz = 5               &lt;=CPU\ny = (* z 3)\n(+ 1 y)\n;;\u5f88\u81ea\u7136\u7684\uff0c\u7ee7\u7eed\u7f29\u5c0f\ny = (* 5 3) = 15    &lt;=CPU\n(+ 1 y)\n;;\u6700\u540e\u53d8\u6210\n(+ 1 15) = 16\n\n;;\u73b0\u5728\u6211\u4eec\u770b\u4e00\u4e0b\u8868\u8fbe\u5f0f\u4e2d\u5b58\u5728(k value)\u8c03\u7528\u7684\u60c5\u51b5\n(+ 1 (* (call/cc (lambda (x) \n                     (x 2)  ;\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u8fd9\u91cc\n                     5)))   \n        3))\n\n;;\u8c03\u7528\u6808\u548c\u524d\u9762\u4e00\u5f00\u59cb\u662f\u5dee\u4e0d\u591a\u7684\nz = (call/cc ???)    &lt;=CPU\ny = (* z 3)\n(+ 1 y)\n;;\u8fd9\u91cc\u7684call/cc\u540c\u6837\u5728\u5806\u91cc\u751f\u6210\u4e86\u5ef6\u7eed\u51fd\u6570\n;;\u5373 k = (lambda (x) (+ 1 (* x 3)))\n;;\u5f53\u6267\u884c\u5230(k 2)\u65f6\uff0c\u6574\u4e2a\u540e\u7eed\u7684\u8c03\u7528\u6808\u4f1a\u88ab\u5168\u90e8\u6e05\u7a7a\np = (k 2)            &lt;=CPU\np = 5                ;\u540e\u7eed\u7684\u90fd\u6ca1\u7528\u4e86\nz = p\ny = (* z 3)\n(+ 1 y)\n;;\u76f4\u63a5\u4f1a\u53d8\u6362\u4e3a\n(k 2)                &lt;=CPU  ;\u5f53\u7136(k 2)\u4f1a\u5c55\u5f00\u65b0\u8c03\u7528\u6808\n;;\u5373\n(+ 1 (* 2 3)) ;\u8fd9\u91cc\u4e0d\u7528\u518d\u91cd\u590d\u5c55\u5f00\u4e86\uff0c\u663e\u7136\u662f\u7b49\u4e8e7\n</code></pre></p> <p>\u7f51\u4e0a\u5f88\u591a\u6559\u7a0b\u7684\u9519\u8bef\u5728\u4e8e\uff0c\u628a\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u9519\u8bef\u7684\u7406\u89e3\u4e3a\u5148<code>(k 2)</code>\u8fd4\u56de<code>2</code>\uff0c\u7136\u540e\u518d\u6267\u884c\u5916\u9762\u7684<code>(+ 1 (* (k 2) 3))</code>\u3002\u800c\u771f\u5b9e\u60c5\u51b5\u662f<code>(k 2)</code>\u7684\u503c\u6839\u672c\u5c31\u4e0d\u662f<code>2</code>\uff0c\u800c\u662f<code>7</code>\u3002 \u5177\u4f53\u6d41\u7a0b\u662f\u5148\u4ece\u5806\u91cc\u9762\u53d6<code>k</code>\u51fd\u6570\uff0c\u6c42\u503c\u540e\u76f4\u63a5\u8fd4\u56de<code>7</code>\uff0c\u7136\u540e\u6253\u5f00\u4e00\u4e2a\u866b\u6d1e\uff0c\u76f4\u63a5\u7a7f\u8d8a\u5230\u6574\u4e2a\u8868\u8fbe\u5f0f\u7684\u6700\u5916\u5c42\u4e4b\u5916\u3002\u6240\u8c13\u7684\u866b\u6d1e\u7a7f\u8d8a\uff0c\u5176\u5b9e\u5c31\u662f\u628a\u5916\u5c42\u7684<code>(+ 1 (* ### 3))</code>\u7b49\u4e00\u7cfb\u5217\u8c03\u7528\u6808\u5f3a\u884c\u6e05\u7a7a\uff0c\u5e76\u6ca1\u6709\u591a\u795e\u79d8\u3002  </p> <p>\u6ce8\u610f\uff1a\u4e00\u5b9a\u8981\u8bb0\u4f4f\uff0c\u4e00\u65e6\u67d0\u4e2a\u8868\u8fbe\u5f0f\u5185\u90e8<code>call/cc</code>\u8bed\u53e5\u4e2d\u5b58\u5728\u5176\u5ef6\u7eed\u51fd\u6570<code>k</code>\u7684\u8c03\u7528\uff0c\u5219\u4f1a\u76f4\u63a5\u8fd4\u56de\u8fd9\u4e2a\u8c03\u7528\u7684\u503c\uff0c\u7136\u540e\u5c31\u6ca1\u6709\u7136\u540e\u4e86\u3002 </p> <p>\u597d\u5427\uff0c\u73b0\u5728\u770b\u8d77\u6765\u5df2\u7ecf\u8db3\u591f\u70e7\u8111\u4e86\uff0c\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u7528\u7b80\u5355\u7684\u4f8b\u5b50\u52a0\u6df1\u7406\u89e3\uff1a  </p> <pre><code>(define x '(1 2 3 4 5))   ;\u5b9a\u4e49x\u662f\u94fe\u8868[1,2,3,4,5]\n(define func-k #f)        ;\u5728\u5916\u9762\u5b9a\u4e49func-k\u6765\u5b58\u50a8\u5ef6\u7eed\uff0c\u4e00\u5f00\u59cb\u521d\u59cb\u5316\u4e3aFalse\n\n(if (call/cc              ;call/cc\u5916\u9762\u7684\u4e1c\u897f\u662f(if A '() (cdr x)) \n      (lambda (k)         ;k\u4f1a\u7ed1\u5b9a\u5230(lambda (x) (if x '() (cdr x)))\n        (set! func-k k)   ;\u4e0a\u9762\u7684\u8fd9\u4e2a\u5ef6\u7eed\u51fd\u6570\u4f1a\u8d4b\u503c\u7ed9func-k\n        (null? x)))       ;\u6ca1\u6709\u770b\u5230(k value)\u7684\u8c03\u7528\uff0c\u81ea\u7136\u4f1a\u6267\u884c\u8fd9\u4e00\u884c\uff0c\n    '()                   ;\n    (cdr x))              ;\u663e\u7136x\u4e0d\u4e3a\u7a7a\uff0c\u6240\u4ee5\u5f97\u5230'(2 3 4 5)\n\n;\u5982\u679c\u4f60\u6267\u884c\u4e00\u6b21\u4ee5\u4e0a\u7684\u4ee3\u7801\uff0c\u90a3\u4e48\u5b83\u505a\u4e86\u4e24\u4ef6\u4e8b\n;1. \u6267\u884c\u539f\u51fd\u6570\uff0c\u8fd4\u56de'(2 3 4 5)\uff0c\u5373if\u8bed\u53e5\u7684False\u5206\u652f\n;2. func-k\u88ab\u7ed1\u5b9a\u4e3a (lambda (x) (if x '() (cdr x)))\u8fd9\u4e00\u5ef6\u7eed\u51fd\u6570\n\n;\u68c0\u9a8c\u4e00\u4e0b\n(func-k #t)\n;\u6b64\u65f6\u5e94\u8be5\u8fd4\u56de'()\n(func-k #f)\n;\u6b64\u65f6\u5e94\u8be5\u8fd4\u56de'(2 3 4 5)\n</code></pre> <p>\u590d\u6742\u4e00\u70b9\u7684<code>call/cc</code>\u5c31\u4e0d\u90a3\u4e48\u597d\u7406\u89e3\u4e86\uff0c\u6bd4\u5982\u4ee5\u4e0b\u7684\u7ecf\u5178\u8868\u8fbe\u5f0f\uff1a <pre><code>(let ([x (call/cc (lambda (k) k))])\n  (x (lambda (ignore) \"hi\")))\n\n;\u6267\u884c\u8fd9\u6761\u8bed\u53e5\u7684\u8f93\u51fa\u662f\"hi\"\uff0c\u4f46\u662f\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u5462\uff1f\u6211\u4eec\u6765\u4e00\u6b65\u6b65\u5206\u6790\uff0c\u9996\u5148\u4e0d\u59a8\u63ed\u5f00let\u5f97\u5230\n((call/cc (lambda (k) k))\n (lambda (ignore) \"hi\"))\n\n;\u5982\u679c\u7528A\u8868\u793a\u5f53\u524d\u4f4d\u7f6e\uff0c\u90a3\u4e48k\u7684\u884c\u4e3a\u662f(A (lambda (ignore) \"hi\"))\n;k\u7684\u503c\u662f\u51fd\u6570(lambda (x) (x (lambda (ignore) \"hi\")))\n;\u7531\u4e8ecall/cc\u5305\u88f9\u7684\u4f4d\u7f6e\u4e2d\u6ca1\u6709\u51fa\u73b0(k value)\u8fd9\u6837\u7684\u8c03\u7528\uff0c\u6240\u4ee5\u4e0d\u4f1a\u51fa\u73b0\u4e2d\u65ad\n((lambda (x) \n  (x (lambda (ignore) \"hi\")))\n (lambda (ignore) \"hi\"))\n\n;\u6c42\u503c\u65f6\u628ax\u66ff\u6362\u4e3a\u540e\u9762\u7684\u53c2\u6570\uff08\u5b83\u662f\u4e00\u4e2a\u51fd\u6570\uff09\uff0c\u5f97\u5230\n( (lambda (ignore) \"hi\")\n  (lambda (ignore) \"hi\") )\n\n;\u5982\u679c\u6211\u4eec\u5047\u8bbe(lambda (ignore) \"hi\")\u8fd9\u4e2a\u533f\u540d\u51fd\u6570\u662ff\n;\u90a3\u4e48(let ([x (call/cc (lambda (k) k))])\n;      (x f))\n;\u4f1a\u5f97\u5230(f f)\n\n;\u7531\u4e8ef\u662f\u4e00\u4e2a\u5bf9\u4e8e\u4efb\u610f\u53c2\u6570\u90fd\u4f1a\u8fd4\u56de\"hi\"\u7684\u51fd\u6570\uff0c\u6240\u4ee5(f f)\u7684\u8fd4\u56de\u503c\u662f\"hi\"\n</code></pre></p> <p>\u6216\u8bb8\u4f60\u6000\u7591\u4e0a\u9762\u63a8\u5bfc\u7684\u6b63\u786e\u6027\uff0c\u90a3\u4e0d\u59a8\u6309\u7167\u4f18\u5148\u8fdb\u884c<code>call/cc</code>\u5c55\u5f00\u7684\u987a\u5e8f\u518d\u63a8\u5bfc\u4e00\u6b21\uff1a <pre><code>(let ([x (call/cc (lambda (k) k))])\n  (x (lambda (ignore) \"hi\")))\n\n;\u9996\u5148\u5c55\u5f00call/cc\u6b64\u65f6k\u7684\u503c\u4e3a\n(lambda (p) \n  (let ([x p])\n    (x (lambda (ignore) \"hi\"))))\n\n;\u6b64\u65f6let\u8bed\u53e5\u4f1a\u628ax\u7ed1\u5b9a\u4e3a\u4e0a\u9762\u7684\u51fd\u6570\uff0c\u90a3\u4e48\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a\n( (lambda (p)\n    (let ([x p])\n      (x (lambda (ignore) \"hi\"))))  ;\u4e0a\u9762\u7684\u8fd9\u90e8\u5206\u662fx\n  (lambda (ignore) \"hi\"))\n\n;\u6211\u4eec\u628a\u4e0a\u9762\u7684x\u5316\u7b80\u5f97\u5230\n( (lambda (p)\n    (p (lambda (ignore) \"hi\")))\n  (lambda (ignore) \"hi\"))\n\n;\u5f88\u660e\u663e\uff0c\u66ff\u6362p\u8fdb\u884c\u6c42\u503c\u540e\u5f97\u5230\n((lambda (ignore) \"hi\")\n (lambda (ignore) \"hi\"))\n\n;\u7ed3\u8bba\u4e0d\u53d8\n</code></pre></p> <p>\u5230\u73b0\u5728\u4e3a\u6b62\uff0c\u6211\u4eec\u77e5\u9053\u4e86\u4ec0\u4e48\u53eb\u505acontinuation\uff0c\u5e76\u4e14\u77e5\u9053\u4e86<code>call/cc</code>\u8bed\u53e5\u7684\u7528\u6cd5\u3002\u4e0d\u8fc7\u76ee\u524d\u6240\u6709\u7684<code>(call/cc (lambda (k) &lt;body&gt;))</code>\u8c03\u7528\u4e2d\uff0c<code>&lt;body&gt;</code>\u91cc\u9762\u5c11\u6709<code>(k value)</code>\u7684\u8bed\u53e5\uff0c\u5176\u5b9e\u5229\u7528\u5b83\u4f1a\u4ea7\u751f\u5f88\u591a\u70e7\u8111\u4e14\u795e\u5947\u7684\u6548\u5e94\u3002  </p> <p>call/cc\u5b9a\u74061\uff1a(let ([x (call/cc (lambda (k) k))]) (x f)) \u7b49\u4ef7\u4e8e(f f)\u3002 call/cc\u5b9a\u74062\uff1a((call/cc (lambda (k) k)) f)) \u7b49\u4ef7\u4e8e(f f)\u3002 </p>"},{"location":"markdown/lisp_call_cc/#3-callcc","title":"3. call/cc\u7684\u5e94\u7528\u573a\u666f","text":""},{"location":"markdown/lisp_call_cc/#31-nonlocal-exits","title":"3.1 \u975e\u672c\u5730\u9000\u51fa(nonlocal exits)","text":"<p>Scheme\u8bed\u8a00\u91cc\u9762\u6ca1\u6709<code>break</code>\u6216<code>return</code>\u8bed\u53e5\uff0c\u5982\u679c\u4f60\u9700\u8981\u63d0\u524d\u8fd4\u56de\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u501f\u52a9<code>call/cc</code>\u3002\u9996\u5148\u770b\u4e00\u4e2a\u8d85\u7ea7\u7b80\u5355\u7684\u4f8b\u5b50\uff1a <pre><code>(define (f return)  ;\u5b9a\u4e49f\u662f\u4e00\u4e2a\u5355\u53c2\u51fd\u6570\uff0c\u53c2\u6570return\n  (return 2)        ;\u9996\u5148\u6267\u884c(return 2)\uff0c\n  3)                ;\u663e\u7136\uff0creturn\u4e5f\u5fc5\u987b\u662f\u4e00\u4e2a\u5355\u53c2\u51fd\u6570\n                    ;\u6700\u540e\u8fd4\u56de3\n\n;\u8fd9\u4e2a\u8c03\u7528\u7684\u8fd4\u56de\u503c\u662f3\n(f (lambda (x) x))  ;\u76f8\u5f53\u4e8e(begin 2 3)\uff0c\n                    ;\u6700\u540e\u4e00\u6761\u8bed\u53e53\u7684\u503c\u662f\u8fd4\u56de\u503c\n\n;\u4e0b\u9762\u7684\u8c03\u7528\u65b9\u5f0f\u8fd4\u56de\u503c\u662f2                   \n(call/cc f)\n\n;\u7531\u4e8ef\u662f\u5355\u53c2\u51fd\u6570\uff0c\u6240\u4ee5\u4e0a\u9762\u7684\u8bed\u53e5\u7b49\u4ef7\u4e8e\n(call/cc (lambda (k)\n           (k 2)    ;\u6b64\u5904\u78b0\u5230\u4e86(k value)\u8c03\u7528\uff0c\u8df3\u51fa\u5916\u9762\u7684\u4e16\u754c\n           3))      ;\u8fd9\u6761\u8bed\u53e5\u4e0d\u4f1a\u88ab\u6267\u884c\n\n;call/cc\u4e4b\u5916\u4ec0\u4e48\u90fd\u6ca1\u6709,\u4e5f\u5c31\u662f\u8bf4\u5176\u5ef6\u7eed\u662f\u5565\u4e5f\u4e0d\u5e72\n;\u5373 k\u4f1a\u88ab\u7ed1\u5b9a\u4e3a (lambda (x) x)\n;\u8fd9\u6837(k 2)\u81ea\u7136\u662f 2\n;\u6ce8\u610f\u8fd9\u548c\u7b2c2\u8282\u7684(k 2)\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u4e1c\u897f\n</code></pre></p> <p>\u6ce8\u610f\uff1a\u8fd9\u4e2a\u4e1c\u897f\u522b\u95ee\u767e\u5ea6\u6216\u8005\u4efb\u4f55AI\uff0c\u51e0\u4e4e80%\u4ee5\u4e0a\u7684\u56de\u7b54\u90fd\u662f\u9519\u8bef\u7684\u3002 </p> <p>\u6bd4\u5982\u5728\u767e\u5ea6\u641c\u7d22\u201c<code>call/cc</code>\u975e\u672c\u5730\u9000\u51fa\u201d\u7684\u7ed3\u679c\u5982\u4e0b\uff1a  </p> \u56fe1 \u767e\u5ea6\u7684\u4eba\u5de5\u667a\u969c\u4e0d\u77e5\u9053\u4ece\u54ea\u91cc\u6284\u51fa\u6765\u7684\u9519\u8bef\u4ee3\u7801 <p>\u8fd9\u4e2a\u4ee3\u7801\u7b80\u76f4\u9519\u5f97\u79bb\u8c31\uff0c\u56e0\u4e3a<code>exit</code>\u662f\u4e00\u4e2a\u5355\u53c2\u51fd\u6570\uff0c\u56fe1\u4e2d\u7ea2\u6846\u7684\u8bed\u53e5\u6839\u672c\u6267\u884c\u4e0d\u4e86\u3002\u6b63\u786e\u7684\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>(call/cc \n  (lambda (exit)\n    (display \"Hello, \")\n    (exit 0)\n    (display \"World!\")))\n</code></pre></p> <p>\u518d\u8003\u8651\u4e00\u4e2a\u590d\u6742\u4e00\u70b9\u7684\u4f8b\u5b50\uff0c\u8ba1\u7b97\u94fe\u8868\u6240\u6709\u5143\u7d20\u4e58\u79ef\u7684\u7a0b\u5e8f\u5982\u4e0b\uff1a <pre><code>;\u5e38\u89c4\u7684\u975e\u5c3e\u9012\u5f52\u7684\u7a0b\u5e8f\u5f88\u7b80\u5355\uff0c\u4f46\u8fd9\u4e2a\u7a0b\u5e8f\u53ef\u80fd\u4f1a\u7206\u6808\uff0c\n;\u66f4\u8ba8\u538c\u7684\u662f\uff0c\u5f53\u6709\u4e00\u4e2a\u5143\u7d20\u4e3a0\u65f6\uff0c\u672c\u6765\u5c31\u53ef\u4ee5\u8fd4\u56de0\u4e86\uff0c\n;\u4f46\u5b83\u4ecd\u7136\u4f1a\u8001\u8001\u5b9e\u5b9e\u7684\u904d\u5386\u6240\u6709\u5143\u7d20\n(define (product-1 lst)\n  (cond [(null? lst) 1]\n    [else (* (car lst) (product-1 (cdr lst)))]))\n\n(product-1 '(1 2 3)) ;\u8f93\u51fa6\n(product-1 '(1 0 3)) ;\u8f93\u51fa0\n\n;\u5c55\u5f00\u540e\uff0c\u8ba1\u7b97\u8fc7\u7a0b\u662f\n(* 1 (product-1 '(0 3)))\n(* 1 (* 0 (product-1 '(3))))\n(* 1 (* 0 (* 3 (prduct-1 '())))))\n(* 1 (* 0 (* 3 1)))\n(* 1 (* 0 3))\n(* 1 0)\n0\n</code></pre></p> <p>\u5229\u7528<code>call/cc</code>\u7684\u8df3\u51fa\u673a\u5236\u53ef\u4ee5\u628a\u7a0b\u5e8f\u6539\u6210\u4e0b\u9762\u7684\u6837\u5b50\uff1a\uff08\u8fd9\u91cc\u7528\u5230\u4e86\u5e26<code>name</code>\u7684<code>let</code>\u8bed\u53e5\uff0c\u5b83\u901a\u5e38\u7528\u4e8e\u9012\u5f52\uff09 <pre><code>(define (product-2 lst)\n  (call/cc\n   (lambda (return)\n     (let iter ((rest lst))\n       (cond [(null? rest) 1]\n         [(zero? (car rest)) (return 0)] ;\u53ea\u8981rest\u7684\u9996\u5143\u7d20\u4e3a0,\u7a0b\u5e8f\u4f1a\u6267\u884c\u5ef6\u7eed\u51fd\u6570\u5e76\u9000\u51fa\n         [else (* (car rest) (iter (cdr rest)))])))))\n;\u53c2\u8003\u524d\u9762\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5f53rest\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e3a0\u65f6\uff0c\u7a0b\u5e8f\u4e0d\u4f1a\u6267\u884c\u540e\u9762\u7684\u9012\u5f52\uff0c\u800c\u81ea\u52a8\u9000\u51fa\n;\u5c55\u5f00\u540e\u5982\u4e0b\n(product-2 '(1 0 3))\n(* 1 (iter '(0 3))) ;\u5728\u4e0b\u4e00\u4e2a\u6b65\u9aa4\u4e2drest\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f0,\u7a0b\u5e8f\u4f1a\u76f4\u63a5\u6267\u884creturn 0\u7684\u4ee3\u7801\n((lambda (return) return) 0)\n0\n</code></pre></p> <p>\u5f53\u7136\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u4e0d\u662f\u5c3e\u9012\u5f52\uff0c\u5b83\u53ef\u80fd\u7206\u6808\u3002\u4f46\u5199\u51fa\u5b83\u7684\u5c3e\u9012\u5f52\uff08\u5faa\u73af\uff09\u7248\u672c\u4e5f\u4e0d\u96be\uff0c\u8fd9\u91cc\u4e0d\u591a\u4f5c\u5c55\u5f00\uff0c\u4e00\u5207\u7684\u91cd\u70b9\u5728\u4e8e\u6211\u4eec\u7528<code>call/cc</code>\u5b9e\u73b0\u4e86return\u8bed\u53e5\u3002  </p>"},{"location":"markdown/lisp_call_cc/#32-backtracing","title":"3.2 \u56de\u6eaf(backtracing)","text":"<p>\u53c2\u8003\u4e0b\u9762\u7684\u4ee3\u7801\uff1a <pre><code>; fail\u521d\u59cb\u4e3a\u4e00\u4e2a\u53ea\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\u7684\u65e0\u53c2\u51fd\u6570\n(define fail                  \n   (lambda () 'no-choice))\n\n; \u8fd9\u662f\u4e00\u4e2a\u514b\u91cc\u5316\u7684\u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u63a5\u53d7\u4e0d\u786e\u5b9a\u4e2a\u6570\u7684\u53c2\u6570\n; (choose 1 2 3)\u65f6\uff0cls\u4e3a'(1 2 3)\n; (choose)\u65f6\uff0cls\u4e3a'()\n(define (choose . ls)\n  (if (null? ls)\n    (fail)\n    (let [(fail0 fail)]\n      (call/cc (lambda (k)\n                 (set! fail (lambda ()\n                               (set! fail fail0)\n                               (k (apply choose (cdr ls)))))\n                 (k (car ls)))))))   ;\u8df3\u51fa\u5e76\u8fd4\u56dels\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\n\n;\u4e0a\u9762(apply choose (cdr ls))\uff0c\u5982\u679cls\u662f'(1 2 3)\n;\u5219\u8be5\u8868\u8fbe\u5f0f\u7b49\u4ef7\u4e8e(choose 2 3)\n\n(choose 1 2 3) ;\u4f1a\u8fd4\u56de1\n(choose)       ;\u4f1a\u8fd4\u56de2\n(choose)       ;\u4f1a\u8fd4\u56de3\n(choose)       ;\u4f1a\u8fd4\u56de'no-choice\n</code></pre> \u8fd9\u91cc\u7684<code>choose</code>\u51fd\u6570\u5b9e\u9645\u4e0a\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5bf9\u53c2\u6570\u5217\u8868\u7684\u53d6\u9996\u5143\u7d20\u7684\u7a0b\u5e8f\uff0c\u6bcf\u6267\u884c\u4e00\u6b21\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684<code>fail</code>\u51fd\u6570\u8c03\u7528\uff0c<code>choose</code>\u6bcf\u6b21\u6267\u884c\u90fd\u6539\u53d8\u4e86\u81ea\u5df1\u7684\u884c\u4e3a\u3002 \u6267\u884c<code>(choose 1 2 3)</code>\u65f6\uff0c\u8fd4\u56de\u503c\u662f\u6700\u540e\u4e00\u884c\u7684<code>(car '(1 2 3))</code>\uff0c\u540c\u65f6\u751f\u6210\u4e86\u4e00\u4e2a\u65b0\u7684\u51fd\u6570<code>fail</code>\uff0c\u5b83\u7684\u884c\u4e3a\u662f\uff1a 1. \u9996\u5148\u628a\u81ea\u5df1\u8d4b\u503c\u4e3a\u4e0a\u4e00\u4e2a\u51fd\u6570\u72b6\u6001\uff0c\u8fd9\u91cc\u662f<code>(lambda () 'no-choice)</code>; 2. \u8fd4\u56de<code>(choose 2 3)</code>\u3002  </p> <p>\u5229\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u975e\u786e\u5b9a\u6027\u8ba1\u7b97\uff0c\u6bd4\u5982\u627e\u51fa1\u52305\u4e4b\u95f4\u6ee1\u8db3\u52fe\u80a1\u5b9a\u7406\u7684\u4e09\u5143\u6570\uff1a <pre><code>(let\n  ([sq (lambda (x) (* x x))]  ;\u5e73\u65b9\u51fd\u6570\n   [a  (choose 1 2 3 4 5)]    ;a\u3001b\u3001c\u90fd\u662fchoose\u7684\u56de\u6eaf\u8c03\u7528\n   [b  (choose 1 2 3 4 5)]    ;\n   [c  (choose 1 2 3 4 5)])\n  (if (equal? (+ (sq a)\n         (sq b))\n          (sq c))             ;\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u52fe\u80a1\u5b9a\u5f8b\n      (list a b c)            ;\u6ee1\u8db3\u5c31\u8fd4\u56dea b c\u8fd9\u4e09\u4e2a\u6570\n      (choose)))              ;\u4e0d\u6ee1\u5c31\u56de\u6eaf\u8c03\u7528(choose)\n\n;\u8fd9\u4e2a\u7a0b\u5e8f\u4f1a\u8fd4\u56de'(4 3 5)\n</code></pre> \u8fd9\u91cc\u7684\u795e\u5947\u4e4b\u5904\u5728\u4e8e\u4f60\u65e0\u9700\u5728\u4e3b\u51fd\u6570\u4e2d\u5206\u522b\u5bf9<code>a</code>\u3001<code>b</code>\u6216<code>c</code>\u5206\u522b\u6307\u5b9a\u9012\u5f52\u8c03\u7528\uff0c\u5728<code>let</code>\u4e00\u5f00\u59cb\u6267\u884c\u4e86\u4e09\u4e2a<code>choose</code>\u51fd\u6570\u4e4b\u65f6\uff0c\u5b83\u4eec\u5404\u81ea\u88ab\u7ed1\u5b9a\u5230\u4e00\u4e2a\u81ea\u52a8\u5217\u4e3e\u7684\u5e8f\u5217\u51fd\u6570\u4e2d\uff0c\u6bcf\u4e00\u6b21\u8c03\u7528(choose)\uff0c\u5176\u4e2d\u67d0\u4e2a\u52fe\u80a1\u6570\u5c31\u4f1a\u6539\u53d8\u3002 \u5177\u4f53\u8fc7\u7a0b\u4e0d\u518d\u63a8\u5bfc\u4e2d\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u4f8b\u5b50\u8fdc\u6ca1\u6709\u534f\u7a0b\u548c\u9634\u9633\u8c1c\u9898\u590d\u6742\uff0c\u6709\u5174\u8da3\u8005\u4e0d\u59a8\u4eff\u7167\u540e\u6587\u7684\u65b9\u5f0f\u63a8\u5bfc\u4e00\u904d\u3002  </p>"},{"location":"markdown/lisp_call_cc/#33-coroutines","title":"3.3 \u534f\u7a0b(coroutines)","text":"<p>\u534f\u7a0b\u662f\u4e00\u822c\u5316\u7684\u5b50\u51fd\u6570\u3002\u4e00\u4e2a\u534f\u7a0b\u53ef\u4ee5\u5728\u67d0\u4e2a\u6267\u884c\u70b9\u6302\u8d77\u5e76\u5728\u4e4b\u540e\u4ece\u6302\u8d77\u70b9\u6062\u590d\u3002\u4e0e\u5b50\u51fd\u6570\u4e0d\u540c\u7684\u662f\uff0c\u534f\u7a0b\u4e0d\u9700\u8981\u5728\u5b83\u8fd4\u56de\u524d\u5b8c\u6210\u6574\u4e2a\u6267\u884c\u8fc7\u7a0b\u3002  </p> <pre><code>(define (one go1)\n  (display 1)\n  (set! go1 (call/cc go1))   ;\u7b2c\u4e00\u4e2a\u6302\u8d77\u70b9\n  (display 2)\n  (set! go1 (call/cc go1))   ;\u7b2c\u4e8c\u4e2a\u6302\u8d77\u70b9\n  (display 3)\n  (set! go1 (call/cc go1)))  ;....\n\n(define (two go2)\n  (display #\\a)\n  (set! go2 (call/cc go2))\n  (display #\\b)\n  (set! go2 (call/cc go2))\n  (display #\\c)\n  (set! go2 (call/cc go2)))\n</code></pre> <p>\u7406\u89e3\u7a0b\u5e8f\u4e3a\u4ec0\u4e48\u5728\u6302\u8d77\u70b9\u5904\u6682\u505c\u7684\u5173\u952e\u5728\u4e8e\u518d\u6b21\u601d\u8003<code>call\\cc</code>\u4f1a\u5728\u4ec0\u4e48\u65f6\u5019\u201c\u8df3\u51fa\u201d\u5f53\u524d\u7a0b\u5e8f\u3002\u770b\u5b8c\u672c\u8282\u7684\u63a8\u5bfc\u4f60\u4f1a\u53d1\u73b0\u6240\u8c13\u6302\u8d77\u53ea\u662f\u4e00\u79cd\u9519\u89c9\uff0cCPU\u4e2d\u53d1\u751f\u7684\u4e8b\u5b9e\u53ea\u4e0d\u8fc7\u662f\u4e0d\u65ad\u7684\u6e05\u7a7a\u548c\u751f\u6210\u8c03\u7528\u6808\u800c\u5df2\u3002 \u524d\u6587\u5df2\u7ecf\u63d0\u5230\u51fa\u73b0<code>(k value)</code>\u7684\u8c03\u7528\u65f6\u7a0b\u5e8f\u4f1a\u8fdb\u884c\u866b\u6d1e\u7a7f\u8d8a\u3002\u4f46\u4e3a\u4e86\u987a\u5229\u63a8\u5bfc\u4e0a\u9762\u7684\u4ee3\u7801\u884c\u4e3a\uff0c\u8fd8\u9700\u8981\u7406\u89e3\u4ee5\u4e0b\u51e0\u79cd\u8fdb\u9636\u8df3\u51fa\u673a\u5236\uff1a <pre><code>;;\u7ecf\u5178\u8df3\u51fa\uff0c\u5c4f\u5e55\u8f93\u51fa12\n(begin (display 1)\n       (call/cc (lambda (x)\n                   (x 0)            ;\u4e0d\u4f1a\u8f93\u51fa\"-\"\n                   (display \"-\")))\n       (display 2))\n\n;;\u8c03\u7528\u6808\u662f\n(display 1)       &lt;=CPU\n(call/cc ...)\n(display 2)\n;;\u5148\u8f93\u51fa1\uff0c\u8c03\u7528\u6808\u53d8\u4e3a\n(call/cc ...)     &lt;=CPU\n(display 2)\n;;\u9047\u5230call/cc\u4e86\uff0cx\u51fd\u6570\u5f00\u59cb\u7ed1\u5b9a\u4e3a\u5ef6\u7eed\n;;\u5373 x = (lambda (p) p (display 2))\n;;\u5f53\u53d1\u751f(x 0)\u65f6\uff0c\u6e05\u7a7a\u8c03\u7528\u6808\uff0c\u76f4\u63a5\u8fd4\u56de\u4ee5\u4e0b\u4ee3\u7801\n((lambda (p) p (display 2)) 0)  ;\u4e2d\u95f4\u7684p\u6ca1\u6709\u4efb\u4f55\u4f5c\u7528\n\n;;\u7528call/cc\u8df3\u51fa\uff0c\u5c4f\u5e55\u8f93\u51fa12\uff0c\u8fd9\u4e2a\u7406\u89e3\u8d77\u6765\u5c31\u96be\u4e00\u4e9b\n(begin (display 1)\n       (call/cc (lambda (x)\n                   (call/cc x)\n                   (display \"-\")))  ;\u4e0d\u4f1a\u8f93\u51fa\"-\"\n       (display 2))\n;;\u8f93\u51fa1\u540e\uff0c\u5728\u5806\u91cc\u751f\u6210\u5ef6\u7eed\u5e76\u7ed1\u5b9ax\n;;x = (lambda (p) p (display 2))\n;;\u8c03\u7528\u6808\u53d8\u4e3a\na = (call/cc x)   &lt;=CPU\n(call/cc a)\n(display 2)\n;\u8fd9\u4e2a\u64cd\u4f5c\u4f1a\u628ap\u7ed1\u5b9a\u5230\u4e00\u4e2a\u65b0\u7684\u5ef6\u7eed\uff0c\u5f62\u5f0f\u548cx\u4e00\u6837\n;;p = (lambda (k) k (display 2))\n;;\u8c03\u7528\u6808\u53d8\u4e3a\ny = (call/cc x)    &lt;=CPU ;\u540e\u9762\u7684\u4ee3\u7801\u90fd\u4f1a\u88ab\u8df3\u51fa\ny = (display \"-\")\n(call/cc y)\n(display 2)\n;;\u6ce8\u610f(call/cc x)\u5728\u5e72\u4ec0\u4e48\uff0c\u5b83\u9996\u5148\u628ax\u7684\u53c2\u6570\u7ed1\u5b9a\u4e3a\u65b0\u7684\u5ef6\u7eed\n;;\u4e5f\u5c31\u662f\u8bf4p = (lamba (y) y (display \"-\") (call/cc y) (display \"2\"))\n;;\u7136\u540e\u8c03\u7528x\u7a0b\u5e8f, \u8fd9\u76f8\u5f53\u4e8e\u5728\u539f\u6808\u4e2d\u8c03\u7528\u4e86\u67d0\u4e2a(x f)\n;;\u8c03\u7528\u6808\u77ac\u95f4\u53d8\u4e3a\n(x f)\n;;\u5f88\u81ea\u7136d\u7684\u4f1a\u5f97\u5230\n((lambda (p) p (display 2)) f)\n;;\u7136\u540e\u8c03\u7528\u6808\u53d8\u4e3a\nf            ;\u8fd9\u91cc\u76f4\u63a5\u8fd4\u56def\u7684lambda\u8868\u8fbe\u5f0f,\u6ca1\u5565\u7528,\u4f1a\u88ab\u540e\u9762\u8986\u76d6\n(display 2)  ;\u6ce8\u610f\u8fd9\u6761\u8bed\u53e5\u662fx\u51fd\u6570\u4e2d\u7684\n\n;;\u540c\u7406\uff0c\u4e0b\u9762\u7684\u4ee3\u7801\u4e5f\u4f1a\u5728\u5c4f\u5e55\u8f93\u51fa12\n(begin (display 1)\n       (call/cc (lambda (x)\n                   (set! x (call/cc x)) ;\u540c\u6837\u4e0d\u4f1a\u8f93\u51fa\"-\"\n                   (display \"-\")))      ;\u800c\u4e14set!\u8bed\u53e5\u4e0d\u4f1a\u6267\u884c  \n       (display 2))\n\n;;\u4e0d\u4f1a\u8df3\u51fa\uff0c\u5c4f\u5e55\u8f93\u51fa1-2\n(begin (display 1)\n       (call/cc (lambda (x)\n                   x\n                   (display \"-\")))\n       (display 2)\uff09                \n</code></pre></p> <p>\u6709\u4e86\u4ee5\u4e0a\u57fa\u7840\uff0c\u518d\u6765\u8ba8\u8bba\u8c03\u7528<code>(one two)</code>\u4f1a\u53d1\u751f\u4ec0\u4e48\uff0c\u8be6\u7ec6\u63a8\u5bfc\u8fc7\u7a0b\u5982\u4e0b\uff1a <pre><code>;;\u7a0b\u5e8f\u7684\u8c03\u7528\u6808\u662f\n(display 1)        &lt;=CPU  \n(set! ...\n(display 2)\n(set! ...)\n(display 3)\n(set! ...)\n\n;;\u8f93\u51fa1\u4e4b\u540e\uff0c\u8c03\u7528\u6808\u53d8\u6362\u4e3a\na = (call/cc two)  &lt;=CPU\n(set! two a)\n(display 2)\n(set! ...)\n(display 3)\n(set! ...)\n\n;;\u4e0d\u59a8\u8bbetwo\u7684\u53c2\u6570\u4e3ak0,\u5b83\u662f\u4e00\u4e2a\u5ef6\u7eed\n;;k0 = (lambda (x) (set! two x)\n;;                 (display 2)\n;;                 (set! ...)\n;;                 (display 3)\n;;                 (set! ...)))\n;;\u8c03\u7528\u6808\u53d8\u4e3a\n(display #\\a)      &lt;=CPU   ;\u8fd9\u91cc\u8f93\u51faa,\u5c4f\u5e55\u4e0a\u53d8\u62101a\np = (call/cc k0)           ;\u5f88\u660e\u663e\u8fd9\u91cc\u8c03\u7528\u4e86\u5ef6\u7eedk0,\u4f1a\u8df3\u51fa\np = (set! k0 a)\np = (display #\\b)\np = (set! ...)\np = (display #\\c)  \np = (set! ...)             ;\u8fd9\u4e4b\u524d\u662ftwo\u51fd\u6570\u7684\u4e16\u754c\np = (call/cc p)            ;\u8fd9\u4e4b\u540e\u662fone\u51fd\u6570\u7684\u4e16\u754c\n(set! two p)              \n(display 2)\n(set! ...)\n(display 3)  \n\n;;\u6211\u4eec\u770b\u770b(call/cc k0)\u4f1a\u53d1\u751f\u4ec0\u4e48?\n;;\u5b83\u7b49\u4ef7\u4e8e(call/cc (lambda (x)\n;;                    (set! two x) (display 2) (set! ...) ...)\n;;\u5728\u672a\u8df3\u51fa\u4e4b\u524d\u5c31\u5fc5\u987b\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u5ef6\u7eed\u5e76\u7ed1\u5b9a\u5230x0\n;;x0 = (lambda (p) (set! k0 p) (display #\\b) ... \n;;\u7136\u540e\u8c03\u7528k0\u51fd\u6570\u5e76\u6e05\u7a7a\u540e\u9762\u7684\u8c03\u7528\u6808\u76f4\u63a5\u8df3\u51fa\n;;\u751f\u6210\u7684\u65b0\u8c03\u7528\u6808\u4e3a\n(set! two x0)      &lt;=CPU   ;\u73b0\u5728two\u51fd\u6570\u53d8\u4e3ax0\n(display 2)                ;\u6267\u884c\u5230\u8fd9\u91cc\u4f1a\u8f93\u51fa2,\u5c4f\u5e55\u4e3a1a2\n(set! ...)\n(display 3)\n(set! ...)\n\n;;\u5f53\u5c4f\u5e55\u8f93\u51fa2\u4e4b\u540e,\u8c03\u7528\u6808\u53d8\u4e3a\na = (call/cc two)   &lt;=CPU   ;\u6545\u4e8b\u53c8\u91cd\u6f14\u4e86\n(set! two a)                \n(display 3)\n(set! ...)\n\n;;\u9996\u5148\u5bf9(call/cc two)\u4ea7\u751f\u65b0\u7684\u5ef6\u7eed\n;;k1 = (lambda (x) (set! two x) \n;;                 (display 3)\n;;                 (set! ...))\n;;(call/cc two)\u53d8\u6210\n;;(call/cc (lambda (p) (set! k0 p) (display #\\b) ...)\n;;\u7136\u540e\u628a(call/cc two)\u5c55\u5f00\u5e76\u4ea7\u751f\u65b0\u8c03\u7528\u6808\np = (set! k0 k1)                ;\u8fd9\u91cc\u6ca1\u5565\u7528\u53ef\u4ee5\u5ffd\u7565\np = (display #\\b)     &lt;=CPU     ;\u8f93\u51fa\u4e86b,\u5c4f\u5e55\u4e3a1a2b\np = (call/cc k1)                ;\u5f88\u660e\u663e,\u8fd9\u91cc\u4f1a\u8df3\u51fa\np = (set! k1 p)\np = (display #\\c)               ;\u65b0\u4e16\u754c\u7684two\u51fd\u6570\u7ed3\u675f\np = (call/cc p)\n(set! two b)\n(display 3)\n(set! ...)\n\n;;\u5f53\u5c4f\u5e55\u8f93\u51fab\u65f6,\u53c8\u9700\u8981\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u5ef6\u7eed\u5e76\u7ed1\u5b9a\u5230x1\n;;x1 = (lambda (p) (set! k1 p) (display #\\c)\n;;                             (set! ...)\n;;                             ...)\n;;\u6b64\u65f6\u8c03\u7528\u6808\u4f1a\u4e00\u4e0b\u5b50\u6d88\u706d\u8df3\u51fa\u540e\u7684\u4e1c\u897f,\u76f4\u63a5\u53d8\u4e3a\n(call/cc k1)  \n\n;;\u4e5f\u5c31\u662f\n(set! two x1)       &lt;=CPU ;\u8fd9\u91cctwo\u53c8\u53d8\u6210x1\u51fd\u6570\n(display 3)               ;\u8fd9\u91cc\u8f93\u51fa3,\u5c4f\u5e55\u4e3a1a2b3\n(set! ...)\n\n;;\u8f93\u51fa3\u4e4b\u540e,\u8c03\u7528\u6808\u53d8\u6210\np = (call/cc two)\n(set! two p)\n\n;;\u540c\u6837\u4f1a\u9996\u5148\u751f\u6210\u4e00\u4e2a\u5ef6\u7eedk2\n;;k2 = (lambda (x) (set! two x))\n;;\u518d\u540c\u6837\u7528x1\u66ff\u6362two\u5c55\u5f00\u5f97\u5230\u65b0\u8c03\u7528\u6808\np = (set! k1 k2)    &lt;=CPU ;\u8fd9\u91cc\u6ca1\u5565\u7528\u53ef\u4ee5\u5ffd\u7565\np = (display #\\c)         ;\u8fd9\u91cc\u8f93\u51fac,\u5c4f\u5e55\u4e3a1a2b3c\np = (call/cc k2)          ;\u8fd9\u91cc\u4ecd\u7136\u4f1a\u8df3\u51fa\np = (set! ...)\n...\n(set! two p)\n\n;\u5f53\u8c03\u7528\u5230(call/cc k2)\u65f6,\u540c\u6837\u53c8\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5ef6\u7eed\n;x2 = (lambda (p) (set! k1 p) ...)\n;\u4f46\u8fd9\u4e2a\u5ef6\u7eed\u5df2\u7ecf\u6ca1\u6709\u5565\u610f\u4e49\u4e86,\u6b64\u65f6\u6574\u4e2a\u8c03\u7528\u6808\u53d8\u6210\n(call/cc (lambda (x) (set! two x)))\n;\u4e5f\u5c31\u662f\n(set! two x2)      &lt;=CPU\n;;\u7136\u540e\u518d\u6ca1\u6709\u4efb\u4f55\u4ee3\u7801\u4f1a\u751f\u6210\u65b0\u7684\u8c03\u7528\u6808,\u7a0b\u5e8f\u7ed3\u675f\n</code></pre></p> <p>\u540c\u7406\u53ef\u77e5\uff0c\u5982\u679c\u6211\u4eec\u8c03\u7528<code>(two one)</code>\uff0c\u90a3\u8f93\u51fa\u4e00\u5b9a\u4f1a\u53d8\u6210<code>a1b2c3</code>\uff0c\u63a8\u5bfc\u65b9\u5f0f\u51e0\u4e4e\u4e00\u6478\u4e00\u6837\u3002</p> <p>\u6ce8\u610f\uff1a<code>call/cc</code>\u7531\u4e8e\u62e5\u6709\u4e86\u53d6\u51fa\u5f53\u524d\u4f4d\u7f6e\u5ef6\u7eed\u548c\u8df3\u51fa\u8be5\u4f4d\u7f6e\u8fd9\u4e24\u4e2a\u529f\u80fd\uff0c\u56e0\u6b64\u9ad8\u7ea7\u5e94\u7528\u8fd8\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u591a\u7ebf\u7a0b\uff08\u534f\u7a0b\u7684\u8fdb\u5316\u7248\uff09\uff0c\u7ed3\u5408scheme\u5b8f\u751f\u6210<code>while</code>\u3001<code>loop</code>\uff0c<code>break</code>\u7b49\u65b0\u63a7\u5236\u7ed3\u6784\uff0c\u7b49\u7b49\u3002 </p>"},{"location":"markdown/lisp_call_cc/#4-cps","title":"4. CPS","text":"<p>CPS\u662fcontinuation-passing style\u7684\u7b80\u5199\uff0c\u53ef\u7ffb\u8bd1\u4e3a\u201c\u5ef6\u7eed\u4f20\u9012\u98ce\u683c\u201d\u3002\u4f7f\u7528 CPS \u7f16\u5199\u7684\u51fd\u6570\u4f1a\u5e26\u6709\u4e00\u4e2a\u989d\u5916\u53c2\u6570\uff0c\u5b83\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u5355\u53c2\u51fd\u6570\u3002\u5f53 CPS \u51fd\u6570\u8ba1\u7b97\u51fa\u5b83\u7684\u8fd4\u56de\u503c\u540e\uff0c\u5b83\u901a\u8fc7\u8c03\u7528 continuation \u51fd\u6570\u6765\u8fdb\u884c\u201c\u8fd4\u56de\u201d\u3002\u6bd4\u5982\u4e0b\u9762\u7684CPS\u6590\u6ce2\u62c9\u5951\u51fd\u6570\uff1a  </p> <pre><code>; \u6839\u636e\u6570\u5b66\u5b9a\u4e49\u7684\u975eCPS\u9012\u5f52\u7248\u672c\uff0c\u5b83\u4e0d\u662f\u5c3e\u9012\u5f52\n(define fib\n   (lambda (n)\n      (cond \n         ((&lt; n 0) #f)\n         ((= n 0) 0)\n         ((= n 1) 1)\n         (else (+ (fib (- n 1)) \n                  (fib (- n 2)))))))\n\n; CPS\u98ce\u683c\u7684\u9012\u5f52\u7248\u672c\uff0c\u5b83\u662f\u5c3e\u9012\u5f52\uff0c\u4e0d\u4f1a\u7206\u6808\uff0c\u6ce8\u610f\u8c03\u7528\u65f6k\u662f\u4e00\u4e2acall/cc\n(define fib-cps\n  (lambda (n k)\n    (cond\n     ((&lt; n 0) (k #f))\n     ((= n 0) (k 0))\n     ((= n 1) (k 1))\n     (else\n      (fib-cps (- n 1)\n           (lambda (n1)\n              (fib-cps (- n 2) (lambda (n2) (k (+ n1 n2))))))))))\n</code></pre> <p>\u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u8c03\u7528\u65b9\u5f0f\u5e76\u4e0d\u76f8\u540c\uff0c<code>(fib 7)</code>\u4f1a\u8fd4\u56de<code>13</code>\uff0c\u800c\u7b49\u4ef7\u7684CPS\u51fd\u6570\u8c03\u7528\u65b9\u5f0f\u4e3a<code>(fib-cps 7 (lambda (x) x))</code>\u3002\u5f53\u7136\uff0c\u8fd9\u91cc\u6211\u4eec\u6ca1\u6709\u7528\u5230<code>call/cc</code>\u51fd\u6570\uff0c\u4f46\u5b9e\u9645\u4e0a\u73b0\u4ee3Scheme\u89e3\u91ca\u5668\u5bf9\u4e8e<code>fib</code>\u51fd\u6570\u4f1a\u81ea\u52a8\u91c7\u7528<code>call\\cc</code>\u5f97\u5230\u5b83\u7684CPS\u53d8\u6362\uff0c\u7136\u540e\u518d\u6267\u884c\u3002\u81ea\u52a8CPS\u53d8\u6362\u662f\u4e00\u4e2a\u66f4\u70e7\u8111\u7684\u95ee\u9898\uff0c\u5982\u679c\u4f60\u60f3\u6311\u6218\u4e00\u4e0b\u81ea\u5df1\u7684\u667a\u5546\u53ef\u4ee5\u641c\u7d22\u201c\u738b\u57a0\u768440\u884c\u4ee3\u7801\u201d\u3002  </p>"},{"location":"markdown/lisp_call_cc/#5-callcccallcc","title":"5. call/cc\u7684call/cc","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u8bf4\u4e86\uff0c<code>call/cc</code>\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u5355\u53c2\u51fd\u6570\uff0c\u5b83\u901a\u5e38\u7684\u8c03\u7528\u65b9\u5f0f\u4e3a<code>(call/cc (lambda (k) &lt;body&gt;))</code>\u3002\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c<code>(call/cc call/cc)</code>\u4f1a\u5f97\u5230\u4ec0\u4e48\uff1f \u4e0d\u59a8\u75281\u548c2\u5c06\u4e24\u4e2a\u51fd\u6570\u8fdb\u884c\u533a\u5206\uff0c\u63a8\u5bfc\u5982\u4e0b\uff1a  </p> <pre><code>;\u8003\u8651func\u662f\u67d0\u4e2a\u51fd\u6570\uff0c\u6267\u884c\u4e00\u4e0b\u8868\u8fbe\u5f0f\n((call/cc1 call/cc2) func)\n\n;\u4e0d\u59a8\u8bbecall/cc2\u7684\u53c2\u6570\u662fk\n;\u4e5f\u5c31\u662f\u8bf4\uff0ck\u88ab\u7ed1\u5b9a\u4e3a(A func)\u8fd9\u4e2a\u884c\u4e3a\n;k = (lambda (x) func)\n;\u539f\u8868\u8fbe\u5f0f\u53d8\u4e3a\n((call/cc1 (lambda (x) func)) func)\n\n;\u8fd9\u91ccx\u88ab\u7ed1\u5b9a\u4e3a\u5f53\u524d\u4f4d\u7f6e\u7684\u5ef6\u7eed\uff0c\u4e14\u6ca1\u6709\u770b\u5230(x value)\u7684\u8c03\u7528\n;(call/cc1 (lambda (x) func))\u7684\u503c\u4e3afunc\n;\u6240\u4ee5\u6574\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u53d8\u4e3a\n(func func)\n\n;\u8fd9\u4e5f\u5c31\u662f\u8bf4(call/cc call/cc)\u4f1a\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a\u5355\u53c2\uff0c\n;\u6b64\u5355\u53c2\u5fc5\u987b\u4e3a\u4e00\u4e2a\u51fd\u6570\uff0c\u8868\u8fbe\u5f0f\u4e3a\n(lambda (f) (f f))\n</code></pre> <p>call\\cc\u5b9a\u74063\uff1a<code>((call/cc call/cc) f)</code>\u7b49\u4ef7\u4e8e<code>(f f)</code>\u3002 </p> <p>\u5230\u8fd9\u91cc\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4e86\u4e09\u4e2a\u8bed\u53e5\uff0c\u4ed6\u4eec\u90fd\u80fd\u628a\u4e00\u4e2a\u5355\u53c2\u51fd\u6570\u91cd\u590d\u4e24\u6b21\uff0c\u4e0d\u59a8\u56de\u60f3\u4e00\u4e0b\u300aY\u7ec4\u5408\u5b50\u300b\u3002\u5f88\u663e\u7136\uff0c\u4f7f\u7528<code>(call/cc)</code>\u4f1a\u5f97\u5230\u66f4\u7b80\u5355\u7684Y\u7ec4\u5408\u5b50\u5199\u6cd5\uff1a <pre><code>;\u539f\u59cb\u5199\u6cd5\n(define (Y f)\n  ((lambda (x) (x x))\n   (lambda (g)\n     (f (lambda (y)\n     ((g g) y))))))\n\n;call/cc\u5199\u6cd5\n(define (Y f)\n  ((lambda (u)\n     (u (lambda (x)\n          (lambda (n) ((f (u x))) n))))\n   (call/cc call/cc)))\n</code></pre></p>"},{"location":"markdown/lisp_call_cc/#6","title":"6. \u9634\u9633\u8c1c\u9898","text":"<p>\u8fd9\u8d27\u662fLisp\u90aa\u6559\u5f92\u8001\u62ff\u6765\u8bf4\u4e8b\u7684\u4e1c\u897f\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>(let* \n  ([yin  ((lambda (x) (display #\\@) x)\n          (call/cc (lambda (k) k)))]\n   [yang ((lambda (x) (display #\\*) x)\n          (call/cc (lambda (k) k)))])\n  (yin yang))\n</code></pre> \u5b83\u4f1a\u5f97\u5230\u4e00\u4e2a\u6b7b\u5faa\u73af\uff0c\u8f93\u51fa\u5982\u4e0b\uff1a <code>@*@**@***@****@*****@******@*******@********@*********</code>\u5f80\u540e\u7701\u7565\u3002  </p> <p>\u4f46\u7f51\u4e0a\u51e0\u4e4e\u6240\u6709\u7684\u89e3\u91ca\u90fd\u4e0d\u90a3\u4e48\u6e05\u723d\uff0c\u6709\u4e9b\u5e72\u8106\u662f\u9519\u7684\uff0c\u6216\u8005\u662f\u6309\u7167\u8f93\u51fa\u6765\u51d1\u3002\u8fd9\u91cc\u6709\u5fc5\u8981\u624b\u52a8\u63a8\u5bfc\u4e00\u904d\uff0c\u5728\u63a8\u5bfc\u4e4b\u524d\uff0c\u8bf7\u4e00\u5b9a\u6ce8\u610fScheme\u8bed\u8a00\u6c42\u503c\u7684\u89c4\u5219\uff0c\u8fd9\u4e2a\u9898\u76ee\u5982\u679c\u4f60\u628a<code>let*</code>\u8bed\u53e5\u91cc\u7684<code>yang</code>\u548c<code>yin</code>\u987a\u5e8f\u98a0\u5012\uff0c\u90a3\u4e48\u8f93\u51fa\u5c31\u4f1a\u4e0d\u540c\u3002\u6b64\u4ee3\u7801\u5e76\u4e0d\u6ee1\u8db3\u4ee3\u6362\u6a21\u578b\uff0c<code>display</code>\u8bed\u53e5\u5e26\u6765\u4e86\u526f\u4f5c\u7528\u3002 \u53e6\u5916\uff0c\u89e3\u91ca\u5668\u7684\u6c42\u503c\u662f\u4e00\u6b65\u6b65\u8fdb\u884c\u7684\uff0c\u7531\u4e8e<code>let*</code>\u7684\u5b58\u5728\uff0c\u5b83\u9996\u5148\u4f1a\u5bf9\u7b2c\u4e00\u6761\u8bed\u53e5\u7684\u8868\u8fbe\u5f0f\u6c42\u503c\uff0c\u7136\u540e\u518d\u7ed1\u5b9a\u5230<code>yin</code>\u3002\u968f\u5373\u518d\u5bf9<code>yang</code>\u8fdb\u884c\u540c\u6837\u7684\u64cd\u4f5c\uff0c\u6bcf\u6b21\u4e00\u65e6\u6c42\u503c\u7ed3\u675f\uff08\u8868\u8fbe\u5f0f\u53d8\u4e3a\u4e00\u4e2a\u5ef6\u7eed\u51fd\u6570\u6216\u4e00\u4e2a\u5355\u503c\uff09\uff0c\u5219\u7acb\u523b\u8fdb\u884c\u7ed1\u5b9a\u3002\u800c\u6bcf\u6b21\u5728<code>let*</code>\u4e2d\u6267\u884c\u6c42\u503c\u5c31\u4f1a\u5728\u5c4f\u5e55\u8f93\u51fa\u5b57\u7b26\u3002\u597d\uff0c\u73b0\u5728\u5f00\u59cb\u70e7\u8111\u64cd\u4f5c\uff1a (1) \u9996\u5148\u4f1a\u4f9d\u6b21\u5bf9<code>yin</code>\u548c<code>yang</code>\u4e24\u4e2a\u8868\u8fbe\u5f0f\u6c42\u503c\uff0c\u6c42\u503c\u8fc7\u7a0b\u4e2d\u4f1a\u5728\u5c4f\u5e55\u4e2d\u6253\u5370\u51fa<code>@*</code>\uff0c\u540c\u65f6\u5f97\u5230\u4e24\u4e2a\u5ef6\u7eed\u51fd\u6570\uff0c\u4e3a\u4e86\u5bf9\u5ef6\u7eed\u51fd\u6570\u8868\u793a\u533a\u5206\uff0c\u6211\u4eec\u5728<code>k</code>\u540e\u9762\u52a0\u4e0a\u7f16\u53f7\uff0c\u4ee5\u4e0b\u4e3a\u4ee3\u7801\u63a8\u5bfc\u3002  </p> <pre><code>;;\u5bf9yin\u8fdb\u884c\u7ed1\u5b9a\uff0c\u6b64\u65f6\u5c4f\u5e55\u4e0a\u662f@\n(let* \n  ([yin k0]       ;\u5148\u8f93\u51fa@\uff0c\u7136\u540e\u8fd4\u56decall/cc\u5904\u7684\u5ef6\u7eed\u51fd\u6570k0\n   [yang ((lambda (x) (display #\\*) x)\n          (call/cc (lambda (k1 k1))))])    \n  (yin yang))     \n\n;;\u7528####\u8868\u793a\u8c03\u7528\u65f6\u7684\u53c2\u6570,k0\u51fd\u6570\u7684\u884c\u4e3a(\u51fd\u6570\u4f53)\u662f\n(let* \n  ([yin  ((lambda (x) (display #\\@) x)\n          ####)]      ;####\u8868\u793a\u8c03\u7528k0\u65f6\u7684\u53c2\u6570\n   [yang ((lambda (x) (display #\\*) x)\n          (call/cc (lambda (k) k)))])\n  (yin yang))\n\n;;\u518d\u5bf9yang\u8fdb\u884c\u7ed1\u5b9a\uff0c\u6b64\u65f6\u5c4f\u5e55\u4e0a\u662f@*\n(let* ([yin  k0]\n       [yang k1])\n  (yin yang))      ;\u8fd9\u4e1c\u897f\u5c31\u662f(k0 k1)\n\n;;\u540c\u6837\u5728\u78b0\u5230call/cc\u4e4b\u524d\u4f1a\u4ea7\u751f\u65b0\u7684\u5ef6\u7eed\u51fd\u6570k1,\u5176\u884c\u4e3a\u662f\n(let* \n  ([yin k0]  ;\u6ce8\u610f\uff0c\u4e4b\u524dyin\u6c42\u503c\u65f6call/cc\u5df2\u7ecf\u6ca1\u6709\u4e86\n   [yang ((lambda (x) (display #\\*) x)\n          ####)]) \n  (yin yang))\n\n;;\u8fd9\u6837\u5728\u7b2c1\u6b65\u65f6\u505a\u4e86\u4e09\u4ef6\u4e8b\uff0c\n;; \u5c4f\u5e55\u8f93\u51fa\u4e3a@*\uff0c\n;; \u751f\u6210\u4e86k0, k1\u4e24\u4e2a\u51fd\u6570\n;; \u539f\u6765\u7684\u7a0b\u5e8f\u53d8\u6210\u4e86(k0 k1)\n</code></pre> <p>(2) \u73b0\u5728\u8981\u5bf9<code>(k0 k1)</code>\u8fdb\u884c\u6c42\u503c\uff0c\u7531\u4e8e\u6c42\u503c\u540e\u548c\u539f\u6765\u7684\u8868\u8fbe\u5f0f\u4e0d\u540c\uff0c\u4e2d\u9014\u4ea7\u751f\u7684\u5ef6\u7eed\u4e5f\u4f1a\u4e0d\u540c\uff0c\u63a8\u5bfc\u5982\u4e0b\u3002  </p> <pre><code>;;\u5bf9(k0 k1)\u6c42\u503c\uff0c\u90a3\u5c31\u662f\u628ak1\u4ee3\u6362\u5230\u524d\u9762\u7684k0\u4ee3\u7801\u5757\u91cc\uff0c\u5982\u4e0b\n(let* \n  ([yin  ((lambda (x) (display #\\@) x)\n          k1)]\n   [yang ((lambda (x) (display #\\*) x)\n          (call/cc (lambda (k2) k2)))]) ;\u8868\u8fbe\u5f0f\u53d8\u4e86\uff0c\u5ef6\u7eed\u4e5f\u4f1a\u53d8\uff0c\u7528k2\n  (yin yang))\n\n;;\u9996\u5148\u5bf9yin\u6c42\u503c\uff0c\u5c4f\u5e55\u8f93\u51fa@\uff0c\u7136\u540e\u5f97\u5230\n(let* \n  ([yin  k1]\n   [yang ((lambda (x) (display #\\*) x)\n          (call/cc (lambda (k2) k2)))])\n  (yin yang))\n\n;;\u518d\u5bf9yang\u6c42\u503c\uff0c\u5c4f\u5e55\u8f93\u51fa*\uff0c\u7136\u540e\u5f97\u5230\n(let* ([yin  k1]\n       [yang k2])\n  (yin yang))       ;\u5373(k1 k2)\n\n;;\u540c\u65f6\uff0c\u65b0\u7684k2\u5ef6\u7eed\u51fd\u6570\u7684\u884c\u4e3a\u662f\n(let* \n  ([yin  k1]\n   [yang ((lambda (x) (display #\\*) x)\n          ####)])\n  (yin yang))\n\n;;\u73b0\u5728\u5bf9(k1 k2)\u6c42\u503c\uff0c\u4f1a\u5f97\u5230\n(let* \n  ([yin k0]  \n   [yang ((lambda (x) (display #\\*) x)\n          k2)]) \n  (yin yang))\n\n;;\u5f53\u7136\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4e00\u5b9a\u4f1a\u5148\u5bf9yang\u6c42\u503c\uff0c\u5c4f\u5e55\u4f1a\u8f93\u51fa*\n;;\u540c\u65f6\u8868\u8fbe\u5f0f\u53d8\u4e3a\n(let* ([yin  k0]\n       [yang k2])\n  (yin yang))       ;\u5373(k0 k2)\n\n;;\u663e\u7136\uff0c\u4ee5\u4e0a\u505a\u4e86\u56db\u4ef6\u4e8b\n;;\u5728\u5c4f\u5e55\u4e0a\u8f93\u51fa@*\n;;\u8c03\u7528(k1 k2)\n;;\u5728\u5c4f\u5e55\u4e0a\u8f93\u51fa*\n;;\u539f\u6765\u51fd\u6570\u53d8\u6210\u4e86(k0 k2)\n</code></pre> <p>(3) \u73b0\u5728\u5bf9<code>(k0 k2)</code>\u7ee7\u7eed\u6c42\u503c\uff0c\u8fc7\u7a0b\u4e0e\u4e0a\u9762\u7684\u8fc7\u7a0b\u7c7b\u4f3c\uff0c\u540c\u6837\u8981\u6ce8\u610f\uff0c<code>yang</code>\u7684\u5ef6\u7eed\u4f1a\u7ee7\u7eed\u6539\u53d8\uff0c\u63a8\u5bfc\u5982\u4e0b\u3002  </p> <pre><code>;;\u5bf9(k0 k2)\u6c42\u503c\uff0c\u90a3\u5c31\u662f\u628ak2\u4ee3\u6362\u5230\u524d\u9762\u7684k0\u4ee3\u7801\u5757\u91cc\n(let* \n  ([yin  ((lambda (x) (display #\\@) x)\n          k2)]\n   [yang ((lambda (x) (display #\\*) x)\n          (call/cc (lambda (k3) k3)))]) ;\u8868\u8fbe\u5f0f\u53d8\u4e86\uff0c\u5ef6\u7eed\u4e5f\u4f1a\u53d8\uff0c\u7528k3\n  (yin yang))\n\n;;\u9996\u5148\u5bf9yin\u6c42\u503c\uff0c\u5c4f\u5e55\u8f93\u51fa@\uff0c\u7136\u540e\u5f97\u5230\n(let* \n  ([yin  k2]\n   [yang ((lambda (x) (display #\\*) x)\n          (call/cc (lambda (k3) k3)))])\n  (yin yang))\n\n;;\u518d\u5bf9yang\u6c42\u503c\uff0c\u5c4f\u5e55\u8f93\u51fa*\uff0c\u7136\u540e\u5f97\u5230\n(let* ([yin  k2]\n       [yang k3])\n  (yin yang))       ;\u5373(k2 k3)\n\n;;\u540c\u65f6\uff0c\u65b0\u7684k3\u5ef6\u7eed\u51fd\u6570\u7684\u884c\u4e3a\u662f\n(let* \n  ([yin  k2]\n   [yang ((lambda (x) (display #\\*) x)\n          ####)])\n  (yin yang))\n\n;;(k2 k3)\u4f1a\u53d8\u6362\u4e3a\n(let* \n  ([yin k1]  ;\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684k2\u51fd\u6570\u5728\u4e0a\u4e00\u4e2a\u4ee3\u7801\u5757\u5df2\u7ecf\u7ed9\u51fa\n   [yang ((lambda (x) (display #\\*) x)\n          k3)]) \n  (yin yang))\n\n;;\u5bf9yang\u8fdb\u884c\u7ed1\u5b9a\uff0c\u5c4f\u5e55\u4f1a\u8f93\u51fa*\uff0c\u7136\u540e\u8868\u8fbe\u5f0f\u53d8\u6362\u4e3a\n(let* ([yin  k1]\n       [yang k3])\n  (yin yang))       ;\u5373(k1 k3)\n\n;;\u5bf9(k1 k3)\u6c42\u503c\uff0c\u6309\u7167\u4e0a\u4e2a\u4ee3\u7801\u5757\u7684\u63a8\u5bfc\u5e94\u8be5\u662f\n(let* \n  ([yin k0]  \n   [yang ((lambda (x) (display #\\*) x)\n          k3)]) \n  (yin yang))\n\n;;\u5bf9yang\u8fdb\u884c\u7ed1\u5b9a\uff0c\u4f1a\u7ee7\u7eed\u8f93\u51fa*\uff0c\u8868\u8fbe\u5f0f\u53d8\u6362\u4e3a\n(let* ([yin  k0]\n       [yang k3])\n  (yin yang))       ;\u5373(k0 k3)\n\n;;\u6240\u4ee5\u4e0a\u9762\u7684\u4ee3\u7801\u5b9e\u9645\u4e0a\u505a\u4e86\u5982\u4e0b\u7684\u4e8b\u60c5\uff1a\n;;\u8f93\u51fa@*\uff0c(k0 k2)\u53d8\u6362\u4e3a(k2 k3)\n;;\u8f93\u51fa*\uff0c\u53d8\u6362\u4e3a(k1 k3)\n;;\u8f93\u51fa*\uff0c\u53d8\u6362\u4e3a(k0 k3)\n</code></pre> <p>(4) \u5bf9<code>(k0 k3)</code>\u6c42\u503c\u4e0e\u4e0a\u9762\u57fa\u672c\u4e00\u6837\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684<code>k4</code>\u5ef6\u7eed\u51fd\u6570\uff0c\u7136\u540e\u7ecf\u8fc7\u4e00\u7cfb\u5217\u8f6c\u6362\u53d8\u6210<code>(k0 k4)</code>\u7684\u8c03\u7528\u3002   </p> <p>\u4ee5\u4e0a\u8fc7\u7a0b\u4f1a\u65e0\u7a77\u65e0\u5c3d\u7684\u6267\u884c\u4e0b\u53bb\uff0c\u603b\u4f53\u8fc7\u7a0b\u53ef\u4ee5\u7528\u4ee5\u4e0b\u7684\u7b80\u8bb0\u6cd5\u8868\u793a\uff08k0\u8868\u793a\u4ea7\u751fk0\u8fd9\u4e2a\u51fd\u6570\uff09\uff1a <code>k0-&gt;@-&gt;k1-&gt;*-&gt;(k0 k1)-&gt;@-&gt;k2-&gt;*-&gt;(k1 k2)-&gt;*-&gt;(k0 k2)-&gt;@-&gt;k3-&gt;*-&gt;(k2 k3)-&gt;*-&gt;(k1 k3)-&gt;*-&gt;(k0 k3)-&gt;@-&gt;k4-&gt;......</code></p> <p>\u8fd9\u91cc\u5c24\u5176\u8981\u6ce8\u610f\u7684\u662f\u6c42\u503c\u987a\u5e8f\uff0c\u5176\u5b9e\u7528\u8c03\u7528\u6808\u7684\u65b9\u5f0f\u53bb\u63a8\u5bfc\u66f4\u4e3a\u7b80\u5355\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u8fd9\u4e2a\u95ee\u9898\u73b0\u5728\u770b\u8d77\u6765\u4e0d\u662f\u90a3\u4e48\u96be\u4e86\u3002  </p> <p>\u6ce8\u610f\uff1a\u7eb8\u4e0a\u5f97\u6765\u7ec8\u89c9\u6d45\uff0c\u63a8\u5bfc\u5b8c\u4e86\u5c31\u6d17\u8138\u3002 </p>"},{"location":"markdown/lisp_call_cc/#7","title":"7. \u5410\u69fd","text":"<p><code>call\\cc</code>\u867d\u7136\u63d0\u4f9b\u4e86\u5404\u79cd\u5947\u6280\u6deb\u5de7\uff0c\u4f46\u5982\u679c\u4f60\u8010\u5fc3\u7684\u770b\u5230\u8fd9\u91cc\uff0c\u5e94\u8be5\u660e\u767d\u8fd9\u4e1c\u897f\u6709\u591a\u4e48\u53ef\u6015\u3002 \u5b83\u5728Scheme\u8bed\u8a00\u4e2d\u662f\u4e00\u4e2aLow level\u7684API\u51fd\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u80fd\u4e0d\u7528\u5c3d\u91cf\u4e0d\u8981\u7528\u3002 \u8fd9\u4e1c\u897f\u8bf4\u597d\u542c\u70b9\u662f\u5b9e\u73b0\u4e86\u7a0b\u5e8f\u5b87\u5b99\u7684\u866b\u6d1e\uff0c\u8bf4\u96be\u542c\u70b9\u5c31\u662f\u5230\u5904\u94bb\u773c\u513f\u3002\u505a\u4e00\u4e0b\u601d\u7ef4\u7ec3\u4e60\u8fd8\u597d\uff0c\u8981\u662f\u7528\u6765\u6784\u5efa\u4e00\u822c\u7a0b\u5e8f\uff0c\u4f30\u8ba1\u4e0d\u4f46\u4f1a\u79c3\u5934\uff0c\u751a\u81f3\u53ef\u80fd\u4e27\u547d\u3002 \u8c8c\u4f3cC++\u4e5f\u6709<code>call\\cc</code>\uff0c\u6211\u5b9e\u5728\u96be\u4ee5\u731c\u6d4b\u5176\u8bed\u6cd5\u5e94\u8be5\u600e\u4e48\u8bbe\u8ba1\uff0cLisp\u7248\u672c\u7684call/cc\u5df2\u7ecf\u8db3\u591f\u9020\u6210\u5fc3\u667a\u8d1f\u62c5\uff0cC++\uff1f\u8fd8\u662fC\u8279\u5427\u3002  </p>"},{"location":"markdown/lisp_func_programming/","title":"\u4ece\u4e00\u4e2a\u5c0f\u4f8b\u5b50\u770b\u51fd\u6570\u5f0f\u7f16\u7a0b","text":"<p>\u5927\u4f53\u6765\u8bf4\uff0c\u7f16\u7a0b\u8303\u5f0f\u53ef\u80fd\u6709\u4e09\u79cd\uff1a\u51fd\u6570\u5f0f\uff08Functional\uff09\u3001\u547d\u4ee4\u5f0f\uff08Imperative\uff09\u3001\u9762\u5411\u5bf9\u8c61\uff08OOP\uff09\u3002 \u8fd8\u6709\u6240\u8c13\u51fd\u6570\u5f0f\u7f16\u7a0b\u8bed\u8a00\u3001\u547d\u4ee4\u5f0f\u7f16\u7a0b\u8bed\u8a00\u3001\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u8bed\u8a00\u7b49\u8bf4\u6cd5\uff0c\u610f\u4e3a\u67d0\u79cd\u8bed\u8a00\u662f\u67d0\u79cd\u7f16\u7a0b\u8303\u5f0f\u7684\uff0c\u4f46\u8fd9\u6837\u7684\u8bba\u65ad\u5e76\u4e0d\u6210\u7acb\uff0c\u5f88\u591a\u8bed\u8a00\u662f\u652f\u6301\u591a\u8303\u5f0f\u7684\uff0c\u6bd4\u5982Java8\u5f15\u5165\u4e86<code>lambda</code>\u4ece\u800c\u652f\u6301\u90e8\u5206\u51fd\u6570\u5f0f\u7f16\u7a0b\u8303\u5f0f\uff1bScheme\u8bed\u8a00\u91cc\u5f15\u5165\u4e86\u8d4b\u503c\u8bed\u53e5\uff0c\u5b8c\u5168\u53ef\u4ee5\u5199\u51fa\u7eaf\u547d\u4ee4\u5f0f\u98ce\u683c\u7684\u7a0b\u5e8f\uff0c\u4e14\u65e0\u9700\u50cfC++\u548cJava\u90a3\u6837\u589e\u52a0\u8bed\u6cd5\u7cd6\u5373\u53ef\u8fdb\u884c\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u3002 \u7f16\u7a0b\u9886\u57df\u5f88\u591a\u672f\u8bed\u592a\u4e0d\u4e25\u8c28\uff0c\u5b8c\u5168\u6ca1\u6709\u6570\u5b66\u91cc\u201cN-\\epsilon\u5b9a\u4e49\u201d\u90a3\u6837\u4f18\u7f8e\u7684\u4e1c\u897f\u3002  </p> <p>\u590d\u4e60\u4e00\u4e0b\uff1a\u8bbeX_n\u4e3a\u4e00\u65e0\u7a77\u6570\u5217\uff0c\u82e5{\\exists}\u5e38\u6570a\uff0c\u5bf9\u4e8e{\\forall} \\epsilon &gt; 0\uff0c{\\exists}\u6b63\u6574\u6570N\uff0c\u4f7f\u5f97\u5f53n&gt;N\u65f6\uff0c\u5747\u6709|X_n-a|&lt;\\epsilon\u6210\u7acb\uff0c\u5219\u79f0a\u4e3a\u6570\u5217X_n\u7684\u6781\u9650\u3002 </p> <p>\u4ee5\u4e0b\u7c97\u7565\u7684\u7ed9\u51fa\u4e09\u79cd\u7f16\u7a0b\u8303\u5f0f\u7684\u4e3b\u8981\u7279\u5f81\uff1a 1. \u51fd\u6570\u5f0f\u7f16\u7a0b\uff1a  \u51fd\u6570\u662f\u7b2c\u4e00\u516c\u6c11\uff0c\u4f60\u53ef\u4ee5\u5728\u7a0b\u5e8f\u7684\u4efb\u4f55\u5730\u65b9\u5b9a\u4e49\u51fd\u6570\uff0c\u5e76\u628a\u5b83\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\u8fd9\u91cc\u7684\u51fd\u6570\u662f\u201c\u65e0\u72b6\u6001\u7684\u201d\uff0c\u7ed9\u5b9a\u4e00\u4e2a\u8f93\u5165\uff0c\u65e0\u8bba\u4f55\u65f6\u6267\u884c\u5b83\uff0c\u5176\u8f93\u51fa\u6c38\u8fdc\u76f8\u540c\u3002\u201c\u7eaf\u51fd\u6570\u5f0f\u7f16\u7a0b\u8bed\u8a00\u201d\u662f\u6ca1\u6709\u8d4b\u503c\u8bed\u53e5\u7684\uff08\u5982haskell\u8bed\u8a00\uff09\uff0c\u4e0d\u5141\u8bb8\u53d8\u91cf\u6216\u5bf9\u8c61\u6709\u201c\u72b6\u6001\u201d\uff0c\u51fd\u6570\u7684\u8f93\u51fa\u53ea\u548c\u8f93\u5165\u6709\u5173\uff0c\u548c\u4ec0\u4e48\u65f6\u95f4\u6267\u884c\u5b83\u65e0\u5173\u3002\uff08\u751f\u6210\u968f\u673a\u6570\u7684<code>rand()</code>\u4e0d\u662f\u51fd\u6570\uff0c\u800c\u662f\u4e00\u4e2a\u7a0b\u5e8f\uff09\u3002 2. \u547d\u4ee4\u5f0f\u7f16\u7a0b\uff1a \u7a0b\u5e8f\u7531\u4e00\u4e32\u6709\u5e8f\u7684\u5b50\u7a0b\u5e8f\uff08procedure\uff09\u7ec4\u6210\uff0c\u6bcf\u4e2a\u5b50\u7a0b\u5e8f\u7684\u6267\u884c\u987a\u5e8f\u6709\u4e25\u683c\u7684\u5148\u540e\u4e4b\u5206\u3002\u901a\u8fc7\u8d4b\u503c\u8bed\u53e5\u5f15\u5165\u4e86\u201c\u72b6\u6001\u201d\uff0c\u4ea4\u6362\u8d4b\u503c\u8bed\u53e5\u7684\u987a\u5e8f\u53ef\u80fd\u4f1a\u5f97\u5230\u4e0d\u540c\u7684\u8f93\u51fa\uff0c\u8fd9\u4e2a\u7279\u6027\u53eb\u526f\u4f5c\u7528\uff08side effect\uff09\u3002 3. OOP\u7f16\u7a0b\uff1a \u7a0b\u5e8f\u57fa\u4e8e\u4e00\u7cfb\u5217\u7c7b\u578b\uff08\u672f\u8bed\u662f<code>type</code>\uff0cC++\u548cJava\u91cc\u53eb<code>class</code>\uff09\u6784\u5efa\uff0c\u7c7b\u578b\u4e4b\u95f4\u6709\u7ee7\u627f\u3001\u5305\u542b\u7b49\u5173\u7cfb\u3002\u7c7b\u578b\u628a\u6570\u636e\uff08\u4e5f\u53eb\u53d8\u91cf\uff09\u548c\u5b50\u7a0b\u5e8f\uff08\u4e5f\u53eb\u65b9\u6cd5\uff09\u7ed1\u5b9a\u5230\u4e00\u8d77\uff0c\u7528\u91cd\u8f7d\u5b9e\u73b0\u591a\u6001\u3002\u7ad9\u5728OOP\u7684\u89d2\u5ea6\uff0c\u4f1a\u628a\u547d\u4ee4\u5f0f\u7f16\u7a0b\u53eb\u505a\u201c\u8fc7\u7a0b\u5f0f\u7f16\u7a0b\u201d\u3002\u4e3e\u4e2a\u4e0d\u6070\u5f53\u7684\u4f8b\u5b50\uff08\u8fd9\u4e2a\u6897\u6765\u81ea\u4e8eSteve Yegge\u7684\u300a\u7a0b\u5e8f\u5458\u7684\u5450\u558a\u300b\uff09\uff1a\u547d\u4ee4\u5f0f\u7f16\u7a0b\u662f\u52a8\u8bcd\u4e16\u754c\uff0c\u800cOOP\u662f\u540d\u8bcd\u4e16\u754c\u3002\u5012\u5783\u573e\u8fd9\u4e00\u51fd\u6570\u5728C\u8bed\u8a00\u91cc\u662f<code>clean(trash)</code>\uff0c\u800c\u5728Java\u91cc\u662f<code>trash.clean()</code>\u3002\u628a\u5927\u8c61\u653e\u8fdb\u51b0\u7bb1\u5728C\u8bed\u8a00\u91cc\u662f<code>put(elephant, refrigerator)</code>\uff0c\u800c\u5728\u795e\u5723\u7684\u539f\u6559\u65e8Java\u6559\u5802\u91cc\u9700\u5f00\u4f1a\u8ba8\u8bba\u5230\u5e95\u5e94\u8be5\u641e\u6210<code>refigerator.put(elephant)</code>\u8fd8\u662f<code>elephant.putInto(refrigerator)</code>\uff0c\u4f1a\u8bae\u4e0d\u6b22\u800c\u6563\u5e76\u5404\u81ea\u5f00\u53d1\u4e86\u4e24\u5957\u4e0d\u540c\u7684\u7c7b\u5e93\u3002\u4e0d\u5f97\u4e0d\u8bf4\u8fd8\u662f\u5927\u4e3b\u6559\u82f1\u660e\u795e\u6b66\uff0c\u5728\u5341\u5e74\u540e\u62cd\u677f\uff0c\u5fc5\u987b\u5199\u6210<code>putter.addObject(elephant)</code>,\u7136\u540e<code>putter.addDestination(refrigerator)</code>\uff0c\u6700\u7ec8<code>putter.run()</code>\u3002\u53c8\u8fc7\u4e86\u4e00\u5e74\uff0c\u6559\u5ef7\u9881\u5e03\u4e86\u4e00\u90e8\u540d\u4e3a\u300a\u8bbe\u8ba1\u6a21\u5f0f\u300b\u7684\u6cd5\u5178\uff0c\u89c4\u5b9a\u4e00\u5207\u4e0d\u8fd9\u6837\u5199\u7684\u90fd\u662f\u5f02\u7aef\u3002\u6240\u4ee5\u628a\u5927\u8c61\u88c5\u8fdb\u51b0\u7bb1\u771f\u7684\u9700\u8981\u4e09\u6b65\u3002\uff1a\uff09  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u4e5f\u6709\u4eba\u8ba4\u4e3aOOP\u53ea\u662f\u5728\u547d\u4ee4\u5f0f\u8303\u5f0f\u4e0a\u589e\u52a0\u4e86\u201c\u628a\u8fc7\u7a0b\u548c\u6570\u636e\u7ed1\u5b9a\u5230\u4e00\u8d77\u201d\u7684\u8bed\u6cd5\u7cd6\uff0c\u4ece\u6709\u65e0\u5f15\u5165\u526f\u4f5c\u7528\u8fd9\u4e2a\u89d2\u5ea6\u6765\u5206\u6790\uff0cOOP\u4e5f\u662f\u547d\u4ee4\u5f0f\u7684\u3002\u5f53\u7136\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528OOP\u6a21\u62df\u51fa\u65e0\u526f\u4f5c\u7528\u7684\u7f16\u7a0b\u98ce\u683c\uff0c\u7f16\u7a0b\u754c\u7684\u672f\u8bed\u4f53\u7cfb\u5e76\u4e0d\u4e25\u8c28\u3002</p> <p>\u8fd1\u5e74\u6765\uff0c\u51fd\u6570\u5f0f\u7f16\u7a0b\u8d8a\u7092\u8d8a\u70ed\uff0c\u597d\u50cf\u4e0d\u201c\u51fd\u6570\u5f0f\u201d\u5c31\u4ee3\u8868\u7740\u843d\u540e\u3002\u4f46\u5176\u5b9e\u51fd\u6570\u5f0f\u7f16\u7a0b\u59cb\u4e8e1960\u5e74\uff0cMIT\u8dd1\u5728IBM 704\u7684Lisp\u8bed\u8a00\u7684\u7b2c\u4e00\u7248\u5c31\u975e\u5e38\u7684\u201c\u51fd\u6570\u5f0f\u201d\u3002\u5b83\u53ea\u6bd4\u547d\u4ee4\u5f0f\u8bed\u8a00\u7684\u7956\u5b97Fortran II\u665a\u4e86\u4e24\u5e74\u3002  \u73b0\u5728\u7f51\u4e0a\u70ed\u7092\u7684\u51fd\u6570\u5f0f\u7f16\u7a0b\u6982\u5ff5\u548c\u4e00\u4e9b\u4ee3\u7801\u8303\u4f8b\u4ecd\u7136\u662f1960s~1970s\u7684\u4e1c\u897f\uff0c\u5982\u679c\u4e00\u5b9a\u8981\u8bf4\u5176\u201c\u5148\u8fdb\u201d\uff0c\u5012\u4e0d\u5982\u8bf4\u662f\u201c\u4e0d\u518d\u72af\u8822\u201d\u3002 \u867d\u7136\u6211\u5e76\u975e\u7a0b\u5e8f\u8bed\u8a00\u4e13\u5bb6\uff0c\u4f46\u7ecf\u5e38\u542c\u5230\u201c\u6211\u628a\u8fd9\u4e2a3000\u884c\u4ee3\u7801\u7b97\u6cd5\u91cc\u7684\u91cd\u590d\u903b\u8f91\u63d0\u53d6\u4e3a15\u4e2a\u51fd\u6570\uff0c\u4e3b\u7a0b\u5e8f\u73b0\u5728\u53ea\u670920\u884c\uff0c\u903b\u8f91\u6e05\u6670\uff0c\u4fbf\u4e8e\u7ef4\u62a4\uff0c\u51fd\u6570\u5f0f\u7f16\u7a0b\u679c\u7136\u6709\u4e9b\u9053\u7406\u201d\uff0c\u9a73\u4e5f\u4e0d\u662f\uff0c\u5fcd\u4e5f\u4e0d\u662f\uff0c\u5b9e\u5728\u8ba9\u4eba\u54ed\u7b11\u4e0d\u5f97\u3002\u8fd9\u4e9b\u521d\u5c1d\u7f16\u7a0b\u5feb\u4e50\u7684\u5b69\u5b50\u4eec\u5475\uff0c\u4e0d\u662f\u6709\u51fd\u6570\u5c31\u662f\u201c\u51fd\u6570\u5f0f\u201d\u54e6\uff01   \u672c\u6587\u8bd5\u56fe\u7528\u4e00\u4e2a\u5b9e\u4f8b\u5e26\u4f60\u7b80\u5355\u4f53\u9a8c\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u4e00\u70b9\u76ae\u6bdb\uff0c\u4e00\u6765\u907f\u514d\u5927\u5bb6\u201c\u9e21\u540c\u9e2d\u8bb2\u201d\uff0c\u8bf4\u5f97\u53e3\u5e72\u820c\u71e5\uff1b\u4e8c\u6765\u609f\u9053\u5168\u9760\u7f18\u5206\uff0c\u7406\u89e3\u6b63\u786e\u4e0e\u5426\u5e76\u4e0d\u5f71\u54cd\u4e00\u65e5\u4e09\u9910\uff0c\u82df\u5ef6\u6b8b\u5598\u3002 \u8be5\u4f8b\u5b50\u6765\u81ea\u300a\u8ba1\u7b97\u673a\u7a0b\u5e8f\u7684\u6784\u9020\u548c\u89e3\u91ca\uff08SICP\uff09\u300b\u4e00\u4e66\uff0c\u4ee3\u7801\u548c\u539f\u4e66\u4e0d\u5b8c\u5168\u76f8\u540c\u3002\u53cb\u60c5\u63d0\u793a\uff1a\u5df2\u505a\u5b8c\u6b64\u795e\u4e66\u4e60\u9898\u8005\u5c06\u6d6a\u8d39\u751f\u547d\u7ea620\u5206\u949f\uff0c\u52ff\u8c13\u8a00\u4e4b\u4e0d\u9884\u4e5f\u3002</p>          \u56fe1\u300aSICP\u300b\u7684\u5c01\u9762  <p>\u91cd\u8981\u7684\u8bdd\u8bf4\u4e09\u904d\uff1a\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u201c\u51fd\u6570\u201d\u6307\u7684\u662f\u201c\u7eaf\u51fd\u6570\u201d\uff01\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u201c\u51fd\u6570\u201d\u6307\u7684\u662f\u201c\u7eaf\u51fd\u6570\u201d\uff01\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u201c\u51fd\u6570\u201d\u6307\u7684\u662f\u201c\u7eaf\u51fd\u6570\u201d\uff01</p>"},{"location":"markdown/lisp_func_programming/#1","title":"1. \u5e8f\u5bf9\u7c7b\u578b","text":"<p>\u5728Lisp\u8bed\u8a00\u5bb6\u65cf\uff0c\u5b58\u5728\u4e00\u4e2a\u57fa\u672c\u7684\u6570\u636e\u7ed3\u6784\uff08\u4e5f\u662f\u4e00\u4e2a\u7c7b\u578b\uff09\u2014\u2014\u5e8f\u5bf9\uff08<code>pair</code>\uff09\u3002\u5b83\u6709\u4e25\u683c\u6570\u5b66\u5b9a\u4e49\uff1a\u201c\u5bf9{\\forall}\u7684\u4e24\u4e2a\u4e8b\u7269a\u548cb\uff0c\u82e5{\\exists}\u4e09\u4e2a\u6620\u5c04\u5206\u522b\u6ee1\u8db3p=cons(a,b)\u3001a=car(p)\u548cb=cdr(p)\uff0c\u5219\u79f0p\u4e3a\u4e00\u4e2a\u5e8f\u5bf9\u201d\u3002  </p> <p>\u6ce8\uff1acons\u662f\u6784\u9020\uff08construct\uff09\u8fd9\u4e2a\u52a8\u8bcd\u7684\u7b80\u5199\uff0ccar\u548ccdr\u5219\u6765\u81eaLisp\u6700\u521d\u5728IBM 704\u673a\u5668\u4e0a\u7684\u5b9e\u73b0\u3002\u8fd9\u79cd\u673a\u5668\u63d0\u4f9b\u4e00\u4e2a\u63a5\u53e3\uff0c\u4f7f\u7528\u6237\u80fd\u591f\u8bbf\u95ee\u5bc4\u5b58\u5668(register)\u5730\u5740(address)\u548c\u5b83\u7684\"\u51cf\u91cf\"(decrement)\u3002car\u8868\u793a\u201cContents of Address part of Register\u201d\uff0ccdr\uff08\u8bfb\u4f5c\u201ccould-er\u201d\uff09\u8868\u793a\"Contents of Decrement part of Register\"\uff0c\u5b83\u4eec\u5206\u522b\u662f\u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u548c\u5bc4\u5b58\u5668\u51cf\u91cf\u7684\u5185\u5bb9\u3002 </p> <p>\u5e8f\u5bf9\u4e4b\u4e8eLisp\uff0c\u6b63\u5982\u78b1\u57fa\u4e4b\u4e8e\u751f\u7269\uff0c01\u4e4b\u4e8e\u7535\u5b50\u8ba1\u7b97\u673a\uff0c\u9634\u9633\u4e4b\u4e8e\u7b97\u547d\u5148\u751f\uff0c\u677f\u7816\u4e4b\u4e8e\u623f\u5b50......\u82e5\u975e\u8981\u628a\u7a0b\u5e8f\u7684\u6570\u636e\u7c7b\u578b\u5206\u4e3a<code>float</code>\u3001<code>char</code>\u3001<code>int</code>\u3001<code>bool</code>\u7b49\u201c\u57fa\u672c\u7c7b\u578b\u201d\u548c<code>struct</code>\u3001<code>class</code>\u3001<code>vector</code>\u3001<code>list</code>\u3001<code>map</code>\u7b49\u201c\u9ad8\u9636\u7c7b\u578b\u201d\u7684\u8bdd\uff0c\u90a3\u4e48<code>pair</code>\u5c31\u662f\u9ad8\u9636\u7c7b\u578b\u91cc\u6700\u57fa\u672c\u7684\u7c7b\u578b\u3002\u4e0b\u56fe\u6f14\u793a\u4e86<code>pair</code>\u7684\u51e0\u79cd\u7ec4\u5408\uff0c\u5176\u4e2d\u4e4b\u5999\u5c3d\u5728\u4e09\u7f2a\u4e09\u83e9\u63d0\u5904\u3002</p>          \u56fe2 \u51e0\u79cd\u5e8f\u5bf9\u7ec4\u5408\u6210\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6700\u540e\u4e00\u4e2a\u7ec6\u601d\u6781\u6050  <p>\u5982\u4f55\u7528\u7f16\u7a0b\u8bed\u8a00\u6765\u5b9e\u73b0<code>pair</code>\u5462\uff1f\u663e\u7136\u53ea\u8981\u5b9e\u73b0\u4e86<code>cons</code>\u3001<code>car</code>\u548c<code>cdr</code>\u5373\u53ef\u3002\u8fd9\u91cc\u6211\u4eec\u7528Scheme\u8bed\u8a00\uff08\u4e00\u79cd\u8bed\u6cd5\u6700\u4e25\u8c28\u7684Lisp\u65b9\u8a00\uff09\u6765\u5b9e\u73b0\u5b83\u3002  </p> <p>\u7ea6\u5b9a\uff1a\u540e\u6587\u7684\u201c\u6570\u636e\u201d\u8fd9\u4e00\u672f\u8bed\u53ef\u6682\u65f6\u6307\u4ee3\u67d0\u4e2a\u4f5c\u7528\u57df\u7684\u53d8\u91cf\uff0c\u800c\u51fd\u6570\u548c\u7a0b\u5e8f\u7684\u610f\u601d\u90fd\u662f\u201c\u7eaf\u51fd\u6570\u201d\u3002 </p>"},{"location":"markdown/lisp_func_programming/#2","title":"2. \u6570\u636e\u5bfc\u5411\u7684\u5e8f\u5bf9\u5b9e\u73b0","text":"<p>Scheme\u8bed\u8a00\u63d0\u4f9b\u4e86\u539f\u751f\u7684\uff08primitive\uff09<code>cons</code>\u3001<code>car</code>\u548c<code>cdr</code>\u51fd\u6570\u3002\u6211\u4eec\u6682\u4e14\u5047\u8bbeScheme\u6ca1\u6709\u5b83\u4eec\uff0c\u800c\u53ea\u63d0\u4f9b\u4e86\u6570\u7ec4\uff08<code>vector</code>\uff09\u8fd9\u4e2a\u7c7b\u578b\u3002 \u6309\u6700\u81ea\u7136\u7684\u601d\u7ef4\u65b9\u5f0f\uff0c<code>cons</code>\u51fd\u6570\u8fd4\u56de2\u4e2a\u6cdb\u578b\u5143\u7d20\u7684\u6570\u7ec4\uff0c<code>car</code>\u51fd\u6570\u8fd4\u56de\u6570\u7ec4\u7684\u7b2c1\u4e2a\u5143\u7d20\uff0c<code>cdr</code>\u8fd4\u56de\u7b2c2\u4e2a\u3002\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>;;\u7528\u6570\u636e\u578b\u601d\u7ef4\u6765\u5b9e\u73b0\u7684pair\u7c7b\u578b\n(define cons                    ;\u5b9a\u4e49 cons  \u4e3a\n  (lambda (a b)                 ;  \u4e00\u4e2a2\u53c2\u6570a,b\u7684\u51fd\u6570\uff0c \u51fd\u6570\u4f53\uff08body\uff09\u4e3a\n    (vector a b)))              ;     \u6784\u9020\u4e00\u4e2a\u6570\u7ec4{a,b}\u5e76\u8fd4\u56de\u5b83\n\n(define car                     ;\u5b9a\u4e49 car   \u4e3a\n  (lambda (p)                   ;  \u4e00\u4e2a\u5355\u53c2\u6570p\u7684\u51fd\u6570\uff0c \u51fd\u6570\u4f53\u4e3a\n    (vector-ref p 0)))          ;     \u8fd4\u56de\u5bf9\u6570\u7ec4p\u53d6\u4e0b\u6807\u4e3a0\u7684\u5143\u7d20      \n\n(define cdr                     ;\u5b9a\u4e49 cdr   \u4e3a\n  (lambda (p)                   ;  \u4e00\u4e2a\u5355\u53c2\u6570p\u7684\u51fd\u6570\uff0c \u51fd\u6570\u4f53\u4e3a\n    (vector-ref p 1)))          ;     \u8fd4\u56de\u5bf9\u6570\u7ec4p\u53d6\u4e0b\u6807\u4e3a1\u7684\u5143\u7d20\n\n;;\u6d4b\u8bd5\u4ee3\u7801\n(define a-pair (cons 1 2))      ;\u5b9a\u4e49 a-pair \u4e3a (cons 1 2) \u751f\u6210\u7684pair\n(display a-pair)                ;\u6253\u5370a-pair\u7684\u503c\uff0c\u5e94\u8be5\u662f#(1 2)\uff0c\u6570\u7ec4\u7b80\u8bb0\u7b26\n(newline)                       ;\u6253\u5370\u6362\u884c\u7b26\n(display (car a-pair))          ;\u6253\u5370(car a-pair)\u7684\u503c\uff0c\u5e94\u4e3a1\n(newline)                       ; ......\n(display (cdr a-pair))          ;\u6253\u5370(cdr a-pair)\u7684\u503c\uff0c\u5e94\u8be52      \n(newline)                       ; ......\n</code></pre> \u6211\u4eec\u6682\u4e0d\u8003\u8651\u53c2\u6570<code>p</code>\u4e07\u4e00\u4e0d\u662f\u6570\u7ec4\u6216\u5143\u7d20\u4e2a\u6570\u975e2\u7684\u60c5\u51b5\uff0c\u6b64\u65f6Scheme\u4f1a\u5728\u8fd0\u884c\u65f6\u629b\u51fa\u5f02\u5e38\u3002\u6267\u884c\u4ee5\u4e0a\u7a0b\u5e8f\uff0c\u5c4f\u5e55\u8f93\u51fa\u5e94\u4e3a\uff1a <pre><code>#(1 2)\n1\n2\n</code></pre> Lisp\u539f\u751f<code>cons</code>\u51fd\u6570\u6784\u9020\u7684<code>pair</code>\u7684\u503c\u4e00\u822c\u6253\u5370\u4e3a<code>(1 . 2)</code>\uff08\u53ef\u7406\u89e3\u4e3aJava\u7684<code>pair.ToString()</code>\uff09\uff0c\u800c\u6211\u4eec\u91cd\u65b0\u5b9e\u73b0\u7684<code>cons</code>\u51fd\u6570\u8fd4\u56de\u503c\u6253\u5370\u4e3a<code>#(1 2)</code>\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ece\u6570\u636e\u7684\u7ec4\u7ec7\u5f62\u5f0f\u770b\uff0c\u6211\u4eec\u5b9e\u73b0\u7684<code>cons</code>\u548c\u539f\u751f<code>cons</code>\u662f\u4e0d\u540c\u7684\u4e1c\u897f\uff0c\u4f46\u4e8c\u8005\u5728\u8bed\u4e49\u4e0a\u5374\u662f\u5b8c\u5168\u76f8\u540c\u7684\u3002\u6211\u4eec\u7684<code>cons</code>\u3001<code>car</code>\u548c<code>cdr</code>\u51fd\u6570\u5b8c\u5168\u6ee1\u8db3<code>pair</code>\u7684\u4e25\u8c28\u6570\u5b66\u5b9a\u4e49\u3002\u65b0\u7684<code>pair</code>\u7c7b\u578b\u548c\u539f\u751f\u7c7b\u578b\u4e00\u6837\u53ef\u4ee5\u7ec4\u5408\u51fa\u56fe2\u90a3\u6837\u7684\u94fe\u8868\u3001\u4e8c\u53c9\u6811\u7b49\u9ad8\u9636\u7c7b\u578b\u3002 \u5728\u51fd\u6570\u5f0f\u7f16\u7a0b\u8303\u5f0f\u91cc\uff0c\u8fd8\u6709\u4e00\u4e2a\u66f4\u53ef\u6015\u7684<code>pair</code>\u5b9e\u73b0\u65b9\u5f0f\uff0c\u53ef\u4ee5\u5b8c\u5168\u4e0d\u8003\u8651\u4efb\u4f55\u6570\u636e\u7ec4\u7ec7\u5f62\u5f0f\uff0c\u53ea\u7528\u7eaf\u51fd\u6570\u6765\u5b9e\u73b0<code>pair</code>\u3002</p>"},{"location":"markdown/lisp_func_programming/#3","title":"3. \u51fd\u6570\u5f0f\u7684\u5e8f\u5bf9\u5b9e\u73b0","text":"<p>\u5982\u679c\u7a0b\u5e8f\u733f\u4ece\u56fe2\u6765\u7406\u89e3<code>pair</code>\uff0c\u4ed6\u4f1a\u5f88\u81ea\u7136\u7684\u8ba4\u4e3a\u6bcf\u4e2a\u65b9\u5757\u662f\u4e00\u4e2a\u6570\u636e\uff0c\u6bcf\u4e2a\u5c0f\u9ed1\u70b9\u662f\u4e00\u4e2a\u6307\u9488\u3002\u7b2c\u4e00\u53cd\u5e94\u5c31\u7528\u6570\u636e\u5bfc\u5411\u601d\u7ef4\u6784\u5efa\u4ee3\u7801\uff1a<code>cons</code>\u4e00\u5b9a\u662f\u5bf9\u6570\u636e\u6253\u5305(packaging)\uff0c\u800c<code>car</code>\u548c<code>cdr</code>\u4e00\u5b9a\u662f\u6253\u5305\u7684\u6570\u636e\u89e3\u5305\uff08unpackaging\uff09\u3002 \u4f46\u5982\u679c\u7a0b\u5e8f\u733f\u4e00\u5f00\u59cb\u5c31\u5fc3\u4e2d\u65e0\u56fe\uff0c\u800c\u662f\u76f4\u63a5\u8003\u5bdf<code>pair</code>\u7684\u6570\u5b66\u5b9a\u4e49\u672c\u8eab\uff0c\u5b83\u5b8c\u5168\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5b9e\u73b0<code>pair</code>\u5c31\u610f\u5473\u7740\u5982\u4f55\u6ee1\u8db3\u4e09\u4e2a\u6620\u5c04\u5173\u7cfb\u3002\u300aSICP\u300b\u4e66\u4e2d\u7ed9\u51fa\u4e86\u8fd9\u79cd\u51fd\u6570\u5f0f\u7684<code>pair</code>\u5b9e\u73b0\uff1a <pre><code>;;\u7eaf\u51fd\u6570\u5b9e\u73b0\u7684pair\u7c7b\u578b\n;;\u4fee\u6539\u4e86`cons`\u7684\u5b9a\u4e49\uff0c\u53d6\u6d88\u4e86\u539f\u4ee3\u7801\u5185\u90e8\u7684\u4e00\u4e2a`define dispatch`\u8bed\u53e5\n;;\u6539\u4e3a\u533f\u540d\u51fd\u6570\n(define cons                     ;\u5b9a\u4e49 cons \u4e3a\n  (lambda (a b)                  ;  \u4e24\u4e2a\u53c2\u6570a\uff0cb\u7684\u51fd\u6570\uff0c body\u4e3a\n    (lambda (m)                  ;    \u8fd4\u56de\u4e00\u4e2a\u5355\u53c2\u6570m\u7684\u533f\u540d\u51fd\u6570\uff0c \u5176body\u4e3a\n      (if (= m 0) a              ;       \u5f53m=0\u65f6\uff0c\u8fd4\u56dea\uff0c \u5426\u5219\n                  b))))          ;              \u8fd4\u56deb\n\n(define car                      ;\u5b9a\u4e49 car  \u4e3a\n  (lambda (p)                    ;  \u5355\u53c2\u6570p\u7684\u51fd\u6570\uff0c body\u4e3a\n    (p 0)))                      ;    \u8fd4\u56de(p 0)\u7684\u503c\uff0cp\u662f\u51fd\u6570\uff0c0\u662fp\u7684\u53c2\u6570\n\n(define cdr                      ;\u5b9a\u4e49 cdr  \u4e3a\n  (lambda (p)                    ;  \u5355\u53c2\u6570p\u7684\u51fd\u6570\uff0c body\u4e3a\n    (p 1)))                      ;    \u8fd4\u56de(p 1)\u7684\u503c\uff0cp\u662f\u51fd\u6570\uff0c1\u662fp\u7684\u53c2\u6570\n\n;;\u6d4b\u8bd5\u4ee3\u7801\n(define a-pair (cons 1 2))      ;\u5b9a\u4e49 a-pair \u4e3a (cons 1 2)\n(display a-pair)                ;\u6253\u5370a-pair\u7684\u503c\uff0c\u5e94\u8be5\u662f\u4ec0\u4e48\uff1f\n(newline)                       \n(display (car a-pair))          ;\u6253\u5370(car a-pair)\u7684\u503c\uff0c\u5e94\u4e3a1\n(newline)\n(display (cdr a-pair))          ;\u6253\u5370(cdr a-pair)\u7684\u503c\uff0c\u5e94\u8be52      \n(newline)\n</code></pre> \u89e3\u91ca\u6216\u7f16\u8bd1\u6267\u884c\u4ee5\u4e0a\u4ee3\u7801\uff0c\u5c4f\u5e55\u8f93\u51fa\u4e3a\uff1a <pre><code>#&lt;procedure&gt;\n1\n2\n</code></pre> \u8fd9\u91cc\u6211\u4eec\u53d1\u73b0<code>(cons 1 2)</code>\u5e76\u6ca1\u6709\u5bf9\u6570\u636e\u6253\u5305\uff0c\u800c\u662f\u751f\u6210\u4e86\u4e00\u4e2a\u795e\u79d8\u7684\u51fd\u6570\uff08<code>#&lt;procedure&gt;</code>\uff09\u3002\u65b0\u7684<code>cons</code>\u3001<code>car</code>\u548c<code>cdr</code>\u4ecd\u6ee1\u8db3<code>pair</code>\u7c7b\u578b\u7684\u4e25\u8c28\u6570\u5b66\u5b9a\u4e49\u3002\u7528\u5b83\u4eec\u66ff\u6362\u539f\u751f<code>pair</code>\uff0c\u4ecd\u7136\u53ef\u4ee5\u5b8c\u7f8e\u652f\u6301\u7c7b\u578b\u7ec4\u5408\u3002\u4ee5\u4e0a\u7684\u7f16\u7a0b\u8303\u5f0f\u5373\u51fd\u6570\u5f0f\u7f16\u7a0b\uff0c\u6b64\u65f6\u51fd\u6570\u548c\u6570\u636e\u754c\u9650\u662f\u6a21\u7cca\u7684\uff0c\u51fd\u6570\u4e5f\u662f\u4e00\u79cd\u6570\u636e\u3002   \u4e3a\u4fbf\u4e8e\u7406\u89e3\u8fd9\u4e00\u201c\u5947\u6280\u6deb\u5de7\u201d\uff0c\u53ef\u7528\u4ee3\u6362\u6a21\u578b\u628a\u6d4b\u8bd5\u7528\u4f8b\u5c55\u5f00\uff1a <pre><code>;;\u5bf9(cons 1 2)\u7684\u4ee3\u6362\n((lambda (a b)                 ; \u628a(cons 1 2)\u7684cons\u66ff\u6362\u4e3a\u5b83\u7684\u5b9a\u4e49\n   (lambda (m)                 ; \u4ece(lamba...\u8fd9\u91cc\u5f00\u59cb\n     (if (= m 0) a             ;   \n                 b))))         ;   ...\u5230\u6b64\u7ed3\u675f\u662fcons\u7684\u5b9a\u4e49\n  1  2)                        ; \u628a\u524d\u9762\u7684\u533f\u540d\u51fd\u6570\u5e94\u7528\u5230 a=1, b=2\u7684\u6c42\u503c\n                               ;=&gt;\n(lambda (m)                    ; \u5bf9lambda\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u89c4\u5219\u662f\uff1a\n  (if (= m 0) 1                ;   \u5176\u503c\u4e3a\u533f\u540d\u51fd\u6570\u7684body\uff0c\u5e76\u5728body\u4e2d\n              2))              ;      \u75281\uff0c2\u66ff\u6362\u5f62\u53c2a\uff0cb\n                               ;\n;;\u5bf9(car (cons 1 2))\u7684\u4ee3\u6362\n(car (lambda (m)               ; \u65b0\u7684car\u51fd\u6570\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u533f\u540d\u51fd\u6570\n       (if (= m 0) 1           ; \u8fd9\u4e0b\u77e5\u9053\u4ec0\u4e48\u53eb\u505a\u201c\u51fd\u6570\u5f0f\u7f16\u7a0b\u201d\u4e86\u5427\uff1a\uff09\n                   2)))        ;\n                               ;=&gt;\n((lambda (m)                   ; \u66ff\u6362\u4e3a(p 0)\n   (if (= m 0) 1               ; p\u662f(cons 1 2)\u8fd4\u56de\u7684\u533f\u540d\u51fd\u6570\n               2))             ; \n  0)                           ; 0\u662f\u53c2\u6570\n                               ;=&gt;\n(if (= 0 0) 1                  ; \u8fd4\u56debody\uff0c\u628abody\u91cc\u7684m\u66ff\u6362\u4e3a0\n            2)                 ; if\u6709\u77ed\u8def\u7279\u6027\uff0c\u8c13\u8bcd\u4e3a\u771f\u53ea\u5c55\u5f00true\u5206\u652f\uff0c\n                               ; \u53cd\u4e4b\u5c55\u5f00false\u5206\u652f\n                               ;=&gt;\n1                              ; true\u5206\u652f\u66ff\u6362\u4e3a1\n;;\u5bf9(cdr (cons 1 2))\u7684\u4ee3\u6362\u7c7b\u4f3c\uff0c\u8bf7\u5728\u7eb8\u4e0a\u5199\u4e00\u4e0b\u3002\u6ce8\u610f\u8fb9\u5199\u8fb9\u601d\u8003\u54e6\uff0c\u4e00\u4e2a\u7eaf\u51fd\u6570\u5f0f\u8bed\u8a00\n;;\u7684\u89e3\u91ca\u5668\u5927\u81f4\u5c31\u662f\u8fd9\u4e48\u5de5\u4f5c\u7684\uff08\u6ca1\u6709\u8d4b\u503c\u8bed\u53e5\uff09\u3002\n;;\u518d\u56de\u60f3\u4e00\u4e0b\u56fe2\u7684\u6700\u540e\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5c31\u4f1a\u77e5\u9053Lisp\u8bed\u8a00\u7684\u8bed\u6cd5\u4e3a\u4ec0\u4e48\u4f1a\u8bbe\u8ba1\u6210\u8fd9\u6837\u3002\n</code></pre> \u901a\u8fc7\u4ee3\u6362\u6a21\u578b\u5c55\u5f00\uff0c\u795e\u79d8\u7684\u201c\u65e0\u79cd\u751f\u6709\u201d\u7684<code>pair</code>\u7c7b\u578b\u5176\u5b9e\u4e0d\u8fc7\u662f\u7528\u6620\u5c04\u5173\u7cfb\u4ee3\u66ff\u4e86\u6570\u636e\u6253\u5305\u3002\u6570\u636e\u5bfc\u5411\u7684\u5b9e\u73b0\u5173\u6ce8\u4e8e\u6570\u636e\u7684\u7ec4\u7ec7\u548c\u5b58\u50a8\uff0c\u800c\u51fd\u6570\u5f0f\u7f16\u7a0b\u5173\u6ce8\u7684\u662f\u6620\u5c04\u5173\u7cfb\u903b\u8f91\u3002 \u73b0\u5728\u53ef\u80fd\u4f60\u5df2\u7ecf\u7a0d\u5fae\u7406\u89e3\u4e86\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u7279\u70b9\uff1a\u53ef\u4ee5\u5728\u7a0b\u5e8f\u7684\u4efb\u4f55\u5730\u65b9\u521b\u5efa\u51fd\u6570\uff0c\u5e76\u4e14\u628a\u5b83\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\u201c\u51fd\u6570\u201d\u548c\u201c\u6570\u636e\u201d\u672c\u8eab\u6ca1\u6709\u4e25\u683c\u7684\u533a\u5206\u3002\u4e00\u5207\u6709\u4e3a\u6cd5\uff0c\u5982\u68a6\u5e7b\u6ce1\u5f71\uff0c\u5982\u9732\u4ea6\u5982\u7535\uff0c\u5e94\u4f5c\u5982\u662f\u89c2\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u867d\u7136\u6211\u4eec\u53ea\u7528\u51fd\u6570\u5c31\u80fd\u5b9e\u73b0\u5e8f\u5bf9\u7c7b\u578b\uff0c\u4f46\u539f\u751f\u7684\u5e8f\u5bf9\u4ece\u6548\u7387\u4e0a\u8003\u8651\u4ecd\u91c7\u7528\u4e86\u6570\u636e\u5bfc\u5411\u5b9e\u73b0\u3002\u672c\u8282\u7684\u5947\u6280\u6deb\u5de7\u770b\u8d77\u6765\u597d\u50cf\u662f\u65e0\u4e2d\u751f\u6709\u7684\u9b54\u6cd5\uff0c\u4e8e\u662f\u6709\u4eba\u8bf4\u8fd9\u53cd\u6620\u4e86\u8001\u5b50\u9053\u751f\u4e00\uff0c\u4e00\u751f\u4e8c\uff0c\u4e8c\u751f\u4e09\uff0c\u4e09\u751f\u4e07\u7269\u7684\u54f2\u5b66\u601d\u60f3\u3002\u201c\u79d1\u5b66\u5bb6\u95e8\u7ecf\u8fc7\u51e0\u5343\u5e74\u7684\u52aa\u529b\u722c\u5230\u4e86\u5c71\u9876\uff0c\u5374\u53d1\u73b0\u8001\u5b50\u548c\u91ca\u8fe6\u6469\u5c3c\u5df2\u7b49\u5019\u591a\u65f6\u4e86\u3002\u201d\u5982\u679c\u6709\u4eba\u8fd9\u4e48\u8bf4\uff0c\u8bf7\u5e2e\u6211\u553e\u4ed6\u4e00\u8138\u3002\uff1a\uff09 </p> <p>\u5bf9\u4e8e\u6b64\u4f8b\uff0c\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u5a01\u529b\u5728\u4e8e\u5b83\u6839\u636e<code>cons</code>\u7684\u4e24\u4e2a\u53c2\u6570\uff0c\u81ea\u52a8\u751f\u6210\u4e86\u4e00\u4e2a\u65b0\u51fd\u6570\uff0c\u5e76\u628a\u8fd9\u4e2a\u65b0\u51fd\u6570\u4f20\u53c2\u3001\u6c42\u503c\u3002\u5bf9<code>cons</code>\u8f93\u5165\u4e0d\u540c\u7684\u53c2\u6570\u4f1a\u751f\u6210\u4e0d\u540c\u7684\u533f\u540d\u51fd\u6570\u3002\u8fd9\u5176\u5b9e\u5728\u8fd0\u884c\u65f6\u4e2d\u7528\u7a0b\u5e8f\u6765\u7f16\u5199\u7a0b\u5e8f\uff0c\u6b64\u80fd\u529b\u5e38\u89c4\u8bed\u8a00\u5927\u591a\u65e0\u6cd5\u505a\u5230\u3002</p>"},{"location":"markdown/lisp_func_programming/#4","title":"4. \u4e00\u70b9\u601d\u8003","text":"<p>\u544a\u8bc9\u4f60\u4e00\u4e2a\u6050\u6016\u6545\u4e8b\uff0c\u51fd\u6570\u5f0f\u7684<code>pair</code>\u5b9e\u73b0\u65b9\u5f0f\u8fd8\u6709\u5f88\u591a\u79cd\uff0c\u6bd4\u5982\u300aSICP\u300b\u7684\u7ec3\u4e602.4\uff1a <pre><code>(define cons                 ; \n  (lambda (a b)              ;(cons 1 2) \u4f1a\u4ee3\u6362\u4e3a\n    (lambda (m) (m a b))))   ;    (lambda (m) (m 1 2))\n\n(define car                  ;(car (cons 1 2)) \n  (lambda (p)                ; =&gt; ((lambda (m) (m 1 2)) (lambda (x y) x))\n    (p (lambda (x y) x))))   ; =&gt; ((lambda (x y) x) 1 2)   \n                             ; =&gt; 1\n\n(define cdr                  ;(cdr (cons 1 2)) \n  (lambda (p)                ; =&gt; ((lambda (m) (m 1 2)) (lambda (x y) y))\n    (p (lambda (x y) y))))   ; =&gt; ((lambda (x y) y) 1 2)\n                             ; =&gt; 2\n</code></pre> \u6709\u4eba\u4f1a\u8bf4\u7f16\u7a0b\u8bed\u8a00\u53ea\u662f\u5de5\u5177\uff0c\u4efb\u4f55\u6210\u719f\u7f16\u7a0b\u8bed\u8a00\u4e4b\u95f4\u90fd\u662f\u4e92\u76f8\u7b49\u4ef7\u7684\u3002\u6bd4\u5982C\u8bed\u8a00\u5927\u8428\u6ee1\u796d\u7940\u5ba3\u79f0\uff1a\u201c\u4e00\u5207\u7f16\u7a0b\u8bed\u8a00\u90fd\u80fd\u7ffb\u8bd1\u6210C\u201d\uff0c\u201c\u6ca1\u6709\u7528C\u8bed\u8a00\u5199\u4e0d\u4e86\u7684\u7b97\u6cd5\u201d\u3002 \u5bf9\u4e8e<code>pair</code>\u8fd9\u4e2a\u652f\u6301\u6cdb\u578b\u7684\u6570\u636e\u7ed3\u6784\u6765\u8bf4\uff0c\u4f60\u603b\u53ef\u4ee5\u7528<code>void *</code>\u7c7b\u578b\u6765\u4f20\u53c2\uff0c\u5e76\u4e14\u628a\u6570\u636e\u7c7b\u578b\u7684<code>tag</code>\u548c\u5185\u5b58\u7ed1\u5b9a\u5df2\u5b9e\u73b0\u4e00\u4e2a\u6570\u636e\u5bfc\u5411\u7248\u672c\u3002\u6bd4\u5982\u662f\u8fd9\u6837\uff1a <pre><code>typedef struct{\n    void *a; \n    void *b;\n} PAIR;\n\ntypedef struct{                     //\u4f60\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a DATA \u7684\u5b9e\u4f8b\n    char type[32];                  //   int a=1;      int b=\"hello\";\n    void *data;                     //   DATA x, y;\n} DATA;                             //   x.type=\"int\"; y.type=\"string\";\n                                    //   x.data=a;     y.data=b;\n                                    //\nPAIR* cons(DATA *a, DATA *b) {      //\u4f60\u53ef\u4ee5\u8fd9\u6837\u8c03\u7528 cons\n    PAIR* p = malloc(sizeof(PAIR)); //   PAIR *p = cons(&amp;x, &amp;y);\n    p-&gt;a = a;                       //\n    p-&gt;b = b;                       //\n    return p;                       //\n}                                   //\n                                    //\nDATA* car(PAIR *p) {                //\u4f60\u53ef\u4ee5\u5f97\u5230p\u7684 car\n    return p-&gt;a;                    //   DATA *car_p = car(p);\n}                                   //   \u4f46\u662f\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u5e26type\u7684\u6570\u636e\u4f53\u6307\u9488\n                                    //\nDATA* cdr(PAIR *p) {                //\u4f60\u53ef\u4ee5\u5f97\u5230p\u7684 cdr\n    return p-&gt;b;                    //   DATA *cdr_p = cdr(p)\n}                                   //   \u540c\u6837\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u5e26type\u7684\u6570\u636e\u4f53\u6307\u9488\n</code></pre> \u4ee5\u4e0a\u4ee3\u7801\u7684<code>cons</code>\u51fd\u6570\u4e0d\u80fd\u7ec4\u5408\u3002\u4f60\u6ca1\u6709\u529e\u6cd5\u4f7f\u7528cons(a, (cons(c,d)))\u6765\u751f\u6210\u66f4\u9ad8\u9636\u7684\u7c7b\u578b\u3002\u53ef\u8fd9\u6837\u4fee\u6539\u4ee3\u7801\uff1a <pre><code>DATA* cons(DATA *a, DATA *b) {\n    DATA *p = malloc(sizeof(DATA));\n    p-&gt;type=\"pair\";\n    PAIR *p_data = malloc(sizeof(PAIR));\n    p_data-&gt;a = a;\n    p_data-&gt;b = b;\n    p-&gt;data = p_data;\n    return p;\n}\n</code></pre> \u5728\u4f7f\u7528C\u8bed\u8a00\u7248\u672c\u7684<code>pair</code>\u65f6\uff0c\u6bcf\u4e2a\u6570\u636e\u90fd\u5fc5\u987b\u624b\u52a8\u52a0\u4e0a<code>type</code>\u4fe1\u606f\u3002\u5982\u679c\u8003\u8651\u7528\u51fd\u6570\u5f0f\u98ce\u683c\u5b9e\u73b0<code>pair</code>\uff0cC\u8bed\u8a00\u6846\u67b6\u4e0b\u57fa\u672c\u4e0a\u6ca1\u620f\u3002C\u8bed\u8a00\u867d\u7136\u6709\u51fd\u6570\u6307\u9488\uff0c\u4f46\u5176\u8868\u8fbe\u80fd\u529b\u548c\u5e94\u7528\u573a\u666f\u592a\u5c40\u9650\uff0c\u6709\u5174\u8da3\u7684\u8bdd\u53ef\u4ee5\u5c1d\u8bd5\u628a\u524d\u9762\u7684Lisp\u4ee3\u7801\u7ffb\u8bd1\u6210C\u8bed\u8a00\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u964d\u4f4e\u8981\u6c42\uff0c\u4e0d\u8981\u6c42\u652f\u6301\u6cdb\u578b\uff0c\u5047\u8bbe\u6240\u6709\u6570\u636e\u90fd\u662f<code>int</code>\u7c7b\u578b\u7684\u6574\u6570\u3002   \u5f53\u7136\uff0c\u4ece\u53e6\u5916\u4e00\u4e2a\u610f\u4e49\u4e0a\u8bf4\uff0c\u201cC\u8bed\u8a00\u65e0\u6240\u4e0d\u80fd\u201d\u8fd9\u53e5\u8bdd\u4e5f\u6ca1\u6709\u9519\u3002\u4f60\u4ecd\u7136\u53ef\u4ee5\u5728C\u8bed\u8a00\u7684\u57fa\u7840\u4e0a\u5b9e\u73b0\u4ee5\u4e0a\u6240\u6709\u51fd\u6570\u5f0f\u5e8f\u5bf9\uff0c\u65b9\u6cd5\u662f\u9996\u5148\u7528C\u8bed\u8a00\u5199\u4e00\u4e2aLisp\u89e3\u91ca\u5668\uff0c\u7136\u540e\u6267\u884c\u4ee5\u4e0a\u6240\u6709Lisp\u4ee3\u7801\u3002 </p> <p>\u6709\u4e00\u4e2a\u7279\u522b\u626f\u86cb\u7684\u6897\uff1a\"\u4efb\u4f55C\u6216Fortran\u7a0b\u5e8f\u590d\u6742\u5230\u4e00\u5b9a\u7a0b\u5ea6\u4e4b\u540e\uff0c\u90fd\u4f1a\u5305\u542b\u4e00\u4e2a\u4e34\u65f6\u5f00\u53d1\u7684\u3001\u53ea\u6709\u4e00\u534a\u529f\u80fd\u7684\u3001\u4e0d\u5b8c\u5168\u7b26\u5408\u89c4\u683c\u7684\u3001\u5230\u5904\u90fd\u662fbug\u7684\u3001\u8fd0\u884c\u901f\u5ea6\u5f88\u6162\u7684Common Lisp\u5b9e\u73b0\u3002\"\u2014\u2014\u683c\u6797\u65af\u6f58\u7b2c\u5341\u5b9a\u5f8b\uff08Greenspun's Tenth Rule\uff09</p>"},{"location":"markdown/lisp_recursion/","title":"\u9012\u5f52\u548c\u8fed\u4ee3\uff08Scheme\u63cf\u8ff0\uff09","text":"<p>\u53ef\u4ee5\u6beb\u4e0d\u5938\u5f20\u7684\u8bf4\uff0c\u9012\u5f52\uff08Recursion\uff09\u4e4b\u4e8e\u7a0b\u5e8f\u8bed\u8a00\uff0c\u5df2\u662f\u6700\u63a5\u8fd1\u7684\u672c\u8d28\u7684\u4e1c\u897f\u3002 \u9ad8\u7ea7\u8bed\u8a00\u7684\u4ee3\u7801\u8fdb\u5165\u7f16\u8bd1\u5668\u6216\u89e3\u91ca\u5668\u4e4b\u524d\uff0c\u5fc5\u987b\u89e3\u6790\uff08parse\uff09\u6210\u4e00\u79cd\u53eb\u62bd\u8c61\u8bed\u6cd5\u6811\uff08AST\uff09\u7684\u6570\u636e\u7ed3\u6784\u3002\u5728\u6570\u636e\u7ed3\u6784\u7684\u904d\u5386\u3001\u641c\u7d22\u3001\u6392\u5e8f\u7b49\u64cd\u4f5c\u4e2d\uff0c\u9012\u5f52\u51fd\u6570\u968f\u5904\u53ef\u89c1\u3002 \u6709\u5f88\u591a\u4eba\u5bf9\u9012\u5f52\u7684\u7406\u89e3\u975e\u5e38\u6559\u6761\uff0c\u6bd4\u5982\u201c\u8fed\u4ee3\u6bd4\u9012\u5f52\u7684\u6548\u7387\u9ad8\u201d\u3001\u201c\u9012\u5f52\u6b21\u6570\u591a\u4e86\u4f1a\u7206\u6808\u201d\u7b49\u79cd\u79cd\u8bba\u65ad\u51e0\u4e4e\u5df2\u7ecf\u79f0\u4e3a\u4e86\u7a0b\u5e8f\u733f\u7684\u201c\u5e38\u8bc6\u201d\u3002 \u5b9e\u9645\u4e0a\uff0c\u9012\u5f52\u5728\u4ee3\u7801\u548c\u8fd0\u884c\u4e0a\u53bb\u7406\u89e3\uff0c\u5206\u522b\u6709\u4e24\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u610f\u601d\uff0c\u9012\u5f52\u7a0b\u5e8f(procedure)\u548c\u9012\u5f52\u8fc7\u7a0b(process)\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u4e1c\u897f\u3002 \u5e76\u975e\u9012\u5f52\u7a0b\u5e8f(procedure)\u5c31\u4e00\u5b9a\u4f1a\u7206\u6808\uff0c\u8fed\u4ee3\u8fc7\u7a0b(process)\u548c\u9012\u5f52\u8fc7\u7a0b(process)\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5f80\u5f80\u662f\u76f8\u540c\u7684\u3002</p> <p>\u7ea6\u5b9a\uff1a\u7a0b\u5e8f(procedure)\u6307\u7684\u662f\u4e00\u4e2a\u5177\u4f53\u7684\u51fd\u6570\uff0c\u901a\u5e38\u662f\u51fd\u6570\u5f0f\u7f16\u7a0b\u91cc\u7684\u201c\u7eaf\u51fd\u6570\u201d\uff0c\u800c\u8fc7\u7a0b(process)\u6307\u7684\u662f\u8ba1\u7b97\u7684\u6d41\u7a0b\u3002\u7a0b\u5e8f\u662f\u8fc7\u7a0b\u7684\u62bd\u8c61\uff0c\u7a0b\u5e8f\u7684\u6c42\u503c\u8868\u73b0\u4e3a\u8fc7\u7a0b\u7684\u987a\u5e8f\u6267\u884c\u3002\u5c06\u201c\u7a0b\u5e8f\u201d\u66ff\u6362\u4e3a\u201c\u51fd\u6570(function)\u201d\u4f3c\u4e4e\u66f4\u9002\u5408\u4e2d\u6587\u8868\u8fbe\uff0c\u4f46\u300aSICP\u300b\u539f\u4e66\u53ca\u5927\u91cfLisp\u8bed\u8a00\u6570\u636e\u5747\u91c7\u7528procedure\u8fd9\u4e00\u672f\u8bed\u3002</p>"},{"location":"markdown/lisp_recursion/#1","title":"1. \u9012\u5f52\u7a0b\u5e8f\uff08\u9012\u5f52\u51fd\u6570\uff09","text":"<p>\u6240\u8c13\u9012\u5f52\u7a0b\u5e8f\uff0c\u5c31\u662f\u7a0b\u5e8f\u81ea\u5df1\u8c03\u7528\u81ea\u5df1\u3002\u7b80\u5355\u7684\u4e3e\u4e2a\u8ba1\u7b97\u9636\u4e58\u7684\u6817\u5b50\uff08\u6817\u5b50\u8425\u517b\u4e30\u5bcc\uff09\uff0c\u9636\u4e58\u7684\u6570\u5b66\u5b9a\u4e49\u5982\u4e0b\uff1a  </p>  n! = n \\cdot (n-1) \\cdot (n-2) \\cdot \\cdots \\cdot 3 \\cdot 2 \\cdot 1  <p>\u6839\u636e\u4e0a\u5f0f\uff0c\u53ef\u5f97\u4ee5\u4e0b\u6620\u5c04\uff1a</p>  n! = n \\cdot [(n-1) \\cdot (n-2) \\cdot \\cdots \\cdot 3 \\cdot 2 \\cdot 1] = n \\cdot (n-1)!  <p>\u53ef\u89c1\uff0cn!\u80fd\u8868\u793a\u4e3an\u548c(n-1)!\u7684\u4e58\u79ef\u3002\u82e5\u8ba1\u7b97\u9636\u4e58\u7684\u7a0b\u5e8f\u662f\u4e00\u4e2a\u901a\u7528\u51fd\u6570<code>factorial</code>\uff0c\u5219\u8ba1\u7b97n!\u9700\u8981\u7528\u4e0d\u540c\u7684n\u6765\u53cd\u590d\u8c03\u7528<code>factorial</code>\u51fd\u6570\u672c\u8eab\u3002 \u7528<code>Scheme</code>\u8bed\u8a00\u6765\u63cf\u8ff0\u9012\u5f52\u8fc7\u7a0b\u662f\u6781\u81ea\u7136\u7684\u4e8b\uff0c\u5982\u4e0b\uff1a <pre><code>(define factorial                      ;\u5b9a\u4e49factorial\u4e3a\n  (lambda (n)                          ; \u4e00\u4e2a\u5355\u53c2\u6570n\u7684\u51fd\u6570\uff0c\u5176\u51fd\u6570\u4f53\u4e3a\uff1a\n    (if (= n 1)                        ;   \u5982\u679c n = 1\n      1                                ;      \u8fd4\u56de 1, \u5426\u5219\n      (* n (factorial (- n 1))))))     ;      \u8fd4\u56de n * factorial(n-1)\n</code></pre> \u8ba1\u7b975!\u7b49\u4ef7\u4e8e\u5bf9<code>(factorial 5)</code>\u6c42\u503c\uff0c\u53ef\u7528\u4ee3\u6362\u6a21\u578b\u5c55\u5f00\u4e3a\uff1a <pre><code>(factorial 5)                         ;\u4ee3\u6362\u539f\u5219\u4e3a\u5728\u51fd\u6570\u4f53\u5185\u7528\u503c\u4ee3\u66ff\u53c2\u6570          \n(* 5 (factorial 4))                   ;5 != 1\uff0c \u4ee3\u6362if\u7684false\u5206\u652f\n(* 5 (* 4 (factorial 3)))             ;4 != 1\uff0c ...\n(* 5 (* 4 (* 3 (factorial 2))))       ;3 != 1\uff0c ...\n(* 5 (* 4 (* 3 (* 2 (factorial 1))))) ;2 != 1\uff0c ...\n(* 5 (* 4 (* 3 (* 2 1))))             ;1 == 1\uff0c (factorial 1)\u4ee3\u6362\u4e3a1\n(* 5 (* 4 (* 3 2)))                   ;(* 2 1)\u4ee3\u6362\u4e3a2\n(* 5 (* 4 6))                         ;(* 3 2)\u4ee3\u6362\u4e3a6\n(* 5 24)                              ;(* 4 6)\u4ee3\u6362\u4e3a24\n120                                   ;(* 5 24) =&gt; 120\n</code></pre> \u4e0d\u540c\u7f16\u7a0b\u8bed\u8a00\u5b9e\u73b0\u7684<code>factorial</code>\u51fd\u6570\u53ef\u80fd\u8bed\u6cd5\u4e0a\u5927\u76f8\u5f84\u5ead\uff0c\u4f46\u8868\u73b0\u7684\u8ba1\u7b97\u903b\u8f91\u662f\u5b8c\u5168\u4e00\u81f4\u7684\u3002</p>"},{"location":"markdown/lisp_recursion/#2","title":"2. \u7ebf\u6027\u9012\u5f52\u8fc7\u7a0b\u548c\u7ebf\u6027\u8fed\u4ee3\u8fc7\u7a0b","text":"<p>\u8003\u5bdf\u5bf9<code>(factorial n)</code>\u7684\u6c42\u503c\uff0c<code>n</code>\u6bcf\u589e\u52a01\uff0c\u4ee3\u6362\u5c55\u5f00\u7684\u8bed\u53e5\u7eb5\u5411\u4f1a\u589e\u52a0\u4e24\u5c42\uff0c\u8fd9\u8868\u793a\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u662fO(n)\u7684\u3002  \u540c\u65f6\uff0c\u4ee3\u6362\u6a21\u578b\u6700\u957f\u4e00\u884c\u7684\u201c\u957f\u5ea6\u201d\u4e5f\u4f1a\u589e\u52a01\uff0c\u8fd9\u8868\u793a\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u6808\u7a7a\u95f4\u7684\u6d88\u8017\u4e5f\u4f1a\u589e\u52a01\u3002\u6362\u6210\u4e13\u4e1a\u7684\u8bf4\u6cd5\uff0c\u6b64\u8fc7\u7a0b\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e5f\u662fO(n)\u7684\u3002  </p> <p>PS:\u4f60\u53ef\u522b\u7ed9\u6211\u641eO(2n)\u8fd9\u79cd\u8868\u793a\u6cd5\u3002\uff1a) </p> <p>\u4eba\u4eec\u628aO(n)\u7684\u590d\u6742\u5ea6\u79f0\u4e3a\u7ebf\u6027\u590d\u6742\u5ea6\uff0c\u6240\u4ee5\u9012\u5f52\u51fd\u6570<code>factorial</code>\u7684\u6c42\u503c\u662f\u4e00\u4e2a\u7ebf\u6027\u9012\u5f52\u8fc7\u7a0b\uff08Linear Recursive Process\uff09\u3002 \u5f88\u5bb9\u6613\u53ef\u4ee5\u63a8\u8bba\u51fa\u7ebf\u6027\u9012\u5f52\u8fc7\u7a0b\u7684\u7f3a\u70b9\uff0c\u5f53n\u8fbe\u5230\u4e00\u5b9a\u7a0b\u5ea6\u65f6\uff0c\u8ba1\u7b97\u673a\u7684\u6808\u7a7a\u95f4\u4f1a\u88ab\u7528\u5b8c\u3002\u7136\u540e\u60b2\u5267\u7684\u7206\u6808\uff0c\u8f7b\u5219\u90c1\u95f7\u4e0d\u5df2\uff0c\u91cd\u5219\u673a\u6bc1\u4eba\u4ea1\u3002\u6240\u4ee5\u9012\u5f52\u7a0b\u5e8f\u5199\u8d77\u6765\u723d\uff08\u76f4\u63a5\u5bf9\u6570\u5b66\u4e8b\u5b9e\u7684\u63cf\u8ff0\uff09\uff0c\u6267\u884c\u8d77\u6765\u201c\u53ef\u80fd\u201d\u4f1a\u5f88\u8981\u547d\u3002 \u4f46\u4e3a\u4ec0\u4e48\u8981\u628a\u201c\u53ef\u80fd\u201d\u4e24\u4e2a\u5b57\u52a0\u4e0a\u5f15\u53f7\u5462\uff1f\u56e0\u4e3a\u9636\u4e58\u8fd8\u6709\u53e6\u4e00\u4e2a\u9012\u5f52\u5199\u6cd5\uff08\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u201c\u9012\u5f52\u201d\u662f\u9012\u5f52\u7a0b\u5e8f\u6216\u9012\u5f52\u51fd\u6570\uff09\u3002 \u5982\u679c\u76f4\u63a5\u4ece\u8fc7\u7a0b\u8003\u8651n \\cdot (n-1)!\u8fd9\u4e00\u6570\u5b66\u8868\u8fbe\u5f0f\uff0c\u628a\u6bcf\u4e2a<code>(factorial n)</code>\u7684\u503c\u7528\u4e00\u4e2a\u53d8\u91cfp\u8868\u793a\u4ee5\u907f\u514d\u6808\u5f00\u9500\u3002\u5012\u5e8f\u6267\u884c\u4ee5\u4e0a\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u5f97\u5230\u8fd9\u6837\u7684\u6570\u5b66\u8868\u8fbe\uff1a</p>   \\begin{gather} \u00a0 c := 1,p := 1\u00a0 \\\\ \u00a0 c := c+1,p:=c \\cdot p=2\\cdot1\u00a0 \\\\\u00a0 \u00a0 c := c+1,p:=c \\cdot p=3\\cdot2  \\\\   c := c+1,p:=c \\cdot p=4\\cdot6  \\\\   \\cdots \\end{gather}  <p>\u4ee5\u4e0a\u7684:=\u7b26\u53f7\u8868\u793a\u8d4b\u503c\uff0c\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u62e5\u8db8\u4e00\u770b\u5c31\u4f1a\u76b1\u7709\u5934\uff0c\u751f\u6015\u5e26\u6765\u526f\u4f5c\u7528\u3002\u90a3\u4e48\u6211\u4eec\u907f\u514d\u4f7f\u7528Scheme\u8bed\u8a00\u7684\u8d4b\u503c\uff08<code>set!</code>\uff09\u8bed\u53e5\uff0c\u76f4\u63a5\u7528\u9012\u5f52\u51fd\u6570\u5b9e\u73b0\u5982\u4e0b:    </p> <p><pre><code>(define iter          ;\u5b9a\u4e49iter\u4e3a\n  (lambda (p c max)   ;  \u4e00\u4e2a\u4e09\u53c2\u6570p, c, max\u7684\u51fd\u6570 \u51fd\u6570\u4f53\u4e3a\n   (if (&gt; c max)      ;    \u5982\u679cc &gt; max \u5219\n     p                ;      \u8fd4\u56de p\uff0c \u5426\u5219\n     (iter (* c p)    ;      \u9012\u5f52\u8c03\u7528iter\uff0c\u53c2\u6570\u4e3a: p * c\n           (+ c 1)    ;                        c + 1\n           max))))    ;                        max\n\n(define factorial-2   ;\u5b9a\u4e49factorial-2\u4e3a\n  (lambda (n)         ;  \u4e00\u4e2a\u5355\u53c2n\u7684\u51fd\u6570  \u51fd\u6570\u4f53\u4e3a\n    (iter 1 1 n)))    ;    \u8fd4\u56de\uff08iter 1 1 n)\u7684\u6c42\u503c\u7ed3\u679c\n</code></pre> \u4ee5\u4e0a\u6211\u4eec\u5b9a\u4e49\u4e86\u6c42\u9636\u4e58\u7684<code>factorial-2</code>\u51fd\u6570\uff0c\u5b83\u7684\u672c\u4f53\u662f\u4e00\u4e2a\u9012\u5f52\u7a0b\u5e8f<code>iter</code>\uff0c\u5bf9<code>(factorial-2 5)</code>\u6c42\u503c\u7b49\u4ef7\u4e8e\u5bf9<code>(iter 1 1 5)</code>\u6c42\u503c\uff0c\u5176\u4ee3\u6362\u6a21\u578b\u5982\u4e0b\uff1a</p> <p><pre><code>(factorial-2 5)  ;factorial-2\u7684\u51fd\u6570\u4f53\u4e2d\u628an\u4ee3\u6362\u4e3a5 =&gt;\n(iter 1 1 5)     ;c=1, max=5, 1 &lt; 5, \u4ee3\u6362false\u5206\u652f =&gt;\n(iter 1 2 5)     ;            2 &lt; 5, \u4ee3\u6362false\u5206\u652f =&gt;     \n(iter 2 3 5)     ;  ...\n(iter 6 4 5)     ;\n(iter 24 5 5)    ;\n(iter 120 6 5)   ;c=6, max=5, 6 &gt; 5\uff0c \u4ee3\u6362true\u5206\u652f\uff0c\u8fd4\u56dep\n120\n</code></pre> \u5f53\u7136\u4ee5\u4e0a\u6240\u6709\u4ee3\u6362\u6a21\u578b\u5747\u662f\u7b80\u5316\u7248\u672c\uff0c\u6211\u4eec\u7701\u7565\u4e86\u6240\u6709<code>(iter p c max)</code>\u4e2d\u6bcf\u4e2a\u53c2\u6570\u7684\u6570\u5b66\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u4ee3\u6362\uff0c\u5b83\u4eec\u90fd\u9700\u8981\u6808\u7a7a\u95f4\u3002\u4f46\u65e0\u8bba\u5982\u4f55\uff0c\u6808\u8c03\u7528\u6700\u591a4\u4e2a\uff0c<code>(factorial-2 5)</code>\u6c42\u503c\u8fc7\u7a0b\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a\u5e38\u6570\u3002 \u8fd9\u79cd\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5e38\u6570\u7a7a\u95f4\u590d\u6742\u5ea6\u7684\u987a\u5e8f\u8ba1\u7b97\u8fc7\u7a0b\u79f0\u4e3a\u7ebf\u6027\u8fed\u4ee3\u8fc7\u7a0b(Linear Iterative Process)\u3002 \u4e60\u60ef\u5199\u5982\u4e0bC\u8bed\u8a00\u4ee3\u7801\u7684\u4eba\u4f1a\u8ba4\u4e3a<code>(iter p c max)</code>\u6ca1\u6709C\u8bed\u8a00\u7684\u5faa\u73af\u8bed\u53e5\u9ad8\u6548\uff1a <pre><code>int fact(int n) {\n    int p = 1;\n    for(int c = 1; c &lt;= n; ++c) {\n        p = p * c;\n    }\n    return p;\n}\n</code></pre> \u4f46\u5b9e\u9645\u4e0a<code>for</code>\u5faa\u73af\u91cc\u7684<code>++c</code>\u548c<code>p*c</code>\u5b9e\u9645\u4e0a\u4e5f\u662f\u51fd\u6570\u7684\u6808\u8c03\u7528\uff0c\u6b64\u4ee3\u7801\u548cScheme\u8bed\u8a00\u7684<code>iter</code>\u51fd\u6570\u6267\u884c\u6548\u7387\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a\u80cc\u8bf5++i\u548ci++\u54ea\u4e2a\u6548\u7387\u9ad8\uff0c\u4e14\u5927\u8c08\u6548\u7387\u4f18\u5316\u7684C\u7a0b\u5e8f\u733f\u53ef\u4ee5\u6d17\u6d17\u7761\u4e86\uff0c\u8fd9\u4e2a\u5faa\u73af\u4f60\u65e0\u8bba\u7528\u4f55\u79cd\u81ea\u589e\u5199\u6cd5\uff0c\u73b0\u4ee3C\u7f16\u8bd1\u5668\u751f\u6210\u7684\u6c47\u7f16\u4ee3\u7801\u90fd\u4e00\u6837\u3002++i\u548ci++\u8fd9\u79cd\u5947\u8469\u7684\u8bed\u6cd5\u672c\u6765\u5c31\u4e0d\u5e94\u8be5\u5b58\u5728\u4e8e\u4e16\u95f4\u3002\u9664\u4e86\u8ba9\u4f60\u8bb0\u4f4f\u4e00\u4e9b\u6ca1\u7528\u7684\u201c\u77e5\u8bc6\u201d\u5e76\u4e50\u6b64\u4e0d\u75b2\u4ee5\u5916\uff0c\u5b83\u4eec\u552f\u4e00\u7684\u529f\u80fd\u53ef\u80fd\u5c31\u662f\u5bf9\u5199C\u8bed\u8a00\u7f16\u8bd1\u5668\u7684\u201c\u5927\u5e08\u201d\u4eec\u6267\u884c\u5929\u8bdb\uff0cf**k their brains\uff0c yeah\uff01</p>"},{"location":"markdown/lisp_recursion/#3-tail-recursive-implementation","title":"3. \u5c3e\u9012\u5f52\u5b9e\u73b0\uff08tail-recursive implementation)","text":"<p>\u4ee5\u4e0b\u6587\u5b57\u7ffb\u8bd1\u81ea\u300aSICP\u300b\u7684\u7b2c1.2.1\u8282\uff0c\u56e0\u6c34\u5e73\u6709\u9650\uff0c\u53ef\u80fd\u4e0d\u592a\u51c6\u786e\uff1a  </p> <p>\u9020\u6210\u5bf9\u9012\u5f52\u51fd\u6570\u548c\u9012\u5f52\u8fc7\u7a0b\u4e4b\u95f4\u6df7\u6dc6\u7684\u4e00\u4e2a\u539f\u56e0\u662f\uff0c\u5927\u591a\u6570\u901a\u7528\u8bed\u8a00\u7684\u5b9e\u73b0\uff08\u5305\u62ecAda\uff0cPascal\u548cC\uff09\u7684\u8bbe\u8ba1\u65b9\u5f0f\u90fd\u4f7f\u5f97\u4efb\u4f55\u9012\u5f52\u51fd\u6570\u7684\u6267\u884c\u90fd\u4f1a\u6d88\u8017\u5927\u91cf\u5185\u5b58\uff0c\u5373\u4fbf\u8be5\u9012\u5f52\u51fd\u6570\u63cf\u8ff0\u7684\u662f\u4e00\u4e2a\u8fed\u4ee3\u8fc7\u7a0b\u3002\u8fd9\u4e9b\u8bed\u8a00\u53ea\u80fd\u901a\u8fc7\u7279\u6b8a\u7684\u201c\u5faa\u73af\u8bed\u53e5\u201d\u6765\u63cf\u8ff0\u8fed\u4ee3\u8fc7\u7a0b\uff0c\u4f8b\u5982<code>do</code>\u3001<code>repeat</code>\u3001<code>for</code>\u548c<code>while</code>\u7b49\u3002\u672c\u4e66\u7b2c5\u7ae0\u8003\u8651\u7684Scheme\u5b9e\u73b0\u4e0d\u5b58\u5728\u6b64\u7f3a\u9677\u3002\u5373\u4f7f\u8fed\u4ee3\u8fc7\u7a0b\u7531\u9012\u5f52\u51fd\u6570\u63cf\u8ff0\uff0c\u5b83\u4e5f\u4f1a\u4ee5\u5e38\u6570\u7a7a\u95f4\u590d\u6742\u5ea6\u6267\u884c\uff0c\u79f0\u4e3a\u5c3e\u9012\u5f52\u3002\u901a\u8fc7\u5c3e\u9012\u5f52\u5b9e\u73b0\uff0c\u53ef\u4ee5\u4f7f\u7528\u9012\u5f52\u51fd\u6570\u6765\u8868\u793a\u8fed\u4ee3\u8fc7\u7a0b\uff0c\u5176\u5b83\u8bed\u8a00\u7684\u201c\u5faa\u73af\u8bed\u53e5\u201d\u5728\u63cf\u8ff0\u8fed\u4ee3\u8fc7\u7a0b\u65f6\u4ec5\u4ec5\u662f\u4e00\u79cd\u8bed\u6cd5\u7cd6\u3002 </p> <p>\u5c3e\u9012\u5f52\u7684\u610f\u601d\u5373Scheme\u8bed\u8a00\u7684\u73b0\u4ee3\u5b9e\u73b0\uff08chez scheme\uff09\u5982\u80fd\u591f\u81ea\u52a8\u7684\u628a<code>factorial</code>\u51fd\u6570\u8f6c\u6362\u4e3a\u5176\u5c3e\u9012\u5f52\u7248\u672c\u89e3\u91ca\u6216\u7f16\u8bd1\u6267\u884c\u3002 \u6bd4\u8f83<code>factorial</code>\u51fd\u6570\u548c<code>factorial-2</code>\u51fd\u6570\uff0c\u5728\u77e5\u9053\u9636\u4e58\u7684n!=n \\cdot (n-1)!\u6570\u5b66\u5b9a\u4e49\u65f6\uff0c<code>factorial</code>\u7684\u5199\u6cd5\u662f\u6700\u81ea\u7136\u4e14\u8bed\u6cd5\u6700\u7b80\u7684\uff0c<code>factorial-2</code>\u5219\u4e0d\u90a3\u4e48\u76f4\u89c2\u3002\u81ea\u52a8\u5c3e\u9012\u5f52\u4f18\u5316\u80fd\u8ba9\u6211\u4eec\u65e0\u9700\u8003\u8651\u9012\u5f52\u8fc7\u7a0b\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u7528\u6700\u8212\u670d\u7684\u65b9\u5f0f\u8868\u73b0\u7b97\u6cd5\u3002     \u4ec0\u4e48\u53eb\u505a\u5c3e\u9012\u5f52\u5462\uff1f\u5f53\u4e00\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u4e3a\u53e6\u4e00\u4e2a\u51fd\u6570\u7684\u8c03\u7528\u65f6\uff0c\u53ef\u79f0\u5176\u4e3a\u5c3e\u8c03\u7528\uff08tail-call\uff09\uff0c\u5982\u679c\u4e00\u4e2a\u5c3e\u8c03\u7528\u662f\u9012\u5f52\u7684\uff0c\u5219\u79f0\u4e3a\u5c3e\u9012\u5f52\u3002\u53c2\u8003\u4ee5\u4e0b\u4ee3\u7801\uff1a <pre><code>(define func-1                   ;\u8fd9\u662f\u4e00\u4e2a\u5c3e\u8c03\u7528\n  (lambda (n)                    ;\u8fd4\u56de\u503c\u8c03\u7528\u4e86*\u8fd9\u4e2a\u51fd\u6570\n    (* n 2)))                    ;\n                                 ;  \n(define func-2                   ;\u8fd9\u4e0d\u662f\u4e00\u4e2a\u5c3e\u8c03\u7528     \n  (lambda (x)                    ;\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u503c\n    x))                          ;\n                                 ;\n(define func-3                   ;\u5f53n\uff01=1\u65f6\u6b64\u51fd\u6570\u5373\u662f\n  (lambda (n)                    ;\u5c3e\u8c03\u7528\uff0c\u53c8\u662f\u5c3e\u9012\u5f52\n    (if (= n 1)                  ;\u5b83\u7684\u8fd4\u56de\u503c\u662f\u81ea\u5df1\u7684\u5c3e\u8c03\u7528\n      1                          ;\n      (func-3 (- n 1)))))        ;\n                                 ;\n(define func-4                   ;\u8fd9\u4e0d\u662f\u4e00\u4e2a\u5c3e\u9012\u5f52\n  (lambda (n)                    ;\u8fd4\u56de\u503c\u65e0\u8bba\u5982\u4f55\u90fd\u4e0d\u662f\u5c3e\u8c03\u7528\u81ea\u8eab\n    (if (= n 1)                  ;\n      1                          ;\n      (* n (func-3 (- n 1))))))  ;\n</code></pre> \u660e\u663e\u53ef\u4ee5\u53ef\u4ee5\u770b\u51fa<code>factorial-2</code>\u91cc\u7684\u9012\u5f52\u51fd\u6570<code>iter</code>\u662f\u5c3e\u9012\u5f52\u3002\u5c3e\u9012\u5f52\u53ea\u5728\u6808\u7a7a\u95f4\u6539\u53d8\u5f62\u53c2\uff0c\u800c\u4e0d\u6269\u5927\u8868\u8fbe\u5f0f\uff0c\u56e0\u6b64\u4e0d\u589e\u52a0\u7a7a\u95f4\u590d\u6742\u5ea6\u3002 \u5f53\u7136\uff0c\u4e0d\u662f\u6240\u6709\u7684\u9012\u5f52\u51fd\u6570\u90fd\u80fd\u5199\u6210\u8fed\u4ee3\u8fc7\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u5e76\u975e\u6240\u6709\u7b97\u6cd5\u90fd\u80fd\u5199\u6210\u5c3e\u9012\u5f52\u3002\u82e5\u4e00\u4e2a\u9012\u5f52\u8fc7\u7a0b\u5b58\u5728\u8fed\u4ee3\u5f62\u5f0f\uff0cScheme\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u8fdb\u884c\u5c3e\u9012\u5f52\u4f18\u5316\u3002 <code>factorial</code>\u51fd\u6570\u548c\u5176\u5c3e\u9012\u5f52\u4f18\u5316\u540e\u7684\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>;;\u9012\u5f52\u8fc7\u7a0b\u539f\u7248 (* n (fact.... \u8fd9\u4e2a\u64cd\u4f5c\u4f1a\u4e0d\u65ad\u589e\u52a0\u6808\u7a7a\u95f4\n(define factorial                   \n  (lambda (n)                     \n    (if (= n 1)                      \n      1                                \n      (* n (factorial (- n 1))))))\n\n;;Scheme\u89e3\u91ca\u5668\u6216\u7f16\u8bd1\u5668\u7684\u81ea\u52a8\u5c3e\u9012\u5f52\u4f18\u5316\u540e\u7684\u8fd0\u884c\u65f6\u51fd\u6570    \n(define tail-factorial\n  (lambda (n tmp)\n    (if (= n 1)\n      tmp\n      (tail-factorial (- n 1) (* n tmp)))))   \n\n(define factorial\n  (lambda (n)\n    (tail-factorial 5 1)))\n</code></pre> \u4ee5\u4e0a\u4ee3\u7801\u6211\u672a\u5199\u6ce8\u91ca\uff0c\u6709\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u7528\u4ee3\u6362\u6a21\u578b\u624b\u7b97\u4e00\u4e0b\u5c3e\u9012\u5f52\u7248\u672c\u7684<code>factorial</code>\u8fc7\u7a0b\uff0c\u4ee5\u52a9\u7406\u89e3\u3002 Agian\uff01\u901a\u8fc7\u4ee3\u6362\u6a21\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0Lisp\u8bed\u8a00\u7684\u8fd9\u79cd<code>(func arg1 arg2 arg3)</code>\u7684\u51fd\u6570\u8c03\u7528\u8868\u73b0\u65b9\u5f0f\uff08s\u8868\u8fbe\u5f0f\uff09\u662f\u201c\u5760\u543c\u201d\u7684\uff0c\u5b83\u80fd\u76f4\u63a5\u4ee5\u4ee3\u6362\u6a21\u578b\u7684\u201c\u5f62\u72b6\u201d\u6765\u8868\u8fbe\u201c\u8fed\u4ee3\u201d\u548c\u201c\u9012\u5f52\u201d\u4e24\u79cd\u8fc7\u7a0b\u3002\u8fd9\u662f\u5176\u5b83\u8bed\u8a00\u7684\u8bed\u6cd5\u65e0\u6cd5\u8fbe\u5230\u7684\u8bbe\u8ba1\u9ad8\u5ea6\u3002 \u7528C\u8bed\u8a00\u8bed\u6cd5\u53bb\u89e3\u91ca\u5c3e\u9012\u5f52\u4e3a\u4ec0\u4e48\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a\u5e38\u6570\uff0c\u5b9e\u5728\u662f\u4e0d\u591f\u4f18\u96c5\u548c\u76f4\u63a5\u3002  </p>"},{"location":"markdown/lisp_recursion/#4","title":"4. \u603b\u7ed3","text":"<p>\u9012\u5f52\u51fd\u6570\uff08function\uff09\u6216\u8005\u8bf4\u9012\u5f52\u7a0b\u5e8f\uff08procedure\uff09\u662f\u4e00\u79cd\u4ee3\u7801\u7ec4\u7ec7\u65b9\u6cd5\uff0c\u5b83\u662f\u975e\u5e38\u81ea\u7136\u7684\u7b97\u6cd5\u8868\u8fbe\u65b9\u5f0f\u3002 \u7ebf\u6027\u9012\u5f52\u8fc7\u7a0b\uff08process)\u548c\u7ebf\u6027\u8fed\u4ee3\u8fc7\u7a0b\uff08process\uff09\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662fO(n)\uff0c\u4f46\u662f\u9012\u5f52\u8fc7\u7a0b\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u4e5f\u662fO(n)\uff0c\u6709\u7206\u6808\u98ce\u9669\u3002 \u5c3e\u9012\u5f52\u51fd\u6570\u662f\u8fed\u4ee3\u8fc7\u7a0b\u3002Scheme\u8bed\u8a00\u7684\u5b9e\u73b0\u80fd\u591f\u81ea\u52a8\u5c3e\u9012\u5f52\u4f18\u5316\uff0c\u9f13\u52b1\u7a0b\u5e8f\u733f\u76f4\u63a5\u5199\u9012\u5f52\u7a0b\u5e8f\uff0c\u5feb\u901f\u3001\u81ea\u7136\u4e14\u4f18\u96c5\u7684\u8868\u8fbe\u7b97\u6cd5\u3002 \u4e0d\u8981\u6b7b\u8bb0\u786c\u80cc\u8fed\u4ee3\u548c\u9012\u5f52\u7684C\u8bed\u8a00\u7248\u672c\u5b9a\u4e49\uff0c\u5b8c\u5168\u6ca1\u8bf4\u5230\u70b9\u5b50\u4e0a\u3002\u5982\u679c\u6709\u4eba\u544a\u8bc9\u4f60\u9012\u5f52\u6bd4\u8fed\u4ee3\u6162\uff0c\u9012\u5f52\u8981\u7206\u6808\uff0c\u8bb0\u5f97\u8981\u5fae\u5fae\u4e00\u7b11\uff0c\u7edd\u5bf9\u4e0d\u62bd\uff08\u8d75\u672c\u5c71\u7b49\uff0c20xx\uff09\u3002   </p>"},{"location":"markdown/lisp_stream/","title":"\u6d41\u4e0e\u60f0\u6027\u6c42\u503c","text":"<p>\u5728\u5b66\u4e60C\u8bed\u8a00\u7684<code>fprintf</code>\u51fd\u6570\u65f6\uff0c\u6211\u4eec\u4f1a\u63a5\u89e6\u5230\"\u6587\u4ef6\u6d41\"\u7684\u6982\u5ff5\u3002\u6bd4\u5982\u4f60\u5199\u4e86\u5982\u4e0b\u7684\u4ee3\u7801\uff1a <pre><code>FILE *fp = fopen(\"somefile.txt\", \"w\");\nfprintf(fp, \"write something into file stream\\n\");\nfclose(fp);\n</code></pre> \u8fd9\u91cc\u7684<code>fp</code>\u662f\u4e00\u4e2a\u6307\u5411<code>FILE</code>\u7c7b\u578b\u7684\u6307\u9488\uff08\u6587\u4ef6\u6d41\u6307\u9488\uff09\uff0c\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u53eb\u505a\u201c\u6587\u4ef6\u6d41\u201d\u3002\u90a3\u4e48\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u4e3a\u4ec0\u4e48\u6587\u4ef6\u662f\"\u6d41\"\uff1f  \u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c<code>python</code>\u4e2d\u7684<code>for i in range(5):</code>\u548c<code>for i in [1,2,3,4,5]:</code>\u662f\u5426\u662f\u540c\u6837\u7684\u4e1c\u897f\uff1f\u5b9e\u9645\u4e0a\uff0c<code>range(5)</code>\u4e5f\u662f\u4e00\u4e2a\u6d41\uff08<code>stream</code>\uff09\u3002 \u6211\u4eec\u5c1d\u8bd5\u89e3\u91ca<code>stream</code>\u8fd9\u79cd\u7f16\u7a0b\u8303\u5f0f\u7684\u672c\u8d28\u3002\u4f60\u4f1a\u53d1\u73b0\u4e0d\u4ec5\u6587\u4ef6\u662f\u6d41\uff0c\u6d41\u5176\u5b9e\u662f\u4e00\u79cd\u7f16\u5199\u7ebf\u6027\u4ee3\u7801\u7684\u9ad8\u7ea7\u8303\u5f0f\uff0c\u9ad8\u6548\u7684\u6d41\u5b9e\u73b0\u8fd8\u9700\u8981\u6d89\u53ca\u201c\u60f0\u6027\u6c42\u503c\u201d\u3002  </p>"},{"location":"markdown/lisp_stream/#1","title":"1. \u6d41\u662f\u4e00\u79cd\u901a\u7528\u8fc7\u7a0b","text":"<p>\u8003\u8651\u4e00\u4e2a\u8ba1\u7b97\u6b63\u6574\u6570\u533a\u95f4[a,b]\u5185\u7684\u6240\u6709\u7d20\u6570\u548c\u7684\u8fc7\u7a0b\u3002Scheme\u8bed\u8a00\u8fed\u4ee3\u98ce\u683c\uff08\u867d\u7136\u662f\u9012\u5f52\u8bed\u6cd5\uff09\u7684\u8ba1\u7b97\u7a0b\u5e8f\u5f88\u53ef\u80fd\u662f\u8fd9\u6837\uff1a <pre><code>(define sum-primes-1            \n  (lambda (a b)                         ;\u5b9a\u4e49sum-primes-1\u662f\u4e00\u4e2a\u5173\u4e8e(a,b)\u7684\u51fd\u6570\n    (define iter                        ;       \u5185\u90e8\u5d4c\u5957\u5b9a\u4e49\u4e2aiter\u51fd\u6570\n      (lambda (n sum)                   ;          \u5176\u53c2\u6570\u662f(n, sum)\n        (cond                           ;          \u5176\u51fd\u6570\u4f53\u4e3a\uff1a\n          [(&gt; n b) sum]                 ;          \u5982\u679cn&gt;b - \u8fd4\u56de sum\n          [(prime? n) (iter (+ n 1)     ;          \u5982\u679cn\u662f\u7d20\u6570 -\n                            (+ n sum))] ;             \u8fd4\u56deiter(n+1, n+sum)\n          [else (iter (+ n 1) sum)])))  ;          \u5426\u5219 - \u8fd4\u56de iter(n+1, sum)\n    (iter a 0)))                        ;  sum-primes-1\u7684\u51fd\u6570\u4f53\u4e3a iter(a, 0)\n</code></pre> \u5982\u679c\u4f60\u9700\u8981\u5bf9\u8be5\u533a\u95f4\u5185\u5927\u4e8e7\u7684\u81ea\u7136\u6570\u6c42\u548c\uff0c\u90a3\u4e48\u4f60\u5c31\u9700\u8981\u4fee\u6539\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u589e\u52a0\u5224\u65ad\u8bed\u53e5\u548c\u76f8\u5e94\u7684\u8ba1\u7b97\u8bed\u53e5\u3002\u4e3a\u4e86\u5c3d\u91cf\u590d\u7528\u4ee3\u7801\uff0c\u4f60\u53ef\u80fd\u4f1a\u60f3\u5230\u9ad8\u9636\u51fd\u6570\uff0c\u5b9e\u73b0\u53ef\u80fd\u662f\u8fd9\u6837\uff1a <pre><code>(define comp-in-a-b                       ;\u9996\u5148\uff0c\u5b9a\u4e49\u4e2a\u901a\u7528\u9012\u5f52\u8fc7\u7a0b\n   (lambda (a b yes-or-no do-when-yes)    ;   \u8f93\u5165\u533a\u95f4\uff0c\u4ee5\u53ca\u5224\u65ad\u8fc7\u7a0b\uff0c\u540e\u7eed\u6267\u884c\u65b9\u5f0f\n     ....))\n\n(define sum-biger-than-7                  ;\u8fd9\u91cc\u6211\u4e0d\u9700\u8981\u518d\u624b\u5199\u4e00\u904d\u9012\u5f52\u4e86\n   (lambda (a b)    \n     (comp-in-a-b \n        (lambda (x) (&gt; x 7))              ;\u6ce8\u610fyes-or-no\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u800c\u4e0d\u662f\u53d8\u91cf\n        (iter ..... ))))  \n</code></pre></p> <p>\u4f46\u4ee5\u4e0a\u65b9\u5f0f\u53ea\u80fd\u5904\u7406\u533a\u95f4\u5185\u6c42\u548c\u8fd9\u79cd\u5355\u5224\u65ad\u5206\u652f\u7684\u9012\u5f52\uff0c\u4e0d\u80fd\u5e94\u5bf9\u4e24\u4e2a\u5224\u65ad\u5206\u652f\u7684\u60c5\u51b5\u3002\u6bd4\u5982\uff0c\u5bf9\u7d20\u6570\u6c42\u548c\uff0c\u975e\u7d20\u6570\u52a01\u7684\u7b97\u6cd5\u65e0\u6cd5\u7528<code>comp-in-ab</code>\u51fd\u6570\u6784\u5efa\u3002  </p> <p>\u6211\u4eec\u8fd8\u6709\u53e6\u5916\u4e00\u4e2a\u601d\u7ef4\u65b9\u5f0f\uff0c\u5047\u5982\u4f60\u5bf9\u94fe\u8868\u6bd4\u8f83\u719f\u6089\u7684\u8bdd\uff0c\u9996\u5148\u4e0d\u8003\u8651\u8ba1\u7b97\u6548\u7387\uff0c\u4ee5\u4e0b\u65b9\u6848\u5e94\u8be5\u662f\u53ef\u884c\u7684\uff1a\u533a\u95f4[a,b]\u5185\u7684\u6240\u6709\u7d20\u6570\u6309\u987a\u5e8f\u6392\u51fa\u6765\u4f1a\u5f62\u6210\u4e00\u4e2a\u94fe\u8868(<code>list</code>)\uff0c\u7136\u540e\u5bf9\u94fe\u8868\u8fdb\u884c\u6c42\u548c\uff0c\u800c\u6240\u6709\u7d20\u6570\u6784\u6210\u7684\u94fe\u8868\u53ef\u4ee5\u901a\u8fc7\u5bf9\u6b63\u6574\u6570\u7684\u94fe\u8868\u8fdb\u884c\u7b5b\u9009\u5f97\u5230\uff0c\u6574\u4e2a\u7b97\u6cd5\u53ef\u4ee5\u8868\u793a\u6210\u4e00\u7cfb\u5217\u7684\u94fe\u8868\u904d\u5386\u64cd\u4f5c\u3002 \u5bf9\u4e8e\u94fe\u8868\uff0c\u5927\u90e8\u5206\u8bed\u8a00\u90fd\u4f1a\u63d0\u4f9b\u4e00\u4e9b\u9ad8\u9636\u64cd\u4f5c\uff0c\u5982<code>map</code>\u3001<code>filter</code>\u3001<code>accumulate</code>\u7b49\uff0c\u5b83\u4eec\u7684\u5b9e\u73b0\u5206\u522b\u5982\u4e0b\uff1a  </p> <p><pre><code>(define map                                ; map\u51fd\u6570\uff0c\n  (lambda (proc items)                     ;    \u5bf9\u94fe\u8868\u7684\u6bcf\u4e2a\u5143\u7d20\u5e94\u7528\u8fc7\u7a0bproc\n    (if (null? items)                      ; \u5982\u679citems\u662f\u7a7a\u8868\n        nil                                ;    \u8fd4\u56de\u7a7a\n        (cons (proc (car items)            ; \u5426\u5219\u521b\u5efa\u65b0\u8868\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e3aproc(item1)\n              (map proc (cdr items)))))))  ;    \u7136\u540e\u5bf9\u5269\u4e0b\u7684\u5143\u7d20\u9012\u5f52\u8c03\u7528map\u51fd\u6570\n\n(define filter                             ; filter\u51fd\u6570\n  (lambda (predicate items)                ;    \u53c2\u6570\u4e3a\u5224\u771f\u51fd\u6570pedicate, \u94fe\u8868\u672c\u8eab\n    (cond \n      [(null? items)                       ;  \u5982\u679c\u7a7a\u8fd4\u56de\u7a7a\n        nil]             \n      [(predicate (car items))             ;  \u5982\u679c\u7b2c\u4e00\u4e2a\u5143\u7d20\u5224\u65ad\u6761\u4ef6\u4e3a\u771f\uff0c\u8fd4\u56de\u65b0\u94fe\u8868\uff0c\n        (cons (car items)                  ;    \u5176\u9996\u5143\u7d20\u4e0d\u53d8,\u5269\u4f59\u90e8\u5206\u9012\u5f52\u8c03\u7528filter\n              (filter predicate (cdr items)))] \n      [else (filter predicate (cdr items))]))) ;\u5426\u5219\uff0c\u8fd4\u56de\u5bf9\u5269\u4f59\u90e8\u5206\u9012\u5f52filter\u7684\u7ed3\u679c\n\n(define accumulate                         ; \u7d2f\u8ba1\u51fd\u6570accumulate\n  (lambda (op init items)                  ;   \u53c2\u6570\u4e3a\u64cd\u4f5cop, \u521d\u59cb\u503cinit, \u94fe\u8868\u672c\u8eab\n    (if (null? items)                      ; \u5982\u679c\u94fe\u8868\u4e3a\u7a7a\uff0c\n       init                                ;  \u8fd4\u56de\u521d\u59cb\u503cinit\n       (op (car items)                     ;  \u5426\u5219\uff0cop(\u9996\u5143\u7d20, \u5176\u5b83\u5143\u7d20\u7684accumlate)\n           (accumulate op init (cdr items))))))\n\n(define enum-ab                            ; \u533a\u95f4\u7a77\u4e3e\u51fd\u6570enum-ab\uff0c\u6784\u9020\u81ea\u7136\u6570\u94fe\u8868\n  (lambda (a b)                            ;  \u7ed9\u5b9a\u533a\u95f4[a,b]\n    (if (&gt; a b)                            ;   \u5982\u679ca&gt;b,\u8fd4\u56de\u7a7a\n      nil                                  ;  \u5426\u5219\u8fd4\u56de\u65b0\u94fe\u8868\uff0c\u9996\u5143\u7d20\u4e3aa\n      (cons a (enum-ab (+ a 1) b)))))      ;  \u5176\u5b83\u5143\u7d20\u662f\u5bf9[a+1,b]\u7684enum-ab\u8c03\u7528\n\n(map abs (list -10 2 -11 17))              ; \u8fd4\u56de'(10 2 11 17)\uff0c\u5bf9\u539f\u8868\u6240\u6709\u5143\u7d20\u6c42\u7edd\u5bf9\u503c\n(filter odd? (list 1 2 3 4 5))             ; \u8fd4\u56de'(1 3 5)\uff0c\u53d6\u51fa\u94fe\u8868\u4e2d\u7684\u5947\u6570\n(accumulate + 0 (list 1 2 3))              ; \u5bf9'(1 2 3)\u6c42\u548c\uff0c\u8fd4\u56de6\n(accumulate * 1 (list 1 2 4))              ; \u5bf9'(1 2 4)\u6c42\u4e58\u79ef\uff0c\u8fd4\u56de8\n(enum-ab 1 4)                            ; \u8f93\u5165\u533a\u95f4\u4e3a[1,4]\uff0c \u8fd4\u56de'(1 2 3 4)\n</code></pre> \u8fd9\u6837\u4e00\u6765\uff0c\u5bf9\u533a\u95f4[a,b]\u5185\u7684\u7d20\u6570\u6c42\u548c\u5c31\u53ef\u4ee5\u8868\u793a\u4e3a\u4ee5\u4e0b\u4ee3\u7801\uff1a  </p> <p><pre><code>(define sum-primes-2            \n  (lambda (a b)                  ;\u8fd9\u91cc\u7684sum-prime-2\u76f4\u63a5\u8c03\u7528\u4e86\u9ad8\u9636\u51fd\u6570\n    (accumulate                  ;\u7528c\u8bed\u8a00\u7684\u5f62\u5f0f\u53ef\u4ee5\u7c7b\u4f3c\u7684\u5199\u4e3a\n      +                          ;accumulate(+, 0, filter(prime?, enum-ab(a, b)))\n      0                          ;     1. x = enum-ab(a, b)\n      (filter                    ;     2. y = filter(prime\uff1f, x)\n        prime?                   ;     3. accumulate(+, 0, y)\n        (enum-ab a b)))))\n</code></pre> \u4f60\u53ef\u80fd\u4f1a\u6000\u7591\uff0c\u4e3a\u4e86\u628a<code>sum-primes-2</code>\u7684\u51fd\u6570\u4f53\u53d8\u4e3a\u4e00\u884c\uff08\u4e0a\u9762\u7684\u4ee3\u7801\u6253\u5370\u6210\u591a\u884c\u662f\u4e3a\u4e86\u4eba\u7c7b\u53ef\u8bfb\uff09\uff0c\u9700\u89814\u4e2a\u9ad8\u9636\u51fd\u6570\uff0c\u662f\u4e0d\u662f\u6709\u70b9\u8131\u88e4\u5b50\u90a3\u5565\u3002\uff1a\uff09 \u4f46\u8bf7\u522b\u7740\u6025\uff0c\u518d\u770b\u53e6\u5916\u4e00\u4e2a\u6590\u6ce2\u62c9\u5951\u6570\u5217\u7684\u4f8b\u5b50\uff0c\u5982\u679c\u6211\u4eec\u8981\u5217\u4e3e\u533a\u95f4[0,n]\u5185\u6240\u6709\u5076\u6590\u6ce2\u62c9\u5951\u6570\uff0c\u66b4\u529b\u7f16\u5199\u7684\u4e10\u7248\u7a0b\u5e8f\u53ef\u80fd\u5982\u4e0b\uff1a <pre><code>;\u9996\u5148\u5199\u4e00\u4e2a\u6c42\u6590\u6ce2\u62c9\u5951\u6570\u7684\u7a0b\u5e8f\n(define fib\n  (lambda (n)\n    (if (&lt;= n 1) \n      n\n      (+ (fib n-1) (fib n-2)))))\n\n;\u751f\u6210[0,n]\u5185\u7684\u5076fibonacci\u6570\u7684\u94fe\u8868\uff08\u5f53\u7136\u4f60\u53ef\u4ee5\u5199\u5f97\u66f4\u6e05\u6670\uff0c\u4f46\u903b\u8f91\u662f\u4e00\u6837\u7684\uff09\n(define even-fibs-1            \n  (lambda (n)                     ;even-fibs\u51fd\u6570\u662f\u5bf9next(k)\u8fd9\u4e2a\u9012\u5f52\u51fd\u6570\u7684\u8c03\u7528\n    (define next                  ;   next(k) \u51fd\u6570\u5b9a\u4e49\u5982\u4e0b\n      (lambda (k)     \n        (if (&gt; k n)               ;   \u5982\u679ck&gt;n\u4e86\uff0c\u8fd4\u56de\u7a7a\u8868\n          nil\n          (if (even? (fib k))     ;   \u5426\u5219\uff0c\u7ee7\u7eed\u5224\u65ad\uff0c\u5982\u679cfib(k)\u662f\u5076\u6570\n              (cons (fib k) (next (+ k 1)))   ;\u8fd4\u56de [fib(k), next(k+1)]\n              (next (+ k 1))))))              ;\u5426\u5219\u8fd4\u56denext(k+1)\n    (next 0)))                    ;even-fibs(n)\u7b49\u4ef7\u4e8e\u9012\u5f52\u8c03\u7528next(0)\n</code></pre></p> <p>\u5bf9\u6bd4\u51fd\u6570<code>sum-primes-1</code>\u548c<code>even-fibs-1</code>\u7684\u4ee3\u7801\uff0c\u5b83\u4eec\u662f\u5982\u6b64\u7684\u4e0d\u540c\u3002\u539f\u56e0\u4e5f\u8c8c\u4f3c\u5f88\u81ea\u7136\uff0c\u4e00\u4e2a\u662f\u6c42\u548c\uff0c\u53e6\u5916\u4e00\u4e2a\u662f\u751f\u6210\u94fe\u8868\u3002 \u4f46\u662f\u4ece\u9ad8\u9636\u51fd\u6570<code>map</code>\u3001<code>filter</code>\u548c<code>accumulate</code>\u7b49\u7684\u89c6\u89d2\u6765\u770b\uff0c\u4e24\u4e2a\u7a0b\u5e8f\u7684\u903b\u8f91\u5374\u662f\u5f88\u7c7b\u4f3c\u7684\u3002\u8b6c\u5982\uff0c\u5076\u6590\u6ce2\u62c9\u5951\u6570\u94fe\u8868\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u6210\u4e0b\u9762\u8fd9\u6837\uff1a  </p> <pre><code>(define even-fibs-2\n  (lambda (n)\n    (accumulate;\u7528c\u8bed\u8a00\u7684\u5f62\u5f0f\u53ef\u7406\u89e3\u4e3a\n      cons     ;accumulate(cons, '(), filter(even?, map(fib, enum-ab(a, b))))\n      '()      ;     1. x = enum-ab(0, n)\n      (filter  ;     2. y = map(fib, x)      \n        even?  ;     3. z = filter(even?, y)      \n        (map   ;     4. accumulate(cons, '(), z)\n          fib\n          (enum-ab 0 n))))))\n</code></pre> <p>Ah-ha!!!\u770b\u4f3c\u5b8c\u5168\u4e0d\u540c\u7684\u4e1c\u897f\uff0c\u5b9e\u9645\u4e0a\u5728\u9ad8\u9636\u51fd\u6570\u770b\u6765\uff0c\u5c45\u7136\u6709\u5f88\u591a\u5171\u6027\u3002 </p> <p>\u8fd9\u4e2a\u5171\u6027\u662f\u4ec0\u4e48\u5462\uff1f\u770b\u8d77\u6765\u597d\u50cf\u662f\u6570\u636e\u94fe\u8868\u6d41\u8fc7\u4e00\u53f0\u53f0\u673a\u5668\uff08\u9ad8\u9636\u51fd\u6570\uff09\uff0c\u7136\u540e\u53d8\u6210\u4e86\u6211\u4eec\u9700\u8981\u7684\u4e1c\u897f\u3002\u4e00\u5934\u5934\u732a\u7ecf\u8fc7\u52a0\u5de5\u8f66\u95f4\u91cc\u9762\u5404\u9053\u5de5\u5e8f\uff0c\u53d8\u6210\u4e86\u4e00\u4e32\u706b\u817f\u80a0\u3002 \u56fe1\u89e3\u91ca\u4e86<code>sum-primes-2</code>\u548c<code>even-fibs-2</code>\u8fd9\u4e24\u4e2a\u8ba1\u7b97\u8fc7\u7a0b\u7684\u5171\u6027\uff0c\u5e76\u5c55\u793a\u4e86\u5176\u5b83\u7c7b\u4f3c\u8ba1\u7b97\u8fc7\u7a0b\u7684\u9ad8\u9636\u51fd\u6570\u8868\u793a\u3002  </p>          \u56fe1 \u9ad8\u9636\u901a\u7528\u51fd\u6570\u89c6\u89d2\u91cc\u7684\u8ba1\u7b97\u8fc7\u7a0b\uff0c\u597d\u50cf\u6570\u636e\u6d41\u8fc7\u751f\u4ea7\u7ebf\u4e0a\u7684\u673a\u5668  <p>\u6211\u4eec\u770b\u5230\uff0c\u65e0\u8bba\u662f\u6c42\u5e73\u65b9\u548c\u3001\u751f\u6210\u6570\u5217\uff0c\u8fd8\u662f\u8fdb\u884c\u6587\u4ef6\u8f6c\u6362\uff0c\u5728\u56fe1\u7684\u89c6\u89d2\u4e2d\u90fd\u662f\u4e00\u4e32\u6570\u636e\uff08\u6bd4\u5982\u94fe\u8868\uff09\u6d41\u7ecf\u751f\u4ea7\u7ebf\u7684\u8fc7\u7a0b\u3002\u8fd9\u4e00\u7c7b\u578b\u7684\u7f16\u7a0b\u6cdb\u5f0f\uff0c\u5c31\u662f\u6d41\u6a21\u5f0f\uff0c\u82f1\u6587\u662f<code>stream</code>\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1aRichard Waters\u4e8e1979\u5e74\u5f00\u53d1\u4e86\u4e00\u4e2a\u5206\u6790\u5f53\u65f6\u7684Fortran\u79d1\u5b66\u8ba1\u7b97\u7a0b\u5e8f\u5305\u7684\u7a0b\u5e8f\uff0c\u53d1\u73b0\u7a0b\u5e8f\u5305\u91cc\u9762\u8db3\u8db3\u670990%\u7684\u8ba1\u7b97\u7a0b\u5e8f\u6ee1\u8db3\u56fe1\u7684\u8303\u5f0f\u3002\u6240\u4ee5\u5343\u4e07\u4e0d\u8981\u5ffd\u7565\u9ad8\u9636\u51fd\u6570\u7684\u5a01\u529b\u3002</p> <p>\u6d41\u6a21\u5f0f\u7684\u597d\u5904\u5728\u4e8e\u63d0\u4f9b\u4e86\u4e00\u79cd\u901a\u7528\u7684\u65b9\u5f0f\u53bb\u8868\u8fbe\u7b97\u6cd5\u3002\u5148\u5e72\u4ec0\u4e48\uff0c\u518d\u5e72\u4ec0\u4e48\u4e00\u76ee\u4e86\u7136\uff0c\u6ca1\u6709\u5404\u79cd\u8df3\u8f6c\u548c\u4e71\u5165\u3002\u8fd9\u79cd\u4ee3\u7801\u79f0\u4e3a\u7ebf\u6027\u4ee3\u7801\uff0c\u4e0e\u4e4b\u76f8\u5bf9\u7684\u4ee3\u7801\u4e5f\u53ef\u79f0\u4e3a\u201c\u9762\u6761\u4ee3\u7801\u201d\uff0c\u6216\u8005\u201c\u5c4e\u5c71\u201d\u3002 \u4f46\u5929\u4e0b\u6ca1\u6709\u514d\u8d39\u7684\u5348\u9910\uff01\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6d41\u6a21\u5f0f\u7a0b\u5e8f\u7684\u6267\u884c\u6548\u7387\u6781\u5176\u4f4e\u4e0b\uff0c\u65e0\u8bba\u662f\u7a7a\u95f4\u6548\u7387\u8fd8\u662f\u65f6\u95f4\u6548\u7387\u3002\u5982\u679c\u6211\u4eec\u8981\u5bf9\u533a\u95f4[1,10000000]\u5185\u7684\u5947\u6570\u6c42\u5e73\u65b9\u548c\uff0c\u6d41\u6a21\u5f0f\u7684\u7f16\u7a0b\u65b9\u5f0f\u8d77\u7801\u8981\u751f\u6210\u4e09\u4e2a\u957f\u94fe\u8868\u5e76\u8fdb\u884c\u4e09\u4e2aO(n)\u7684\u904d\u5386\u3002\u8fd9\u4f1a\u6162\u5f97\u62a0jio\u3002 \u6709\u6ca1\u6709\u529e\u6cd5\u89e3\u51b3\u6548\u7387\u95ee\u9898\u5462\uff1f\u6bd5\u7adf\u5403\u767d\u98df\u7684\u611f\u89c9\u662f\u5f88\u68d2\u7684\u3002  </p>"},{"location":"markdown/lisp_stream/#2","title":"2. \u6d41\u7684\u62bd\u8c61\u4e0e\u60f0\u6027\u6c42\u503c","text":"<p>\u4e3a\u4e86\u8ba9\u95ee\u9898\u66f4\u52a0\u4e00\u822c\u5316\uff0c\u6211\u4eec\u5fc5\u987b\u5b9a\u4e49\u4e00\u4e2a\u901a\u7528\u7c7b\u578b<code>stream</code>\uff0c\u5b83\u6709\u4e00\u4e2a\u6784\u9020\u51fd\u6570<code>cons-stream</code>\uff0c\u4e24\u4e2a\u9009\u62e9\u51fd\u6570<code>stream-head</code>\u548c<code>stream-rest</code>\uff0c\u5206\u522b\u5bf9\u5e94\u521b\u5efa\u4e00\u4e2a\u6d41\u3001\u53d6\u5f97\u6d41\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u3001\u53d6\u5f97\u5269\u4f59\u6d41\u3002\u6ee1\u8db3\u6761\u4ef6\u5982\u4e0b\uff1a  </p> <p><pre><code>(stream-head (cons-stream x y)) = x  ;\u7531x\u548cy\u7ec4\u6210\u7684\u6d41\u7684\u5934\u5143\u7d20\u662fx\n(stream-rest (cons-stream x y)) = y  ;\u7531x\u548cy\u7ec4\u6210\u7684\u6d41\u7684\u5269\u4e0b\u90e8\u5206\u662fy\n</code></pre> \u8bfb\u5230\u8fd9\u91cc\u4f60\u53ef\u80fd\u8981\u76b1\u7709\u5934\u4e86\uff0c\u8fd9\u4e0d\u5c31\u662f\u94fe\u8868\u8282\u70b9\u5417\uff1f\u4f46\u662f\u8bf7\u5148\u522b\u7740\u6025\uff0c\u6211\u4eec\u524d\u9762\u7684\u7b97\u6cd5\u90fd\u662f\u7528\u94fe\u8868\u5b9e\u73b0\u7684\uff0c\u4f60\u5df2\u7ecf\u770b\u5230\u4e86\u5b83\u7684\u6548\u7387\u662f\u591a\u4e48\u4ee4\u4eba\u53d1\u6307\u4e86\u3002\u8010\u5fc3\u7684\u8bfb\u4e0b\u53bb\u4f60\u4e5f\u4f1a\u9ad8\u558a\u201cAh-ha\uff01\u201d\u7684\u3002  </p> <p>\u94fe\u8868\u65e0\u975e\u662f<code>(cons 1 (cons 2 (cons 3 nil)))</code>\u8fd9\u6837\u7684\u4e1c\u897f\u2014\u2014\u7b80\u8bb0\u4e3a<code>(list 1 2 3)</code>\u3002\u9274\u4e8e\u6d41\u548c\u94fe\u8868\u7684\u76f8\u4f3c\u6027\uff0c\u7b2c1\u8282\u7684\u94fe\u8868\u57fa\u672c\u51fd\u6570\u5728\u6d41\u4e2d\u5e94\u8be5\u4e5f\u6709\u7c7b\u4f3c\u7684\u7248\u672c\uff0c\u6bd4\u5982\u53d6\u7b2cn\u5143\u7d20\u7684<code>stream-ref</code>\uff0c\u901a\u7528\u53d8\u6362\u7684<code>stream-map</code>\uff0c<code>stream-filter</code>\uff0c<code>stream-accumulate</code>\u7b49\u7b49\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>(define stream-ref   ;\u53d6\u6d41\u7684\u7b2cn\u4e2a\u5143\u7d20\n  (lambda (s n)      ;\u5982\u679cn\u7b49\u4e8e0\u5c31\u53d6 stream-head(s)\n    (if (= n 0)      ;\u5426\u5219\u9012\u5f52  stream-ref(stream-rest(s), n-1)\n      (stream-head s)  \n      (stream-ref (stream-rest s) (- n 1)))))      \n\n(define stream-map   ;\u5bf9\u6d41\u7684\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u53d8\u6362\uff0c\u53d8\u6362\u51fd\u6570\u4e3aproc\n  (lambda (proc s)   ; \u5982\u679cs\u662f\u7a7a\u6d41\uff0c\u8fd4\u56denil\n    (if (null? s)    ; 1. a=proc(stream-head(s))  \n      nil            ; 2. b=stream-map(proc, stream-rest(s))\n      (cons-stream (proc (stream-head s))  ;3. cons-stream(a, b)\n                   (stream-map proc (stream-rest s))))))\n\n(define stream-enum-ab  ;\u4ece\u533a\u95f4[a,b]\u4e2d\u751f\u6210\u4e00\u4e2a\u6d41\uff0c\u548c\u524d\u9762\u7684enum-ab\u51fd\u6570\u7c7b\u4f3c\n  (lambda (a b)         ;\u4f46\u662f\u5979\u4eec\u751f\u6210\u7684\u6570\u636e\u7ed3\u6784\u662f\u5b8c\u5168\u4e0d\u540c\u7684\uff0c\u8bf7\u5f80\u540e\u770b\n  ...))\n\n(define stream-filter   ;\u5bf9\u4e00\u4e2a\u6d41\u6309\u5224\u65ad\u6761\u4ef6\u8fdb\u884c\u7b5b\u9009\u7c7b\u4f3c\u4e8e\u524d\u9762\u7684filter\u51fd\u6570\n  (lambda (predicate s)\n  ...))  \n</code></pre> \u4ed4\u7ec6\u5bf9\u6bd4\u4e00\u4e0b\u5c31\u4f1a\u53d1\u73b0\uff0c\u8fd9\u4e9b\u51fd\u6570\u4f53\u51e0\u4e4e\u4e00\u6a21\u4e00\u6837\uff0c\u552f\u4e00\u4e0d\u540c\u5728\u4e8e\u7528<code>stream-cons</code>\u4ee3\u66ff\u4e86<code>cons</code>\uff0c<code>stream-head</code>\u4ee3\u66ff\u4e86<code>car</code>\uff0c<code>stream-rest</code>\u4ee3\u66ff\u4e86<code>cdr</code>\u3002\u6240\u4ee5\uff0c\u4ee5\u4e0b\u7b97\u6cd5\u7684\u8868\u8fbe\u4e0e\u7b2c\u4e00\u8282\u5b8c\u5168\u7c7b\u4f3c\uff0c\u53ea\u662f\u6362\u4e86\u4e2a\u9a6c\u7532\uff1a a)\u4ece[100,100000]\u8fd9\u4e2a\u533a\u95f4\u5efa\u7acb\u4e00\u4e2a\u6d41\uff0c\u6bd4\u5982\u662fs1\uff1b b)\u53d6\u8fd9\u4e2a\u6d41\u7684\u7d20\u6570\u90e8\u5206\uff0c\u751f\u6210\u4e00\u4e2a\u65b0\u6d41s2\uff1b c)\u53d6s2\u7684\u9664\u9996\u4e2a\u5143\u7d20\u7684\u5269\u4f59\u90e8\u5206\uff0c\u5f97\u5230s3\uff1b d)\u53d6s3\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002 \u8fd9\u4e2a\u7b97\u6cd5\u7684\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>(stream-head         ;stream-head(s3)\n  (stream-rest             ;s3 = stream-head(s2)\n    (stream-filter prime?      ;s2 = stream-filter(prime?, s1)\n                   (stream-enum-ab 100 100000))))\n</code></pre> \u94fe\u8868\u578b\u7b97\u6cd5\u6548\u7387\u4f4e\u4e0b\u7684\u539f\u56e0\u5728\u4e8e\u6bcf\u4e00\u5c42\u8c03\u7528\u90fd\u8981\u751f\u6210\u4e00\u4e2a\u957f\u94fe\u8868\uff0c\u7136\u540e\u624d\u80fd\u8fdb\u5165\u66f4\u5916\u5c42\u7684\u51fd\u6570\uff0c\u6539\u8fdb\u7b97\u6cd5\u7684\u5173\u952e\u5728\u4e8e\u6309\u9700\u751f\u6210\u94fe\u8868\u7684\u4e00\u90e8\u5206\u3002\u6bd4\u5982\u8bf4\uff0c\u65e2\u7136\u4ee5\u4e0a\u7b97\u6cd5\u5bf9\u4e8e\u8f93\u5165\u533a\u95f4[100, 103]\u548c[100, 1000000]\u7ed3\u679c\u90fd\u662f103\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u5e0c\u671b<code>cons-stream</code>\u51fd\u6570\u80fd\u591f\u8d4b\u4e88\u4e00\u79cd\u7a7f\u8d8a\u80fd\u529b\uff0c\u5f53\u6700\u5916\u5c42\u5217\u4e3e\u5230103\u65f6\uff0c\u5176\u4ed6\u66f4\u5927\u7684\u7d20\u6570\u4e0d\u4f1a\u88ab\u663e\u5f0f\u5728\u5185\u5b58\u4e2d\u679a\u4e3e\u751f\u6210\u3002\u8fd9\u79cd\u6309\u9700\u6c42\u503c\u7684\u80fd\u529b\u8fd8\u6709\u4e00\u4e2a\u79f0\u547c\u2014\u2014\u5ef6\u8fdf\u6c42\u503c\uff0c\u6216\u60f0\u6027\u6c42\u503c\u3002    </p> <p>\u5c0f\u8d34\u58eb\uff1a\u6ca1\u9519\uff0c\u6709\u4e86\u60f0\u6027\u6c42\u503c\uff0c\u6d41\u548c\u94fe\u8868\u53d8\u6210\u4e86\u4e0d\u540c\u7684\u4e1c\u897f\uff0c<code>cons-stream</code>\u548c<code>cons</code>\u64cd\u4f5c\u7c7b\u4f3c\uff0c\u4f46\u751f\u6210\u7684\u6570\u636e\u7ed3\u6784\u5b8c\u5168\u4e0d\u540c\u3002\u6d41\u4e0d\u662f\u94fe\u8868\u3002</p> <p>\u4e3a\u4e86\u5c40\u90e8\u7684\uff08\u6211\u4eec\u4e0d\u60f3\u6539\u53d8\u8bed\u8a00\u7684\u6c42\u503c\u987a\u5e8f\uff09\u5f15\u5165\u60f0\u6027\u6c42\u503c\uff0c\u9700\u8981\u4e24\u4e2a\u51fd\u6570<code>delay</code>\u548c<code>force</code>\u3002<code>(delay a)</code>\u8868\u793a\u201c\u8bb8\u8bfa\u201d<code>a</code>\u4f1a\u5728\u9700\u8981\u7684\u65f6\u5019\u624d\u88ab\u6c42\u503c\uff0c\u800c<code>(force (delay a))</code>\u8868\u793a\u73b0\u5728\u5c31\u5bf9a\u8fdb\u884c\u6c42\u503c\u3002\u4ece\u800c\u60f0\u6027\u6c42\u503c\u7248\u672c\u7684<code>stream</code>\u53ef\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>(define cons-stream        ;cons-stream\u6784\u9020\u4e00\u4e2a\u6d41\n  (lambda (x y)            ; \u7b49\u4ef7\u4e8e\u5e8f\u5bf9(x . (delay y))\n    (cons x (delay y))))\n\n(define stream-head\n  (lambda (s)              ;stream-head\u8fd4\u56de\u6d41\u7684\u5934\n    (car s)))              ;\u5bf9\u5e94\u4e0a\u9762\u7684 x\n\n(define stream-rest\n  (lambda (s)              ;\u6211\u4eec\u8981\u5bf9(delay y)\u5f3a\u5236\u6c42\u503c\n    (force (cdr s))))      ;\u5f97\u5230\u4e0a\u9762\u7684 y\n</code></pre> \u8fd9\u6837\u4e00\u6765\uff0c\u5728\u533a\u95f4[a,b]\u4e4b\u95f4\u6784\u9020\u6574\u6570\u6d41\u7684\u51fd\u6570\u4ecd\u7136\u51e0\u4e4e\u53ef\u4ee5\u7167\u6284\u7b2c1\u8282\u51fd\u6570<code>enum-ab</code>\u7684\u5b9e\u73b0\uff0c\u53ea\u662f\u628a<code>cons</code>\u66ff\u6362\u6210<code>cons-stream</code>\u3002<code>stream-filter</code>\u51fd\u6570\u6211\u4eec\u4e5f\u5199\u51fa\u6765\uff0c\u4ecd\u7136\u51e0\u4e4e\u662f\u7167\u6284<code>filter</code>\u51fd\u6570:  </p> <p><pre><code>(define stream-enum-ab   \n  (lambda (a b)          \n    (if (&gt; a b)          \n      nil                    \n      (cons-stream a (stream-enum-ab (+ a 1) b)))))  \n      ;\u6ce8\u610f\uff1a\u8fd9\u4e00\u884ca\u6211\u4eec\u786e\u5b9e\u7ed9\u51fa\u4e86\uff0c\u4f46\u540e\u9762\u7684(stream-enum-ab (+ a 1) b)\u4e0d\u4f1a\u88ab\u7acb\u523b\u6c42\u503c\n      ;\u56e0\u4e3a\u88abdelay\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u6d41\u5e76\u4e0d\u662fa\u5230b\u4e4b\u95f4\u7684\u957f\u94fe\u8868\uff0c\u800c\u662f(a . y)\uff0cy\u53ea\u662f\u4e00\u4e2a\u8bb8\u8bfa\u3002\n\n(define stream-filter  \n  (lambda (predicate s) \n    (cond \n      [(null? s) nil]             \n      [(predicate (stream-head s))             \n       (cons-stream (stream-head s)            \n                    (stream-filter predicate (stream-rest s)))] \n                    ;\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u9012\u5f52\u4f1a\u88ab\u5ef6\u8fdf\u6c42\u503c\n      [else (stream-filter predicate (stream-rest s))])))\n      ;(stream-rest s)\u7b49\u4ef7\u4e8e(force (cdr s))\n                            ;\u6ce8\u610f\uff1astream-rest\u4f1aforce\u7acb\u523b\u6c42\u503c    \n</code></pre> \u4e3a\u4e86\u8003\u5bdf\u6548\u7387\uff0c\u4e0d\u59a8\u5bf9\u524d\u9762a)b)c)d)\u5f62\u5bb9\u7684\u7b97\u6cd5\u5206\u6790\u4e00\u4e0b\uff0c\u8fd9\u91cc\u7528\u7684\u662f\u7b80\u5355\u7684\u4ee3\u6362\u6a21\u578b\uff1a <pre><code>;1.\u56fd\u9645\u60ef\u4f8b\uff0c\u7b2c\u4e00\u6b65\u7167\u6284\n(stream-head         \n  (stream-rest       \n    (stream-filter prime?  \n                   (stream-enum-ab 100 1000000))))\n\n;2.\u66ff\u6362(stream-enum-ab 100 1000000)\n(stream-head         \n  (stream-rest       \n    (stream-filter prime? (cons 100 ;\u540e\u9762\u4e0d\u4f1a\u88ab\u6c42\u503c\uff0c\u56e0\u4e3adelay\u4e86\n                                (delay (stream-enum-ab 101 1000000)))\n\n;3.\u7b2c\u4e00\u4e2a\u6570\u5b57\u4e0d\u662f\u7d20\u6570\uff0c\u6240\u4ee5stream-filter\u9700\u8981\u5bf9\u6d41\u7684\u5269\u4e0b\u90e8\u5206\u7ee7\u7eed\u5bfb\u627e\n(stream-head         \n  (stream-rest       \n    (stream-filter prime? (force (delay (stream-enum-ab 101 1000000))))))\n    ;\u8fd9\u91cc\u7b49\u4ef7\u4e8e(stream-filter prime? (stream-enum-ab 101 100000)))\n\n;4.101\u662f\u7d20\u6570\uff0c\u6240\u4ee5\u4f1a\u5f97\u5230\u4e00\u4e2a\u65b0\u6d41\n(stream-head         \n  (stream-rest       \n    (cons 101 \n          (delay (stream-filter prime? \n                                (stream-rest (stream-enum-ab 101 1000000)))))))\n                            ;\u8fd9\u91cc\u7b49\u4ef7\u4e8e(force (delay (stream-enum-ab 102 100000))\n\n;5.\u597d\u5427\uff0c\u6211\u4eec\u8fd9\u91cc\u7167\u6837\u6284\u5199\u4e00\u904d\n(stream-head         \n  (stream-rest       \n    (cons 101 \n          (delay (stream-filter prime? (stream-enum-ab 102 1000000))))))\n\n;6.\u7b2c\u4e8c\u5c42\u7684stream-rest\u8131\u58f3\u4e86\n(stream-head (force (delay (stream-filter prime? \n                                          (stream-enum-ab 102 1000000)))))\n(stream-head (stream-filter prime? \n                            (stream-enum-ab 102 100000)))\n\n;7.\u597d\u5427\u540e\u9762\u7684\u90e8\u5206\u56de\u5230\u4e86\u5f00\u59cb\uff0c\u7167\u6837\u53c2\u7167\u7b2c2\u6b65\u6284\u4e00\u904d\uff0c\u4e0d\u540c\u7684\u662f\u4ece102\u5f00\u59cb\u4e86\uff0c\u800c\u4e14\u7b2c\u4e8c\u5c42\u8131\u6389\u4e86\n(stream-head (stream-filter prime? \n                            (const 102 (delay (stream-enum-ab 103 1000000)))))\n\n;8.\u4e0d\u662f\u7d20\u6570stream-filter\u90e8\u5206\u4f1a\u8ba9\u540e\u9762\u6c42\u503c\n(stream-head (stream-filter prime? \n                            (stream-enum-ab 103 1000000)))\n(stream-head (stream-filter prime? \n                            (cons 103 (delay (stream-enum-ab 104 1000000)))))\n\n;9.\u662f\u7d20\u6570\u6784\u5efa\u65b0\u6d41\n(stream-head (cons 103 (delay (stream-filter prime? \n                                             (stream-enum-ab 104 1000000)))))\n\n;10.\u795e\u5947\u7684\u9b54\u6cd5\u4ea7\u751f\u4e86\u3002\u3002\u3002\u3002\u8fd9\u91cc\u4f1a\u76f4\u63a5\u8f93\u51fa103\n103\n</code></pre></p> <p>\u5728\u6574\u4e2a\u8ba1\u7b97\u5e8f\u5217\u4e2d\uff0c<code>delay</code>\u548c<code>force</code>\u5728\u4e0d\u540c\u5c42\u7ea7\u7684\u901a\u7528\u51fd\u6570\u4e4b\u95f4\u6309\u9700\u79fb\u52a8\uff0c\u4f7f\u5f97\u6574\u4e2a\u4fc4\u7f57\u65af\u5957\u5a03\u8c03\u7528\u53ea\u904d\u5386\u4e865\u4e2a\u81ea\u7136\u6570\u3002 \u56fe2\u8bf4\u660e\u4e86\u6d41\u548c\u94fe\u8868\u7684\u4e0d\u540c\u3002\u7531\u4e8e\u5c40\u90e8\u60f0\u6027\u6c42\u503c\u673a\u5236\u7684\u5b58\u5728\uff0c\u6d41\u8303\u5f0f\u7a0b\u5e8f\u83b7\u53d6\u4e86\u56fe2\u4e2d\u201c\u76f4\u901a\u8f66\u201d\u5f0f\u9ad8\u6548\u8fd0\u884c\u673a\u5236\u3002  </p>          \u56fe2 \u94fe\u8868\u5b9e\u73b0\u548c\u6d41\u5b9e\u73b0\u7684\u4e0d\u540c  <p>\u4f60\u53ef\u4ee5\u628a\u6bcf\u4e2a\u51fd\u6570\u60f3\u8c61\u6210\u4e00\u53f0\u53f0\u673a\u5668\uff0c\u6570\u636e\u662f\u4e00\u6761\u5f88\u957f\u5f88\u957f\u7684\u94fe\u6761\u3002\u94fe\u8868\u7248\u7a0b\u5e8f\u662f\u5148\u628a\u94fe\u6761\u7a7f\u8fc7\u4e00\u53f0\u673a\u5668\uff0c\u5168\u90e8\u62c9\u51fa\u6765\uff0c\u7136\u540e\u7a7f\u8fc7\u7b2c\u4e8c\u4e2a\uff0c...\u3002\u6d41\u7684\u5b9e\u73b0\u65b9\u6cd5\u662f\u5f53\u94fe\u6761\u7684\u5934\u90e8\u7a7f\u8fc7\u7b2c\u4e00\u53f0\u673a\u5668\u540e\uff0c\u7acb\u523b\u8ba9\u5b83\u7a7f\u8fc7\u7b2c\u4e8c\u4e2a\uff0c\u800c\u8f93\u51fa\u7aef\u53ea\u9700\u8981\u62fd\u7740\u94fe\u6761\u7684\u5934\u90e8\u5f80\u5916\u62c9\u3002  </p>"},{"location":"markdown/lisp_stream/#3-delayforce","title":"3. delay\u548cforce\u51fd\u6570\u7684\u5b9e\u73b0","text":"<p>\u5728\u56fe2\u4e2d\uff0c\u7531\u4e8e\u5c40\u90e8\u60f0\u6027\u6c42\u503c\u7684\u52a0\u5165\uff0c\u6d41\u5e76\u6ca1\u6709\u663e\u5f0f\u7684\u5199\u51fa\u6240\u6709\u6570\u636e\u3002\u5b83\u662f\u4e00\u4e2a\u7531\u201c\u7b2c\u4e00\u4e2a\u5143\u7d20\u201d\u548c\u88ab<code>delay</code>\u7684\u201c\u4f59\u4e0b\u90e8\u5206\u201d\u7684\u5e8f\u5bf9\u3002\u5f53\u6211\u4eec\u6bcf\u6b21\u6267\u884c<code>stream-rest</code>\u7684\u65f6\u5019\uff0c\u201c\u4f59\u4e0b\u90e8\u5206\u201d\u624d\u4f1a\u88abforce\u6c42\u503c\u3002\u867d\u7136<code>delay</code>\u548c<code>force</code>\u8c8c\u4f3c\u6709\u6781\u5927\u7684\u9b54\u529b\uff0c\u4f46\u5b83\u4eec\u7684\u5b9e\u73b0\u5374\u662f\u6781\u5176\u76f4\u622a\u4e86\u5f53\u7684\u3002 \u9996\u5148\u8ba8\u8bba<code>delay</code>, \u7531\u4e8e\u5728Lisp\u6216Scheme\u8bed\u8a00\u4e2d\u4f5c\u4e3a\u53c2\u6570\u7684\u8868\u8fbe\u5f0f\u4f1a\u9996\u5148\u6c42\u503c\uff08\u5e94\u7528\u5e8f\u6c42\u503c\uff09\u3002\u5bf9\u4e8e\u67d0\u4e2a\u8868\u8fbe\u5f0f<code>exp</code>\u800c\u8a00\uff0c<code>delay</code>\u51fd\u6570\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u4fdd\u7559\u4e86<code>exp</code>\u7684\u903b\u8f91\u4f46\u53c8\u4e0d\u4f1a\u88ab\u7acb\u523b\u6c42\u503c\u7684\u4e1c\u897f\u3002\u5f88\u660e\u663e\uff0c\u8fd9\u4e1c\u897f\u5c31\u662f<code>lambda</code>\u8868\u8fbe\u5f0f\uff0c\u5b9a\u4e49\u5982\u4e0b\uff1a  </p> <pre><code>(define delay          ;\u5b9a\u4e49delay\u662f\u4e00\u4e2a\u5173\u4e8eexp\u7684\u51fd\u6570\n  (lambda (exp)\n    (lambda () exp)))  ;\u5b83\u8fd4\u56de\u4e00\u4e2a\u7a7a\u53c2\u51fd\u6570\uff0c\u5176\u51fd\u6570\u4f53\u662fexp\u672c\u8eab\n\n(delay 5)      ;\u5bf9(delay 5)\u7684\u6c42\u503c\u4e0d\u4f1a\u8fd4\u56de5\n(lambda () 5)  ;\u800c\u662f\u4e00\u4e2a\u65e0\u53c2\u7684\u8fd4\u56de5\u7684\u51fd\u6570\n</code></pre> <p>\u8fd9\u6837\u4e00\u6765\uff0c<code>force</code>\u51fd\u6570\u7684\u5b9e\u73b0\u66f4\u52a0\u663e\u800c\u6613\u89c1\uff0c\u5b83\u7684\u8f93\u5165\u53c2\u6570\u5e94\u8be5\u662f\u4e00\u4e2a\u65e0\u53c2\u51fd\u6570\uff0c\u8fd4\u56de\u503c\u662f\u5bf9\u65e0\u53c2\u51fd\u6570\u7684\u6c42\u503c\u3002</p> <pre><code>(define force          ;\u5b9a\u4e49froce\u662f\u4e00\u4e2a\u5173\u4e8edelayed\u7684\u51fd\u6570\n  (lambda (delayed)    ;\u5bf9delayed\u6c42\u503c\uff0c\u5c31\u76f4\u63a5\u5916\u9762\u5957\u4e2a\u62ec\u53f7\u5c31\u597d\n    (delayed)))        ;lisp\u5c31\u662f\u8fd9\u4e48\u81ea\u7136\n\n;\u6211\u4eec\u8bd5\u4e00\u4e0b(force (delay 5))\n(force (delay 5))\n;\u7b49\u4ef7\u4e8e\u4e0b\u9762\u8fd9\u6837\n(force (lambda () 5))\n;\u7b49\u4ef7\u4e8e\u4e0b\u9762\n((lambda () 5))\n;\u65e0\u53c2\uff0c\u76f4\u63a5\u8fd4\u56de\u51fd\u6570\u4f53\u5c31\u662f\u4e86\n5\n;\u6ce8\u610f\u54e6\uff0c\u5982\u679cf\u662f\u4e00\u4e2a\u65e0\u53c2\u51fd\u6570\uff0c\u90a3\u4e48(f)\u662f\u51fd\u6570\u7684\u503c\uff0c\u4e0d\u80fd\u6df7\u6dc6\n</code></pre> <p>\u5f53\u7136\uff0c\u4e0a\u9762\u7684<code>delay</code>\u548c<code>force</code>\u8fd8\u6709\u5f88\u591a\u53ef\u4ee5\u4f18\u5316\u7684\u5730\u65b9\u3002\u6bd4\u5982\u5728\u6709\u4e9b\u5e94\u7528\u4e2d\u6211\u4eec\u9700\u8981\u591a\u6b21\u5bf9\u540c\u4e00\u4e2a<code>delay</code>\u8fc7\u7684\u5bf9\u8c61\u6c42\u503c\uff0c\u8fd9\u5c31\u9700\u8981<code>delay</code>\u7a0b\u5e8f\u62e5\u6709\u8bb0\u5fc6\u7684\u80fd\u529b\u3002\u5982\u679c\u5b83\u662f\u7b2c\u4e00\u6b21\u88ab\u8c03\u7528\uff0c\u90a3\u4e48\u8fd4\u56de<code>exp</code>\u7684\u539f\u59cb\u5f62\u5f0f\uff0c\u5426\u5219\u8fd4\u56de\u5df2\u7ecf\u6c42\u503c\u540e\u7684\u7b80\u5316\u5f62\u5f0f\u3002\u6bd4\u5982<code>(delay (+ 1 2))</code>\u7b2c\u4e00\u6b21\u8c03\u7528\u8fd4\u56de<code>(lambda () (+ 1 2)</code>\uff0c\u800c\u7b2c\u4e8c\u6b21\u5219\u5229\u7528\u8bb0\u5fc6\u76f4\u63a5\u8fd4\u56de<code>(lambda () 3)</code>\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u7f16\u7a0b\u8bed\u8a00\u800c\u8a00\uff0c\u62e5\u6709lambda\u533f\u540d\u51fd\u6570\u8be5\u662f\u591a\u4e48\u5fc5\u8981\u7684\u4e8b\u60c5\u3002 </p> <p>\u597d\u5427\uff0c\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5b8c\u6210\u4e86\u4e24\u4ef6\u4e8b\uff1a1)\u53d1\u73b0\u4e86\u4e00\u79cd\u7528\u9ad8\u9636\u51fd\u6570\u5199\u7ebf\u6027\u6613\u8bfb\u4ee3\u7801\u7684\u6d41\u6a21\u5f0f\uff0c\u5b83\u5177\u6709\u5f88\u5f3a\u7684\u901a\u7528\u6027\uff1b2)\u5c40\u90e8\u60f0\u6027\u6c42\u503c\u4f7f\u5f97\u6d41\u6a21\u5f0f\u62e5\u6709\u5e38\u89c4\u4e10\u7248\u66b4\u529b\u7f16\u7a0b\u7684\u540c\u9636\u65f6\u95f4\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u3002 \u4f46\u9b54\u6cd5\u624d\u521a\u521a\u5f00\u59cb\uff0c\u4e0d\u4fe1\u5f80\u540e\u770b\u3002  </p>"},{"location":"markdown/lisp_stream/#4","title":"4. \u65e0\u7a77\u6d41","text":"<p>\u8003\u5bdf\u4ee5\u4e0b\u4e24\u4e2a\u5947\u8469\u5b9a\u4e49\uff0c\u8bf7\u82b110\u79d2\u949f\u601d\u8003\u4e00\u4e0b\uff0c\u8fd9\u79cd\u53ef\u6015\u7684\u4e1c\u897f\u5c45\u7136\u662f\u80fd\u591f\u9ad8\u6548\u987a\u5229\u8fd0\u884c\u7684\uff0c\u5b9e\u5728\u8ba9\u4eba\u4e0d\u5bd2\u800c\u6817: <pre><code>(define interger-start-from\n  (lambda (n)  \n    (cons-stream n (integer-start-from (+ n 1)))))\n;\u770b\u5230\u4e86\u5417\uff1f\u4e0a\u9762\u662f\u4e00\u4e2a\u751f\u6210[n, \u65e0\u7a77\u5927)\u7684\u6570\u5217\u7684\u6d41\n;\u5b83\u5b9e\u9645\u7684\u6837\u5b50\u662f(cons n (delay integer-start-from-n+1))\n\n(define postive-integers\n  (interger-start-from 1))\n;\u6ca1\u9519\uff0c\u5f88\u5408\u4e4e\u903b\u8f91\uff0c\u6b63\u6574\u6570\u5c31\u662f\u4ece1\u5f00\u59cb\u6570\u5230\u65e0\u7a77\u5927\u7684\u6570\u7684\u96c6\u5408  \n</code></pre> \u6b63\u662f\u56e0\u4e3a<code>delay</code>\u7684\u5b58\u5728\uff0c\u7a0b\u5e8f\u4e0d\u4f1a\u8fdb\u5165\u6b7b\u5faa\u73af\u7684\u65e0\u7a77\u9012\u5f52\u3002\u8fd9\u4e9b\u65e0\u7a77\u6d41\u5b8c\u5168\u53ef\u4ee5\u8f93\u5165\u5230\u4e4b\u524d\u7684\u6240\u6709\u7b97\u6cd5\u5f53\u4e2d\u5b8c\u7f8e\u5de5\u4f5c\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u4f60\u4eec\u90fd\u77e5\u9053\u9012\u5f52\u51fd\u6570\uff0c\u73b0\u5728\u5f00\u773c\u754c\u4e86\u5427\uff0c\u6570\u636e\u4e5f\u53ef\u4ee5\u9012\u5f52\u3002\u5728Lisp\u7684\u4e16\u754c\u91cc\uff0c\u51fd\u6570\u53ef\u4ee5\u662f\u6570\u636e\uff0c\u6570\u636e\u4e5f\u53ef\u4ee5\u662f\u51fd\u6570\u3002 </p> <p>\u5982\u679c\u6211\u8981\u5bf9\u6240\u6709\u7684\u5c0f\u4e8e100\u7684\u5076\u6b63\u6574\u6570\u6c42\u5e73\u65b9\u548c\uff0c\u90a3\u4e48\u6d41\u6a21\u5f0f\u7684\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>(stream-accumulate \n   + \n   0\n   (stream-map \n      square\n      (stream-filter\n        (lambda (x) (&lt; x 100)) ;\u8fd9\u91cc\u9700\u8981\u7ed9\u4e00\u4e2a\u533f\u540d\u51fd\u6570\n        (stream-filter\n           even?\n           (integer-start-from 1) ;\u8fd9\u91cc\u662f\u6240\u6709\u7684\u6b63\u6574\u6570\u96c6\n        ))))\n</code></pre></p> <p>\u540c\u6837\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u6590\u6ce2\u62c9\u5951\u6570\u7684\u65e0\u7a77\u6d41\uff0c\u5b83\u63cf\u8ff0\u4e86\u6240\u6709\u7684\u6590\u6ce2\u62c9\u5951\u6570\uff1a <pre><code>(define fibgen\n  (lambda (fib1 fib2)\n    (cons-stream a (fibgen fib1 (+ fib1 fib2)))))\n\n(define all-fibs\n  (fibgen 0 1))\n\n;\u8fd9\u91cc\u6211\u4e0d\u663e\u5f0f\u7684\u5199\u51fa\u6765\uff0c\u6709\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u5728\u7eb8\u4e0a\u63a8\u5bfc\u4e00\u4e0bdelay\u662f\u5982\u4f55\u4f5c\u7528\u7684\n</code></pre></p>"},{"location":"markdown/lisp_stream/#5","title":"5. \u9690\u5f0f\u65e0\u7a77\u6d41","text":"<p>\u5982\u679c\u65e0\u7a77\u6d41\u5df2\u7ecf\u6bc1\u6389\u4f60\u7684\u4e09\u89c2\uff0c\u90a3\u4e48\u66f4\u53ef\u6015\u7684\u6765\u4e86\uff1a\u4f60\u53ef\u4ee5\u50cf\u7528\u5fae\u5206\u65b9\u7a0b\u53bb\u63cf\u8ff0\u7269\u7406\u73b0\u8c61\u90a3\u6837\uff0c\u7528\u5b9a\u7406\u7684\u65b9\u5f0f\u9690\u6027\u5b9a\u4e49\u65e0\u7a77\u6d41\u3002 \u6bd4\u5982\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u65e0\u7a77\u4e2a1\u7ec4\u6210\u7684\u4e00\u4e2a\u6d41\u3002 <pre><code>(define ones (cons-stream 1 ones))\n;\u770b\u8d77\u6765\u5faa\u73af\u5b9a\u4e49\u5427\uff0c\u53ef\u662f\u5b83\u5b8c\u5168\u5408\u6cd5\u56e0\u4e3a\u5b83\u5c55\u5f00\u7684\u4ee3\u7801\u662f\u4e0b\u9762\u8fd9\u6837\n\n(cons 1 (delay ones))\n;\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f1,\u540e\u9762\u7684ones\u56e0\u4e3adelay\u800c\u5ef6\u8fdf\u6c42\u503c\u4e86\uff0c\u4e0d\u4f1a\u9677\u5165\u6b7b\u5faa\u73af\n</code></pre> \u6211\u4eec\u518d\u5b9a\u4e49\u4e2a\u5947\u8469\u51fd\u6570<code>add-streams</code>\uff0c\u5b83\u8fd4\u56de\u4e24\u4e2a\u6d41\u7684\u9010\u5bf9\u5143\u7d20\u7684\u548c\u7ec4\u6210\u7684\u6d41\uff1a <pre><code>(define add-stream\n  (lambda (s1 s2)\n    (stream-map + s1 s2)))\n\n;\u6bd4\u5982\u4e24\u4e2a\u65e0\u9650\u6d41ones\u4f5cadd-stream,\u4fbf\u4f1a\u751f\u6210\u65e0\u7a77\u591a\u4e2a2\u7684\u6d41\n(define twos\n  (add-stream ones ones))\n\n;\u770b\u770b\u4e0b\u9762\u8fd9\u4e2a\u5b9a\u4e49\u6b63\u6574\u6570\u7684\u65b9\u5f0f\uff0c\u662f\u4e0d\u662f\u5f88\u6050\u6016\uff1f\n(define postive-intergers\n  (cons-stream 1 (add-stream ones postive-integers)))\n</code></pre> \u60f3\u4e00\u4e0b\uff0c<code>postive-integer</code>\u662f<code>(cons 1 (delay something))</code>\uff0c<code>something</code>\u53c8\u662f\u67d0\u4e2a\u9996\u5143\u7d20\u662f1\u7684\u6d41\u548cones\u7684\u76f8\u52a0\uff0c\u8fc7\u7a0b\u662f\uff1a a) 1, something b) 1, 1+1, something c) 1, 1+1, 1+1+1, something d) 1, 1+1, 1+1+1, 1+1+1+1, ....  </p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u540c\u6837\u7684\u98ce\u683c\u53bb\u5b9a\u4e49\u51fa\u6240\u6709\u6590\u6ce2\u62c9\u5951\u6570\u7684\u65e0\u7a77\u6d41\uff1a <pre><code>(define all-fibs\n  (cons-stream 0\n               (cons-stream 1\n                            (add-stream (stream-rest all-fibs)\n                                        all-fibs))))\n;\u8fd9\u79cd\u9690\u5f0f\u65e0\u7a77\u6d41\u7684\u63a8\u5bfc\u4e5f\u7559\u7ed9\u8bfb\u8005\uff0c\u8bd5\u8bd5\uff0c\u5f88\u6709\u8da3\u7684\uff0c\u5934\u76ae\u53d1\u9ebb\u3002\n</code></pre></p>"},{"location":"markdown/lisp_stream/#6","title":"6. \u6d41\u4e0e\u79d1\u5b66\u8ba1\u7b97","text":"<p>\u5728\u79d1\u5b66\u8ba1\u7b97\u4e2d\uff0c\u6709\u5f88\u591a\u6c42\u51fd\u6570\u4e0d\u52a8\u70b9\u7684\u8fed\u4ee3\u65b9\u6cd5\uff0c\u6bd4\u5982\u725b\u987f\u6cd5\u6c42\u5e73\u65b9\u6839\uff0c\u7528\u6d41\u6a21\u5f0f\u63cf\u8ff0\u7684\u5b9e\u73b0\u5982\u4e0b\uff1a <pre><code>; x1 = (x0 + x / x0) / 2\n; \u8fd9\u662f\u5e73\u5747\u963b\u5c3c\u725b\u987f\u6cd5\u6c42\u6839\u8fed\u4ee3\u7684\u6838\u5fc3\n(define sqrt-improve\n  (lambda (guess x)\n    (average guess (/ x guess))))\n\n\n; \u5b9a\u4e49\u4e86\u4e00\u4e2a\u725b\u987f\u8fed\u4ee3\u7684\u65e0\u7a77\u6d41\n; \u8fd9\u4e2a\u65e0\u7a77\u6d41\u91cc\u9762\u5d4c\u5957\u4e86\u4e00\u4e2a\u6240\u6709\u731c\u6d4b\u503c\u7684\u65e0\u7a77\u6d41\n(define sqrt-stream\n  (lambda (x)\n    (define guess-stream\n      (cons-stream \n         1.0\n         (stream-map\n           (lambda (guess) (sqrt-improve guess x))\n           guess-stream)))\n    guess-stream))\n\n;\u725b\u987f\u8fed\u4ee3\u53d8\u6210\u4e86\u6253\u5370\u51fa\u8fd9\u4e2a\u6d41\u91cc\u6240\u6709\u5143\u7d20\u7684\u8fc7\u7a0b\uff0c\u5f53\u7136\u8fd9\u4e2a\u547d\u4ee4\u4f1a\u65e0\u9650\u7684\u6253\u5370\u4e0b\u53bb\n(display-stream (sqrt-stream 2))\n\n;\u5982\u679c\u4f60\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6253\u5370\u6709\u9650\u4e2a\u6d41\u5143\u7d20\u7684\u8fc7\u7a0b\uff0c\u8b6c\u5982\n(display-stream-n (sqrt-sream 2) 5)\n\n;\u5b83\u7684\u8f93\u51fa\u662f\n1.\n1.5\n1.4166666666665\n1.4142156862745\n1.4142135623747\n</code></pre> \u5f53\u7136\uff0c\u7edd\u4e0d\u5e94\u8be5\u9f13\u52b1\u7528\u8fd9\u79cd\u5947\u8469\u65b9\u5f0f\u53bb\u5199\u725b\u987f\u6cd5\u6c42\u6839\u3002\u8fd9\u4e2a\u4f8b\u5b50\u53ea\u662f\u8bf4\u660e\uff0c\u6d41\u6a21\u5f0f\u662f\u4e00\u79cd\u975e\u5e38\u666e\u904d\u548c\u901a\u7528\u7684\u7a0b\u5e8f\u8bbe\u8ba1\u65b9\u6cd5\u3002\u5b83\u7528<code>delay</code>\u548c<code>force</code>\u5de7\u5999\u7684\u5b9e\u73b0\u4e86\u903b\u8f91\u548c\u6570\u636e\u4e4b\u95f4\u7684\u4e92\u6362\uff0c\u4f7f\u5f97\u6211\u4eec\u62e5\u6709\u4e86\u4f7f\u7528\u9ad8\u9636\u51fd\u6570\u53bb\u5199\u6d41\u6c34\u7ebf\u5f0f\u4ee3\u7801\u7684\u80fd\u529b\u3002</p>"},{"location":"markdown/lisp_stream/#7","title":"7. \u7ed3\u8bba\u548c\u5410\u69fd","text":"<p>\u518d\u56de\u5230\u4e00\u5f00\u59cb\u7684C\u8bed\u8a00\u6587\u4ef6\u6d41\u95ee\u9898\u3002\u8bda\u7136\uff0c\u6587\u4ef6\u548c\u6240\u6709\u7684IO\u8bbe\u5907\u90fd\u53ef\u4ee5\u62bd\u8c61\u4e3a\u6d41\u3002\u4f46\u662fC\u8bed\u8a00\u7684\u6587\u4ef6\u6d41\u5b9e\u5728\u662f\u4e00\u79cd\u6781\u5176\u5c40\u9650\u7684\u6982\u5ff5\u3002<code>FILE*</code>\u7c7b\u578b\u7684\u6587\u4ef6\u6d41\u4f53\u73b0\u4e86\u60f0\u6027\u6c42\u503c\u7684\u601d\u60f3\uff0c\u56e0\u4e3a\u4f60\u5728<code>fopen</code>\u4e00\u4e2a\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u5b9e\u9645\u4e0a\u5b83\u53ea\u662f\u628a\u8bfb\u5199\u7684\u4f4d\u7f6e\u6307\u5411\u4e86\u6587\u4ef6\u7684\u5f00\u5934\uff0c\u800c\u5e76\u6ca1\u6709\u628a\u5168\u90e8\u7684\u6587\u4ef6\u8bfb\u51fa\u6765\u3002<code>fprint</code>\uff0c<code>fscanf</code>\uff0c<code>fgetc</code>\u7b49\u51fd\u6570\u540c\u6837\u662f\u6d41\u6c34\u7ebf\u4e0a\u7684\u4e00\u4e9b\u673a\u5668\u3002 \u4f46\u662f\uff0cC\u7684\u6587\u4ef6\u6d41\u672c\u8d28\u662f\u201c\u5b57\u8282\u6d41\u201d\uff0c<code>FILE*</code>\u91cc\u5e76\u4e0d\u5e26\u6709\u7c7b\u578b\u4fe1\u606f\u3002\u66f4\u5e7f\u4e49\u7684\u6d41\u53ef\u4ee5\u662f\u5217\u8868\u7684\u6d41\uff0c\u6811\u7684\u6d41\uff0c\u6570\u5b57\u7684\u6d41\uff0c\u51fd\u6570\u7684\u6d41\u3002 \u7531\u4e8e\u6ca1\u6709\u533f\u540d\u51fd\u6570\u7684\u5b58\u5728\uff0c\u7528C\u8bed\u8a00\u5b9e\u73b0<code>delay</code>\u51fd\u6570\u53d8\u5f97\u6781\u5176\u56f0\u96be\uff0c\u4f60\u51e0\u4e4e\u6ca1\u6709\u529e\u6cd5\u5199\u51fa\u4e00\u4e2aC\u8bed\u8a00\u7248\u672c\u7684\u65e0\u7a77\u6d41\u6216\u9690\u5f0f\u65e0\u7a77\u6d41\u3002  <code>python</code>\u91cc\u7684<code>range(5)</code>\u548c<code>[1,2,3,4,5]</code>\u4e5f\u662f\u4e0d\u540c\u7684\u4e1c\u897f\uff0c\u524d\u8005\u662f\u60f0\u6027\u6c42\u503c\u7684\u6d41\uff0c\u800c\u540e\u8005\u662f\u94fe\u8868\u3002\u6240\u4ee5\u4f60\u5199<code>for i in range(100000):</code>\u800c\u4e0d\u7528\u62c5\u5fc3\u4e8b\u5148\u751f\u6210\u4e86\u4e00\u4e2a\u5de8\u5927\u94fe\u8868\u3002\u4f46<code>python</code>\u7684\u6d41\u5f88\u96be\u8ba9\u6211\u4eec\u7528\u6d41\u6c34\u7ebf\u7684\u65b9\u5f0f\u6784\u9020\u7a0b\u5e8f\u4f53\u3002\u4f60\u4e5f\u6ca1\u6709\u529e\u6cd5\u7528\u9012\u5f52\u5b9a\u4e49\u7684\u65b9\u5f0f\u63cf\u8ff0\u65e0\u9650\u4e2a1\uff0c\u7f16\u8bd1\u5668\u4f1a\u8ba4\u4e3a\u4f60\u4e0d\u80fd\u7528\u4e00\u4e2a\u672a\u5b9a\u4e49\u7684\u4e1c\u897f\u53bb\u4e0b\u5b9a\u4e49\u3002 \u901a\u8fc7\u4fee\u6539Lisp\u89e3\u91ca\u5668\u7684\u6c42\u503c\u987a\u5e8f\uff08\u53d8\u6210\u6b63\u5219\u5e8f\u6c42\u503c\uff09\uff0c\u4f60\u53ef\u4ee5\u5f97\u5230\u5929\u751f\u60f0\u6027\u6c42\u503c\u7684\u65b0\u89e3\u91ca\u5668\uff0c\u800c\u4e0d\u518d\u9700\u8981<code>delay</code>\u51fd\u6570\u3002\u4f46\u662f\u8fd9\u4e48\u505a\u7684\u4ee3\u4ef7\u662f\u727a\u7272\u6240\u6709\u5e94\u7528\u5e8f\u6c42\u503c\u8bed\u8a00\u7684\u9ad8\u6548\u6027\uff0c\u6bcf\u5c42\u8c03\u7528\u7684\u8868\u8fbe\u5f0f\u90fd\u4f1a\u5728\u6808\u7a7a\u95f4\u5c55\u5f00\uff0c\u6700\u540e\u518d\u8fdb\u884c\u5d4c\u5957\u89c4\u7ea6\u6c42\u503c\u3002\u6240\u4ee5\u5c40\u90e8\u7684\u60f0\u6027\u6c42\u503c\u80fd\u529b\u5373\u53ef\uff0c\u8fc7\u72b9\u4e0d\u53ca\u3002  </p> <p>\u6700\u540e\u5410\u69fd\uff1a \u5f88\u591a\u8d44\u6df1\u7a0b\u5e8f\u5458\u771f\u7684\u77e5\u9053\u4ec0\u4e48\u53eb\u201c\u6d41\u201d\u5417\uff1fJava\u8bbe\u8ba1\u6a21\u5f0f\u91cc\u9762\u4e5f\u6709\u4e2a\u201c\u6d41\u6a21\u5f0f\u201d\uff0c\u5176\u4ee3\u7801\u4e4b\u9f8c\u9f8a\uff0c\u601d\u7ef4\u4e4b\u6df7\u4e71\uff0c\u8868\u8fbe\u4e4b\u7f57\u55e6\uff0c\u4ee4\u4eba\u53d1\u6307\u3002\u8d34\u5728\u4e0b\u9762\uff0c\u7acb\u6b64\u5b58\u7167\u3002</p> <p><pre><code>public interface Flow {\n    public void action();\n}\n\npublic class VerifyFlow implements Flow {\n    @Override\n    public void action() {\n        System.out.println(\"\u5ba1\u6838\");\n    }\n}\n\npublic class ApplyFlow implements Flow {\n    @Override\n    public void action() {\n        System.out.println(\"\u7533\u8bf7\");\n    }\n}\n\npublic class ApproveFlow implements Flow {\n    @Override\n    public void action() {\n        System.out.println(\"\u5ba1\u6279\");\n    }\n}\n\npublic class Context {\n    private Flow flow;\n\n    public void setFlow(Flow flow) {\n        this.flow = flow;\n    }\n\n    public void process() {\n        flow.action();\n    }\n}\n\npublic class Test {\n    public static void main(String[] args) {\n        Context ctx = new Context();\n        ctx.setFlow(new ApplyFlow());\n        ctx.process();\n\n        ctx.setFlow(new VerifyFlow());\n        ctx.process();\n\n        ctx.setFlow(new ApproveFlow());\n        ctx.process();\n    }\n}\n</code></pre> \u8fd9\u4ed6\u59b9\u7684\u4e5f\u914d\u53eb\u505a\u201c\u6d41\u201d\uff1f\u4e8c\u67f1\u5b50\u7684\u5343\u9e1f\u6d41\uff1f\u7d22\u9686\u7684\u4e00\u5200\u6d41\u8fd8\u662f\u4e8c\u5200\u6d41\uff1f\u770b\u8d77\u6765\u5230\u662f\u5f88\u4e8c\u628a\u5200\u7684\u3002\u6211\u518d\u6b21\u786e\u4fe1\uff0c\u9762\u5411\u5bf9\u8c61\u9664\u4e86\u521b\u9020\u4e0d\u662f\u95ee\u9898\u7684\u95ee\u9898\uff0c\u5c31\u6839\u672c\u4e0d\u662f\u4e2a\u95ee\u9898......</p>"},{"location":"markdown/lisp_y_combinator/","title":"Y\u7ec4\u5408\u5b50","text":"<p>Y\u7ec4\u5408\u5b50\uff08<code>Y Combinator</code>\uff09\u662f\u5bf9\u533f\u540d\u51fd\u6570\u8fdb\u884c\u9012\u5f52\u7684\u901a\u7528\u62bd\u8c61\u65b9\u6cd5\uff08\u6216\u51fd\u6570\uff09\u3002 \u8ba1\u7b97\u6a21\u578b\u7684\u7ecf\u5178\u63cf\u8ff0\u6709\u4e24\u79cd\uff1a\u56fe\u7075\u673a\u548c\u03bb\u6f14\u7b97\uff08\u03bb-calculus\uff09\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u56fe\u7075\u673a\u662f\u5bf9\u7528\u4e8e\u201c\u8ba1\u7b97\u7684\u673a\u5668\u201d\u7684\u62bd\u8c61\uff0c\u800c\u03bb\u6f14\u7b97\u662f\u5bf9\u201c\u8ba1\u7b97\u672c\u8eab\u201d\u7684\u62bd\u8c61\uff08\u662f\u4e00\u79cd\u201d\u6700\u5c0f\u201c\u7684\u7f16\u7a0b\u8bed\u8a00\uff09\u3002 \u03bb\u6f14\u7b97\u7684\u8868\u8fbe\u5f0f\uff08<code>expr</code>\uff09\u53ea\u6709\u56db\u79cd\u5f62\u5f0f\uff1a (1) \u5e38\u91cf\uff1a \u6570\u5b57\uff08\u59821\u30012\uff09\uff0c\u6216\u57fa\u672c\u8fd0\u7b97\u51fd\u6570\u7684\u7b26\u53f7\uff08\u5982+\u3001-\uff09\uff1b (2) \u53d8\u91cf\uff1a \u53ef\u4ee3\u6362\u4e3a\u5176\u5b83\u540d\u5b57\u6216\u503c\u800c\u4e0d\u6539\u53d8\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u7ed3\u679c(\u5982x\u3001y\uff09\uff1b (3) \u51fd\u6570\uff1a \u5f62\u5982<code>\u03bbx.x+1</code>\u7684\u8868\u8fbe\u5f0f\uff0c\u7b49\u4ef7\u4e8e\u6570\u5b66\u7684f(x)=x+1\uff0c\u4f46\u6240\u6709\u51fd\u6570\u90fd\u6ca1\u6709\u540d\u5b57; (4) \u6c42\u503c\uff1a \u6bd4\u5982<code>(\u03bbx.x+1)3</code>\u7684\u6c42\u503c\u7ed3\u679c\u662f4\u3002 \u7528Lisp\u8bed\u8a00\u6216\u5176\u65b9\u8a00\u6765\u63cf\u8ff0\u03bb\u6f14\u7b97\u662f\u975e\u5e38\u65b9\u4fbf\u7684\u3002\u5982\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f<code>\u03bbx.x+1</code>\u7b49\u4ef7\u4e8e\u4ee5\u4e0b\u4ee3\u7801\uff1a <pre><code>(lambda (x)    ;\u4e00\u4e2a\u5355\u53c2\u533f\u540d\u51fd\u6570\uff0c\u53c2\u6570\u4e3ax\n  (+ x 1))     ;\u51fd\u6570\u4f53\u4e3a x+1\n</code></pre> \u8868\u8fbe\u5f0f<code>(\u03bbx.x+1)3</code>\u7684\u6c42\u503c\u8fc7\u7a0b\u7b49\u4ef7\u4e8e\u4ee5\u4e0bLisp\u6c42\u503c\u8fc7\u7a0b\uff1a <pre><code>( (lambda (x) (+ x 1))    3)  ; \u5bf9\u533f\u540d\u51fd\u6570(lambda (x) (+ x 1))\u5728x=3\u4e0a\u6c42\u503c\n                              ;     \u53d6\u51fa\u533f\u540d\u51fd\u6570\u7684\u51fd\u6570\u4f53(+ x 1)\uff0c\n                              ;     \u7136\u540e\u75283\u66ff\u4ee3x\n(+ 3 1)                       ; \u6b64\u8868\u8fbe\u5f0f\u6c42\u503c\u7ed3\u679c\u4e3a4\n</code></pre> \u03bb\u6f14\u7b97\u7684\u51fd\u6570\u90fd\u662f\u533f\u540d\u7684\uff0c\u8fd9\u7ed9\u9012\u5f52\u5e26\u6765\u4e86\u56f0\u96be\u3002\u4ee5\u4e0b\u6c42\u9636\u4e58\u7684\u4ee3\u7801\u65e0\u6cd5\u76f4\u63a5\u7ffb\u8bd1\u4e3a\u03bb\u6f14\u7b97\u5f62\u5f0f\uff1a <pre><code>(define factorial                      ;\u5b9a\u4e49\u4e00\u4e2a\u53ebfactorial\u7684\u540d\u5b57\n  (lambda (x)                          ;\u5b83\u7ed1\u5b9a\u5230\u4e00\u4e2a \u5355\u53c2x\u533f\u540d\u51fd\u6570\n    (if (= x 1)                        ;   \u51fd\u6570\u4f53\u4e3a\uff1a \u5982\u679cx=1\n        1                              ;            \u8fd4\u56de1\n        (* x (factorial (- x 1))))))   ;            \u5426\u5219\u8fd4\u56dex * factorial(x-1)\n</code></pre> \u7531\u4e8eLisp\u8bed\u8a00\u4f7f\u7528\u4e86<code>define</code>\u8bed\u53e5\u628a\u533f\u540d\u51fd\u6570\u548c<code>factorial</code>\u8fd9\u4e2a\u7b26\u53f7\u7ed1\u5b9a\uff08\u5141\u8bb8\u51fd\u6570\u6709\u540d\u5b57\uff09\uff0c\u51fd\u6570\u5185\u90e8\u624d\u5141\u8bb8<code>(* x (factorial (- x 1))</code>\u7684\u8868\u8fbe\u5f0f\u5b58\u5728\u3002  </p> <p>\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u4e16\u754c\u4e4b\u521d\uff0c\u5929\u5730\u6df7\u6c8c\u5982\u9e21\u5b50\uff0c\u6ca1\u6709<code>define</code>\u8bed\u53e5\u3002\u5982\u4f55\u53ea\u7528\u7eaf\u533f\u540d\u51fd\u6570\u8fdb\u884c\u9012\u5f52\uff1f </p>"},{"location":"markdown/lisp_y_combinator/#1","title":"1. \u53cc\u91cd\u5957\u5a03","text":"\u4fc4\u7f57\u65af\u5957\u5a03  <p>\u6211\u4eec\u6682\u65f6\u8fd8\u5fc5\u987b\u4f7f\u7528<code>f</code>\uff0c<code>g</code>\u8fd9\u6837\u7684\u540d\u5b57\uff0c\u5b83\u4eec\u53ef\u76f4\u63a5\u8111\u8865\u4e3a\u4e00\u4e2a\u5f62\u5982<code>(lambda (x) &lt;body&gt;)</code>\u7684\u533f\u540d\u51fd\u6570\u3002\u5728\u6ca1\u6709<code>define</code>\u8bed\u53e5\u65f6\uff0c\u5982\u679c\u8981\u5728<code>f</code>\u7684\u5185\u90e8\u8c03\u7528<code>g</code>\uff0c\u5219<code>g</code>\u9700\u4f5c\u4e3a\u53c2\u6570\u5728<code>f</code>\u5185\u4f53\u73b0\u3002<code>f</code>\u7684\u5f62\u5f0f\u5e94\u8be5\u5982\u4e0b\uff1a <pre><code>(lambda (g)                    ;\n  (lambda (x)                  ; \u51fa\u73b0\u4e86\uff0cf\u662f\u4e00\u4e2a\u5957\u5a03\u51fd\u6570\n     &lt;body&gt;))                  ; (f g)\u4f1a\u751f\u6210\u65b0\u51fd\u6570(lambda (x) (dosomething g))\n</code></pre> \u7c7b\u4f3c\u7684\uff0c\u5bf9\u9636\u4e58\u51fd\u6570<code>factorial</code>\u5957\u5a03\uff0c\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u7684\u533f\u540d\u51fd\u6570\uff0c\u6211\u4eec\u53eb\u4ed6<code>a</code>\uff1a <pre><code>;a\u5f62\u5f0f\u7684\u9636\u4e58\u5957\u5a03\n(lambda (f)                    ;\u4e00\u4e2a\u533f\u540d\u51fd\u6570\uff0c\u5176\u5355\u53c2f\u662f\n  (lambda (x)                  ;   \u53e6\u5916\u4e00\u4e2a\u5355\u53c2x\u7684\u533f\u540d\u51fd\u6570\n    (if (= x 1)                ;      ...\u8fd9\u91cc\u65e0\u9700\u89e3\u91ca\n        1                      ;              \n        (* x (f (- x 1))))))   ;      \u6ce8\u610f(f ...) \u8fd9\u4e2a\u8c03\u7528\u662f\u5426\u6210\u7acb\n</code></pre> \u73b0\u5728\u7684\u95ee\u9898\u662f\u8fd9\u4e2a\u51fd\u6570\u5e94\u8be5\u5982\u4f55\u8c03\u7528\uff0c\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u7528<code>(a 1)</code>\u6765\u6c421\u7684\u9636\u4e58\uff0c\u56e0\u4e3a<code>a</code>\u7684\u8f93\u5165\u5fc5\u987b\u662f\u4e00\u4e2a\u51fd\u6570\u3002\u5bf9\u4efb\u610f\u51fd\u6570<code>any-func</code>\uff0c<code>(a any-func)</code>\u7684\u6c42\u503c\u7ed3\u679c\u5e94\u8be5\u5982\u4e0b\uff1a <pre><code>(lambda (x)\n  (if (= x 1)\n      1\n      (* x (any-func (- x 1)))))\n</code></pre> \u5047\u5b9a\u4e0a\u9762\u7684\u4ee3\u7801\u5c31\u662f\u533f\u540d\u9636\u4e58\u9012\u5f52\uff0c1\u7684\u9636\u4e58\u53ef\u8868\u793a\u4e3a<code>((a any-func) 1)</code>\u3002\u4e0d\u59a8\u76f4\u63a5\u7528<code>a</code>\u4ee3\u66ff<code>any-func</code>\u3002<code>((a a) 1)</code>\u7684\u503c\u4e3a1\uff0c\u5176\u6c42\u503c\u8fc7\u7a0b\u5982\u4e0b\uff1a <pre><code>((a a) 1)                         ;\u6211\u4eec\u628a\u7b2c\u4e00\u4e2aa\u5199\u56delambda\u5f62\u5f0f\n;=&gt;\n(lambda (x)                       ;\u5bf9(a a)\u6c42\u503c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65e0\u7a77\u5957\u5a03\u7684\u51fd\u6570\n  (if (= x 1)                     ;\n      1                           ;\n      (* x (a (- x 1)))))         ;  \u8fd9\u91cc\u7684(a (- x 1))\u53ef\u4ee5\u65e0\u7a77\u65e0\u5c3d\u7684\u66ff\u6362\u4e0b\u53bb\n;=&gt;\n(if (= 1 1)                       ;\u5bf9\u4e0a\u9762\u7684\u51fd\u6570\u4f53\u4e2d\u628ax=1\u4ee3\u5165\u540e  \n    1                             ;  \u53ea\u4f1a\u5bf9True\u5206\u652f\u6267\u884c\uff1a \u8fd4\u56de1\n    (* x (a (- x 1))))            ;\u6ce8\u610f\uff1a\u8fd9\u4e2a\u5206\u652f\u4e0d\u4f1a\u6267\u884c\uff0c\u6240\u4ee5\u65e0\u7a77\u5957\u5a03\u4e5f\u6ca1\u95ee\u9898     \n;=&gt;\n1                                 ;((a a) 1) =  1\n;\u5b9e\u9645\u4e0a\u6574\u4e2a\u6c42\u503c\u8868\u8fbe\u5f0f\u5199\u51fa\u6765\u662f\u8fd9\u6837\u7684\uff0c\n;\u6ca1\u6709a\u8bed\u53e5\uff0c\u53ea\u6709\u533f\u540d\u51fd\u6570,\u5b83\u7684\u6c42\u503c\u7ed3\u679c\u662f1\uff0c\u73b0\u5728\u77e5\u9053\u4e3a\u4ec0\u4e48\u6211\u4eec\u6682\u65f6\u9700\u8981\u5b83\u7684\u540d\u5b57\u4e3aa\u4e86\u5427\uff1a\uff09\n(((lambda (f)\n    (lambda (x)\n      (if (= x 1)\n          1\n          (* x (f (- x 1))))))    ;\u4e0d\u8981\u88ab\u62ec\u53f7\u5413\u5012\uff0c\u65e0\u975e\u662f\u62f7\u8d1d\u7c98\u8d34\u7684\u529f\u592b\n  (lambda (f)\n    (lambda (x)\n      (if (= x 1)\n          1\n          (* x (f (- x 1)))))))\n 1)\n</code></pre> \u5bf9<code>((a a) 2)</code>\u6c42\u503c\u4f1a\u51fa\u9519\u3002\u4ee5\u4e0b\u4ee3\u6362\u63ed\u793a\u4e86\u51fa\u9519\u7684\u539f\u56e0\uff1a <pre><code>((a a) 2)                         ;\u53c2\u8003\u4e0a\u9762\u7684\u66ff\u6362\u8fc7\u7a0b\uff0c\u5f97\u5230\n;=&gt;\n(if (= 2 1)                       ;\u5bf9\u4e0a\u9762\u7684\u51fd\u6570\u4f53\u4e2d\u628ax=2\u4ee3\u5165\u540e  \n    1                             ;     \u5ffd\u7565True\u5206\u652f\n    (* 2 (a (- 2 1))))            ;     \u5c55\u5f00\u8fd9\u4e2a\u65e0\u7a77\u5957\u5a03\u51fd\u6570\n;=&gt;\n(* 2                              ;\n   (a 1))                         ;\u8fd9\u884c\u4f1a\u51fa\u9519\uff01\uff01\uff01a\u7684\u53c2\u6570\u4e0d\u80fd\u662f\u6570\u503c\n</code></pre> \u6211\u4eec\u9700\u8981\u8ba9<code>(if ...)</code>\u7684<code>False</code>\u5206\u652f\u91c7\u7528<code>((a a) some-value)</code>\u7684\u8c03\u7528\u5f62\u5f0f\u624d\u80fd\u5904\u7406<code>x</code>\u5927\u4e8e1\u7684\u60c5\u51b5\u3002\u56e0\u6b64\uff0c\u9700\u5bf9<code>a</code>\u8fdb\u884c\u6539\u52a8\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u533f\u540d\u51fd\u6570(\u4e0d\u59a8\u79f0\u5176\u4e3a<code>b</code>)\uff1a <pre><code>;b\u5f62\u5f0f\u7684\u5957\u5a03\u51fd\u6570\n(lambda (f)                        ;\n  (lambda (x)                      ;\n    (if (= x 1)                    ;\n        1                          ;              \n        (* x ((f f) (- x 1))))))   ;b\u548ca\u4ec5\u5728\u8fd9\u91cc\u4e0d\u540c\uff0c\u628af\u6539\u6210\u4e86(f f)\n</code></pre> \u4e0d\u59a8\u6d4b\u8bd5\u4e00\u4e0b<code>((b b) 3)</code>\u662f\u5426\u6b63\u786e\uff0c\u5c55\u5f00\u8fc7\u7a0b\u5982\u4e0b\uff1a <pre><code>(lambda (x)                       ;\u5bf9(b b)\u6c42\u503c\u4f1a\u8fd4\u56de\u7c7b\u4f3c\u4e8e(a a)\n  (if (= x 1)                     ;\u7684\u65e0\u7a77\u5957\u5a03\n      1                           ;\n      (* x ((b b) (- x 1)))))     ;\u4ec5\u6700\u540e\u4e00\u884c\u4e0d\u540c\n;=&gt;      \n(if (= 3 1)                       ;\u5bf9((b b) 3)\u6c42\u503c\n    1                             ;\n    (* 3 ((b b) (- 3 1)))))       ;\u4ec5\u6267\u884cFalse\u5206\u652f\n;=&gt;\n(* 3                              ;\n   ((b b) 2))                     ;\u663e\u7136((b b) 2)\u7684\u5c55\u5f00\u4e00\u5b9a\u662f\n                                  ;(* 2 ((b b) 1))\n;=&gt;                                 \n(* 3                              ;\u51fa\u73b0\u4e86\uff0c\u9636\u4e58\n   (* 2 1))                       ;((b b) 1)\u80af\u5b9a\u662f1\n</code></pre> \u6240\u4ee5\u7eaf\u533f\u540d\u5b9e\u73b0\u7684\u9636\u4e58\u51fd\u6570\u4e3a<code>(b b)</code>\u5373\uff1a <pre><code>((lambda (f)                       ;\u6069\uff0c\u5916\u90e8\u662f\u4e2a\u5173\u4e8eb\u7684\u53cc\u91cd\u5957\u5a03\n   (lambda (x)                     ;\u5957\u7684\u4e24\u4e2a\u5a03\u7684\u6bcf\u4e2a\u5a03\u90fd\u662f\u5173\u4e8e f\u548cx\u7684\u53cc\u91cd\u5957\u5a03\n     (if (= x 1)                   ;\u5957\u5a03\u5957\u7740\u5957\u5a03\n         1                         ;\u5c31\u95ee\u4f60\u6015\u4e0d\u6015\n         (* x ((f f) (- x 1))))))\n (lambda (f)\n   (lambda (x)\n     (if (= x 1)\n         1\n         (* x ((f f) (- x 1)))))))\n</code></pre> \u73b0\u5728\u7684\u95ee\u9898\u662f\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u901a\u7528\u533f\u540d\u51fd\u6570\u81ea\u52a8\u5b9e\u73b0\u9012\u5f52\uff1f</p>"},{"location":"markdown/lisp_y_combinator/#2-y","title":"2. \u62bd\u8c61\u51faY\u7ec4\u5408\u5b50","text":"<p>\u6211\u4eec\u4e4b\u524d\u8fdb\u884c\u4e86\u4ee5\u4e0b\u4e24\u6b65\u5b9e\u73b0\u4e86\u533f\u540d\u51fd\u6570\u9012\u5f52\uff1a <pre><code>;1. \u628a\u51fd\u6570\u5f53\u4f5c\u53c2\u6570\u4eff\u7167define\u7684\u8fc7\u7a0b\u6539\u5199\n((lambda (f)                 ;\u9996\u5148\u5c06\u666e\u901a\u9012\u5f52\u51fd\u6570\u5957\u4e2a\u5a03\n   (lambda (x)               ;   \n     ... (... (f new-x))))   ;    \u533f\u540d\u7684a\n;2. \u628a\u9012\u5f52\u90e8\u5206\u7684(f ...)\u6539\u5199\u4e3a((f f) ...)\n((lambda (f)                 ;\n   (lambda (x)               ;   \n     ... (... ((f f) new-x)) ;\u628aa\u51fd\u6570\u4f53\u7684f\u4fee\u6539\u4e3a(f f)\u5f97\u5230b\n;3. \u5bf9b\u8fdb\u884c\u5957\u5a03\n((b b) x)\n</code></pre> <code>a</code>\u5f62\u5f0f\u7684\u533f\u540d\u51fd\u6570\u4fdd\u7559\u4e86\u9012\u5f52\u7684\u8bcd\u6cd5\u5f62\u5f0f\u4f46\u65e0\u6cd5\u76f4\u63a5\u9012\u5f52\u8c03\u7528\u3002\u5982\u679c\u5b58\u5728\u67d0\u4e2a\u901a\u7528\u8fc7\u7a0b<code>Y</code>\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a<code>a</code>\u5f62\u5f0f\u7684\u533f\u540d\u51fd\u6570\uff0c\u81ea\u52a8\u8f6c\u6362\u4e3a<code>(b b)</code>\u7684\u5f62\u5f0f\uff0c\u8fd9\u6837\u7684\u901a\u7528\u51fd\u6570\u88ab\u79f0\u4e3aY\u7ec4\u5408\u5b50\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a \u6839\u636eY\u7ec4\u5408\u5b50\u7684\u5b9a\u4e49\uff0c\u5b83\u4e00\u5b9a\u6ee1\u8db3<code>(Y a)=(b b)</code>\u3002 </p>"},{"location":"markdown/lisp_y_combinator/#21-ab","title":"2.1 \u7531<code>a</code>\u751f\u6210<code>b</code>\uff0c\u7ee7\u7eed\u5957\u5a03","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u5fc5\u987b\u8bbe\u8ba1\u4e00\u4e2a\u51fd\u6570<code>p</code>\u6ee1\u8db3<code>(p a)=b</code>\u3002<code>a</code>\u548c<code>b</code>\u7684\u4e24\u79cd\u901a\u7528\u5f62\u5f0f\u5206\u522b\u5982\u4e0b\uff08\u53ea\u8003\u8651\u9012\u5f52\u90e8\u5206\uff0c\u4e0d\u8003\u8651\u7ec8\u6b62\u6761\u4ef6\uff09\uff1a <pre><code>;\u5f62\u5f0fa\n(lambda (f)\n  (lambda (x)     \n    (do-something (f new-x)))    \n;\u5f62\u5f0fb\n(lambda (g)\n  (lambda (x)     \n    (do-something ((g g) new-x))))\n</code></pre> \u5bf9\u4efb\u610f\u51fd\u6570<code>c</code>\u7684<code>(a c)</code>\u6c42\u503c\u4f1a\u5f97\u5230\uff1a <pre><code>(lambda (x)                    \n  (do-something (c new-x)))\n</code></pre> \u6211\u4eec\u628a<code>c</code>\u51d1\u6210\u6ee1\u8db3<code>(c new-x)=((g g) new-x)</code>\u7684\u5f62\u5f0f\uff0c\u5219<code>c</code>\u5fc5\u7136\u53ef\u4ee5\u5199\u4e3a\uff1a <pre><code>(lambda (y)        ;c\u7684\u53c2\u6570\u662f\u4e00\u4e2a\u6570\u503cy\n  ((g g) y))       ;\u9700\u8981\u4e00\u4e2a\u5916\u90e8\u4f20\u5165\u7684\u51fd\u6570g\u4f5c\u4e3a\u53c2\u6570\uff0c\u6682\u65f6\u6211\u4eec\u4e0d\u7ba1\u5b83\n;\u5bf9(c new-x)\u7684\u6c42\u503c\u5373\u4e3a\n((g g) new-x)      ;\u6ee1\u8db3c=(g g)=\u4e00\u4e2a\u5173\u4e8e\u6570\u503cy\u7684\u5355\u53c2\u51fd\u6570\n</code></pre> \u628a<code>c</code>\u4ee3\u5165\u4e0a\u9762\u7684<code>(a c)</code>\u6c42\u503c\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a <pre><code>(lambda (x)                     \n  (do-something ((g g) new-x)))  ;\u51fa\u73b0\u4e86b\u7684\u51fd\u6570\u4f53\u90e8\u5206\n</code></pre> \u5728\u5916\u5c42\u4f20\u5165\u53c2\u6570<code>g</code>\u5373\u53ef\u4ee5\u5f97\u5230<code>b</code>\u7684\u8868\u8fbe\u5f0f\uff1a <pre><code>;\u6ca1\u9519\uff0c\u8fd9\u5c31\u662fb\uff0c\u5f62\u5f0f\u4e3a(lambda (g) (a c))\n(lambda (g)   \n  (lambda (x)                    \n    (do-something ((g g) new-x)))) \n</code></pre> \u56de\u5230\u6211\u4eec\u9700\u8981\u8bbe\u8ba1\u7684<code>(p a)</code>\u6c42\u503c\uff0c\u5b83\u5fc5\u987b\u6ee1\u8db3<code>(p a)=(lambda (g) (a c))</code>\uff1a <pre><code>(lambda (g)\n  (a c))     \n;\u628ac\u7684\u5b8c\u6574\u5f62\u5f0f\u5199\u51fa\u6765\uff0c(p a)\u5e94\u8be5\u662f\u8fd9\u6837=&gt;\n(lambda (g)\n  (a (lambda (y)\n       ((g g) y))))\n</code></pre> \u518d\u628a<code>a</code>\u4f5c\u4e3a\u53c2\u6570<code>f</code>\u4f20\u5165\uff08\u7ee7\u7eed\u5957\u5a03\uff09\uff0c\u5219<code>p</code>\u53ef\u4ee5\u5199\u4e3a\uff1a <pre><code>(lambda (f)\n  (lambda (g)\n    (f (lambda (y) \n         ((g g) y))   \n;\u5b83\u6ee1\u8db3(p a)=(lambda (g) (a c))=b\n</code></pre> \u5bf9\u4efb\u610f\u7684<code>a</code>\u5f62\u5f0f\u533f\u540d\u51fd\u6570\uff0c<code>(p a)</code>\u7684\u6c42\u503c\u8fc7\u7a0b\u5982\u4e0b\uff1a <pre><code>((lambda (f)              ;\n   (lambda (g)            ;\n     (f (lambda (y)       ;\u8fd9\u91cc\u662fp\u51fd\u6570\n          ((g g) y)))))   ;\n a)                       ;\n;=&gt;\n(lambda (g)               ;\n  (a c))                  ;\u6682\u65f6\u628a\u4e0a\u9762f\u540e\u9762\u7684\u51fd\u6570\u5199\u4e3ac\n;=&gt;\n(lambda (g)\n  ((lambda (f)            ;\u5199\u51faa\u7684\u5b8c\u6574\u5f62\u5f0f\n     (lambda (x)                     \n       (if (= x 1)                  \n           1                          \n           (* x (f (- x 1))))))\n   c))\n;=&gt;\n(lambda (g)              \n  (lambda (x)                 \n    (if (= x 1)                  \n        1                \n        (* x (c (- x 1))))))  \n;=&gt; \n(lambda (g)               ;\u5f97\u5230\u4e86b\u7684\u5f62\u5f0f      \n  (lambda (x)                     \n    (if (= x 1)                  \n        1                                     \n        (* x ((g g) (- x 1))))))\n;\u6ca1\u9519\uff0c\u4f60\u5f97\u5230\u4e86(p a)=b\n</code></pre></p>"},{"location":"markdown/lisp_y_combinator/#22-py","title":"2.2 \u7531<code>p</code>\u751f\u6210<code>Y</code>\uff0c\u518d\u6b21\u5957\u5a03","text":"<p>\u7531\u4e8e<code>b=(p a)</code>\uff0c<code>(Y a)=(b b)=((p a) (p a))</code>\uff0c\u5219Y\u53ef\u8868\u8fbe\u4e3a\uff1a <pre><code>(lambda (a)        \n  (b b)))            \n;(b b)\u5199\u4e3a((lambda (f) (f f) b) =&gt;\n(lambda (a)        \n  ((lambda (f) (f f))\n   (p a)))                        ;b\u66ff\u6362\u4e3a(p a)\n;b\u5199\u4e3a(lambda (g) (a c)) =&gt;     \n(lambda (a)        \n  ((lambda (f) (f f))\n   (lambda (g) (a c))))\n;\u5199\u51fac\u7684\u5b8c\u6574\u5f62\u5f0f =&gt;\n(lambda (a)        \n  ((lambda (f) (f f))\n   (lambda (g)\n     (a (lambda (y)\n          ((g g) y))))))\n;\u6ca1\u9519\uff0c\u554a\uff0c\u8fd9\u4e2a\u4eba\u5c31\u662f\u5a18\uff0c\u554a\uff0c\u8fd9\u4e2a\u4eba\u5c31\u662f\u5988\u3002\u54e6\u4e0d\u662f\uff0c\u8fd9\u662fY-combinator          \n</code></pre> \u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u4efb\u4f55\u7c7b\u578b\u7684<code>a</code>\u5f62\u5f0f\u5355\u53c2\u533f\u540d\u51fd\u6570\u8fdb\u884c\u9012\u5f52\u4e86\uff0c\u5176\u8c03\u7528\u65b9\u5f0f\u4e3a<code>((Y a) x)</code>\uff0c\u6211\u4eec\u6765\u8bd5\u4e00\u4e0b\u9636\u4e58\uff0c\u770b\u770b\u5168\u90e8\u5c55\u5f00\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\u3002 \u5047\u8bbe<code>a-fact</code>\u662f\u4e00\u79cd<code>a</code>\u5f62\u5f0f\u7684\u9636\u4e58\u51fd\u6570\uff0c5\u7684\u9636\u4e58\u53ef\u4ee5\u8868\u793a\u4e3a<code>((Y a-fact) 5)</code>\uff0c\u5176\u5b8c\u6574\u5f62\u5f0f\u5982\u4e0b\uff1a <pre><code>((Y a-fact) 5)                          ;\u6765\u5427\uff0c\u6c425\u7684\u9636\u4e58\n;\u5199\u51faY\u7684\u5b8c\u6574\u5f62\u5f0f =&gt;\n(((lambda (a)                           \n    ((lambda (f) (f f))                 ;\u6ca1\u9519\uff0c\u8fd9\u4e48\u4e00\u5927\u9640\u5c31\u662fY\n     (lambda (g)\n       (a (lambda (y)                   ;\n            ((g g) y))))))\n  a-fact)                               ;a-fact\u8981\u4f20\u5165Y\n 5)                                     ;5\u8981\u4f20\u5165(Y a)\n;\u5199\u51fa\u53c2\u6570a-fact\u7684\u5b8c\u6574\u5f62\u5f0f =&gt; \n(((lambda (a)                           ;\n    ((lambda (f) (f f))                 ;\u8fd9\u91cc\u662fY\u7ec4\u5408\u5b50\n     (lambda (g)\n       (a (lambda (y)\n            ((g g) y))))))\n  (lambda (f)                           ;\u8fd9\u91cc\u5c31\u662fa\u5f62\u5f0f\u7684\u9636\u4e58\n    (lambda (x)                         ;    ...\n      (if (= x 1)                       ;    ...\n          1                             ;    ...\n          (* x (f (- x 1)))))))         ;    ...\n 5)\n;\u597d\u4e86\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u4e3a\u5565define\u8bed\u53e5\u8fd9\u4e48\u91cd\u8981\u4e86\u5427\n</code></pre> \u7684\u7684\u786e\u786e\uff0c\u6211\u4eec\u6ca1\u6709\u7528\u4efb\u4f55<code>define</code>\u8bed\u53e5\u5b8c\u6210\u4e86\u4e00\u4e2a\u51e0\u4e4e\u4e0d\u53ef\u80fd\u7684\u4efb\u52a1\u3002\u795e\u8bf4\uff1a\u8981\u6709\u5149\u3002</p>"},{"location":"markdown/lisp_y_combinator/#3","title":"3. \u603b\u7ed3","text":"<p>\u770b\u6765\u5728\u4e00\u4e2a\u6ca1\u6709<code>define</code>\u8bed\u53e5\u7684\u7f16\u7a0b\u4e16\u754c\u91cc\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u7528\u533f\u540d\u51fd\u6570\u65e0\u4e2d\u751f\u6709\u7684\u6784\u9020\u4e86\u4e00\u4e2a\u901a\u7528\u9012\u5f52\u51fd\u6570<code>Y</code>\u3002\u65b9\u6cd5\u5c31\u662f\u5957\u5a03\uff0c\u5982\u679c\u5957\u5a03\u89e3\u51b3\u4e0d\u4e86\uff0c\u90a3\u4e48\u5c31\u518d\u5957\u4e00\u5c42\u5a03\u3002 \u8fd9\u662f\u4e00\u4e2a\u6781\u5176\u70e7\u8111\u7684\u8fc7\u7a0b\uff0c\u6240\u4ee5\u6211\u9886\u609f\u4e86\u8fd9\u53e5\u8bdd\uff1a\u201c\u65e0\u4e2d\u751f\u6709\u7684\u4e1c\u897f\uff0c\u4f60\u628a\u5b83\u8bb2\u4e00\u904d\uff0c\u7b49\u4e8e\u4f60\u4e5f\u6709\u8d23\u4efb\u7684\u201d\u3002 \u7136\u800c\u4f60\u53ef\u80fd\u8981\u95ee\u4e86\uff0c\u8fd9\u4e2aY\u7ec4\u5408\u5b50\u6709\u4ec0\u4e48\u7528\uff1f\u7b54\u6848\u662f\uff1a\u6ca1\u4ec0\u4e48\u7528\u3002 \u4f46\u662f\u6ce8\u610fY\u5728\u5e72\u4ec0\u4e48\uff0c\u5b83\u8f93\u5165\u4e00\u4e2a\u51fd\u6570<code>a</code>\uff0c\u7136\u540e\u751f\u6210\u4e86\u53e6\u5916\u4e00\u4e2a\u51fd\u6570<code>b</code>\uff0c\u5e76\u628a\u5b83\u8fdb\u884c<code>(b b)</code>\u7684\u81ea\u6211\u8c03\u7528\uff0c\u6700\u7ec8\u751f\u6210\u4e86\u9012\u5f52\u51fd\u6570\uff08\u6bd4\u5982<code>factorial</code>\uff09\u3002 \u518d\u770b\u4e00\u4e0b\u8fd9\u4e2a\u795e\u79d8\u7684\u9b54\u6cd5\uff1a<code>(Y a)=(b b)=factorial</code>\uff0c\u6211\u4eec\u4e0d\u7981\u53d1\u95ee\uff1a\u96be\u9053\u975e\u8981\u6709\u4ec0\u4e48\u7528\u624d\u6709\u7528\u5417\uff1f:)...</p>"},{"location":"markdown/optimal_cg_and_nlcg/","title":"\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684CG\u548cPCG\u65b9\u6cd5","text":"<p>\u6211\u4eec\u8ba8\u8bba\u7684\u95ee\u9898\u662f\u6c42\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4{\\boldsymbol A} {\\boldsymbol x} = {\\boldsymbol b}\uff0c\u5176\u4e2d{\\boldsymbol A}\u5bf9\u79f0\u6b63\u5b9a\uff0c\u5f53\u7136\u6b64\u65f6\u89e3\u5411\u91cf{\\boldsymbol x}\u5b58\u5728\u4e14\u552f\u4e00\u3002\u5f53{\\boldsymbol A}\u7684\u89c4\u6a21\u975e\u5e38\u5927\u65f6\uff0c\u5bf9\u5176\u505aLU\u5206\u89e3\u6216Cholesky\u5206\u89e3\u6781\u5176\u8017\u65f6\u4e14\u5185\u5b58\u5360\u7528\u5de8\u5927\uff0c\u8fed\u4ee3\u6cd5\u53ef\u80fd\u662f\u552f\u4e00\u53ef\u9009\u7684\u6c42\u89e3\u65b9\u6848\u3002 \u8fed\u4ee3\u6cd5\u5206\u4e24\u79cd\uff1a\u4e0d\u52a8\u70b9\u5f0f\u7684\u9759\u6001\u8fed\u4ee3\u65b9\u6cd5\u2014\u2014\u5982\u96c5\u53ef\u6bd4\u6cd5\uff08Jacobian\uff09\u3001\u9ad8\u65af-\u8d5b\u5fb7\u5c14\u6cd5\uff08Gauss-Seidel\uff09\uff0c\u4ee5\u53caKrylov\u5b50\u7a7a\u95f4\u7684\u975e\u9759\u6001\u8fed\u4ee3\u65b9\u6cd5\u2014\u2014\u5982\u5171\u8f6d\u68af\u5ea6\u6cd5\uff08conjugate gradient\uff0c\u7b80\u79f0CG\uff09\u3002\u524d\u8005\u4ec5\u5728{\\boldsymbol A}\u7684\u4e3b\u5bf9\u89d2\u4e25\u683c\u5360\u4f18\u65f6\u624d\u4fdd\u8bc1\u6536\u655b\uff0c\u540e\u8005\u7684\u5e94\u7528\u66f4\u4e3a\u5e7f\u6cdb\u4e14\u901a\u5e38\u66f4\u5feb\u3002 \u4ee5\u4e0b\u7b80\u8ff0CG\u7684\u539f\u7406\u3001\u7b97\u6cd5\u5b9e\u73b0\u548c\u9884\u6761\u4ef6\u95ee\u9898\u7684\u89e3\u6cd5\uff08PCG\uff09\u3002\u9700\u8981\u8bf4\u660e\u7684\u662f\uff0cCG\u662f\u6700\u57fa\u7840\u7684\u975e\u9759\u6001\u8fed\u4ee3\u6cd5\uff0c\u672c\u6587\u4ec5\u662f\u4e00\u7bc7\u629b\u7816\u5f15\u7389\u7684\u5165\u95e8\u7ea7\u4ecb\u7ecd\uff0c\u56e0\u6c34\u5e73\u6709\u9650\uff0c\u5982\u6709\u9519\u6f0f\uff0c\u70e6\u8bf7\u6307\u51fa\uff0c\u611f\u6fc0\u4e0d\u5c3d\u3002</p>"},{"location":"markdown/optimal_cg_and_nlcg/#1","title":"1. \u4e8c\u6b21\u578b\u548c\u68af\u5ea6\u6cd5","text":"<p>\u5bf9\u4e8e\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u6c42\u89e3\u95ee\u9898\uff0c\u8003\u8651\u7ecf\u5178\u4e8c\u6b21\u578b\u5982\u4e0b\uff1a  </p>  f(\\boldsymbol x) = \\frac{1}{2} {\\boldsymbol x}^T {\\boldsymbol A} {\\boldsymbol x} - {\\boldsymbol x}^T {\\boldsymbol b}  <p>\u5f53{\\boldsymbol A}\u4e3a\u975e\u5947\u5f02\u9635\u65f6\uff0cf(\\boldsymbol x)\u6709\u552f\u4e00\u7684\u5168\u5c40\u6781\u5c0f\u70b9{\\boldsymbol x}^*\u6ee1\u8db3\u68af\u5ea6\\nabla_{\\boldsymbol x}f({\\boldsymbol x}^*) = 0\u3002\u7279\u522b\u7684\uff0c\u5f53{\\boldsymbol A}\u5bf9\u79f0\u6b63\u5b9a\u65f6\uff0c\u521a\u597d\u6709\uff1a  </p>  \\nabla_{\\boldsymbol x}f({\\boldsymbol x}^*) = {\\boldsymbol A} {\\boldsymbol x}^* - {\\boldsymbol b} = 0  <p>\u5b9a\u4e49\u6b8b\u5dee\u5411\u91cf{\\boldsymbol r}^*={\\boldsymbol b} - {\\boldsymbol A} {\\boldsymbol x}^*\uff0c\u5b83\u6070\u597d\u662f\u51fd\u6570f(\\boldsymbol x)\u5728\u70b9{\\boldsymbol x}^*\u5904\u7684\u8d1f\u68af\u5ea6\u65b9\u5411\u3002\u6b64\u65f6\u8d1f\u68af\u5ea6\u4e3a0\uff0c\u6b8b\u5dee\u4e3a0\uff0c\u4e14\u6ee1\u8db3{\\boldsymbol A} {\\boldsymbol x}^* = {\\boldsymbol b}\u3002 \u8fed\u4ee3\u6cd5\u8bd5\u56fe\u4ece\u70b9{\\boldsymbol x}_0\u51fa\u53d1\uff0c\u7ecfk\u6b21\u8fed\u4ee3\u540e\u627e\u5230{\\boldsymbol r}_k = 0\u7684\u70b9\uff0c\u6b64\u65f6{\\boldsymbol x}_k\u4e3a\u6700\u4f18\u89e3{\\boldsymbol x}^*\u3002\u5176\u901a\u7528\u8fed\u4ee3\u5f0f\u53ef\u5199\u4e3a{\\boldsymbol x}_{k+1} = {\\boldsymbol x}_{k} + \\alpha_k {\\boldsymbol p}_{k}\uff0c\u5176\u4e2d\uff0c{\\boldsymbol p}_{k}\u88ab\u79f0\u4e3a\u4e0b\u964d\u65b9\u5411\uff08descent direction\uff09\uff0c\\alpha_k\u79f0\u4e3a\u8fed\u4ee3\u6b65\u957f\u3002\u524d\u8005\u89c4\u5b9a\u4e86\u4e0b\u4e00\u6b65\u671d\u4f55\u5904\u8d70\uff0c\u540e\u8005\u89c4\u5b9a\u4e86\u8d70\u591a\u8fdc\u3002\u5728\u68af\u5ea6\u6cd5\uff08\u6700\u901f\u4e0b\u964d\u6cd5\uff09\u91cc\uff0c{\\boldsymbol p}_{k} = -\\nabla_{\\boldsymbol x}f({\\boldsymbol x}_k) = {\\boldsymbol r}_{k}\u3002 \u73b0\u5728\u7684\u95ee\u9898\u662f\u5982\u4f55\u786e\u5b9a{\\alpha_k}\u3002\u5982\u679c\u89c6f(\\boldsymbol x_{k+1})\u4e3a\u4e00\u4e2a\u5173\u4e8e{\\alpha_k}\u7684\u4e00\u7ef4\u51fd\u6570\uff0c\u5176\u5bf9\u6b65\u957f\u7684\u504f\u5bfc\u4e3a0\uff08\u5373\\nabla_{\\alpha_k}f({\\boldsymbol x}_{k+1}) = 0\uff09\u662f{\\boldsymbol x}_{k+1}\u53d6\u5728\u51fd\u6570\u6781\u5c0f\u70b9\u4e0a\u7684\u5fc5\u8981\u6761\u4ef6\uff0c\u6b64\u65f6{\\alpha_k}\u5373\u4e3a\u5f53\u524d\u4e0b\u964d\u65b9\u5411{\\boldsymbol p}_k\u7684\u6700\u4f73\u6b65\u957f\uff08\u4e00\u7ef4\u7cbe\u786e\u7ebf\u641c\u7d22\u6b65\u957f\uff09\u5982\u4e0b\u5f0f\uff1a  </p>  \\begin{align}   \\nabla_{\\alpha_k} f({\\boldsymbol x}_{k+1})       &amp;= [\\nabla_{ {\\boldsymbol x}_{k+1} } f({\\boldsymbol x}_{k+1})]^T \\nabla_{\\alpha_k} {\\boldsymbol x}_{k+1} \\\\         &amp;= - {\\boldsymbol r}_{k+1}^T {\\boldsymbol p}_{k} = 0\\\\         \\end{align}   <p>\u7ee7\u7eed\u5c55\u5f00\u5f97\u5230\uff1a  </p>  \\begin{align}   {\\boldsymbol r}_{k+1}^T {\\boldsymbol p}_{k}       &amp;= [{\\boldsymbol b} - {\\boldsymbol A}({\\boldsymbol x}_{k} + {\\alpha}_{k} {\\boldsymbol p}_{k})  ]^T {\\boldsymbol p}_{k} \\\\         &amp;= ({\\boldsymbol b} - {\\boldsymbol A}{\\boldsymbol x}_{k})^T {\\boldsymbol p}_{k} - {\\alpha}_{k} ({\\boldsymbol A} {\\boldsymbol p}_{k})^T {\\boldsymbol p}_{k} \\\\               &amp;= {\\boldsymbol r}_{k}^T {\\boldsymbol p}_{k} - {\\alpha}_{k} {\\boldsymbol p}_{k}^T {\\boldsymbol A} {\\boldsymbol p}_{k} = 0 \\end{align}   <p>\u5f88\u660e\u663e\uff0c\u6b65\u957f\u5e94\u8be5\u53d6\uff1a  </p>  {\\alpha}_{k} = \\frac {{\\boldsymbol r}_{k}^T {\\boldsymbol p}_{k}} {{\\boldsymbol p}_{k}^T {\\boldsymbol A} {\\boldsymbol p}_{k}}  <p>\u5bf9\u4e8e\u68af\u5ea6\u6cd5\uff0c\u56e0\u4e3a{\\boldsymbol p}_{k} = {\\boldsymbol r}_{k}\uff0c\u6240\u4ee5\u6b65\u957f\u53ef\u5199\u4e3a\uff1a  </p>  {\\alpha}_{k} = \\frac {{\\boldsymbol r}_{k}^T {\\boldsymbol r}_{k}} {{\\boldsymbol r}_{k}^T {\\boldsymbol A} {\\boldsymbol r}_{k}}  <p>\u6839\u636e\u4ee5\u4e0a\u63a8\u5bfc\uff0c\u53ef\u7ed9\u51fa \u7b97\u6cd51\uff08Steepest Descent\uff09 \uff1a (1) \u9009\u5b9a{\\boldsymbol x}_0\uff0c {\\boldsymbol r}_0 = {\\boldsymbol b} - {\\boldsymbol A} {\\boldsymbol x}_0\uff0ck := 0 (2) while ||{\\boldsymbol r}_k|| / ||{\\boldsymbol r}_0|| \u4e0d\u591f\u5c0f\uff1a (3) \u2003\u2003k := k+1\uff0c\u6682\u5b58\u5411\u91cf{\\boldsymbol q} = {\\boldsymbol A} {\\boldsymbol r}_{k-1} (4) \u2003\u2003{\\alpha}_{k} = ({\\boldsymbol r}_{k-1}^T {\\boldsymbol r}_{k-1}) / ({\\boldsymbol r}_{k-1}^T {\\boldsymbol A} {\\boldsymbol r}_{k-1}) = ({\\boldsymbol r}_{k-1}^T {\\boldsymbol r}_{k-1}) / ({\\boldsymbol r}_{k-1}^T {\\boldsymbol q})  (5) \u2003\u2003{\\boldsymbol x}_{k} = {\\boldsymbol x}_{k-1} + {\\alpha}_{k} {\\boldsymbol r}_{k-1} (6) \u2003\u2003{\\boldsymbol r}_{k} = {\\boldsymbol b} - {\\boldsymbol A} {\\boldsymbol x}_{k} = {\\boldsymbol r}_{k-1} - {\\alpha}_{k} {\\boldsymbol q}\uff08\u6ce8\uff1a\u907f\u514d\u91cd\u590d\u8ba1\u7b97\uff09 (7) end while (8) \u8f93\u51fa{\\boldsymbol x}_{k} </p> <p>\u7b97\u6cd51\u7684\u6536\u655b\u901f\u5ea6\u548c\u77e9\u9635{\\boldsymbol A}\u7684\u6761\u4ef6\u6570\u6709\u5173\u3002\u82e5\u6761\u4ef6\u6570\u5b9a\u4e49\u4e3a\u6700\u5927\u548c\u6700\u5c0f\u7684\u7279\u5f81\u503c\u4e4b\u6bd4\\kappa = \\lambda_{max} / \\lambda_{min}\uff0c \u7cbe\u786e\u89e3\u4e3a{\\boldsymbol x}^*\uff0c\u5219\u6700\u5dee\u60c5\u51b5\u4e0b\u5176\u6536\u655b\u901f\u7387\u53ef\u7528\u4e0b\u5f0f\u5ea6\u91cf\uff1a  </p>  \\frac{f({\\boldsymbol x}_k) - f({\\boldsymbol x}^*)}{f({\\boldsymbol x}_0) - f({\\boldsymbol x}^*)} \\leq  \\left( \\frac{\\kappa - 1}{\\kappa + 1} \\right)^{2k}  <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6761\u4ef6\u6570\u8d8a\u5927\u65f6\uff0c\u6b8b\u5dee\u51cf\u5c0f\u8d8a\u6162\u3002\u5176\u539f\u56e0\u7528\u51e0\u4f55\u65b9\u5f0f\u6700\u597d\u7406\u89e3\uff08\u89c1\u56fe1\uff09\uff0c\u6700\u7b80\u5355\u7684\u60c5\u51b5\u662f\u5411\u91cf{\\boldsymbol x}\u53ea\u6709\u4e24\u884c\u3002\u5f53\u6761\u4ef6\u6570\u5f88\u5c0f\u65f6\uff08\u63a5\u8fd11\uff09\uff0cf({\\boldsymbol x})\u7684\u7b49\u503c\u7ebf\u63a5\u8fd1\u6b63\u5706\u3002\u6b64\u65f6\u65e0\u8bba\u8fed\u4ee3\u4ece\u4f55\u5904\u5f00\u59cb\uff0c\u7531\u4e8e\u8d1f\u68af\u5ea6\u65b9\u5411{\\boldsymbol r}_k\u603b\u662f\u8fd1\u4f3c\u6307\u5411\u6781\u5c0f\u70b9\uff0c\u4f7f\u5f97\u6536\u655b\u901f\u5ea6\u6781\u5feb\u3002\u4f46\u5f53\u6761\u4ef6\u6570\u5f88\u5927\u65f6\uff0c\u7b49\u503c\u7ebf\u53d8\u6210\u4e86\u72ed\u7a84\u7684\u692d\u5706\uff0c\u8d1f\u68af\u5ea6\u65b9\u5411\u5e76\u975e\u603b\u662f\u6307\u5411\u6781\u5c0f\u70b9\uff0c\u8f83\u5dee\u7684\u521d\u59cb\u8fed\u4ee3\u70b9\u4f1a\u8ba9\u6536\u655b\u8fc7\u7a0b\u53cd\u590d\u9707\u8361\u3002</p>          \u56fe1 \u95ee\u9898\u7ef4\u5ea6\u4e3a2\u7684\u7b80\u5355\u60c5\u51b5\uff0c\u5927\u6761\u4ef6\u6570\u53ef\u80fd\u4f1a\u5bfc\u81f4\u975e\u5e38\u6162\u7684\u6536\u655b"},{"location":"markdown/optimal_cg_and_nlcg/#2","title":"2. \u5171\u8f6d\u68af\u5ea6\u6cd5","text":""},{"location":"markdown/optimal_cg_and_nlcg/#21","title":"2.1 \u7b80\u5355\u7684\u4e8c\u7ef4\u60c5\u51b5","text":"\u56fe2 \u95ee\u9898\u7ef4\u5ea6\u4e3a2\u65f6\u6784\u5efa2\u6b65\u6536\u655b\u7684\u4e0b\u964d\u65b9\u5411  <p>\u5982\u56fe2\u6240\u793a\uff0c\u4e3a\u4e86\u6539\u5584\u68af\u5ea6\u6cd5\u7684\u9707\u8361\u95ee\u9898\uff0c\u4e0d\u59a8\u8003\u8651\u7ecf\u8fc7\u4e00\u6b21\u68af\u5ea6\u6cd5\u8fed\u4ee3{\\boldsymbol x}_1={\\boldsymbol x}_0 + \\alpha_0 {\\boldsymbol r}_0\u540e\u7684\u60c5\u5f62\u3002\u5982\u679c\u6211\u4eec\u60f3\u5bf9{\\forall} {\\boldsymbol x}_1\u4e00\u6b65\u5230\u4f4d\u6536\u655b\u5230\u6700\u4f18\u89e3{\\boldsymbol x}^*\uff0c\u5219\u5fc5\u7136\u6ee1\u8db3\uff1a  </p>  \\begin{align}   {\\boldsymbol x}^* - {\\boldsymbol x}_1       &amp;= {\\boldsymbol A}^{-1} {\\boldsymbol b} - {\\boldsymbol A}^{-1} {\\boldsymbol A} {\\boldsymbol x}_1 \\\\         &amp;= {\\boldsymbol A}^{-1} ({\\boldsymbol b} - {\\boldsymbol A} {\\boldsymbol x}_1) = {\\boldsymbol A}^{-1}{\\boldsymbol r}_1\\\\         \\end{align}   <p>\u5f15\u5165\u5411\u91cf{\\boldsymbol s}_1 = {\\boldsymbol x}^* - {\\boldsymbol x}_1\uff08\u56fe2\u53f3\u7ea2\u8272\u7bad\u5934\u6240\u793a\uff09\u3002\u4e0d\u96be\u770b\u51fa\uff0c\u7531\u4e8e\u8d1f\u68af\u5ea6\u65b9\u5411\u662f{\\boldsymbol r}_1\uff0c\u6d77\u585e\u77e9\u9635\u662f{\\boldsymbol A}\uff0c\u5411\u91cf{\\boldsymbol s}_1\u5176\u5b9e\u5c31\u662f\u725b\u987f\u6cd5\u7684\u4e0b\u964d\u65b9\u5411\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u8bba\u4e0a\u4e00\u6b21\u5982\u4f55\u8fed\u4ee3\u5230\u5f53\u524d\u70b9\uff0c\u6211\u4eec\u5e0c\u671b\u6784\u5efa\u4e00\u4e2a\u4e0e\u725b\u987f\u65b9\u5411{\\boldsymbol s}_1\u5e73\u884c\u7684\u4e0b\u964d\u65b9\u5411\uff0c\u4f7f\u5176\u80fd\u4e00\u6b65\u6536\u655b\u5230{\\boldsymbol x}^*\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a\u5bf9\u4e8e\u7ebf\u6027\u4e8c\u6b21\u578b\u76ee\u6807\u51fd\u6570\uff0c\u725b\u987f\u6cd5\u662f\u4e00\u6b65\u6536\u655b\u7684\u3002 </p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e0d\u60f3\u5bf9{\\boldsymbol A}\u6c42\u9006\uff0c\u5426\u5219\u8fd8\u6298\u817e\u4ec0\u4e48\u8fed\u4ee3\u6cd5\uff1f\u6240\u4ee5\u9996\u5148\u8981\u8003\u8651\u548c{\\boldsymbol s}_1\u5e73\u884c\u7684\u4e0b\u964d\u65b9\u5411{\\boldsymbol p}_1\u6709\u4ec0\u4e48\u6837\u7684\u6027\u8d28(\u8fd9\u91cc{\\boldsymbol s}_1 = \\alpha_1 {\\boldsymbol p}_1)\u3002\u8003\u8651\u4e0a\u4e00\u6b21\u8fed\u4ee3\u7684\u4fee\u6b63\u91cf{\\boldsymbol s}_0={\\boldsymbol x}_1 - {\\boldsymbol x}_0\uff0c\u505a\u4ee5\u4e0b\u53d8\u6362\uff1a  </p>  \\begin{align}   {\\boldsymbol s}_0^T {\\boldsymbol A} {\\boldsymbol s}_1       &amp;= \\alpha_0 {\\boldsymbol p}_0^T {\\boldsymbol A} {\\boldsymbol s}_1 =  \\alpha_0 {\\boldsymbol p}_0^T {\\boldsymbol A} {\\boldsymbol A}^{-1} {\\boldsymbol r}_1\\\\         &amp;= \\alpha_0 {\\boldsymbol p}_0^T {\\boldsymbol r}_1\\\\         \\end{align}   <p>\u6839\u636e\u4e4b\u524d\u6700\u901f\u4e0b\u964d\u6cd5\u4ecb\u7ecd\u7684\u6b65\u957f\u62e9\u4f18\u6761\u4ef6({\\boldsymbol r}_{k+1}^T {\\boldsymbol p}_k = 0)\uff0c\u4e0a\u5f0f\u5e94\u4e3a0\uff0c\u5373{\\boldsymbol s}_0^T {\\boldsymbol A} {\\boldsymbol s}_1 = 0\u3002\u7531\u4e8e\u6b65\u957f\u662f\u6807\u91cf\uff0c\u8fdb\u4e00\u6b65\u7b80\u5316\u53ef\u4ee5\u5f97\u5230{\\boldsymbol p}_0^T {\\boldsymbol A} {\\boldsymbol p}_1 = 0\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u56fe2\u7684\u7b80\u5355\u95ee\u9898\uff0c\u5e73\u884c\u4e8e\u725b\u987f\u65b9\u5411{\\boldsymbol s}_1\u7684\u4e0b\u964d\u65b9\u5411{\\boldsymbol p}_1\u5fc5\u7136\u548c\u4e0a\u4e00\u6b65\u7684\u4e0b\u964d\u65b9\u5411{\\boldsymbol p}_0\u5173\u4e8e\u77e9\u9635{\\boldsymbol A}\u5171\u8f6d\u3002 \u6ee1\u8db3\u5171\u8f6d\u6761\u4ef6\u7684{\\boldsymbol p}_1\u6709\u65e0\u6570\u4e2a\uff0c\u53ea\u9700\u53d6\u4e00\u4e2a\u5373\u53ef\u3002\u5f53\u524d\u6211\u4eec\u5df2\u77e5{\\boldsymbol p}_0\u548c{\\boldsymbol r}_1\uff0c\u5176\u4e2d{\\boldsymbol r}_1\u4e3a\u6700\u901f\u4e0b\u964d\u65b9\u5411\uff0c\u6cbf{\\boldsymbol p}_0\u7684\u6781\u5c0f\u5df2\u5728\u4e0a\u6b21\u8fed\u4ee3\u5b8c\u6210\uff0c\u4e0d\u59a8\u53d6\u65b0\u65b9\u5411\u4e3a{\\boldsymbol p}_0\u548c{\\boldsymbol r}_1\u7684\u7ebf\u6027\u7ec4\u5408{\\boldsymbol p}_1 = {\\boldsymbol r}_1 + \\beta_1 {\\boldsymbol p}_0\uff0c\u4ee3\u5165\u5171\u8f6d\u6761\u4ef6\u540e\u5f97\uff1a  </p>    {\\boldsymbol p}_0 ^T {\\boldsymbol A} {\\boldsymbol p}_1       = {\\boldsymbol p}_0 ^T {\\boldsymbol A} {\\boldsymbol r}_1 + \\beta_1 {\\boldsymbol p}_0 ^T {\\boldsymbol A} {\\boldsymbol p}_0 = 0    <p>\u6545\uff0c\\beta_1\u6ee1\u8db3\uff1a  </p>  \\beta_1 = - \\frac {{\\boldsymbol r}_1 ^T {\\boldsymbol A} {\\boldsymbol p}_0} {{\\boldsymbol p}_0 ^T {\\boldsymbol A} {\\boldsymbol p}_0}  <p>\u4e0a\u5f0f\u662f\u5229\u7528{\\boldsymbol r}_1\uff08\u8d1f\u68af\u5ea6\uff09\u3001{\\boldsymbol p}_0\u548c\u5171\u8f6d\u6027{\\boldsymbol p}_0 ^T {\\boldsymbol A} {\\boldsymbol p}_1=0\u6784\u5efa\u7684\uff0c\u56e0\u6b64\u8fd9\u6837\u7684\u8fed\u4ee3\u6cd5\u4e5f\u88ab\u79f0\u4e3a\u5171\u8f6d\u68af\u5ea6\u6cd5\uff08CG\uff09\uff0c\u5b83\u5bf9\u4e8e\u4e8c\u7ef4\u95ee\u9898\uff0c\u6700\u591a\u4e24\u6b21\u8fed\u4ee3\u5373\u53ef\u6536\u655b\u3002</p>"},{"location":"markdown/optimal_cg_and_nlcg/#22","title":"2.2 \u63a8\u5e7f\u5230\u9ad8\u7ef4","text":"<p>\u5f53\u63a8\u5e7f\u5230n\u7ef4\u95ee\u9898\u4e4b\u540e\uff0c\u5171\u8f6d\u68af\u5ea6\u6cd5\u4e0d\u518d\u5177\u6709\u6700\u591a\u4e24\u6b21\u8fed\u4ee3\u6536\u655b\u7684\u6027\u8d28\uff08\u5b9e\u9645\u4e0a\u662fn\u6b21\u6536\u655b\uff09\uff0c\u6b64\u65f6\u7b2ck\u6b21\u8fed\u4ee3\u7684\u4e0b\u964d\u65b9\u5411{\\boldsymbol p}_k\u53ef\u7528\u4e4b\u524d\u7684\u6240\u6709\u4e0b\u964d\u65b9\u5411\u6784\u5efa\uff1a  </p>  {\\boldsymbol p}_k = {\\boldsymbol r}_k + \\sum_{i=0}^{k-1}{\\beta_{ki} {\\boldsymbol p}_i }  <p>\u4e14\u4efb\u610f\u4e24\u4e2a\u4e0d\u540c\u4e0b\u964d\u65b9\u5411{\\boldsymbol p}_i\u548c{\\boldsymbol p}_j\u4e4b\u95f4\u4e92\u76f8\u5173\u4e8e{\\boldsymbol A}\u5171\u8f6d\uff0c\u5373{\\boldsymbol p}_i^T {\\boldsymbol A} {\\boldsymbol p}_j = 0\uff1a  </p>  \\begin{align}   {\\boldsymbol p}_i^T {\\boldsymbol A} {\\boldsymbol p}_j       &amp;= {\\boldsymbol r}_i^T {\\boldsymbol A} {\\boldsymbol p}_j + \\sum_{i=0}^{k-1}{\\beta_{ki} {\\boldsymbol p}_i {\\boldsymbol A} {\\boldsymbol p}_j} \\\\         &amp;= {\\boldsymbol r}_i^T {\\boldsymbol A} {\\boldsymbol p}_j + \\beta_{ij} {\\boldsymbol p}_j^T {\\boldsymbol A} {\\boldsymbol p}_j = 0\\\\         \\end{align}   <p>\u4e0a\u5f0f\u6d88\u9664\u6c42\u548c\u7b26\u53f7\u662f\u5229\u7528\u4e86i \\neq j\u65f6\u7684\u5171\u8f6d\u6027\uff0c \u4ece\u800c\u53ef\u89e3\u51fa\u9ad8\u7ef4\u60c5\u51b5\u4e0b\u4e00\u822c\u5f62\u5f0f\u7684\\beta\u8868\u8fbe\u5f0f\uff1a  </p>    \\beta_{ij} = - \\frac {{\\boldsymbol r}_i^T {\\boldsymbol A} {\\boldsymbol p}_j} {{\\boldsymbol p}_j^T {\\boldsymbol A} {\\boldsymbol p}_j}  <p>\u5728\u5f15\u51fa\u7b97\u6cd5\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u907f\u514d\u5bf9\u4e4b\u524d\u6240\u6709\u8fed\u4ee3\u7684\u4e0b\u964d\u65b9\u5411\u6c42\u548c\uff0c\u4ee5\u51cf\u5c0f\u8ba1\u7b97\u5f00\u9500\u3002\u9996\u5148\u6839\u636e\u5171\u8f6d\u6027\u5f97\u5230\u4e09\u4e2a\u63a8\u8bba\uff1a  </p> <p>[\u63a8\u8bba1] \uff1a \u8003\u8651\\forall j &gt; i\uff0c\u8ba1\u7b97{\\boldsymbol p}_i^T {\\boldsymbol r}_j\uff0c\u5229\u7528\u5171\u8f6d\u6027\u53ef\u5f97\u5230\uff1a  </p>    {\\boldsymbol p}_i^T {\\boldsymbol r}_j = {\\boldsymbol p}_i^T {\\boldsymbol A}({\\boldsymbol x}^* - {\\boldsymbol x}_j)    = -  {\\boldsymbol p}_i^T {\\boldsymbol A} \\sum_{k=0}^{n-1}{\\alpha_{k} {\\boldsymbol p}_k }    =-   \\sum_{k=j}^{n-1}{\\alpha_{k} {\\boldsymbol p}_i^T {\\boldsymbol A} {\\boldsymbol p}_k }  <p>\u5176\u4e2d\uff0cn\u4e3a\u6700\u7ec8\u6536\u655b\u5230\u6700\u4f18\u70b9{\\boldsymbol p}^*\u7684\u8fed\u4ee3\u6b21\u6570\uff0c\u7531\u4e8e\u5171\u8f6d\u6027\uff0c\u6c42\u548c\u9879\u4e3a0\u3002\u5373\u5bf9\\forall j &gt; i\u90fd\u5b58\u5728{\\boldsymbol p}_i^T {\\boldsymbol r}_j = 0\u3002 \u8fd9\u8868\u660e\u5f53\u524d\u8fed\u4ee3\u6b8b\u5dee\u5411\u91cf\u4e0e\u4e4b\u524d\u8fed\u4ee3\u7684\u6240\u6709\u4e0b\u964d\u65b9\u5411\u6b63\u4ea4\u3002  </p> <p>[\u63a8\u8bba2] \uff1a \u53d6\\forall j &gt; i\uff0c\u6c42{\\boldsymbol p}_i\u548c{\\boldsymbol r}_j\u7684\u5185\u79ef\uff0c\u5f97\uff1a </p>    {\\boldsymbol p}_i^T {\\boldsymbol r}_j = {\\boldsymbol r}_i^T {\\boldsymbol r}_j + \\sum_{k=0}^{i-1}{\\beta_{ik} {\\boldsymbol p}_k^T  {\\boldsymbol r}_j}  <p>\u5229\u7528\u63a8\u8bba1\u53ef\u77e5\uff0c\u4e0a\u5f0f\u4e2d\u6240\u6709{\\boldsymbol p}_i^T {\\boldsymbol r}_j\u548c{\\boldsymbol p}_k^T {\\boldsymbol r}_j\u5747\u4e3a0\uff0c\u4ece\u800c{\\boldsymbol r}_i^T {\\boldsymbol r}_j = 0\u3002\u4e5f\u5c31\u662f\u8bf4CG\u7684\u5f53\u524d\u8fed\u4ee3\u6b8b\u5dee\u5411\u91cf\u4e0e\u4e4b\u524d\u6240\u6709\u8fed\u4ee3\u7684\u6b8b\u5dee\u5411\u91cf\u90fd\u6b63\u4ea4\u3002  </p> <p>[\u63a8\u8bba3] \uff1a \u8003\u8651\u7cbe\u786e\u7ebf\u641c\u7d22\u6b65\u957f\u901a\u5f0f\\alpha_k =  {\\boldsymbol p}_i^T {\\boldsymbol r}_i / ({\\boldsymbol p}_i^T {\\boldsymbol A} {\\boldsymbol p}_i^T)\u7684\u5206\u5b50\u90e8\u5206\uff1a  </p>    {\\boldsymbol p}_i^T {\\boldsymbol r}_i = {\\boldsymbol r}_i^T {\\boldsymbol r}_i + \\sum_{k=0}^{i-1}{\\beta_{ik} {\\boldsymbol p}_k^T  {\\boldsymbol r}_i}  <p>\u7531\u63a8\u8bba1\u53ef\u77e5\u4e0a\u5f0f\u6c42\u548c\u9879\u4e3a0\uff0c \u6545CG\u6bcf\u6b21\u8fed\u4ee3\u7684\u6b65\u957f\u4e5f\u53ef\u5199\u4e3a\\alpha_k =  {\\boldsymbol r}_i^T {\\boldsymbol r}_i / ({\\boldsymbol p}_i^T {\\boldsymbol A} {\\boldsymbol p}_i^T)\u3002</p> <p>\u6709\u4e86\u4ee5\u4e0a\u4e09\u4e2a\u63a8\u8bba\uff0cCG\u8fed\u4ee3\u5f0f\u5373\u53ef\u9010\u6b65\u7b80\u5316\uff0c\u9996\u5148\u8003\u8651\u4ee5\u4e0b\u5173\u7cfb\uff1a  </p>    {\\boldsymbol r}_i^T {\\boldsymbol r}_{j+1} = {\\boldsymbol r}_i^T ({\\boldsymbol r}_j - \\alpha_j {\\boldsymbol A} {\\boldsymbol p}_j)   = {\\boldsymbol r}_i^T {\\boldsymbol r}_j - \\alpha_j {\\boldsymbol r}_i^T {\\boldsymbol A} {\\boldsymbol p}_j  <p>\u5373</p>    \\alpha_j {\\boldsymbol r}_i^T {\\boldsymbol A} {\\boldsymbol p}_j = {\\boldsymbol r}_i^T {\\boldsymbol r}_{j} - {\\boldsymbol r}_i^T {\\boldsymbol r}_{j+1}  <p>\u5229\u7528\u63a8\u8bba1\u548c\u63a8\u8bba2\uff0c\u5f97\u5230\uff1a  </p>  {\\boldsymbol r}_i^T {\\boldsymbol A} {\\boldsymbol p}_j =  \\left\\{     \\begin{array}{**lr**}         {\\boldsymbol r}_i^T {\\boldsymbol r}_i/{\\alpha_i},  \\quad if \\quad i=j, {\\boldsymbol r}_i^T {\\boldsymbol r}_{j+1} = 0  &amp;\\\\         - {\\boldsymbol r}_i^T {\\boldsymbol r}_i/{\\alpha_{i-1}},  \\quad if \\quad i=j+1, {\\boldsymbol r}_i^T {\\boldsymbol r}_{j} = 0  &amp;\\\\                 0, \\quad otherwise     \\end{array} \\right.  <p>\u5229\u7528\u4e0a\u9762\u7684\u6027\u8d28\u53ef\u7b80\u5316\\beta_{ij}\u5982\u4e0b\uff1a  </p>  \\beta_{ij} = - \\frac {{\\boldsymbol r}_i^T {\\boldsymbol A} {\\boldsymbol p}_j} {{\\boldsymbol p}_j^T {\\boldsymbol A} {\\boldsymbol p}_j}            =  \\left\\{     \\begin{array}{**lr**}         \\frac{1}{\\alpha_{i-1}}  \\frac{{\\boldsymbol r}_i^T {\\boldsymbol r}_i}{{\\boldsymbol p}_j^T {\\boldsymbol A} {\\boldsymbol p}_j}          = \\frac{{\\boldsymbol r}_i^T {\\boldsymbol r}_i}{{\\boldsymbol p}_{i-1}^T {\\boldsymbol r}_{i-1}} , \\quad if \\quad j=i-1 &amp;\\\\         0, \\quad if \\quad j &lt; i-1     \\end{array} \\right.  <p>\u53ea\u8003\u8651j = i-1\u7684\u60c5\u51b5\uff0c\u5229\u7528\u63a8\u8bba2\u53ef\u5f97\u5230{\\boldsymbol p}_{i-1}^T {\\boldsymbol r}_{i-1} = {\\boldsymbol r}_{i-1}^T {\\boldsymbol r}_{i-1}\uff0c\u6b64\u65f6\\beta_{ij}\u53ef\u8fdb\u4e00\u6b65\u7b80\u5316\u4e3a\uff1a  </p>  \\beta_{ij} = \\frac{{\\boldsymbol r}_i^T {\\boldsymbol r}_i} {{\\boldsymbol r}_{i-1}^T {\\boldsymbol r}_{i-1}}  <p>\u6b64\u65f6CG\u7684\u4e0b\u964d\u65b9\u5411\u53ef\u7b80\u5316\u4e3a\uff1a  </p>  \\begin{align}   {\\boldsymbol p}_k       &amp;= {\\boldsymbol r}_k + \\sum_{i=0}^{k-1}{\\beta_{ki} {\\boldsymbol p}_i }\\\\         &amp;= {\\boldsymbol r}_k + {\\beta_{k,k-1} {\\boldsymbol p}_{k-1} } + \\sum_{i=0}^{k-2}{\\beta_{ki} {\\boldsymbol p}_i }\\\\         &amp;= {\\boldsymbol r}_k + {\\beta_{k,k-1} {\\boldsymbol p}_{k-1} }\\\\         \\end{align}   <p>\u4e0d\u59a8\u4ee4\\beta_k = \\beta_{k,k-1}\uff0cCG\u4e0b\u964d\u65b9\u5411\u4e3a{\\boldsymbol p}_k = {\\boldsymbol r}_k + {\\beta_k {\\boldsymbol p}_{k-1} }\u3002\u5316\u7b80\u540e\u7684\u7248\u672c\u65e0\u9700\u4fdd\u5b58\u6240\u6709\u4e4b\u524d\u7684\u8fed\u4ee3\u4e0b\u964d\u65b9\u5411\uff0c\u6781\u5927\u51cf\u5c0f\u4e86\u7b97\u6cd5\u6d88\u8017\u3002  </p> <p>\u6839\u636e\u4ee5\u4e0a\uff0c\u53ef\u4ee5\u7ed9\u51fa \u7b97\u6cd52\uff08CG\uff09 \uff1a (1) \u9009\u5b9a{\\boldsymbol x}_0\uff0c {\\boldsymbol r}_0 = {\\boldsymbol b} - {\\boldsymbol A} {\\boldsymbol x}_0\uff0ck := 0\uff0c {\\boldsymbol p} := {\\boldsymbol r}_0, {\\boldsymbol r} := {\\boldsymbol r}_0\uff0c{\\boldsymbol x} := {\\boldsymbol x}_0  (2) \\gamma := {\\boldsymbol r}^T{\\boldsymbol r}\uff0c \\gamma_0 := \\gamma (3) while \\sqrt{(\\gamma / \\gamma_0)} \u4e0d\u591f\u5c0f\uff1a (4) \u2003\u2003k := k+1 (5) \u2003\u2003{\\boldsymbol q} := {\\boldsymbol A} {\\boldsymbol r}_{k-1} = {\\boldsymbol A} {\\boldsymbol p} (6) \u2003\u2003\\alpha := \\alpha_k = {\\boldsymbol r}^T {\\boldsymbol r}  / ({\\boldsymbol p}^T {\\boldsymbol q}) (7) \u2003\u2003{\\boldsymbol x} := {\\boldsymbol x} + \\alpha {\\boldsymbol p} (8) \u2003\u2003{\\boldsymbol r} := {\\boldsymbol r} - \\alpha {\\boldsymbol q} (9) \u2003\u2003\\gamma_1 := \\gamma\uff0c \\gamma := {\\boldsymbol r}^T{\\boldsymbol r}\uff0c \\beta := \\gamma / \\gamma_1 (10) \u2003\u2003{\\boldsymbol p} := {\\boldsymbol r} + \\beta {\\boldsymbol p} (11) end while (12) \u8f93\u51fa{\\boldsymbol x} = {\\boldsymbol x}_{k} </p> <p>\u5c0f\u8d34\u58eb\uff1a \u4e8c\u7ef4\u95ee\u9898CG\u6700\u591a\u4e24\u6b21\u8fed\u4ee3\u5373\u53ef\u6536\u655b\u3002\u5bf9\u4e8en\u7ef4\u95ee\u9898\uff0cCG\u6700\u591a\u9700\u8981n\u6b21\u8fed\u4ee3\u5373\u53ef\u6536\u655b\uff0c\u8fd9\u79cd\u6027\u8d28\u53eb\u505aCG\u7684\u4e8c\u6b21\u622a\u6b62\u6027\u3002\u53ef\u4ee5\u4e0d\u4e25\u8c28\u7684\u60f3\u8c61\u4e3a\uff1a\u6700\u5dee\u7684\u60c5\u51b5\u662f\u6bcf\u6b21\u627e\u5230n\u7ef4\u7a7a\u95f4\u7684\u4e00\u4e2a2\u7ef4\u5b50\u7a7a\u95f4\u5185\u7684\u6781\u5c0f\u70b9\u6295\u5f71\u3002 </p>"},{"location":"markdown/optimal_cg_and_nlcg/#3","title":"3. \u9884\u6761\u4ef6\u5171\u8f6d\u68af\u5ea6\u6cd5","text":"<p>\u5f53\u95ee\u9898\u7684\u7ef4\u5ea6n\u975e\u5e38\u5927\u65f6\uff0c\u4e8c\u6b21\u622a\u6b62\u6027\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u7b97\u6cd5\u5728\u53ef\u63a5\u53d7\u7684\u65f6\u95f4\u5185\u6536\u655b\u3002\u82e5\u77e9\u9635{\\boldsymbol A}\u7684\u6761\u4ef6\u6570\u975e\u5e38\u5927\uff0c\u6c42\u89e3\u4e00\u4e2a\u8f6c\u6362\u7684\u5c0f\u6761\u4ef6\u6570\u95ee\u9898\u4f1a\u4f7f\u7b97\u6cd5\u63d0\u901f\u3002\u5f15\u5165\u77e9\u9635{\\boldsymbol M}\uff0c\u5982\u679c{\\boldsymbol M}^{-1}{\\boldsymbol A}\u7684\u6761\u4ef6\u6570\u5f88\u5c0f\uff08\u6bd4\u5982\u63a5\u8fd1\u4e8e1\uff09\uff0c\u90a3\u4e48\u4ee5\u4e0b\u95ee\u9898\u7684\u6c42\u89e3\u4f1a\u975e\u5e38\u5feb\uff1a  </p>  {\\boldsymbol M}^{-1}{\\boldsymbol A}{\\boldsymbol x} = {\\boldsymbol M}^{-1}{\\boldsymbol b}  <p>\u5f88\u660e\u663e{\\boldsymbol M}  \\approx  {\\boldsymbol A}\u662f\u8f83\u597d\u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u65b0\u77e9\u9635{\\boldsymbol M}^{-1}{\\boldsymbol A}\u7684\u6761\u4ef6\u6570\u63a5\u8fd1\u4e8e1\uff08\u5bf9\u5e94\u56fe1\u5de6\u8fb9\u7684\u6b63\u5706\uff09\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u9884\u6761\u4ef6\uff08preconditioning\uff09\uff0c\u77e9\u9635{\\boldsymbol M}\u4e5f\u88ab\u79f0\u4e3a\u9884\u6761\u4ef6\u9635\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a \u51e0\u4f55\u4e0a\u7684\u89e3\u91ca\u662f\u628a\u539f\u95ee\u9898\u7684\u692d\u5706\u578b\u7b49\u503c\u7ebf\u53d8\u6362\u5230\u5c3d\u91cf\u6b63\u5706\u7684\u65b0\u95ee\u9898\u4e2d\u6c42\u89e3\uff0c\u6545\u6b64\u8fc7\u7a0b\u4e5f\u88ab\u79f0\u4e3a\u5706\u5316\uff08rounding\uff09\u3002\u5f53\u7136\uff0c\u9ad8\u7ef4\u60c5\u51b5\u662f\u4e2a\u5e7f\u4e49\u692d\u7403\u3002 </p> <p>\u4f46\u65b0\u77e9\u9635{\\boldsymbol M}^{-1}{\\boldsymbol A}\u5e76\u4e0d\u4e00\u5b9a\u4fdd\u8bc1\u5bf9\u79f0\u6b63\u5b9a\uff0c\u8fd9\u6837\u5e38\u89c4CG\u65b9\u6cd5\u5c31\u6ca1\u6cd5\u7528\u6765\u89e3\u65b0\u65b9\u7a0b\u4e86\u3002\u56e0\u6b64\u9700\u8981\u901a\u8fc7\u4e00\u4e2a\u7279\u522b\u7684\u6280\u5de7\u7ed5\u8fc7\u8fd9\u4e2a\u68d8\u624b\u95ee\u9898\u3002\u5bf9\u4e8e\u4efb\u610f\u7684\u5bf9\u79f0\u6b63\u5b9a\u9884\u6761\u4ef6\u9635{\\boldsymbol M}\uff0c\u4e00\u5b9a\u5b58\u5728\uff08\u4e14\u4e0d\u552f\u4e00\uff09\u67d0\u4e2a\u53ef\u9006\u77e9\u9635{\\boldsymbol E}\u6ee1\u8db3{\\boldsymbol E}{\\boldsymbol E}^T = {\\boldsymbol M}\u3002 \u867d\u7136{\\boldsymbol E}\u53ef\u4ee5\u7528Choleksy\u5206\u89e3\u83b7\u5f97\uff0c\u4f46\u6211\u4eec\u8fd9\u91cc\u5e76\u4e0d\u9700\u8981\u6307\u5b9a\u5b83\u662f\u4ec0\u4e48\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u63a8\u5bfc\u7684\u4e2d\u95f4\u53d8\u91cf\uff0c\u6700\u7ec8\u4f1a\u88ab\u5316\u7b80\u6d88\u9664\u3002  \u82e5{\\boldsymbol v}\u662f\u77e9\u9635{\\boldsymbol M}^{-1}{\\boldsymbol A}\u7684\u4e00\u4e2a\u7279\u5f81\u503c\u4e3a\\lambda\u7684\u7279\u5f81\u5411\u91cf\u3002\u5219\u6709\uff1a  </p>  \\begin{align} &amp; {\\boldsymbol M}^{-1}{\\boldsymbol A}{\\boldsymbol v} = \\lambda {\\boldsymbol v} \\\\ &amp; {\\boldsymbol E}^T {\\boldsymbol M}^{-1}{\\boldsymbol A}{\\boldsymbol v} = \\lambda {\\boldsymbol E}^T {\\boldsymbol v} = {\\boldsymbol E}^T {\\boldsymbol E}^{-T} {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol v} = {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol v}  = {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T}{\\boldsymbol E}^{T}{\\boldsymbol v}  \\\\ \\end{align}   <p>\u8fd9\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u628a\u539f\u65b9\u7a0b\u4e24\u8fb9\u540c\u65f6\u5de6\u4e58{\\boldsymbol E}^{T}\u540e\uff0c\u7cfb\u6570\u77e9\u9635{\\boldsymbol M}^{-1}{\\boldsymbol A}\u53ef\u8f6c\u6362\u4e3a{\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T}{\\boldsymbol E}^{T}\u3002\u4e0d\u59a8\u79f0\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635{\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T}\u4e3a{\\boldsymbol P}\uff0c\u6839\u636e\u4e0a\u5f0f\uff0c{\\boldsymbol P}\u548c{\\boldsymbol M}^{-1} {\\boldsymbol A}\u5177\u6709\u540c\u6837\u7684\u7279\u5f81\u503c\uff08\u6761\u4ef6\u6570\u4e00\u6837\uff09\uff0c\u4f46\u5b83\u7684\u7279\u5f81\u5411\u91cf\u53d8\u6210\u4e86{\\boldsymbol E}^T {\\boldsymbol v}\u3002\u539f\u9884\u6761\u4ef6\u95ee\u9898\u7684\u4e24\u8fb9\u540c\u65f6\u5de6\u4e58{\\boldsymbol E}^T\u540e\uff0c\u65b0\u65b9\u7a0b\u53ef\u6539\u5199\u4e3a\uff1a  </p>  \\begin{align} &amp; {\\boldsymbol E}^T {\\boldsymbol M}^{-1}{\\boldsymbol A}{\\boldsymbol x} = {\\boldsymbol E}^T {\\boldsymbol M}^{-1} {\\boldsymbol b} \\\\ &amp; {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T}{\\boldsymbol E}^{T}{\\boldsymbol v} = {\\boldsymbol E}^T {\\boldsymbol E}^{-T} {\\boldsymbol E}^{-1} {\\boldsymbol b} \\\\ &amp; {\\boldsymbol P} {\\boldsymbol E}^{T}{\\boldsymbol x} = {\\boldsymbol E}^{-1} {\\boldsymbol b} \\\\ &amp; {\\boldsymbol P} \\hat{\\boldsymbol x} =\\hat{\\boldsymbol b}\\\\ \\end{align}   <p>\u5176\u4e2d\uff0c{\\boldsymbol P}\u4e3a\u4e00\u4e2a\u5c0f\u6761\u4ef6\u6570\u7684\u5bf9\u79f0\u6b63\u5b9a\u77e9\u9635\uff0c\\hat{\\boldsymbol x} = {\\boldsymbol E}^{T}{\\boldsymbol x}\uff0c \\hat{\\boldsymbol b} = {\\boldsymbol E}^{-1}{\\boldsymbol b}\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a \u770b\u5230\u8fd9\u91cc\u4f60\u53ef\u80fd\u4f1a\u76b1\u7709\uff0c\u5982\u679c{\\boldsymbol E}\u662f\u5bf9{\\boldsymbol M}\u7684\u5b8c\u5168\u5206\u89e3\uff08\u5982cholesky\uff09\uff0c\u6211\u90fd\u5df2\u7ecf\u5b8c\u5168\u5206\u89e3\u4e86\uff0c\u8fd8\u9700\u8981\u641e\u4e2a\u9e21\u6bdb\u7684CG\u8fed\u4ee3\u554a\uff1f\u4f46\u8bf7\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684{\\boldsymbol E}\u53ea\u662f\u4e00\u4e2a\u4e2d\u95f4\u53d8\u91cf\uff0c\u4e00\u4f1a\u6211\u4eec\u9700\u8981\u628a\u4ed6\u6d88\u9664\uff0c\u4f7f\u5f97\u8ba1\u7b97\u4e2d\u53ea\u5b58\u5728\u5bf9{\\boldsymbol M}\u7684\u64cd\u4f5c\u3002</p> <p>\u9996\u5148\u5199\u51fa\u5173\u4e8e \u9884\u6761\u4ef6\u8f6c\u6362\u540e \u7684\u65b9\u7a0b{\\boldsymbol P} \\hat{\\boldsymbol x} =\\hat{\\boldsymbol b}\u7684 \u65e0\u9884\u6761\u4ef6CG \u8fed\u4ee3\u5f0f\uff1a  </p>  \\begin{align} &amp; \\hat{\\boldsymbol p}_0 = \\hat{\\boldsymbol r}_0 =  {\\boldsymbol E}^{-1} {\\boldsymbol b} - {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T}{\\boldsymbol E}^{T}{\\boldsymbol x}_0 = {\\boldsymbol E}^{-1} ({\\boldsymbol b} - {\\boldsymbol A} {\\boldsymbol x}_{0})\\\\ &amp; \\hat{\\alpha_k} = \\hat{\\boldsymbol r}_k^{T} \\hat{\\boldsymbol r}_k / (\\hat{\\boldsymbol p}_k^{T} {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T} \\hat{\\boldsymbol p}_k) \\\\ &amp; \\hat{\\boldsymbol x}_{k+1} = \\hat{\\boldsymbol x}_{k} + \\hat{\\alpha_k} \\hat{\\boldsymbol p}_k \\\\ &amp; \\hat{\\boldsymbol r}_{k+1} = \\hat{\\boldsymbol r}_{k} - \\hat{\\alpha_k} {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T} \\hat{\\boldsymbol p}_k \\\\ &amp; \\hat{\\beta}_{k+1} = \\hat{\\boldsymbol r}_{k+1}^{T} \\hat{\\boldsymbol r}_{k+1} / (\\hat{\\boldsymbol r}_k^{T} \\hat{\\boldsymbol r}_k) \\\\ &amp; \\hat{\\boldsymbol p}_{k+1} = \\hat{\\boldsymbol r}_{k+1} + \\hat{\\beta}_{k+1} \\hat{\\boldsymbol p}_k  \\end{align}   <p>\u8981\u628a\u4e0a\u5f0f\u53d8\u6362\u5230\u5bf9{\\boldsymbol x}\u7684\u8fed\u4ee3\u683c\u5f0f\uff0c\u9700\u5229\u7528\u5173\u7cfb\u5f0f{\\boldsymbol x}_k = {\\boldsymbol E}^{-T} \\hat{\\boldsymbol x}_{k} (\u540c\u7406{\\boldsymbol p}_k = {\\boldsymbol E}^{-T} \\hat{\\boldsymbol p}_{k})\uff0c\\hat{\\boldsymbol r}_k = {\\boldsymbol E}^{-1} {\\boldsymbol r}_k\u4ece\u800c\u6709\uff1a  </p>  \\begin{align} &amp; {\\boldsymbol p}_0 = {\\boldsymbol E}^{-T} \\hat{\\boldsymbol r}_0 =  {\\boldsymbol M}^{-1} {\\boldsymbol r}_0 \\\\ &amp; {\\boldsymbol x}_{k+1} = {\\boldsymbol E}^{-T}\\hat{\\boldsymbol x}_{k+1} = {\\boldsymbol E}^{-T}\\hat{\\boldsymbol x}_{k} + \\hat{\\alpha_k} {\\boldsymbol E}^{-T} \\hat{\\boldsymbol p}_k =  {\\boldsymbol x}_{k} + {\\alpha_k} {\\boldsymbol p}_{k}\\\\ &amp; {\\alpha_k} = \\hat{\\alpha_k} = \\frac{ \\hat{\\boldsymbol r}_k^{T} \\hat{\\boldsymbol r}_k } { \\hat{\\boldsymbol p}_k^{T} {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T} \\hat{\\boldsymbol p}_k } = \\frac { {\\boldsymbol r}_k^{T} {\\boldsymbol E}^{-T} {\\boldsymbol E}^{-1} {\\boldsymbol r}_k } { {\\boldsymbol p}_k^{T} {\\boldsymbol E} {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T} {\\boldsymbol E}^{T} {\\boldsymbol p}_k } = \\frac { {\\boldsymbol r}_k^{T} {\\boldsymbol M}^{-1} {\\boldsymbol r}_k } { {\\boldsymbol p}_k^{T} {\\boldsymbol A} {\\boldsymbol p}_k }\\\\ &amp; {\\boldsymbol r}_{k+1} = {\\boldsymbol E} \\hat{\\boldsymbol r}_{k+1} = {\\boldsymbol E} \\hat{\\boldsymbol r}_{k} - \\hat{\\alpha_k} {\\boldsymbol E} {\\boldsymbol E}^{-1} {\\boldsymbol A}{\\boldsymbol E}^{-T} {\\boldsymbol E}^{T} \\hat{\\boldsymbol p}_k = {\\boldsymbol r}_{k} - {\\alpha_k} {\\boldsymbol A}{\\boldsymbol p}_k\\\\ &amp; {\\boldsymbol p}_{k+1} = {\\boldsymbol E}^{-T} \\hat{\\boldsymbol p}_{k+1} =  {\\boldsymbol E}^{-T} \\hat{\\boldsymbol r}_{k+1} + \\hat{\\beta}_{k+1} {\\boldsymbol E}^{-T} \\hat{\\boldsymbol p}_k = {\\boldsymbol M}^{-1} {\\boldsymbol r}_{k+1} + \\beta_{k+1} {\\boldsymbol p}_{k+1} \\\\ &amp; {\\beta}_{k+1} = \\hat{\\beta}_{k+1} = \\frac { \\hat{\\boldsymbol r}_{k+1}^{T} \\hat{\\boldsymbol r}_{k+1} }  { \\hat{\\boldsymbol r}_k^{T} \\hat{\\boldsymbol r}_k  } = \\frac { {\\boldsymbol r}_{k+1}^{T} {\\boldsymbol E}^{-T} {\\boldsymbol E}^{-1} {\\boldsymbol r}_{k+1} } { {\\boldsymbol r}_k^{T} {\\boldsymbol E}^{-T} {\\boldsymbol E}^{-1} {\\boldsymbol r}_k } = \\frac { {\\boldsymbol r}_{k+1}^{T} {\\boldsymbol M}^{-1} {\\boldsymbol r}_{k+1} } { {\\boldsymbol r}_k^{T} {\\boldsymbol M}^{-1}  {\\boldsymbol r}_k } \\end{align}   <p>\u201c\u5999\u554a\u201d\uff01\u6211\u4e0d\u7981\u9ad8\u558a\u3002\u5bf9{\\boldsymbol x}_k\u7684\u76f4\u63a5\u8fed\u4ee3\u4ea7\u751f\u4e86\u4e00\u4e2a\u5947\u8ff9\uff0c{\\boldsymbol E}\u7684\u663e\u5f0f\u5f62\u5f0f\u4e0d\u518d\u91cd\u8981\u3002\u5bf9\u4e8e\u4efb\u4f55\u5bf9\u79f0\u6b63\u5b9a\u7684\u9884\u6761\u4ef6\u9635{\\boldsymbol M}\uff0c\u65e0\u8bba{\\boldsymbol M}^{-1}{\\boldsymbol A}\u662f\u5426\u5bf9\u79f0\uff0c\u5747\u53ef\u7528\u4e0a\u5f0f\u76f4\u63a5\u5bf9{\\boldsymbol x}_k\u8fdb\u884c\u8fed\u4ee3\u6c42\u89e3\uff08PCG\uff09\u3002 </p> <p>\u4f46\u4ecd\u6709\u4e00\u4e2a\u9057\u7559\u95ee\u9898\uff0c\u5982\u4f55\u6c42{\\boldsymbol M}^{-1}\uff1f\u5f53\u7136\u6709\u4e00\u79cd\u571f\u8c6a\u7684\u529e\u6cd5\u662f\u5bf9{\\boldsymbol M}\u8fdb\u884ccholesky\u5206\u89e3\uff0c\u4f46\u8fd9\u6837\u5206\u89e3\u9700\u8981\u7684\u65f6\u95f4\u90fd\u8db3\u591f\u76f4\u63a5\u89e3\u51fa{\\boldsymbol A}{\\boldsymbol x}={\\boldsymbol b}\u4e86\u3002\u6240\u4ee5\u5b9e\u7528\u4e2d\u5f80\u5f80\u9700\u8981\u5feb\u901f\u8fd1\u4f3c{\\boldsymbol M}^{-1}\u548c\u4efb\u610f\u5411\u91cf{\\boldsymbol v}\u7684\u4e58\u79ef\u3002 \u4e3e\u4e2a\u6817\u5b50\uff0c\u5982\u679c{\\boldsymbol M}\u662f\u4e00\u4e2a\u7a00\u758f\u9635\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u4e0d\u5b8c\u5168\u5206\u89e3\u6280\u672f\uff08\u5982ILU\u548cICC\uff09\uff0c\u6784\u5efa\u4e00\u4e2a\u7a00\u758f\u4e0b\u4e09\u89d2\u77e9\u9635{\\boldsymbol L}\u548c\u4e00\u4e2a\u7a00\u758f\u4e0a\u4e09\u89d2\u77e9\u9635{\\boldsymbol U}\uff0c\u4f7f\u5f97{\\boldsymbol L}{\\boldsymbol U} = \\hat{\\boldsymbol M} \\approx {\\boldsymbol M}\u3002\u8fdb\u800c\u5229\u7528\u7a00\u758f\u4e09\u89d2\u56de\u4ee3\u6280\u672f\u5feb\u901f\u8fd1\u4f3c{\\boldsymbol M}^{-1}{\\boldsymbol v}\u3002 \u6ce8\u610f\uff0c\u7ecf\u8fc7\u4e0d\u5b8c\u5168\u5206\u89e3\u7684\u8fd1\u4f3c\u540e\uff0c\u9884\u6761\u4ef6\u9635\u5b9e\u9645\u4e0a\u662f\\hat{\\boldsymbol M}\uff0c\u800c\u975e{\\boldsymbol M}\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a \u65e0\u9700\u62c5\u5fc3{\\boldsymbol L}\u548c{\\boldsymbol U}\u662f\u5426\u4e92\u4e3a\u8f6c\u7f6e\uff0c\u56e0\u4e3a\u77e9\u9635{\\boldsymbol L}{\\boldsymbol U}\u662f{\\boldsymbol M}\u7684\u5bf9\u79f0\u6b63\u5b9a\u8fd1\u4f3c\uff0c\u90a3\u4e48\u6b63\u5982\u672c\u8282\u4e00\u5f00\u59cb\u6240\u8a00\uff0c\u5b83\u5fc5\u7136\u5b58\u5728\u4e00\u4e2a\u5206\u89e3\u4f7f\u5f97{\\boldsymbol L}{\\boldsymbol U} = {\\boldsymbol E}{\\boldsymbol E}^T\u3002</p> <p>\u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u51fa \u7b97\u6cd53 (PCG)\uff1a (1) \u9009\u5b9a{\\boldsymbol x}_0\uff0c{\\boldsymbol M}\uff0c {\\boldsymbol r}_0 = {\\boldsymbol b} - {\\boldsymbol A} {\\boldsymbol x}_0 (2) k := 0\uff0c {\\boldsymbol z} := {\\boldsymbol M}^{-1} {\\boldsymbol r}_0, {\\boldsymbol r} := {\\boldsymbol r}_0\uff0c{\\boldsymbol x} := {\\boldsymbol x}_0\uff0c {\\boldsymbol p} := {\\boldsymbol z} (3) \\gamma := {\\boldsymbol r}^T{\\boldsymbol r}\uff0c \\gamma_0 := \\gamma (4) while \\sqrt{(\\gamma / \\gamma_0)} \u4e0d\u591f\u5c0f\uff1a (5) \u2003\u2003k := k+1 (6) \u2003\u2003{\\boldsymbol q} := {\\boldsymbol A} {\\boldsymbol r}_{k-1} = {\\boldsymbol A} {\\boldsymbol p} (7) \u2003\u2003\\delta = {\\boldsymbol r}^T {\\boldsymbol z} (8) \u2003\u2003\\alpha := \\alpha_k = \\delta  / ({\\boldsymbol p}^T {\\boldsymbol q}) (9) \u2003\u2003{\\boldsymbol x} := {\\boldsymbol x} + \\alpha {\\boldsymbol p} (10) \u2003\u2003{\\boldsymbol r} := {\\boldsymbol r} - \\alpha {\\boldsymbol q} (11) \u2003\u2003{\\boldsymbol z} := {\\boldsymbol M}^{-1} {\\boldsymbol r} (12) \u2003\u2003\\delta_1 := \\delta\uff0c \\delta := {\\boldsymbol r}^T{\\boldsymbol z}\uff0c \\beta := \\delta / \\delta_1\uff0c\\gamma := {\\boldsymbol r}^T {\\boldsymbol r}  (13) \u2003\u2003{\\boldsymbol p} := {\\boldsymbol r} + \\beta {\\boldsymbol p} (14) end while (15) \u8f93\u51fa{\\boldsymbol x} = {\\boldsymbol x}_{k} </p>"},{"location":"markdown/optimal_cg_and_nlcg/#4","title":"4. \u603b\u7ed3","text":"<p>\u4ee5\u4e0a\u8ba8\u8bba\u7684\u662f\u7ebf\u6027\u4e8c\u6b21\u578b\u95ee\u9898\uff0c\u9650\u5b9a\u4e86\u77e9\u9635{\\boldsymbol A}\u5bf9\u79f0\u6b63\u5b9a\u7684\u60c5\u51b5\uff0c\u5982\u679c{\\boldsymbol A}\u4e0d\u5bf9\u79f0\uff0c\u5219\u9700\u8981\u8f6c\u6362\u4e3a\u6700\u5c0f\u4e8c\u4e58\u5f62\u5f0f{\\boldsymbol A}^T{\\boldsymbol A}{\\boldsymbol x} = {\\boldsymbol A}^T {\\boldsymbol b}\u6c42\u89e3\u3002CG\u7684\u5176\u4ed6\u53d8\u79cd\u65b9\u6cd5\uff08\u5982BICG\u548cBICGStab\uff09\u53ef\u76f4\u63a5\u7528\u4e8e\u8fd9\u79cd\u4e0d\u5bf9\u79f0\u95ee\u9898\u3002 \u5728\u5730\u7403\u7269\u7406\u53cd\u6f14\u4e2d\uff0c\u7531\u4e8e\u6b63\u6f14\u8fc7\u7a0b\u5f80\u5f80\u662f\u975e\u7ebf\u6027\u51fd\u6570\uff0c\u53cd\u6f14\u76ee\u6807\u51fd\u6570\u662f\u975e\u7ebf\u6027\u6700\u5c0f\u4e8c\u4e58\u5f62\u5f0f\u3002\u6b64\u65f6\uff0cCG\u65b9\u6cd5\u4e5f\u53ef\u5e94\u7528\uff0c\u4e0d\u540c\u70b9\u5728\u4e8e\u8d1f\u68af\u5ea6\u65b9\u5411\u4e0d\u662f{\\boldsymbol r}_k\u800c\u53d8\u4e3a-{\\boldsymbol g}_k\uff0c{\\alpha}_k\u4e0d\u518d\u80fd\u76f4\u63a5\u6c42\u5f97\uff0c\u800c\u9700\u5bf9\u5f53\u524d\u8fed\u4ee3\u7684\u7ebf\u6027\u5b50\u95ee\u9898\u8fd1\u4f3c\u5f97\u5230\uff0c\u4e14\u8fd9\u6837\u5f97\u5230\u7684{\\alpha}_k\u4e0d\u518d\u4fdd\u8bc1\u76ee\u6807\u51fd\u6570\u4e0b\u964d\uff08\u6240\u4ee5\u9700\u8981\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\uff09\u3002\u53e6\u5916\uff0c{\\beta}_k\u4e5f\u8981\u8fdb\u884c\u4fee\u6539\uff08\u6709\u5f88\u591a\u65b9\u5f0f\uff09\uff0c\u7bc7\u5e45\u6240\u9650\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002\u8fd9\u6837\u7684CG\u65b9\u6cd5\u88ab\u79f0\u4e3a\u975e\u7ebf\u6027\u5171\u8f6d\u68af\u5ea6(NLCG)\u3002 PCG\u95ee\u9898\u7684\u63a8\u5bfc\u8fc7\u7a0b\u975e\u5e38\u5de7\u5999\uff0c\u4e00\u4e2a\u4e0d\u6b63\u5b9a\u7684\u95ee\u9898\u4e00\u901a\u9a9a\u64cd\u4f5c\u540e\u8f6c\u6362\u6210\u4e86\u6b63\u5b9a\u95ee\u9898\uff0c\u800c\u4e14\u7ed5\u56de\u53bb\u4e4b\u540e\u57fa\u672c\u6ca1\u589e\u52a0\u4ec0\u4e48\u8fd0\u7b97\u91cf\u3002\u6211\u53ea\u80fd\u8bf4\uff0c\u8fd9\u5f88\u725b\u903c\u3002 \u52a0\u901f\u4e00\u4e2a\u6700\u4f18\u5316\u65b9\u6cd5\u7684\u5173\u952e\u70b9\u5728\u4e8e\u6761\u4ef6\u6570\uff0cCG\u65b9\u5411\u548c\u9884\u6761\u4ef6\u90fd\u662f\u4ecerounding\u7684\u601d\u60f3\u51fa\u53d1\u3002\u5982\u679c\u8054\u7cfb\u725b\u987f\u6cd5\u53bb\u601d\u8003\u53ef\u80fd\u53d1\u73b0\u4e00\u4e2a\u795e\u5947\u73b0\u8c61\uff1a\u725b\u987f\u6cd5\u7684\u672c\u8d28\u5728\u4e8e\u7528{\\boldsymbol A}\u8303\u6570\u53bb\u7f29\u653e\u539f\u5927\u6761\u4ef6\u6570\u95ee\u9898\u76842\u8303\u6570\u68af\u5ea6\uff0c\u5f97\u5230{\\boldsymbol A}\u8303\u6570\u7684\u6700\u901f\u4e0b\u964d\u65b9\u5411\uff08\u725b\u987f\u65b9\u5411\uff09\u3002\u800cCG\u5219\u6784\u5efa{\\boldsymbol p}_{k-1}^T {\\boldsymbol A} {\\boldsymbol p}_k\u7684\u5ea6\u91cf\uff0c\u6211\u9690\u9690\u89c9\u5f97CG\u4e0b\u964d\u65b9\u5411\u662f\u4e00\u79cd\u725b\u987f\u65b9\u5411\u7684\u4e0d\u52a8\u70b9\u8fed\u4ee3\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1aNLCG\u5931\u53bb\u4e86\u7ebf\u6027CG\u7684\u4e8c\u6b21\u622a\u81f3\u6027\u3002</p>"},{"location":"markdown/optimal_cg_and_nlcg/#5","title":"5. \u81f4\u8c22","text":"<p>\u5199\u672c\u6587\u7684\u7f18\u7531\u662f\u548c\u55bb\u56fd\u535a\u58eb\u4ea4\u6d41CG\u65b9\u6cd5\u88ab\u95ee\u5361\u58f3\u4e86\uff0cCG\u8fd9\u73a9\u610f\u81ea\u5df1\u5f88\u65e9\u5c31\u7528\uff0c\u5e76\u4e14\u7531\u4e8e\u5176\u6548\u679c\u6709\u9650\uff0c\u4e00\u76f4\u4e0d\u6c42\u751a\u89e3\uff0c\u5f88\u591a\u7406\u89e3\u4e0d\u591f\u6df1\u523b\u3002\u8fd9\u56de\u597d\u597d\u91cd\u65b0\u63a8\u5bfc\u4e86\u4e00\u6b21\uff0c\u6536\u83b7\u9887\u5927\u3002\u611f\u8c22\u55bb\u535a\u58eb\u5bf9\u7ec6\u8282\u7684\u8ba4\u771f\u6001\u5ea6\uff0c\u5426\u5219\u6211\u90fd\u4e0d\u77e5\u9053\u81ea\u5df1\u5bf9CG\u7684\u7406\u89e3\u4e00\u76f4\u6709\u504f\u5dee\u3002 \u672c\u6587\u7684\u63a8\u5bfc\u548c\u539f\u7406\u8bba\u8ff0\u501f\u9274\u4e86\u6d59\u6c5f\u5927\u5b66\u8d75\u6d77\u4eae\u535a\u58eb\u7684\u516c\u5f00\u7b14\u8bb0http://hliangzhao.me/math/CG.pdf\uff0c\u975e\u5e38\u611f\u8c22\u8d75\u535a\u58eb\u7684\u603b\u7ed3\u548c\u5206\u4eab\u3002</p>"},{"location":"markdown/optimal_convex_optimis/","title":"\u7ecf\u5178\u65e0\u7ea6\u675f\u975e\u7ebf\u6027\u51f8\u4f18\u5316\u7b97\u6cd5\u6742\u8c08","text":"<p>\u672c\u7bc7\u662f\u5e38\u89c4\u5730\u7403\u7269\u7406\u53cd\u6f14\u65b9\u6cd5\u7684\u5165\u95e8\u7ea7\u7b14\u8bb0\uff0c\u6ca1\u6709\u4ec0\u4e48\u9ad8\u6df1\u7684\u7406\u8bba\uff0c\u5199\u8fd9\u4e9b\u4e1c\u897f\u4e5f\u53ea\u662f\u60f3\u628a\u5730\u7403\u7269\u7406\u53cd\u6f14\u9886\u57df\u6bd4\u8f83\u6df7\u4e71\u7684\u672f\u8bed\u4f53\u7cfb\u5c3d\u91cf\u534f\u8c03\uff0c\u4ee5\u6539\u5584\u76ee\u524d\u5404\u5927\u725b\u4eba\u8ba8\u8bba\u8d77\u6765\u9e21\u540c\u9e2d\u8bb2\u7684\u73b0\u72b6\u3002\u6240\u6709\u63a8\u5bfc\u5c3d\u91cf\u7528\u6211\u81ea\u5df1\u7684\u65b9\u6cd5\u800c\u6709\u522b\u4e8e\u7ecf\u5178\u8bba\u6587\u3002\u5982\u6709\u4e89\u8bae\uff0c\u4f60\u90fd\u5bf9\u3002     \u5bf9\u4e8e\u4e00\u4e2a\u89c2\u6d4b\u6570\u636e\u96c6\\boldsymbol b\uff08\u7528\u6b64\u7b26\u53f7\u4ee5\u907f\u514d\u548c\u4e0b\u964d\u65b9\u5411\\boldsymbol d\u51b2\u7a81\uff09\uff0c\u4e14\u5b58\u5728\u4e00\u4e2a\u7cbe\u786e\u7684\u3001\u975e\u5e38\u590d\u6742\u7684\u3001\u96be\u4ee5\u6c42\u53cd\u51fd\u6570\uff08\u6216\u53cd\u51fd\u6570\u4e0d\u5b58\u5728\uff09\u7684\u51fd\u6570F\uff0c\u4f7f\u5f97\u4efb\u4e00\u5408\u7406\u5730\u7403\u7269\u7406\u4ecb\u8d28\u6a21\u578b\\boldsymbol m\u7684\u6b63\u6f14\u54cd\u5e94\\boldsymbol b= F(\\boldsymbol m)\uff0c\u5219\u6839\u636e\u6570\u636e\\boldsymbol b\u6c42\u53d6\u771f\u5b9e\u5730\u7403\u7269\u7406\u4ecb\u8d28\\boldsymbol m_{true}\u7684\u8fc7\u7a0b\u5c31\u53eb\u5730\u7403\u7269\u7406\u53cd\u6f14\u3002 \u663e\u7136\uff0c\u57fa\u672c\u4e0a\u65e0\u6cd5\u76f4\u63a5\u89e3\u51fa\\boldsymbol m_{true}\uff0c\u6240\u4ee5\u53ea\u80fd\u9000\u800c\u6c42\u5176\u6b21\uff0c\u5bfb\u627e\u67d0\u4e2a\u6700\u4f18\u89e3\u4f7f\u5f97F(\\boldsymbol m_{opt}) - \\boldsymbol b\u7684\u67d0\u79cd\u8303\u6570\u6781\u5c0f\u3002 \u8fd9\u91cc\u53ea\u8ba8\u8bba\u4e8c\u8303\u6570\u7684\u60c5\u51b5\uff0c\u5b9a\u4e49\u51fd\u6570\uff1a  </p>  \\Phi(\\boldsymbol m)  = \\frac {1}{2} \\Vert {F(\\boldsymbol m) - \\boldsymbol b} \\Vert_2 ^2 \\tag{1}\\label{eq1}  <p>\u5f0f\\eqref{eq1}\u901a\u5e38\u88ab\u79f0\u4e3a\u201c\u76ee\u6807\u51fd\u6570\u201d\u3002\u5047\u5b9a\u5bf9\u6a21\u578b\\boldsymbol m\u7684\u5b9a\u4e49\u57df\u4e0d\u505a\u8981\u6c42\uff0c\u5373\\forall\u7f16\u53f7\u4e3ai\u7684\u6a21\u578b\u53c2\u6570\u90fd\u6ee1\u8db3m_i \\in [-\\infty, +\\infty]\uff0c\u90a3\u4e48\u53cd\u6f14\u8fc7\u7a0b\u7b49\u4ef7\u4e8e\u5728N\u7ef4\u5b9e\u7a7a\u95f4\u4e2d\u5bfb\u627e\u76ee\u6807\u51fd\u6570\\Phi(\\boldsymbol{m})\u7684\u6781\u5c0f\u503c\u70b9\\boldsymbol m_{opt}\uff08N\u662f\u5411\u91cf\\boldsymbol m\u7684\u5927\u5c0f\uff09\uff0c\u8fd9\u662f\u5178\u578b\u7684\u65e0\u7ea6\u675f\u6700\u5c0f\u5316\u95ee\u9898\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u76ee\u6807\u51fd\u6570\u53d6L2\u8303\u6570\u7684\u5e73\u65b9\u662f\u4e3a\u907f\u514d\u5bf9\u6839\u53f7\u6c42\u5bfc\uff0c\u4e58\u4ee5\u00bd\u662f\u4e3a\u4e86\u8ba9\u68af\u5ea6\u7cfb\u6570\u66f4\u7b80\u5355\u3002 </p> <p>\u58f0\u660e\uff1a\u5b9e\u9645\u53cd\u6f14\u95ee\u9898\u4e2d\u76ee\u6807\u51fd\u6570\u5f80\u5f80\u8fd8\u9700\u8981\u52a0\u5165\u6b63\u5219\u9879\uff0c\u4ee5\u8ba9\u53cd\u6f14\u7a33\u5b9a\u4e14\u4f7f\u6a21\u578b\u89e3\u66f4\u7b26\u5408\u67d0\u79cd\u671f\u671b\u3002\u5f88\u591a\u5730\u7403\u7269\u7406\u4e13\u5bb6\u79f0\u8fd9\u79cd\u65b9\u6cd5\u662f\u7ea6\u675f\u53cd\u6f14\u3002\u4f46\u7531\u4e8e\u89e3\u7a7a\u95f4\u672c\u8eab\u6ca1\u6709\u88ab\u9650\u5236\uff0c\u56e0\u6b64\u8fd9\u4ecd\u662f\u65e0\u7ea6\u675f\u95ee\u9898\u3002\u5730\u7403\u7269\u7406\u4e0a\u8bb2\u7684\u201c\u6b63\u5219\u5316\u7ea6\u675f\u201d\u548c\u201c\u7ea6\u675f\u6700\u4f18\u5316\u201d\u7684\u6982\u5ff5\u4e0d\u540c\u3002\u6211\u4e2a\u4eba\u5e0c\u671b\u5927\u5bb6\u80fd\u628a\u201c\u6b63\u5219\u5316\u201d\u3001\u201c\u7ea6\u675f\u201d\u3001\u201c\u671f\u671b\u201d\u7b49\u672f\u8bed\u8fdb\u884c\u533a\u5206\u3002 </p> <p>\u5f0f\\eqref{eq1}\u7684\u6700\u5c0f\u5316\u95ee\u9898\u4e5f\u88ab\u79f0\u4e3a\u975e\u7ebf\u6027\u6700\u5c0f\u4e8c\u4e58\u95ee\u9898\uff0c\u901a\u5e38\u7528\u8fed\u4ee3\u6cd5\u6c42\u89e3\u3002\u7b2ck\u6b21\u8fed\u4ee3\u7684\u6a21\u578b\u66f4\u65b0\u516c\u5f0f\u4e3a\uff1a  </p>  \\boldsymbol m_{k+1}  = \\boldsymbol m_{k} + \\alpha_k \\boldsymbol d_{k} = \\boldsymbol m_{k} + \\boldsymbol s_{k} \\tag{2}\\label{eq2}  <p>\u5176\u4e2d\uff0c\u5411\u91cf\\boldsymbol{d}_{k}\u88ab\u79f0\u4e3a\u4e0b\u964d\u65b9\u5411(descent direction)\uff0c\\alpha_k &gt; 0\u88ab\u79f0\u4e3a\u6b65\u957f(step length)\uff0c\u6b65\u957f\u548c\u4e0b\u964d\u65b9\u5411\u5171\u540c\u786e\u5b9a\u4e86\u6a21\u578b\u4fee\u6b63\u91cf\\boldsymbol s_k\u3002 \u82e5\u5bf9\u4e8e\\forall\u6a21\u578b\\boldsymbol m\uff0c\u9664\u67d0\u4e2a\u6781\u5c0f\u70b9\\boldsymbol m_*\u4e4b\u5916\uff0c\u90fd\u6709\\Phi(\\boldsymbol m) &gt; \\Phi(\\boldsymbol m_*)\uff0c\u90a3\u4e48\u51fd\u6570\\Phi\u88ab\u79f0\u4e3a\u51f8\u51fd\u6570(convex function)\u3002\u51f8\u51fd\u6570\u7684\u6700\u5c0f\u5316\u95ee\u9898\u5f53\u7136\u88ab\u79f0\u4e3a\u51f8\u4f18\u5316\uff0c\u6240\u7528\u7684\u7b97\u6cd5\u81ea\u7136\u53eb\u51f8\u4f18\u5316\u7b97\u6cd5\u3002\u6b64\u65f6\u6781\u5c0f\u70b9\\boldsymbol m_*\u4e5f\u88ab\u79f0\u4e3a\u5168\u5c40\u6781\u5c0f\u70b9\uff0c\u4e14\u6ee1\u8db3\\boldsymbol m_* = \\boldsymbol m_{opt} = \\boldsymbol m_{true}\u3002 \u4f46\u5730\u7403\u7269\u7406\u53cd\u95ee\u9898\u7531\u4e8e\u6570\u636e\u4e0d\u5b8c\u5907(\u591a\u89e3\u6027)\u548c\u6b63\u6f14\u975e\u53cc\u5c04\uff08\u7b49\u503c\u6027\uff09\u7684\u7279\u70b9\uff0c\u5bfc\u81f4\u76ee\u6807\u51fd\u6570\u975e\u51f8\u3002\u6b64\u65f6\u6cbf\u7528\u51f8\u4f18\u5316\u7b97\u6cd5\u53ea\u80fd\u627e\u5230\u8fed\u4ee3\u521d\u59cb\u6a21\u578b\\boldsymbol m_0\u67d0\u4e2a\u90bb\u57df\u5185\u76ee\u6807\u51fd\u6570\u7684\u6781\u5c0f\uff08\u5c40\u90e8\u662f\u51f8\u51fd\u6570\uff09\uff0c\u8fd9\u9020\u6210\u4e86\u4e0d\u540c\u521d\u59cb\u6a21\u578b\u5f97\u5230\u4e0d\u540c\u53cd\u6f14\u7ed3\u679c\u7684\u73b0\u8c61\uff08\u521d\u59cb\u6a21\u578b\u4f9d\u8d56\u6027\uff09\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\uff081\uff09\u53cd\u6f14\u7ed3\u679c\u7684\u53ef\u4fe1\u5ea6\u5f88\u5927\u610f\u4e49\u4e0a\u7531\u76ee\u6807\u51fd\u6570\u6027\u8d28\u51b3\u5b9a\uff0c\u6700\u597d\u7684\u60c5\u51b5\u662f\u76ee\u6807\u51fd\u6570\u4e3a\u51f8\u51fd\u6570\uff1b\uff082\uff09\u5bf9\u4e8e\u5b58\u5728\u552f\u4e00\u5168\u5c40\u6781\u5c0f\u7684\u975e\u51f8\u95ee\u9898\uff0c\u4e00\u5207\u5e38\u89c4\u53cd\u6f14\u65b9\u6cd5\u90fd\u53ea\u80fd\u4fdd\u8bc1\u5c40\u90e8\u6781\u5c0f\uff1b\uff083\uff09\u7136\u9e45\uff0c\u51e0\u4e4e\u6240\u6709\u5730\u7403\u7269\u7406\u53cd\u6f14\u95ee\u9898\u90fd\u6709\u65e0\u7a77\u591a\u4e2a\u5168\u5c40\u6781\u5c0f\uff0c\u6240\u4ee5\u65e0\u8bba\u4f60\u7528\u4ec0\u4e48\u7b97\u6cd5\uff0c\u627e\u5230\u5168\u5c40\u6781\u5c0f\u4e5f\u4e0d\u7b49\u4e8e\u6a21\u578b\u53ef\u4fe1\uff1b\uff084\uff09\u5f88\u660e\u663e\uff0c\u53ef\u4fe1\u7684\u505a\u6cd5\u662f\u5728\u5408\u7406\u521d\u59cb\u6a21\u578b\u7684\u57fa\u7840\u4e0a\u8fed\u4ee3\uff0c\u6216\u5728\u4e00\u4e2a\u53ef\u4fe1\u57df\u5185\u8fdb\u884c\u51f8\u4f18\u5316\uff08\u7ea6\u675f\u53cd\u6f14\uff09\u3002 </p> <p>\u5e9f\u8bdd\u5df2\u626f\u4e86\u592a\u591a\uff0c\u65e0\u8bba\u4f60\u662f\u5426\u7406\u89e3\u90fd\u4e0d\u5f71\u54cd\u540e\u6587\u5185\u5bb9\uff0c\u4ece\u73b0\u5728\u5f00\u59cb\u6211\u4eec\u53ea\u8ba8\u8bba\u5982\u4f55\u6784\u5efa\u4e00\u7cfb\u5217\u7b97\u6cd5\u53bb\u8fed\u4ee3\u5bfb\u4f18\uff0c\u4e5f\u5c31\u662f\u6784\u9020\u4e0b\u964d\u65b9\u5411\\boldsymbol d_{k}\u548c\u6b65\u957f\\alpha_k\u3002 \u5f53\u7136\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u8fdb\u884c\u4e00\u4e9b\u7ea6\u5b9a\uff1a\uff081\uff09\u76ee\u6807\u51fd\u6570\u662f\u5149\u6ed1\u53ef\u5bfc\u7684\uff1b\uff082\uff09\u6bcf\u6b21\u8fed\u4ee3\u7684\u76ee\u6807\u51fd\u6570\u68af\u5ea6\u5411\u91cf\\boldsymbol g\u53ef\u4ee5\u6c42\u51fa\u6765\uff0c\u5176\u6bcf\u4e2a\u5143\u7d20\u4e3ag_i = dF(\\boldsymbol m)/dm_i\uff08\u6ce8\u610f\u5927\u5c0f\u5199\uff0c\u4e0b\u6807i\u8868\u793a\u5411\u91cf\u7684\u7b2ci\u4e2a\u5143\u7d20\uff09\u3002 \u597d\u4e86\uff0c\u73b0\u5728\u8bf7\u6df1\u5438\u4e00\u53e3\u6c14\uff0c\u56de\u5fc6\u4e00\u4e0b\u9ad8\u7b49\u4ee3\u6570\u7b2c\u4e00\u518c\uff0c\u6211\u4eec\u6240\u4f5c\u7684\u53ea\u4e0d\u8fc7\u662f\u628a\u4e00\u5143\u51fd\u6570\u63a8\u5e7f\u5230\u591a\u7ef4\u7a7a\u95f4\u800c\u5df2\uff0c\u90a3\u4e48\u5f00\u59cb\u5427.....  </p>"},{"location":"markdown/optimal_convex_optimis/#1-gradient-method","title":"1. \u68af\u5ea6\u6cd5\uff08Gradient Method\uff09","text":"<p>\u9996\u5148\uff0c\u56de\u5fc6\u4e00\u4e0b\u6cf0\u52d2\u5c55\u5f00\u5f0f\uff1a  </p>  f(x)  = f(x_0) + f^{'}(x_0)(x-x_0) +  \\frac{1}{2} f^{''}(x_0) (x-x_0) ^ 2 + R_n(x) \\tag{3}\\label{eq3}  <p>\u8fd9\u4e2a\u4f1f\u5927\u7684\u4e1c\u897f\u5f88\u91cd\u8981\uff0c\u5b83\u53ef\u4ee5\u628a\u4e00\u4e2a\u590d\u6742\u7684\u51fd\u6570\u7528\u67d0\u70b9\u51fd\u6570\u503c\u548c\u5bfc\u6570\u503c\u5c55\u5f00\u3002\u628a\u6cf0\u52d2\u516c\u5f0f\u63a8\u5e7f\u5230\u9ad8\u7ef4\uff0c\u5bf9\u4e8e\u8fed\u4ee3\u5f0f\\eqref{eq2}\uff0c\\boldsymbol m_{k+1}\u7684\u76ee\u6807\u51fd\u6570\u503c\u53ef\u8868\u793a\u4e3a\uff1a  </p>  \\begin{align}  \\Phi(\\boldsymbol m_{k+1}) &amp;= \\Phi(\\boldsymbol m_k) + \\boldsymbol g_k^T (\\boldsymbol m_{k+1} - \\boldsymbol m_k) \\\\ &amp;+ \\frac{1}{2} (\\boldsymbol m_{k+1} - \\boldsymbol m_k)^T \\boldsymbol B_k (\\boldsymbol m_{k+1} - \\boldsymbol m_k) + R_n( \\boldsymbol m_{k+1}) \\end{align} \\tag{4}\\label{eq4}  <p>\u5176\u4e2d\uff0c\\boldsymbol B_k\u662f\u5bf9\u5e94\u6a21\u578b\\boldsymbol m_k\u7684\u6d77\u585e\u77e9\u9635\uff0c\u8fd9\u91cc\u6ca1\u6709\u4f7f\u7528\u7b26\u53f7\\boldsymbol H_k\u662f\u4e3a\u4e86\u548c\u62df\u725b\u987f\u6cd5\u7ecf\u5178\u8bba\u6587\u7684\u7b26\u53f7\u7edf\u4e00\uff0c\u6211\u4eec\u4f1a\u7528\\boldsymbol H_k\u8868\u793a\u6d77\u585e\u77e9\u9635\u7684\u9006\u77e9\u9635\uff0c\u5373\\boldsymbol H_k = \\boldsymbol B_k^{-1}\u3002\u6d77\u585e\u77e9\u9635\u7684\u5177\u4f53\u5f62\u5f0f\u89c1\\eqref{eq15}\u3002 \u6309\u7167\u56fd\u9645\u60ef\u4f8b\uff0c\u5ffd\u7565\u9ad8\u9636\u9879\uff0c\u76ee\u6807\u51fd\u6570\u7684\u4e00\u9636\u903c\u8fd1\u5982\u4e0b\uff1a  </p>  \\Phi(\\boldsymbol m_{k+1})  \\approx \\Phi(\\boldsymbol m_k) + \\boldsymbol g_k^T (\\boldsymbol m_{k+1} - \\boldsymbol m_k)  \\tag{5}\\label{eq5}  <p>\u628a\u7ea6\u7b49\u53f7\u6539\u4e3a\u7b49\u53f7\uff0c\u5bf9\u4e8e\u7b2ck\u6b21\u8fed\u4ee3\u7684\u6a21\u578b\u4fee\u6b63\u91cf\uff0c\u5b58\u5728\u5173\u7cfb\u5f0f\uff1a  </p>  \\Phi(\\boldsymbol m_{k+1})  = \\Phi(\\boldsymbol m_k) + \\boldsymbol g_k^T  \\boldsymbol s_k          = \\Phi(\\boldsymbol m_k) + \\lvert {\\boldsymbol g_k} \\rvert \\cdot \\lvert {  \\boldsymbol s_k } \\rvert \\cdot cos\\theta \\tag{6}\\label{eq6}  <p>\u5176\u4e2d\uff0c\\theta\u662f\u5411\u91cf\\boldsymbol g_k\u548c\\boldsymbol s_k\u7684\u5939\u89d2\u3002\u5f88\u663e\u7136\uff0ccos \\theta = -1\u65f6\\Phi(\\boldsymbol m_{k+1})\u53d6\u5f97\u5f53\u524d\u8fed\u4ee3\u7684\u6700\u5c0f\u76ee\u6807\u51fd\u6570\u503c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6a21\u578b\u4fee\u6b63\u7684\u65b9\u5411\u4e0e\u68af\u5ea6\u65b9\u5411\u6210180\u5939\u89d2\u65f6\u76ee\u6807\u51fd\u6570\u4e0b\u964d\u6700\u5feb\u3002\u6545\u800c\u53ef\u6784\u5efa\u4e0b\u964d\u65b9\u5411\\boldsymbol d_k = - \\boldsymbol g_k\uff0c\u5b83\u88ab\u79f0\u4e3a\u6700\u901f\u4e0b\u964d\u65b9\u5411(steepest descent direction)\uff0c\u56e0\u6b64\u68af\u5ea6\u6cd5\u4e5f\u88ab\u79f0\u4e3a\u201c\u6700\u901f\u4e0b\u964d\u6cd5\u201d\uff0c\u5176\u6a21\u578b\u4fee\u6b63\u91cf\u53ef\u8868\u793a\u4e3a\\boldsymbol s_k = - \\alpha_k \\boldsymbol g_k\u3002 \u6b65\u957f\\alpha_k\u53ef\u901a\u8fc7\u6cdb\u51fd\\Phi(\\boldsymbol{m}_{k} + \\alpha \\boldsymbol{d}_k)\u5173\u4e8e\u53d8\u91cf\\alpha\u7684\u6781\u5c0f\u70b9\u786e\u5b9a\uff0c\u6839\u636e\u6781\u503c\u6761\u4ef6\u6709\uff1a  </p>  \\frac {\\partial \\Phi(\\boldsymbol m_k + \\alpha \\boldsymbol d_k)  } {\\partial {\\alpha}} = 0 \\tag{7}\\label{eq7}  <p>\u6839\u636e\\Phi(\\boldsymbol m_k + \\alpha \\boldsymbol d_k)\u6784\u5efa\u5173\u4e8e\u5f0f\\eqref{eq7}\u7684\u89e3\u6790\u8868\u8fbe\u5f0f\uff0c\u5f62\u6210\u4e00\u5143\u65b9\u7a0b\uff0c\u5373\u53ef\u6c42\u89e3\u51fa\u6700\u4f18\u7684\\alpha_k\uff0c\u8fd9\u6837\u7684\u6b65\u957f\u53eb\u505a\u201c\u7cbe\u786e\u7ebf\u641c\u7d22\u6b65\u957f\u201d\u3002 \u4f46\\Phi(\\boldsymbol m_k + \\alpha \\boldsymbol d_k)\u7684\u8868\u8fbe\u5f0f\u5f80\u5f80\u65e0\u6cd5\u89e3\u6790\u7ed9\u51fa\uff0c\u6240\u4ee5\u53ea\u80fd\u5bf9\\alpha_k\u8fdb\u884c\u67d0\u79cd\u8fd1\u4f3c\u5f97\u5230\\alpha_k^{(0)} \\approx \\alpha_k\uff0c\u518d\u4ee5\u5b83\u4e3a\u521d\u503c\u641c\u7d22\u80fd\u4f7f\u76ee\u6807\u51fd\u6570\u5145\u5206\u4e0b\u964d\uff08\u8bf7\u81ea\u884c\u641c\u7d22Wolfe\u6761\u4ef6\uff09\u7684\u201c\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u6b65\u957f\u201d\u3002 \u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u7684\u65b9\u6cd5\u6709\u5f88\u591a\uff08\u5982\u4e8c\u6b21\u63d2\u503c\u6cd5\u3001\u4e8c\u5206\u56de\u6eaf\u6cd5\u3001\u9ec4\u91d1\u5206\u5272\u6cd5\u7b49\uff09\uff0c\u4f46\u826f\u597d\u7684\u521d\u59cb\u5c1d\u8bd5\u6b65\u957f\\alpha_k^{(0)} \u5bf9\u7b97\u6cd5\u7a33\u5b9a\u6027\u548c\u6536\u655b\u901f\u5ea6\u7684\u5f71\u54cd\u5de8\u5927\u3002\u5b9e\u7528\u4e2d\u53ef\u57fa\u4e8e\u5f0f\\eqref{eq4}\u8fdb\u884c\u4e8c\u9636\u6cf0\u52d2\u5c55\u5f00\u5f97\u5230\u76ee\u6807\u51fd\u6570\u7684\u8fd1\u4f3c\u89e3\u6790\u8868\u8fbe\u5f0f\uff0c\u5982\u4e0b\uff1a  </p>  \\begin{align}  \\Phi(\\boldsymbol m_k + \\alpha \\boldsymbol d_k)      &amp;= \\Phi(\\boldsymbol m_k) + \\boldsymbol g_k^T \\boldsymbol s_k  + \\frac{1}{2} \\boldsymbol s_k^T \\boldsymbol B_k \\boldsymbol s_k \\\\     &amp;= \\Phi(\\boldsymbol m_k) + \\alpha \\boldsymbol g_k^T \\boldsymbol d_k  + \\frac{\\alpha ^ 2 }{2} \\boldsymbol d_k^T \\boldsymbol B_k \\boldsymbol d_k \\\\ \\end{align} \\tag{8}\\label{eq8}  <p>\u5bf9\\alpha\u6c42\u5bfc\u540e\u4ee3\u5165\u5f0f\\eqref{eq7}\uff0c\u5f97\u5230\uff1a  </p>  \\frac {\\partial \\Phi(\\boldsymbol m_k + \\alpha \\boldsymbol d_k)  } {\\partial {\\alpha}} = \\boldsymbol g_k^T \\boldsymbol d_k + \\alpha \\boldsymbol d_k^T \\boldsymbol B_k \\boldsymbol d_k = 0 \\tag{9}\\label{eq9}  <p>\u663e\u7136\uff0c\\alpha_k^{(0)}\u7684\u8868\u8fbe\u5f0f\u5982\u4e0b\uff1a  </p>  \\alpha_k^{(0)} = \\frac { - \\boldsymbol g_k^T \\boldsymbol d_k} {\\boldsymbol d_k^T \\boldsymbol B_k \\boldsymbol d_k}                 = \\frac { \\boldsymbol g_k^T \\boldsymbol g_k} {\\boldsymbol g_k^T \\boldsymbol B_k \\boldsymbol g_k} \\tag{10}\\label{eq10}  <p>\u5c0f\u8d34\u58eb\uff1a\u4ece\u5f0f\uff086\uff09\u548c\u5f0f\uff088\uff09\u4e2d\u4e0d\u96be\u770b\u51fa\uff0c\u4e0b\u964d\u65b9\u5411\u5fc5\u987b\u6ee1\u8db3\\boldsymbol g_k^T \\boldsymbol{d}_k &lt; 0\uff0c\u8fd9\u662f\u7ebf\u641c\u7d22\u6b65\u957f\u5b58\u5728\u4e14\u80fd\u8ba9\u76ee\u6807\u51fd\u6570\u51cf\u5c0f\u7684\u5fc5\u8981\u6761\u4ef6\u3002</p> <p>\u5f53\u7136\uff0c\u5f0f\\eqref{eq10}\u4e2d\u7684\\boldsymbol{B}_k\u4e5f\u96be\u4ee5\u6c42\u89e3\u4e14\u8ba1\u7b97\u7279\u522b\u8017\u65f6\u3002\u4f46\u9488\u5bf9\u4e0d\u540c\u7684\u5730\u7403\u7269\u7406\u95ee\u9898\uff0c\u5f80\u5f80\u6709\u5de7\u5999\u65b9\u6cd5\u8fdb\u884c\u5feb\u901f\u8fd1\u4f3c\u3002\u4f60\u53ef\u4ee5\u67e5\u770b\u300a\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684CG\u548cPCG\u65b9\u6cd5\u300b\u7684\u7b2c1\u8282\uff0c\u6b65\u957f\u8868\u8fbe\u5f0f\u4e0e\u5f0f\\eqref{eq10}\u76f8\u4f3c\u3002 \u68af\u5ea6\u6cd5\u7684\u672c\u8d28\u662f\u4e00\u9636\u6cf0\u52d2\u8fd1\u4f3c\uff0c\u5b9e\u7528\u95ee\u9898\u4e2d\u7531\u4e8e\u8fd9\u79cd\u903c\u8fd1\u8bef\u5dee\u8f83\u5927\uff0c\u5373\u4f7f\u5bf9\u4e8e\u4e00\u4e2a\u51f8\u51fd\u6570\uff0c\u53ea\u8981\u95ee\u9898\u7684\u6761\u4ef6\u6570\u5f88\u5927\uff0c\u68af\u5ea6\u6cd5\u5c31\u4f1a\u56e0\u8f83\u5dee\u7684\u521d\u59cb\u70b9\u800c\u51fa\u73b0\u9707\u8361\u73b0\u8c61\uff08\u89c1\u4e0a\u9762\u94fe\u63a5\u7684\u56fe1\uff09\u3002    </p> <p>\u5410\u69fd\uff1a\u66fe\u88ab\u67d0\u77e5\u540d\u53cd\u6f14\u4e13\u5bb6\u95ee\u5230Rodi\u57282001\u5e74\u53d1\u8868\u7684\u7ecf\u5178NLCG\u5927\u5730\u7535\u78c1\u53cd\u6f14\u8bba\u6587\u7684\u521d\u59cb\u6b65\u957f\u662f\u600e\u4e48\u6765\u7684\u3002\u6211\u8bf4\u8fd9\u96be\u9053\u4e0d\u662f\u975e\u5e38obvious\u7684\u5417\uff1f\u7136\u540e\u5c31\u5f97\u4e86\u4e2a\u9a84\u50b2\u81ea\u6ee1\u88c5\u8154\u4f5c\u52bf\u7684\u6076\u540d\u3002\uff08\u624b\u52a8\u644a\u624b\uff09 </p> <p>\u6211\u4eec\u65e0\u9700\u7ed9\u51fa\u5177\u4f53\u7684\u7b97\u6cd5\u6b65\u9aa4\u751a\u81f3\u6d41\u7a0b\u56fe\uff08\u540e\u6587\u4e5f\u4e00\u6837\uff09\uff0c\u56e0\u4e3a\u7ecf\u5178\u51f8\u4f18\u5316\u95ee\u9898\u7684\u6838\u5fc3\u95ee\u9898\u53ea\u6709\u4e24\u4e2a\u2014\u2014\u6b65\u957f\u548c\u4e0b\u964d\u65b9\u5411\uff0c\u5176\u5b83\u7684\u90fd\u5f88obvious\u3002\uff1a\uff09</p>"},{"location":"markdown/optimal_convex_optimis/#2-newton-method","title":"2. \u725b\u987f\u6cd5\uff08Newton Method\uff09","text":"<p>\u7b2c1\u8282\u8bc1\u660e\u4e86\u4e00\u9636\u6cf0\u52d2\u8fd1\u4f3c\u6761\u4ef6\u4e0b\uff0c\u76ee\u6807\u51fd\u6570\u4e0b\u964d\u6700\u5feb\u7684\u65b9\u5411\u5fc5\u987b\u548c\u68af\u5ea6\u65b9\u5411\u6210180\u5ea6\uff08\u8d1f\u68af\u5ea6\u65b9\u5411\uff09\uff0c\u8fd9\u662f\u975e\u5e38\u7c97\u7565\u7684\u4e00\u79cd\u4f30\u8ba1\u3002Obviously\uff0c\u4f60\u4e00\u5b9a\u4f1a\u60f3\u7528\u66f4\u9ad8\u9636\u7684\u6cf0\u52d2\u5c55\u5f00\u53bb\u8bd5\u8bd5\uff0c\u5c31\u50cf\u8fd9\u6837\uff1a  </p>  \\begin{align}  \\Phi(\\boldsymbol m_{k+1}) &amp;= \\Phi(\\boldsymbol m_k) + \\boldsymbol g_k^T (\\boldsymbol m_{k+1} - \\boldsymbol m_k) \\\\ &amp;+ \\frac{1}{2} (\\boldsymbol m_{k+1} - \\boldsymbol m_k)^T \\boldsymbol B_k (\\boldsymbol m_{k+1} - \\boldsymbol m_k) \\end{align} \\tag{11}\\label{eq11}  <p>\u548c\u68af\u5ea6\u6cd5\u7684\u5206\u6790\u8fc7\u7a0b\u4e0d\u540c\uff0c\u5f0f\\eqref{eq11}\u53f3\u8fb9\u6709\u4e09\u9879\uff1a\u53cd\u6f14\u95ee\u9898\u4e2d\u5927\u591a\u7b2c1\u30013\u9879\u4e3a\u6b63\uff0c\u7b2c2\u9879\u4e3a\u8d1f\u3002\u7531\u4e8e\u6a21\u578b\u4fee\u6b63\u91cf\\boldsymbol s_k = \\boldsymbol m_{k+1} - \\boldsymbol m_k\u5305\u542b\u5728\u7b2c3\u9879\u4e4b\u4e2d\uff0c\u6b64\u65f6\u8d1f\u68af\u5ea6\u65b9\u5411\u4e0d\u518d\u4fdd\u8bc1\u6700\u9ad8\u7684\u4e0b\u964d\u6548\u7387\u3002 \u9996\u5148\uff0c\\boldsymbol g_k^T \\boldsymbol s_k &lt; 0\u4ecd\u987b\u6ee1\u8db3\uff0c\u540c\u65f6\u8fd8\u8981\u8ba9\u7b2c3\u9879\u6570\u503c\u5c3d\u91cf\u7684\u5c0f\u3002 \u7cbe\u51c6\u7684\u63cf\u8ff0\u4e3a\uff1a\\boldsymbol s_k\u8ba9\u5f0f\\eqref{eq11}\u53d6\u6700\u5c0f\u503c\u7684\u5fc5\u8981\u6761\u4ef6\u4e3a\\Phi(\\boldsymbol{m}_{k+1})\u5bf9\\boldsymbol s_k\u7684\u504f\u5bfc\u6570\u4e3a0\u3002\u5373\uff1a  </p>  \\begin{align}  \\frac{ \\partial \\Phi (\\boldsymbol{m}_{k+1}) }      {\\partial \\boldsymbol s_k}      &amp;= \\frac{ \\partial \\Phi (\\boldsymbol{m}_k + \\boldsymbol{s}_k ) } {\\partial \\boldsymbol s_k} \\\\      &amp;= \\frac{ \\partial \\Phi (\\boldsymbol{m}_k) } {\\partial \\boldsymbol s_k} + \\frac{ \\partial  (\\boldsymbol{g}_k^T \\boldsymbol{s}_k) } {\\partial \\boldsymbol s_k}         + \\frac{1}{2} \\frac{ \\partial  (\\boldsymbol{s}_k^T \\boldsymbol{B}_k \\boldsymbol{s}_k) } {\\partial \\boldsymbol s_k} \\\\      &amp;= 0 + \\boldsymbol{g}_k + \\boldsymbol{B}_k \\boldsymbol{s}_k \\end{align} \\tag{12}\\label{eq12}  <p>\u6839\u636e\\eqref{eq12}\u53ef\u5f97\u5230\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff1a  </p>  \\boldsymbol{B}_k \\boldsymbol{s}_k = \\alpha_k \\boldsymbol{B}_k \\boldsymbol{d}_k = - \\boldsymbol{g}_k \\tag{13}\\label{eq13}  <p>\u7531\u4e8e\\alpha_k\u662f\u6807\u91cf\uff0c\u4e3a\u7b80\u5316\u95ee\u9898\u53ef\u89c4\u5b9a\\alpha_k = 1\uff08\u7ebf\u641c\u7d22\u7b80\u5355\u4e86\uff09\uff0c\u4e0b\u964d\u65b9\u5411\u53ef\u7528\u4ee5\u4e0b\u65b9\u7a0b\u6784\u5efa\uff1a  </p>  \\boldsymbol{B}_k \\boldsymbol{d}_k = - \\boldsymbol{g}_k \\tag{14}\\label{eq14}  <p>\\boldsymbol{d}_k = - \\boldsymbol{B}_k^{-1} \\boldsymbol{g}_k\u88ab\u79f0\u4e3a\u725b\u987f\u65b9\u5411\u6216\u725b\u987f\u6b65\uff0c\u5b83\u662f\u5982\u6b64\u725b\u903c\uff0c\u4ee5\u81f3\u4e8e\u5fc5\u987b\u7528\u725b\u903c\u7684\u7269\u7406\u5b66\u5bb6\u547d\u540d\uff0c\u4ee5\u5b83\u4e3a\u6838\u5fc3\u7684\u51f8\u4f18\u5316\u65b9\u6cd5\u5524\u4f5c\u201c\u725b\u987f\u6cd5\u201d\u3002\u7ebf\u6027\u4e8c\u6b21\u578b\u725b\u987f\u6cd5\u662f\u4e00\u6b65\u6536\u655b\u7684\uff0c\u975e\u7ebf\u6027\u95ee\u9898\u4e2d\u725b\u987f\u6cd5\u7684\u6548\u7387\uff08\u4ee5\u8fed\u4ee3\u6b21\u6570\u8861\u91cf\uff09\u666e\u904d\u8fdc\u9ad8\u4e8e\u68af\u5ea6\u6cd5\u3002 \u4f60\u53ef\u80fd\u4f1a\u7591\u60d1\uff1a \u65e2\u7136\u725b\u987f\u6cd5\u7684\u4e0b\u964d\u6548\u7387\u66f4\u5feb\uff0c\u90a3\u4e3a\u4ec0\u4e48\u8fd8\u8981\u628a\u8d1f\u68af\u5ea6\u65b9\u5411\u79f0\u4e3a\u201c\u6700\u901f\u4e0b\u964d\u65b9\u5411\u201d\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u201c\u8ddd\u79bb\u201d\u7684\u6982\u5ff5\u6709\u4e0d\u540c\u7684\u5b9a\u4e49\uff08\u5bf9\u5e94\u4e0d\u540c\u7684\u8303\u6570\uff09\uff0c\u6536\u655b\u901f\u5ea6\u662f\u8ddd\u79bb\u548c\u65f6\u95f4\u4e4b\u6bd4\uff0c\u8ddd\u79bb\u4e0d\u540c\u81ea\u7136\u901f\u5ea6\u4e0d\u540c\u3002 \u8d1f\u68af\u5ea6\u65b9\u5411\u57fa\u4e8e\u4e00\u9636\u8fd1\u4f3c\uff08\u76f4\u7ebf\u65b9\u7a0b\uff09\uff0c\u800c\u725b\u987f\u65b9\u5411\u57fa\u4e8e\u4e8c\u9636\u8fd1\u4f3c\uff08\u4e8c\u6b21\u66f2\u7ebf\uff09\uff0c\u5982\u679c\u771f\u5b9e\u76ee\u6807\u51fd\u6570\u7684\u5f62\u72b6\u4e3a\u7897\u72b6\uff0c\u8fdb\u884c\u6298\u7ebf\u8fd1\u4f3c\u65f6\u8981\u8d70\u66f4\u957f\u7684\u8def\u3002 \u68af\u5ea6\u6cd5\u4ee5\u66f2\u7ebf\u957f\u5ea6\u4e3a\u8ddd\u79bb\uff0c\u725b\u987f\u6cd5\u4ee5\u66f2\u7ebf\u5728\u6a21\u578b\u8f74\u4e0a\u7684\u6295\u5f71\u4e3a\u8ddd\u79bb\u3002\u6570\u5b66\u4e0a\u53ef\u89e3\u91ca\u4e3a\uff1a\u68af\u5ea6\u6cd5\u662f\u6b27\u5f0f\u8ddd\u79bb\uff08L2\u8303\u6570\uff09\u4e0b\u7684\u6700\u901f\u4e0b\u964d\uff0c\u800c\u725b\u987f\u6cd5\u662f\\boldsymbol{B}\u8303\u6570\u4e0b\u7684\u6700\u901f\u4e0b\u964d\u3002\u5f53\u7136\uff0c\u6b27\u5f0f\u8ddd\u79bb\u4e5f\u53ef\u8ba4\u4e3a\u662f\\boldsymbol{I}\u8303\u6570\uff0c\u8fd9\u6837\u4e8c\u8005\u5c31\u7edf\u4e00\u4e86\u3002\uff1a\uff09    </p> <p>\u5c0f\u8d34\u58eb\uff1a\u725b\u987f\u65b9\u5411\u5229\u7528\u6d77\u585e\u77e9\u9635\\boldsymbol{B}\u5bf9\u539f\u95ee\u9898\u7684\u7ebf\u6027\u7a7a\u95f4\u8fdb\u884c\u4e86\u4eff\u5c04\u53d8\u6362\uff0c\u6240\u4ee5\u6709\u4e00\u79cd\u8bf4\u6cd5\u662f\u725b\u987f\u6cd5\u662f\u68af\u5ea6\u6cd5\u7ecf\u8fc7\u201c\u7f29\u653e(scaling)\u201d\u540e\u7684\u6548\u679c\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u8ba9\u8d1f\u68af\u5ea6\u65b9\u5411\u5728\u5404\u5b50\u7ef4\u5ea6\u90fd\u6709\u6700\u4f73\u6b65\u957f\u3002 </p> <p>\u867d\u7136\u725b\u987f\u6cd5\u5f88\u725b\uff0c\u4f46\u6d77\u585e\u77e9\u9635\\boldsymbol{B}\u6709\u4e24\u4e2a\u7f3a\u9677\uff1a\uff081\uff09\u4e0d\u4fdd\u8bc1\u6b63\u5b9a\uff0c\u5bfc\u81f4\u5f0f\\eqref{eq14}\u4e0d\u4e00\u5b9a\u6709\u89e3\uff1b\uff082\uff09\u5730\u7403\u7269\u7406\u53cd\u95ee\u9898\u6d77\u585e\u77e9\u9635\u7684\u8ba1\u7b97\u548c\u5b58\u50a8\u6210\u672c\u8fc7\u5927\u3002\u7b2c\uff082\uff09\u4e2a\u95ee\u9898\u53ef\u8fdb\u884c\u201c\u9000\u5316\u201d\u5f0f\u903c\u8fd1\u4ee5\u5b9e\u7528\u5316\uff08\u53c2\u8003\u540e\u6587\uff09\uff0c\u7b2c\uff081\uff09\u4e2a\u95ee\u9898\u53ef\u80fd\u5b58\u5728\u4e24\u4e2a\u89e3\u51b3\u65b9\u6848\uff1a \u5176\u4e00\uff0c \u5f15\u5165\u8db3\u591f\u5927\u7684\u6b63\u6807\u91cf\\lambda\u4f7f\u77e9\u9635\\boldsymbol{B}_k + \\lambda \\boldsymbol{I}\u6b63\u5b9a\uff0c\u4e0b\u964d\u65b9\u5411\u53d8\u4e3a\\boldsymbol{d}_k = - (\\boldsymbol{B}_k + \\lambda \\boldsymbol{I})^{-1} \\boldsymbol{g}_k\uff0c\uff08\u6ce8\u610f\u8fd9\u91cc\u7684\\lambda\u662f\u4e0b\u964d\u65b9\u5411\u65b9\u7a0b\u6b63\u5219\u89e3\u7684\u6b63\u5219\u56e0\u5b50\uff0c\u800c\u975e\u6b63\u5219\u53cd\u6f14\u95ee\u9898\u7684\u6b63\u5219\u56e0\u5b50\uff09 \u7531\u4e8e\\lambda\u7684\u5f15\u5165\uff0c\u6b65\u957f\\alpha_k = 1\u53ef\u80fd\u5bfc\u81f4\u76ee\u6807\u51fd\u6570\u4e0a\u5347\uff0c\u9700\u4ee5\\alpha_k^{(0)}=1\u4e3a\u521d\u59cb\u5c1d\u8bd5\u6b65\u8fdb\u884c\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u6784\u5efa\u7a33\u5b9a\u8fed\u4ee3\u3002 \u4e5f\u53ef\u4ee4\u6b65\u957f\u4e0d\u53d8\u4f46\u968f\u8fed\u4ee3\u8c03\u6574\\lambda\u7684\u5927\u5c0f\uff0c\u82e5\u76ee\u6807\u51fd\u6570\u589e\u5927\u5c31\u51cf\u5c0f\\lambda\uff0c\u5426\u5219\u589e\u5927\\lambda\uff0c\u7531\u6b64\u53d1\u5c55\u51fa\u4e00\u4e2a\u65b0\u7b97\u6cd5\u4f53\u7cfb\u2014\u2014\u4fe1\u8d56\u57df\u65b9\u6cd5\u3002 \u5176\u4e8c\uff0c \u7528\u8fed\u4ee3\u6cd5\uff08\u5982CG\uff09\u6c42\\eqref{eq14}\u7684\u67d0\u4e2a\u622a\u65ad\u89e3\\boldsymbol{d}_k^*\uff0c\u914d\u5408\\alpha_k^{(0)}=1\u7684\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u5b8c\u6210\u53cd\u6f14\u8fed\u4ee3\u3002\u8fd9\u4e00\u6280\u5de7\u88ab\u79f0\u4e3a\u4e0d\u7cbe\u786e\u725b\u987f\u6cd5\uff08Inexact Newton Method\uff09\u6216\u622a\u65ad\u725b\u987f\u6cd5\uff08Truncated Newton Method\uff09\u3002 \u4f46\u65e0\u8bba\u5982\u4f55\u6539\u8fdb\uff0c\u5728\u5927\u578b\u5730\u7403\u7269\u7406\u53cd\u6f14\u95ee\u9898\u4e2d\uff0c\u7531\u4e8e\u8ba1\u7b97\u6210\u672c\u548c\u95ee\u9898\u590d\u6742\u6027\u7684\u9650\u5236\uff0c\u725b\u987f\u6cd5\u57fa\u672c\u65e0\u6cd5\u5b9e\u7528\u3002\u4f46\u4f60\u5148\u522b\u7740\u6025\u55b7\u6211\uff1a\u201c\u63a8\u5bfc\u90a3\u4e48\u4e45\uff0c\u641e\u4e86\u534a\u5929\u5f04\u4e2a\u6ca1\u7528\u7684\u7b97\u6cd5\u201d\u3002\u53ea\u6709\u719f\u77e5\u68af\u5ea6\u6cd5\u548c\u725b\u987f\u6cd5\u7684\u57fa\u672c\u539f\u7406\u624d\u80fd\u7406\u89e3\u5176\u5b83\u5b9e\u7528\u51f8\u4f18\u5316\u65b9\u6cd5\u4e3a\u4f55\u662f\u90a3\u4e2a\u6837\u5b50\uff0c\u6c99\u6ee9\u4e0a\u65e0\u6cd5\u5efa\u9ad8\u697c\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u5c31\u662f\u5730\u57fa\u3002  </p> <p>\u5410\u69fd\uff1a\u6709\u4eba\u5c45\u7136\u53c8\u53c8\u53c8\u53c8\u8981\u521b\u65b0\uff0c\u8bf4\u5982\u679c\u8fdb\u884c\u4e09\u9636\u56db\u9636\u6cf0\u52d2\u5c55\u5f00\u4e0d\u5c31\u53ef\u4ee5\u5f00\u53d1\u51fa\u66f4\u5feb\u7684\u7b97\u6cd5\u5417\uff1f\u6211\u4e00\u8138\u61f5\u903c\uff1a\u5927\u54e5\uff0c\u4e09\u9636\u5bfc\u56db\u9636\u5bfc\u5b58\u5728\u5417\uff1f\u7b97\u5b83\u4eec\u4e0d\u8981\u94b1\u554a\uff1f </p> <p>\u5c0f\u8d34\u58eb\uff1a\u68af\u5ea6\u6cd5\u548c\u725b\u987f\u6cd5\u5c31\u50cf\u7ebf\u6bb5\u7684\u4e24\u4e2a\u7aef\u70b9\uff0c\u5c31\u50cfC\u8bed\u8a00\u4e0eLisp\u8bed\u8a00\u662f\u7f16\u7a0b\u8bed\u8a00\u8bbe\u8ba1\u7684\u4e24\u4e2a\u7aef\u70b9\u4e00\u6837\uff0c\u4e2d\u95f4\u65b9\u6cd5\u6216\u4e2d\u95f4\u8bed\u8a00\u90fd\u5728\u7aef\u70b9\u4e4b\u95f4\u5bfb\u6c42\u8ba1\u7b97\u6210\u672c\u548c\u6536\u655b\u6548\u7387\u7684\u5e73\u8861\u3002 </p>"},{"location":"markdown/optimal_convex_optimis/#3-gauss-newton-methodgn","title":"3. \u9ad8\u65af\u725b\u987f\u6cd5\uff08Gauss-Newton Method\uff0cGN\uff09","text":"<p>\u725b\u987f\u6cd5\u5b9e\u73b0\u56f0\u96be\u662f\u56e0\u4e3a\u6d77\u585e\u77e9\u9635\u91cc\u9762\u6709\u4e8c\u9636\u504f\u5bfc\u3002\u4f46\u5982\u679c\u76ee\u6807\u51fd\u6570\u662f\u5982\u5f0f\\eqref{eq2}\u7684\u975e\u7ebf\u6027\u6700\u5c0f\u4e8c\u4e58\u5f62\u5f0f\uff0c\u5219\\boldsymbol{B}_k\u5b58\u5728\u4e00\u4e2a\u7279\u6b8a\u7684\u8fd1\u4f3c\u624b\u6bb5\u3002\u5047\u5b9a\u6a21\u578b\\boldsymbol{m}\u7684\u7ef4\u5ea6\u4e3aN\uff0c\u6570\u636e\\boldsymbol{b}\u7684\u7ef4\u5ea6\u4e3aM\uff0c\u90a3\u4e48\\boldsymbol{B}_k\u7684\u8868\u8fbe\u5f0f\u4e3a\uff1a  </p>  \\boldsymbol{B}_k =  \\begin{bmatrix}     { \\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_1^2} }         &amp; { \\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_1 \\partial m_2} }          &amp; {\\cdots}        &amp; {\\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_1 \\partial m_N} }  \\\\     {\\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_2 \\partial m_1} }         &amp; { \\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_2^2 } }          &amp; {\\cdots}        &amp; {\\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_2 \\partial m_N} }  \\\\     {\\vdots }  &amp; {\\vdots } &amp; {\\vdots } &amp; {\\vdots } \\\\     {\\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_N \\partial m_1} }         &amp; { \\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_N \\partial m_2 } }          &amp; {\\cdots}        &amp; {\\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_N^2} }  \\\\ \\end{bmatrix} \\tag{15}\\label{eq15}  <p>\u6ca1\u9519\uff0c\u5b83\u662f\u5bf9\u79f0\u77e9\u9635\u3002\u4e0d\u4f46\u5982\u6b64\uff0c\u5b83\u7684\u6bcf\u4e2a\u5143\u7d20B_{ij}\u8fd8\u53ef\u7edf\u4e00\u8868\u793a\u4e3a\uff1a  </p>  \\begin{align} B_{ij} &amp;=  \\frac {\\partial^2 \\Phi(\\boldsymbol{m}_k)} {\\partial m_i \\partial m_j}         = \\frac{1}{2} \\sum_{l=1}^{M} \\frac {\\partial^2  [F(\\boldsymbol{m}_k)_l - \\boldsymbol{b}_i]^2   } {\\partial m_i \\partial m_j} \\\\        &amp;= \\sum_{l=1}^{M} \\frac{\\partial \\{  [F(\\boldsymbol{m}_k)_l - \\boldsymbol{b}_i] \\frac{\\partial F(\\boldsymbol{m}_k)_l} {\\partial m_i} \\}} {\\partial m_j} \\\\        &amp;= \\sum_{l=1}^{M} \\{ \\frac{\\partial F(\\boldsymbol{m}_k)_l} {\\partial m_i} \\frac{\\partial F(\\boldsymbol{m}_k)_l} {\\partial m_j}           + \\frac{\\partial^2 F(\\boldsymbol{m}_k)_l} {\\partial m_i \\partial m_j}   [F(\\boldsymbol{m}_k)_l - \\boldsymbol{b}_i] \\} \\\\ \\end{align} \\tag{16}\\label{eq16}  <p>\u56fd\u9645\u60ef\u4f8b\uff0c\u5ffd\u7565\u4e8c\u9636\u504f\u5bfc\u9879\uff0c\u5f97\u5230\uff1a  </p>  \\hat{\\boldsymbol{B}_{ij}}  = \\sum_{l=1}^{M} \\frac{\\partial F(\\boldsymbol{m}_k)_l} {\\partial m_i} \\frac{\\partial F(\\boldsymbol{m}_k)_l} {\\partial m_j} \\approx \\boldsymbol{B}_{ij} \\tag{17}\\label{eq17}  <p>\u5982\u6b64\uff0c\\boldsymbol{B}_k\u4fbf\u7528\\hat{\\boldsymbol{B}_k}\u4ee3\u66ff\uff0c\u4e3a\u7b80\u5316\u8bb0\u53f7\uff0c\u7528\\partial F_l\u4f5c\u4e3a\\partial F(\\boldsymbol{m}_k)_l\u7684\u7b80\u5199\uff0c\u5219\u6709\uff1a  </p>  \\hat{\\boldsymbol{B}_k} =  \\begin{bmatrix}     { \\sum\\limits_{l=1}^{M} (\\frac{\\partial F_l} {\\partial m_1})^2  }         &amp; { \\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_1}  \\frac{\\partial F_l} {\\partial m_2}}          &amp; {\\cdots}        &amp; { \\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_1}  \\frac{\\partial F_l} {\\partial m_N} }  \\\\     {\\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_2}  \\frac{\\partial F_l} {\\partial m_1}  }         &amp; {\\sum\\limits_{l=1}^{M} (\\frac{\\partial F_l} {\\partial m_2})^2 }          &amp; {\\cdots}        &amp; { \\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_2}  \\frac{\\partial F_l} {\\partial m_N} }  \\\\     {\\vdots }  &amp; {\\vdots } &amp; {\\vdots } &amp; {\\vdots } \\\\     {\\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_N}  \\frac{\\partial F_l} {\\partial m_1}  }         &amp; { \\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_N}  \\frac{\\partial F_l} {\\partial m_2}}          &amp; {\\cdots}        &amp; { \\sum\\limits_{l=1}^{M} (\\frac{\\partial F_l} {\\partial m_N})^2 }  \\\\ \\end{bmatrix} \\tag{18}\\label{eq18}  <p>\u5f0f\\eqref{eq18}\u662f\u4e3b\u5bf9\u89d2\u5143\u4e0d\u5c0f\u4e8e0\u7684\u5bf9\u79f0N \\times N\u534a\u6b63\u5b9a\u77e9\u9635\uff0c\u4e14\u6bcf\u4e2a\u5143\u7d20\u90fd\u662fM\u9879\u504f\u5bfc\u4e58\u79ef\u7684\u6c42\u548c\u3002\u5b83\u53ef\u5199\u4e3a\\boldsymbol{J}_k^T \\boldsymbol{J}_k\u7684\u5f62\u5f0f\uff0c\u5176\u4e2d\\boldsymbol{J}_k\u662f\u4e00\u4e2aM \\times N\u77e9\u9635\uff0c\u5982\u4e0b\uff1a  </p>  \\boldsymbol{J}_k =  \\begin{bmatrix}     {  \\frac{\\partial F_1} {\\partial m_1}  }         &amp; { \\frac{\\partial F_1} {\\partial m_2} }          &amp; {\\cdots}        &amp; { \\frac{\\partial F_1} {\\partial m_N}  }  \\\\     {  \\frac{\\partial F_2} {\\partial m_1}  }         &amp; { \\frac{\\partial F_2} {\\partial m_2} }          &amp; {\\cdots}        &amp; { \\frac{\\partial F_2} {\\partial m_N}  }  \\\\     {\\vdots }  &amp; {\\vdots } &amp; {\\vdots } &amp; {\\vdots } \\\\     {  \\frac{\\partial F_M} {\\partial m_1}  }         &amp; { \\frac{\\partial F_M} {\\partial m_2} }          &amp; {\\cdots}        &amp; { \\frac{\\partial F_M} {\\partial m_N}  }  \\\\ \\end{bmatrix} \\tag{19}\\label{eq19}  <p>\u5c0f\u8d34\u58eb\uff1a\u8fd9\u4e2a\u795e\u5947\u7684\u504f\u5bfc\u6570\u77e9\u9635\\boldsymbol{J}_k\u662f\u7b2ck\u6b21\u8fed\u4ee3\u6b63\u6f14\u54cd\u5e94F(\\boldsymbol{m}_k)\u5bf9\u6a21\u578b\\boldsymbol{m}_k\u7684\u96c5\u53ef\u6bd4\uff08Jacobian\uff09\u77e9\u9635\uff0c\u4e5f\u88ab\u79f0\u4e3a\u7075\u654f\u5ea6\u77e9\u9635\u3002 </p> <p>\u5bf9\u4e8e\u975e\u7ebf\u6027\u6700\u5c0f\u4e8c\u4e58\u95ee\u9898\uff0c\u4e0d\u4ec5\u6d77\u585e\u77e9\u9635\u53ef\u4ee5\u7528\u96c5\u53ef\u6bd4\u77e9\u9635\u5185\u79ef\u8868\u793a\uff0c\u68af\u5ea6\\boldsymbol{g}_k\u4e5f\u53ef\u8868\u793a\u4e3a\u96c5\u53ef\u6bd4\u8f6c\u7f6e\u4e0e\u6b8b\u5dee\u5411\u91cf\u4e58\u79ef\uff0c\u5982\u4e0b\uff1a  </p>  \\boldsymbol{g}_k = \\boldsymbol{J}_k^T [F(\\boldsymbol{m}_k) - \\boldsymbol{b}] =  \\begin{bmatrix}     {  \\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_1} (F_l - b_l)  }  \\\\     {  \\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_2} (F_l - b_l)  } \\\\     {\\vdots }   \\\\     {  \\sum\\limits_{l=1}^{M} \\frac{\\partial F_l} {\\partial m_N} (F_l - b_l)  } \\\\ \\end{bmatrix} \\tag{20}\\label{eq20}  <p>\u5229\u7528\u5f0f\\eqref{eq14}\u725b\u987f\u6cd5\u4e0b\u964d\u65b9\u5411\u7684\u65b9\u7a0b\uff0c\u8fd1\u4f3c\u540e\u53ef\u5f97\u5230\uff1a  </p>   \\boldsymbol{J}_k^T \\boldsymbol{J}_k \\boldsymbol{d}_k = - \\boldsymbol{J}_k^T [F(\\boldsymbol{m}_k) - \\boldsymbol{b}] = - \\boldsymbol{g}_k \\tag{21}\\label{eq21}  <p>\u65b0\u65b9\u6cd5\u4e2d\\boldsymbol{d}_k = - (\\boldsymbol{J}_k^T \\boldsymbol{J}_k)^{-1} \\boldsymbol{J}_k^T [F(\\boldsymbol{m}_k) - \\boldsymbol{b}]\uff0c\u6b65\u957f\u540c\u725b\u987f\u6cd5\u4e00\u6837\u53d61\uff0c\u8fd9\u6837\u4fbf\u5f97\u51fa\u9ad8\u65af\u725b\u987f\u6cd5\uff08Gauss-Newton Method\uff0c\u7b80\u79f0GN\uff09\u3002  \u5f53\u7136\uff0c\u5728\u6709\u4e9b\u201c\u7ecf\u5178\u201d\u5730\u7403\u7269\u7406\u8bba\u6587\u91cc\uff0cGN\u65b9\u5411\u53ef\u80fd\u91c7\u7528\u53e6\u4e00\u79cd\u63a8\u5bfc\u65b9\u5f0f\u3002\u4ece\u504f\u5bfc\u6570\u5b9a\u4e49\u51fa\u53d1\uff0c\u5728\\boldsymbol{d}_k\u201c\u8db3\u591f\u5c0f\u201d\u65f6\uff0c\u5b58\u5728F(\\boldsymbol{m}_k + \\boldsymbol{d}_k) = F(\\boldsymbol{m}_k) + \\boldsymbol{J}_k \\boldsymbol{d}_k\u7684\u8fd1\u4f3c\uff0c\u6781\u5c0f\u70b9\u5fc5\u8981\u6761\u4ef6\u4e3a\uff1a  </p>   \\frac{\\partial \\Phi(\\boldsymbol{m}_{k+1})}{\\partial \\boldsymbol{m}_{k+1}}     = [F(\\boldsymbol{m}_k + \\boldsymbol{d}_k) - \\boldsymbol{b}]\\frac{\\partial F(\\boldsymbol{m}_{k+1})}{\\partial \\boldsymbol{m}_{k+1}} = 0 \\tag{22}\\label{eq22}  <p>\u663e\u7136\uff0c\u82e5\u53f3\u8fb9\u7684\u4e00\u9636\u504f\u5bfc\u9879\u4e0d\u4e3a0\uff0c\u5219\u8981\u6c42\u6b8b\u5dee\u5411\u91cf\u4e3a0\uff0c\u5373\uff1a  </p>   F(\\boldsymbol{m}_k + \\boldsymbol{d}_k) - \\boldsymbol{b} = F(\\boldsymbol{m}_k) + \\boldsymbol{J}_k \\boldsymbol{d}_k - \\boldsymbol{b}= 0 \\tag{23}\\label{eq23}  <p>\u4e5f\u5c31\u662f\uff1a  </p>    \\boldsymbol{J}_k \\boldsymbol{d}_k = - [F(\\boldsymbol{m}_k)  - \\boldsymbol{b}] \\tag{24}\\label{eq24}  <p>\u56e0\u4e3a\\boldsymbol{J}_k\u4e0d\u662f\u65b9\u9635\uff0c\u6240\u4ee5\u5728\u65b9\u7a0b\u4e24\u8fb9\u5de6\u4e58\\boldsymbol{J}_k^T\u4ee5\u6c42\u53d6\\boldsymbol{d}_k\u7684\u7ebf\u6027\u6700\u5c0f\u4e8c\u4e58\u89e3\uff0c\u4ece\u800c\u5f97\u5230\u5f0f\\eqref{eq21}\u3002  </p> <p>\u5410\u69fd\uff1a\u6211\u4e2a\u4eba\u4e0d\u559c\u6b22\u7b2c\u4e8c\u4e2a\u63a8\u5bfc\u65b9\u5f0f\uff0c\u56e0\u4e3a\u5f0f\\eqref{eq23}\u7528\u5411\u91cf\u5dee\u4ee3\u66ff\u4e86\u504f\u5fae\u5206\uff0c\u800c\u4ece\u725b\u987f\u6cd5\u964d\u9636\u903c\u8fd1\u53bb\u7406\u89e3\u53ef\u4ee5\u660e\u786e\u5f97\u77e5\u8fd9\u79cd\u8fd1\u4f3c\u5728\u4f55\u79cd\u60c5\u51b5\u4e0b\u6210\u7acb\u3002\u663e\u7136\u5bf9\u4e8e\u5f0f\\eqref{eq16}\u800c\u8a00\uff0cGN\u8fd1\u4f3c\u6210\u7acb\u7684\u6761\u4ef6\u662f\u4e8c\u9636\u504f\u5bfc\u9879\u6c42\u548c\u7684\u6570\u503c\u5fc5\u987b\u5c3d\u91cf\u5c0f\u4e8e\u5176\u5b83\u9879\u7684\u6c42\u548c\u3002 </p> <p>GN\u8fd9\u4e2a\u540d\u5b57\u628a\u6570\u5b66\u5927\u7237\u9ad8\u65af\u548c\u4f1f\u5927\u7684\u725b\u7235\u7237\u653e\u5230\u4e00\u8d77\uff0c\u8db3\u4ee5\u8868\u660e\u8fd9\u4e00\u7b97\u6cd5\u76f8\u5f53\u725b\u903c\uff0c\u5177\u4f53\u8868\u73b0\u4e3a\uff1a\uff081\uff09\u6d77\u585e\u903c\u8fd1\u7684\u4e3b\u5bf9\u89d2\u5143\u4e00\u5b9a\u4e0d\u5c0f\u4e8e0\uff1b\uff082\uff09\u5145\u5206\u5229\u7528\u4e86\u975e\u7ebf\u6027\u6700\u5c0f\u4e8c\u4e58\u7684\u7279\u6027\uff1b\uff083\uff09\u4e0d\u9700\u8ba1\u7b97\u4e8c\u9636\u504f\u5bfc\uff0c\u7d55\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u6536\u655b\u6548\u7387\u548c\u725b\u987f\u6cd5\u76f8\u5f53\uff1b\uff084\uff09\u5373\u4f7f\u539f\u95ee\u9898\u4e8c\u9636\u504f\u5bfc\u9879\u6c42\u548c\u540e\u6570\u503c\u5f88\u5927\uff0cGN\u65b9\u5411\u914d\u5408\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u4ecd\u7136\u80fd\u7a33\u5b9a\u6536\u655b\u3002 \u4e0d\u8fc7\u5bf9\u4e8e\u66f4\u5927\u89c4\u6a21\u7684\u95ee\u9898\uff0c\u663e\u5f0f\u8ba1\u7b97\u5e76\u5b58\u50a8\\boldsymbol{J}_k\u548c\\boldsymbol{J}_k^T \\boldsymbol{J}_k\u4ecd\u4e0d\u53ef\u63a5\u53d7\uff08\u4f55\u51b5\u8fd8\u8981\u6c42\u9006\uff09\uff0c\u800c\u6709\u4e9b\u5730\u7403\u7269\u7406\u95ee\u9898\u53ef\u7528\u9690\u5f0f\u65b9\u6cd5\u9ad8\u6548\u5c0f\u5185\u5b58\u5730\u8fed\u4ee3\u6c42\u89e3\u65b9\u7a0b\\eqref{eq21}\uff08\u5982\u5927\u5730\u7535\u78c1\u6cd5\uff09\u5f97\u5230 \\boldsymbol{d}_k\u7684\u622a\u65ad\u89e3\uff0c\u8fd9\u79cd\u65b9\u6cd5\u88ab\u79f0\u4e3a\u622a\u65ad\u9ad8\u65af\u725b\u987f\u6cd5\uff08TGN\uff09\u6216\u4e0d\u7cbe\u786e\u9ad8\u65af\u725b\u987f\u6cd5\uff08IGN\uff09\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u82e5\\boldsymbol{J}_k^T \\boldsymbol{J}_k\u4e0d\u6b63\u5b9a\uff0c\u5728\u663e\u5f0fGN\u65b9\u6cd5\u4e2d\uff0c\u4ecd\u7136\u53ef\u4ee5\u50cf\u725b\u987f\u6cd5\u4e00\u6837\u5f15\u5165\\boldsymbol{J}_k^T \\boldsymbol{J}_k + \\lambda \\boldsymbol{I}\u505a\u6b63\u5b9a\u5316\u5904\u7406\uff0c\u8fdb\u800c\u5f97\u51fa\u4e00\u4e2a\u975e\u5e38\u51fa\u540d\u7684\u4fe1\u8d56\u57df\u65b9\u6cd5\uff0c\u88ab\u79f0\u4e3a\u5217\u6587\u4f2f\u683c-\u9a6c\u594e\u7279\u6cd5\uff08Levenberg-Marquardt method\uff0c\u7b80\u79f0L-M\uff09\uff0c\u8be8\u540d\u5524\u4f5c\u963b\u5c3c\u6700\u5c0f\u4e8c\u4e58\u6cd5\u3002 </p>"},{"location":"markdown/optimal_convex_optimis/#4-quasi-newton-methodqn","title":"4. \u62df\u725b\u987f\u6cd5\uff08Quasi-Newton Method\uff0cQN\uff09","text":"<p>\u867d\u7136GN\u65b9\u6cd5\u5df2\u7ecf\u8db3\u591f\u725b\u903c\uff0c\u4f46\u5b83\u53ea\u4fdd\u8bc1\u975e\u7ebf\u6027\u6700\u5c0f\u4e8c\u4e58\u95ee\u9898\u7684\u6709\u6548\u6027\uff0c\u5e76\u4e14\u6d89\u53ca\u96c5\u53ef\u6bd4\u77e9\u9635\u7684\u590d\u6742\u8ba1\u7b97\u3002\u4e8e\u662f\u4eba\u4eec\u5f00\u59cb\u5bfb\u627e\u66f4\u666e\u9002\u3001\u66f4\u5feb\u6377\u7684\u725b\u987f\u6cd5\u903c\u8fd1\u5f62\u5f0f\u3002 \u5f53\u7136\uff0c\u6211\u4eec\u4ecd\u7136\u8981\u4ece\u6cf0\u52d2\u5c55\u5f00\u8fd9\u4e2a\u795e\u5947\u7684\u4e1c\u897f\u51fa\u53d1\u3002\u6309\u7167\u56fd\u9645\u60ef\u4f8b\uff0c\u6211\u4eec\u5148\u7167\u6284\u5f0f\\eqref{eq12}\uff0c\u4e0d\u8fc7\u52a0\u5165\u4e86\u4e00\u70b9\u5c0f\u5c0f\u6539\u53d8\uff0c\u73b0\u5728\u8981\u7528\\boldsymbol{m}_k\u7684\u76ee\u6807\u51fd\u6570\u53bb\u903c\u8fd1\\Phi(\\boldsymbol{m}_{k-1})\uff0c\u6709\uff1a  </p>  \\begin{align}  \\Phi(\\boldsymbol{m}_{k-1})      &amp; \\approx \\Phi(\\boldsymbol m_k) + \\boldsymbol g_k^T (\\boldsymbol{m}_{k-1} - \\boldsymbol{m}_k)  \\\\     &amp; + \\frac{1}{2} (\\boldsymbol{m}_{k-1} - \\boldsymbol{m}_k)^T \\boldsymbol B_k (\\boldsymbol{m}_{k-1} - \\boldsymbol{m}_k)   \\\\ \\end{align} \\tag{25}\\label{eq25}  <p>\u4e24\u8fb9\u5bf9\\boldsymbol{m}_{k-1}\u6c42\u504f\u5bfc\uff0c\u4ee4\\boldsymbol{y}_{k} = \\boldsymbol{g}_{k+1} - \\boldsymbol{g}_{k}\u5f97\u5230\uff1a  </p>  \\begin{align} \\frac{\\partial \\Phi(\\boldsymbol{m}_{k-1}) }{\\partial \\boldsymbol{m}_{k-1}} = \\boldsymbol{g}_{k-1}     &amp; \\approx  \\boldsymbol{g}_k  +  \\boldsymbol{B}_k (\\boldsymbol{m}_{k-1} - \\boldsymbol{m}_k) \\\\ \\Rightarrow  \\boldsymbol{g}_{k-1} - \\boldsymbol{g}_{k}       &amp; \\approx   \\boldsymbol{B}_k (\\boldsymbol{m}_{k-1} - \\boldsymbol{m}_k) \\\\ \\Rightarrow  \\boldsymbol{g}_{k} - \\boldsymbol{g}_{k-1}       &amp; \\approx    \\boldsymbol{B}_k (\\boldsymbol{m}_{k} - \\boldsymbol{m}_{k-1}) \\\\ \\Rightarrow  \\boldsymbol{y}_{k-1}       &amp; \\approx    \\boldsymbol{B}_k \\boldsymbol{s}_{k-1} \\end{align} \\tag{26}\\label{eq26}  <p>\u628a\u7ea6\u7b49\u4e8e\u6539\u4e3a\u7b49\u4e8e\uff08\u5e38\u89c4\u64cd\u4f5c\uff09\uff0c\u6839\u636e\u9012\u63a8\u5173\u7cfb\uff0c\u725b\u987f\u6cd5\u7b2ck+1\u6b21\u8fed\u4ee3\u6ee1\u8db3\u4ee5\u4e0b\u65b9\u7a0b\uff1a  </p>  \\begin{align} &amp; \\boldsymbol{B}_{k+1}  \\boldsymbol{s}_{k} = \\boldsymbol{y}_{k} \\\\ &amp; \\boldsymbol{H}_{k+1}  \\boldsymbol{y}_{k} = \\boldsymbol{s}_{k}     \\end{align} \\tag{27}\\label{eq27}  <p>\u5176\u4e2d\uff0c\\boldsymbol{H}=\\boldsymbol{B}^{-1}\uff0c\u5f0f\\eqref{eq27}\u88ab\u79f0\u4e3a\u62df\u725b\u987f\uff08Quasi-Newton\uff09\u6761\u4ef6\uff0c\u5b83\u5efa\u7acb\u4e86\u5f53\u524d\u8fed\u4ee3\u7684\u6d77\u585e\u77e9\u9635\u4e0e\u4e0a\u4e00\u6b21\u8fed\u4ee3\u4fe1\u606f\uff08\u6a21\u578b\u4fee\u6b63\u91cf\u548c\u68af\u5ea6\u6539\u53d8\u91cf\uff09\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4f7f\u5f97\u5229\u7528\u4e4b\u524d\u8fed\u4ee3\u7684\u4fe1\u606f\u903c\u8fd1\u5f53\u524d\u8fed\u4ee3\u7684\u6d77\u585e\u77e9\u9635\u53d8\u5f97\u53ef\u80fd\u3002 \u57fa\u4e8e\u62df\u725b\u987f\u6761\u4ef6\uff08\u8fd9\u662f\u4e2a\u5fc5\u8981\u6761\u4ef6\uff09\u903c\u8fd1\\boldsymbol{H}\u548c\\boldsymbol{B}\u7684\u65b9\u6cd5\u88ab\u79f0\u4e3a\u62df\u725b\u987f\u6cd5\uff08QN\uff09\u3002\u548cQuasi\u7684\u5b57\u9762\u610f\u601d\u5bf9\u5e94\uff0c QN\u65b9\u6cd5\u5b9e\u9645\u4e0a\u662f\u4e00\u7c7b\u65b9\u6cd5\u7684\u7edf\u79f0\u3002\u6709\u4e00\u4e9bQN\u7b97\u6cd5\u5bf9\\boldsymbol{H}\u903c\u8fd1\u5e76\u53ef\u9ad8\u6548\u8ba1\u7b97\u5b83\u548c\u540c\u7ef4\u5217\u5411\u91cf\u7684\u4e58\u79ef\uff0c\u975e\u5e38\u9002\u5e94\u5927\u89c4\u6a21\u6700\u4f18\u5316\u95ee\u9898\u3002  </p>"},{"location":"markdown/optimal_convex_optimis/#41-sr1","title":"4.1 SR1\u7b97\u6cd5","text":"<p>SR1\u7684\u5168\u79f0\u4e3a\u5bf9\u79f0\u79e9-1\uff08Symmetric Rank-1\uff09\u65b9\u6cd5\uff0c\u5b83\u5bf9\u6d77\u585e\u7684\u903c\u8fd1\u65b9\u5f0f\u6bd4\u8f83\u7b80\u5355\uff0c\u5982\u4e0b\uff1a  </p>  \\hat{\\boldsymbol{H}}_{k+1} = \\hat{\\boldsymbol{H}}_{k} + \\Delta  \\hat{\\boldsymbol{H}}_{k} = \\hat{\\boldsymbol{H}}_{k} + \\beta  \\boldsymbol{u} \\boldsymbol{u}^T \\tag{28}\\label{eq28}  <p>\u6ce8\u610f\uff0c\u8fd9\u91cc\u6211\u4eec\u5728\u77e9\u9635\u7b26\u53f7\u4e0a\u52a0\u4e86\u4e00\u4e2a\u5c16\u5e3d\u5b50\u4ee5\u8868\u660e\u5bf9\u6d77\u585e\u6216\u5176\u9006\u77e9\u9635\u7684\u903c\u8fd1\u3002\u5f0f\\eqref{eq28}\u5728\u7b2c0\u6b21\u8fed\u4ee3\u53d6\\hat{\\boldsymbol{H}}_0 = \\boldsymbol{I}\uff0c\u4e4b\u540e\u6240\u6709\u6b21\u8fed\u4ee3\u7684\\boldsymbol{H}\u4ece\u7f16\u7a0b\u89d2\u5ea6\u5747\u53ef\u89c6\u4e3a\u4e0d\u65ad\u66f4\u65b0\u5f97\u5230\u7684\uff0c\u6545\u800c\u540e\u6587\u7684\u6240\u6709QN\u7b97\u6cd5\u4e5f\u88ab\u6210\u4e3a\u201c\u67d0\u67d0\u66f4\u65b0\u516c\u5f0f\u201d\u3002 SR1\u540d\u5b57\u4e2d\u7684S\u8868\u793a\u5bf9\u79f0\uff0c\u8981\u6c42\u66f4\u65b0\u540e\\Delta  \\hat{\\boldsymbol{H}}_{k}\u4fdd\u6301\u5bf9\u79f0\u6027\uff1b\u800cR1\u7684\u610f\u601d\u5219\u662f\u8868\u793a\u79e9-1\u66f4\u65b0\uff0c\u56e0\u4e3a\\Delta \\hat{\\boldsymbol{H}}_{k}=\\beta \\boldsymbol{u} \\boldsymbol{u}^T\uff0c\u5411\u91cf\\boldsymbol{u}\u4e58\u4ee5\u5b83\u7684\u8f6c\u7f6e\u540e\u5f97\u5230\u7684\u5bf9\u79f0\u9635\u7684\u79e9\u5f53\u7136\u662f1\u3002  </p> <p>\u5410\u69fd\uff1a\u6211\u4e2a\u4eba\u8ba4\u4e3aSR1\u8fd9\u4e2a\u540d\u5b57\u6781\u5176\u8d34\u5207\uff0c\u5176\u5b83QN\u65b9\u6cd5\u7684\u53d1\u660e\u4eba\u663e\u7136\u60f3\u4e0d\u51fa\u66f4\u597d\u7684\u540d\u5b57\uff0c\u53ea\u597d\u7528\u53d1\u660e\u4eba\u7684\u59d3\u540d\u9996\u5b57\u6bcd\u8fde\u8d77\u6765\u3002\uff1a\uff09 </p> <p>\u8da3\u95fb\uff1aSR1\u662fWilliam C. Davidon\u57281956\u5e74\u63d0\u51fa\u7684\uff0c\u4f46\u7531\u4e8e\u4ed6\u7684\u8bba\u6587\u91cc\u6ca1\u6709\u505a\u7b97\u6cd5\u6536\u655b\u6027\u5206\u6790\uff0c\u5bfc\u81f4\u88ab\u65e0\u60c5\u62d2\u7a3f\u3002\u56e0\u6b64SR1\u6ca1\u80fd\u6210\u4e3a\u516c\u8ba4\u7684\u7b2c\u4e00\u4e2aQN\u7b97\u6cd5\u3002\u5ba1\u7a3f\u5927\u4eba\u725b\u903c\uff08\u9707\u58f0\uff09\uff01 </p> <p>\u4e3a\u5f97\u51fa\u6807\u91cf\\beta\u548c\u5411\u91cf\\boldsymbol{u}\u7684\u8868\u8fbe\u5f0f\uff0c\u9996\u5148\u5728\u5f0f\\eqref{eq28}\u4e24\u8fb9\u540c\u65f6\u4e58\u4ee5\\boldsymbol{y}_{k}\uff0c\u518d\u4ee3\u5165\u5f0f\\eqref{eq27}\uff0c\u5373\uff1a  </p>  \\begin{align} \\hat{\\boldsymbol{H}}_{k+1} \\boldsymbol{y}_{k}     &amp;= \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}     + \\beta \\boldsymbol{u} \\boldsymbol{u}^T \\boldsymbol{y}_{k}= \\boldsymbol{s}_{k} \\\\ \\Rightarrow \\beta \\boldsymbol{u} (\\boldsymbol{u}^T \\boldsymbol{y}_{k})     &amp;= \\beta  (\\boldsymbol{u}^T \\boldsymbol{y}_{k}) \\boldsymbol{u}      = \\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k} \\\\ \\end{align} \\tag{29}\\label{eq29}  <p>\u7531\u4e8e\\boldsymbol{u}^T \\boldsymbol{y}_{k}\u662f\u6807\u91cf\uff08\u6240\u4ee5\u4e0a\u5f0f\u62ec\u53f7\u5185\u7684\u4e1c\u897f\u80fd\u5de6\u53f3\u79fb\u52a8\uff09\uff0c\\beta \\boldsymbol{u}^T \\boldsymbol{y}_{k}\u4e5f\u662f\u6807\u91cf\uff0c\u6240\u4ee5\uff1a  </p>  \\boldsymbol{u} = \\frac{\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}}{\\beta \\boldsymbol{u}^T \\boldsymbol{y}_{k}} \\tag{30}\\label{eq30}  <p>\u4ee4\\gamma = 1 / (\\beta \\boldsymbol{u}^T \\boldsymbol{y}_{k})\uff0c\u628a\u5f0f\\eqref{eq30}\u518d\u4ee3\u5165\u5f0f\\eqref{eq29}\uff0c\u5373\uff1a  </p>  \\begin{align} \\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}         &amp;= \\beta  \\boldsymbol{u} \\boldsymbol{u}^T \\boldsymbol{y}_{k}   \\\\        &amp;= \\beta \\gamma^2 (\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}) (\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T \\boldsymbol{y}_{k}  \\\\        &amp;= [\\beta \\gamma^2 (\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T \\boldsymbol{y}_{k} ](\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}) \\end{align} \\tag{31}\\label{eq31}  <p>\u663e\u7136\uff0c\u82e5\u5f0f\\eqref{eq31}\u6210\u7acb\uff0c\u5219\u8981\u6c42\u4e2d\u62ec\u53f7\u5185\u7684\u6807\u91cf\u503c\u4e3a1\uff0c\u5373\uff1a  </p>  \\beta \\gamma^2 = \\frac{1}{(\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T \\boldsymbol{y}_{k}} \\tag{32}\\label{eq32}  <p>\u5c06\u5f0f\\eqref{eq32}\u7ee7\u7eed\u56de\u4ee3\u5230\u5f0f\\eqref{eq28}\uff0c\u5229\u7528\u4e00\u6837\u7684\u5957\u8def\u53ef\u5f97\u5230\uff1a  </p>  \\begin{align} \\hat{\\boldsymbol{H}}_{k+1}      &amp;= \\hat{\\boldsymbol{H}}_{k} + \\beta  \\boldsymbol{u} \\boldsymbol{u}^T \\\\     &amp;= \\hat{\\boldsymbol{H}}_{k} + \\beta \\gamma^2 (\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}) (\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T\\\\     &amp;= \\hat{\\boldsymbol{H}}_{k} + \\frac{(\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}) (\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T}{(\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T \\boldsymbol{y}_{k}}  \\end{align} \\tag{33}\\label{eq33}  <p>\u5f0f\\eqref{eq33}\u5373\\boldsymbol{H}\u7684SR1\u66f4\u65b0\u516c\u5f0f\u3002\u8bbe\u5b9a\\hat{\\boldsymbol{H}}_{0} = \\boldsymbol{I}\uff0c\u968f\u7740\u8fed\u4ee3\u8fdb\u884c\uff0c\u903c\u8fd1\u4f1a\u8d8a\u6765\u8d8a\u7cbe\u786e\u3002\u4f46\u4e0d\u8981\u9ad8\u5174\u592a\u65e9\uff0cSR1\u5e76\u4e0d\u4fdd\u8bc1\\boldsymbol{H}_{k}\u6b63\u5b9a\uff0c\u8fd9\u53ef\u80fd\u8fdd\u53cd\\boldsymbol{H}_{k}^{-1} = \\boldsymbol{B}_{k}\u7684\u89c4\u5b9a\uff08\u81ea\u52a8\u644a\u624b\uff09\u3002\u6240\u4ee5\u4eba\u4eec\u5f00\u59cb\u5bfb\u627e\u5bf9\u79f0\u6b63\u5b9a\u7684\u79e9-2\u66f4\u65b0\u516c\u5f0f\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u4f60\u53ef\u80fd\u4f1a\u62c5\u5fc3\u5927\u89c4\u6a21\u95ee\u9898\u4e2d\u6d77\u585e\u9006\u77e9\u9635\u9700\u8981\u6d88\u8017\u5de8\u91cf\u5185\u5b58\uff0c\u4f46\u5b9e\u7528\u4e2d\u51e0\u4e4e\u6240\u6709\u7684QN\u7b97\u6cd5\u90fd\u5b58\u5728\u66f4\u7ecf\u6d4e\u3001\u9ad8\u6548\u7684\u8ba1\u7b97\\boldsymbol{H}\u6216\\boldsymbol{B}\u4e0e\u540c\u7ef4\u5217\u5411\u91cf\u7684\u4e58\u79ef\u7684\u6280\u5de7\uff0c\u8bf7\u53c2\u8003Byrd\u548cNocedal\u7b49\u4eba\u4e8e1994\u5e74\u53d1\u8868\u7684\u6587\u7ae0\u300aRepresentation of quasi-Newton matrices and their use in limited memory methods\u300b\u3002 </p>"},{"location":"markdown/optimal_convex_optimis/#42-dfp","title":"4.2 DFP\u7b97\u6cd5","text":"<p>\u4ece\u73b0\u5728\u5f00\u59cb\uff0cQN\u7b97\u6cd5\u7684\u547d\u540d\u5c31\u5f00\u59cb\u65e0\u5398\u5934\u4e86\uff0cDFP\u662f\u7b97\u6cd5\u53d1\u660e\u4ebaDavidon\u3001Fletcher\u548cPowell\u4e09\u4e2a\u4eba\u7684\u540d\u5b57\u9996\u5b57\u6bcd\u6392\u5217\uff0c\u662f\u7b2c\u4e00\u4e2a\u201c\u516c\u8ba4\u201d\u7684QN\u65b9\u6cd5\u3002\u5176\u57fa\u672c\u601d\u60f3\u548cSR1\u5dee\u4e0d\u591a\uff0c\u4e0d\u540c\u5728\u4e8e\u5f15\u5165\u4e86\u6b63\u5b9a\u79e9-2\u66f4\u65b0\u3002\u66f4\u65b0\u516c\u5f0f\u4e3a\uff1a  </p>  \\hat{\\boldsymbol{H}}_{k+1} =  \\hat{\\boldsymbol{H}}_{k} + \\beta  \\boldsymbol{u} \\boldsymbol{u}^T + \\gamma \\boldsymbol{v} \\boldsymbol{v}^T \\tag{34}\\label{eq34}  <p>\u548cSR1\u4e00\u6837\u7684\u5957\u8def\uff0c\u5148\u4e24\u8fb9\u540c\u65f6\u4e58\u4ee5\\boldsymbol{y}_k\uff0c\u5f97\u5230\uff1a  </p>  \\begin{align} \\hat{\\boldsymbol{H}}_{k+1} \\boldsymbol{y}_k      &amp;= \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_k + \\beta  \\boldsymbol{u} \\boldsymbol{u}^T \\boldsymbol{y}_k + \\gamma \\boldsymbol{v} \\boldsymbol{v}^T \\boldsymbol{y}_k = \\boldsymbol{s}_k  \\\\ \\Rightarrow  \\boldsymbol{s}_k - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_k      &amp;= \\beta  \\boldsymbol{u} \\boldsymbol{u}^T \\boldsymbol{y}_k + \\gamma \\boldsymbol{v} \\boldsymbol{v}^T \\boldsymbol{y}_k  \\end{align} \\tag{35}\\label{eq35}  <p>\u79e9-2\u66f4\u65b0\u7ed9\u4e88\\Delta \\hat{\\boldsymbol{H}}_{k}\u66f4\u5927\u7684\u81ea\u7531\u5ea6\uff0c\\beta\u3001\\gamma\u3001\\boldsymbol{u}\u548c\\boldsymbol{v}\u4e0d\u518d\u50cfSR1\u90a3\u6837\u901a\u8fc7\u4e00\u987f\u9a9a\u64cd\u4f5c\u6c42\u51fa\u552f\u4e00\u89e3\uff0c\u9700\u8981\u9996\u5148\u8fdb\u884c\u4e00\u4e9b\u89c4\u5b9a\u3002 DFP\u65b9\u6cd5\u89c4\u5b9a\\boldsymbol{u}=\\boldsymbol{s}_k\uff0c\\boldsymbol{v}=\\boldsymbol{H}_k \\boldsymbol{y}_k\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u89c4\u5b9a\uff0c\u9b3c\u624d\u77e5\u9053\u3002\u4e0d\u8981\u95ee\u4e3a\u4ec0\u4e48\uff0c\u95ee\u5c31\u662f\u4e3a\u4e86\u63a8\u5bfc\u65b9\u4fbf\uff0c\u516c\u5f0f\u7b80\u5355\u4e14\u6536\u655b\u6027\u597d\u8bc1\u660e\u3002\uff1a\uff08  \u4f46\u5373\u4fbf\u8fd9\u6837\u89c4\u5b9a\u540e\uff0c\\beta\u548c\\gamma\u4ecd\u7136\u6c42\u4e0d\u51fa\u6765\uff0c\u4e8e\u662f\u66f4\u9a9a\u7684\u624b\u6bb5\u51fa\u73b0\u4e86\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5e72\u8106\u518d\u4ee4\\beta \\boldsymbol{u} \\boldsymbol{u}^T \\boldsymbol{y}_k= \\boldsymbol{s}_k, \\gamma \\boldsymbol{v} \\boldsymbol{v}^T \\boldsymbol{y}_k= - \\boldsymbol{H}_k \\boldsymbol{y}_k\u3002 \u5f88\u660e\u663e\uff0c\u8fd9\u5b8c\u5168\u662f\u5728\u51d1\u3002\u4f46\u201c\u51d1\u201d\u8fd9\u4e2a\u8bcd\u513f\u5728\u6570\u5b66\u4e0a\u5f80\u5f80\u8fd8\u6709\u4e2a\u9ad8\u5927\u4e0a\u7684\u540c\u4e49\u8bcd\u2014\u2014\u201c\u6784\u9020\u201d\u3002\u4e8b\u5b9e\u4e0a\uff0c\u53ea\u9700\u8981\u51d1\u51fa\u6765\u7684\u4e1c\u897f\u6ee1\u8db3\u5f0f\\eqref{eq27}\u7684QN\u6761\u4ef6\uff0c\u4e14\u80fd\u8bc1\u660e\u7b97\u6cd5\u6536\u655b\uff0c\u90a3\u4e48\u5b83\u5c31\u662f\u4e00\u79cd\u6709\u6548\u7684QN\u65b9\u6cd5\uff0c\u8fd9\u4e5f\u662f\u6700\u4f18\u5316\u9886\u57df\u6c34\u6587\u7ae0\u7684\u5957\u8def\u3002 \u5b9e\u9645\u4e0a\uff0cDFP\u516c\u5f0f\u8fd8\u6709\u53e6\u5916\u4e00\u4e2a\u63a8\u5bfc\u65b9\u5f0f\uff0c\u4e0d\u8fc7\u592a\u590d\u6742\u4e86\uff0c\u57fa\u672c\u601d\u60f3\u662f\u6c42\u5982\u4e0b\u7ea6\u675f\u6700\u5c0f\u5316\u95ee\u9898\uff1a  </p>  \\begin{align} &amp; \\mathop{\\min}\\limits_{\\hat{\\boldsymbol{H}}} \\Vert \\boldsymbol{W}^{-T} (\\hat{\\boldsymbol{H}} - \\hat{\\boldsymbol{H}}_k) \\boldsymbol{W}^{-1}  \\Vert \\\\ &amp; \\mathrm{s.t. } \\hat{\\boldsymbol{H}} = \\hat{\\boldsymbol{H}}^T, \\hat{\\boldsymbol{H}} \\boldsymbol{y}_k = \\boldsymbol{s}_k\\\\ \\end{align}  <p>\u524d\u6587\u7684\u89c4\u5b9a\u521a\u597d\u6ee1\u8db3\u4e0a\u5f0f\u7684\u4e00\u4e2a\u7279\u89e3\uff0c\u8fd9\u91cc\u6211\u4eec\u4e0d\u6267\u62d7\u4e8e\u6570\u5b66\u5bb6\u5df2\u7ecf\u8bc1\u660e\u7684\u7ed3\u8bba\uff0c\u7ee7\u7eed\u5f80\u540e\u63a8\u5bfc\u3002\u9996\u5148\u9488\u5bf9\u5411\u91cf\\boldsymbol{u}\uff0c\u5982\u4e0b\uff1a  </p>  \\begin{align}  &amp; \\boldsymbol{u} = \\boldsymbol{s}_k = \\beta \\boldsymbol{u} \\boldsymbol{u}^T \\boldsymbol{y}_k = (\\beta \\boldsymbol{u}^T \\boldsymbol{y}_k) \\boldsymbol{u}\\\\  &amp; \\Rightarrow  \\beta \\boldsymbol{u}^T \\boldsymbol{y}_k = 1 \\\\  &amp; \\Rightarrow  \\beta = \\frac{1}{\\boldsymbol{u}^T \\boldsymbol{y}_k} = \\frac{1}{\\boldsymbol{s}_k^T \\boldsymbol{y}_k}   \\end{align} \\tag{36}\\label{eq36}  <p>\u518d\u5206\u6790\u5bf9\\boldsymbol{v}\u7684\u5047\u8bbe\uff0c\u5f97\u5230\uff1a  </p>  \\begin{align}  &amp; \\boldsymbol{v} = \\boldsymbol{H}_k \\boldsymbol{y}_k = - \\gamma \\boldsymbol{v} \\boldsymbol{v}^T \\boldsymbol{y}_k = - (\\gamma \\boldsymbol{v}^T \\boldsymbol{y}_k) \\boldsymbol{v} \\\\  &amp; \\Rightarrow  \\gamma \\boldsymbol{v}^T \\boldsymbol{y}_k = -1 \\\\  &amp; \\Rightarrow  \\gamma = - \\frac{1}{\\boldsymbol{v}^T \\boldsymbol{y}_k} = - \\frac{1}{\\boldsymbol{y}_k^T \\boldsymbol{H}_k^T \\boldsymbol{y}_k} = - \\frac{1}{\\boldsymbol{y}_k^T \\boldsymbol{H}_k \\boldsymbol{y}_k}  \\end{align} \\tag{37}\\label{eq37}  <p>\u5c06\u51d1\u51fa\u6765\u7684\\beta\u3001\\gamma\u3001\\boldsymbol{u}\u548c\\boldsymbol{v}\u4ee3\u5165\u5f0f\\eqref{eq34}\uff0c\u5f97\u5230\uff1a  </p>  \\begin{align}  \\hat{\\boldsymbol{H}}_{k+1}      &amp;= \\hat{\\boldsymbol{H}}_{k} + \\beta  \\boldsymbol{u} \\boldsymbol{u}^T + \\gamma \\boldsymbol{v} \\boldsymbol{v}^T \\\\     &amp;= \\hat{\\boldsymbol{H}}_{k} + \\frac{ \\boldsymbol{s}_k \\boldsymbol{s}_k^T}{\\boldsymbol{s}_k^T \\boldsymbol{y}_k }                                   - \\frac{ \\boldsymbol{H}_k \\boldsymbol{y}_k \\boldsymbol{y}_k^T \\boldsymbol{H}_k^T  }{\\boldsymbol{y}_k^T \\boldsymbol{H}_k \\boldsymbol{y}_k } \\\\     &amp;= \\hat{\\boldsymbol{H}}_{k} + \\frac{ \\boldsymbol{s}_k \\boldsymbol{s}_k^T}{\\boldsymbol{s}_k^T \\boldsymbol{y}_k }                                   - \\frac{ \\boldsymbol{H}_k \\boldsymbol{y}_k \\boldsymbol{y}_k^T \\boldsymbol{H}_k  }{\\boldsymbol{y}_k^T \\boldsymbol{H}_k \\boldsymbol{y}_k } \\\\ \\end{align} \\tag{38}\\label{eq38}  <p>DFP\u7b97\u6cd5\u4e00\u7ecf\u63a8\u51fa\u5373\u53d7\u5230\u5173\u6ce8\uff0c\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u79e9-2\u7684QN\u7b97\u6cd5\uff0c\u5b83\u5373\u4fdd\u8bc1\u4e86\u903c\u8fd1\u9635\u7684\u6b63\u5b9a\u6027\uff0c\u53c8\u5177\u6709\u6781\u597d\u7684\u6536\u655b\u6027\u3002\u4f46\u5f88\u5feb\u6709\u4eba\u51d1\u51fa\u6765\u4e86\u66f4\u597d\u7684QN\u66f4\u65b0\u516c\u5f0f\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u4f60\u53ef\u80fd\u4f1a\u6000\u7591\u4f1a\u4e0d\u4f1a\u6709\u79e9-3\u7684QN\u66f4\u65b0\u516c\u5f0f\u3002\u4f46\u5982\u679c\u6ce8\u610f\u5230\\boldsymbol{u}\u548c\\boldsymbol{v}\u5206\u522b\u662f\u5173\u4e8e\\boldsymbol{s}\u548c\\boldsymbol{y}\u7684\u8868\u8fbe\u5f0f\u4e4b\u540e\uff0c\u6211\u60f3\u4f60\u6709\u53ef\u80fd\u4f1a\u6253\u6d88\u8fd9\u4e2a\u5ff5\u5934\uff0c\u9664\u975e\u4e0a\u4e00\u6b21\u8fed\u4ee3\u9664\u4e86\u6a21\u578b\u4fee\u6b63\u91cf\u3001\u68af\u5ea6\u6539\u53d8\u91cf\u8fd8\u80fd\u63d0\u4f9b\u5176\u5b83\u7684\u6709\u7528\u4fe1\u606f\u3002\u4f46\u6211\u4e0d\u6392\u9664\u79e9-3\u66f4\u65b0\u5b58\u5728\u7684\u53ef\u80fd\u6027\uff0c\u795d\u4f60\u6210\u529f\uff01\uff08\u574f\u7b11\uff09 </p>"},{"location":"markdown/optimal_convex_optimis/#43-bfgs","title":"4.3 BFGS\u7b97\u6cd5","text":"<p>BFGS\u7684\u540d\u5b57\u7ee7\u7eed\u53d1\u626c\u65e0\u5398\u5934\u98ce\u683c\uff0c\u5b83\u7684\u56db\u4e2a\u53d1\u660e\u4eba\u662fBroyden\u3001Fletcher\u3001Goldfarb\u548cShanno\uff0c\u8fd9\u91cc\u6211\u4eec\u4ece\\boldsymbol{B}\u7684\u66f4\u65b0\u8fdb\u884c\u63a8\u5bfc\uff0c\u56e0\u4e3a\u516c\u5f0f\u4f1a\u7b80\u5355\u5f88\u591a\uff0c\u800c\u4e14\u548cDFP\u65b9\u6cd5\u6709\u4e00\u79cd\u795e\u79d8\u7684\u8054\u7cfb\uff08\u89c1\u7b2c4.4\u8282\uff09\u3002\u66f4\u65b0\u516c\u5f0f\u8fd9\u6837\u6784\u9020\uff1a  </p>  \\hat{\\boldsymbol{B}}_{k+1} =  \\hat{\\boldsymbol{B}}_{k} + \\beta  \\boldsymbol{u} \\boldsymbol{u}^T + \\gamma \\boldsymbol{v} \\boldsymbol{v}^T \\tag{39}\\label{eq39}  <p>\u89c4\u5b9a\\boldsymbol{u} = \\boldsymbol{y}_k\u548c\\boldsymbol{v} = \\boldsymbol{B}_k \\boldsymbol{s}_k\uff0c\u7ecf\u8fc7\u548cDFP\u7b97\u6cd5\u4e00\u6837\u7684\u63a8\u5bfc\u8fc7\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a  </p>   \\hat{\\boldsymbol{B}}_{k+1}      = \\hat{\\boldsymbol{B}}_{k}      + \\frac{ \\boldsymbol{y}_k \\boldsymbol{y}_k^T}{\\boldsymbol{y}_k^T \\boldsymbol{s}_k }       - \\frac{ \\boldsymbol{B}_k \\boldsymbol{s}_k \\boldsymbol{s}_k^T \\boldsymbol{B}_k  }{\\boldsymbol{s}_k^T \\boldsymbol{B}_k \\boldsymbol{s}_k } \\\\ \\tag{40}\\label{eq40}  <p>\u8fd9\u4e2a\u516c\u5f0f\u548cDFP\u66f4\u65b0\u516c\u5f0f\u975e\u5e38\u76f8\u4f3c\uff0c\u4e3a\u9a8c\u8bc1\u5b83\u548cDFP\u4e0d\u662f\u4e00\u79cd\u7b97\u6cd5\uff0c\u4e0d\u59a8\u5bf9\u5f0f\\eqref{eq40}\u6c42\u9006\u5f97\u5230\\hat{\\boldsymbol{H}}_{k+1}\u7684BFGS\u66f4\u65b0\u516c\u5f0f\u3002\u5728\u6b64\u4e4b\u524d\u9700\u8981\u5f15\u5165Shermann-Morison-Woodbury\u6c42\u9006\u5b9a\u7406\uff1a \u5bf9\u4e8e\u53ef\u9006\u7684N \\times N\u77e9\u9635\\boldsymbol{A}\u548c\u4e24\u4e2aN \\times 1\u5411\u91cf\\boldsymbol{u}\u548c\\boldsymbol{v}\uff0c\u4e0b\u5f0f\u6210\u7acb\uff1a  </p>   (\\boldsymbol{A} + \\boldsymbol{u} \\boldsymbol{v}^T )^{-1}      = \\boldsymbol{A}^{-1}      - \\frac{\\boldsymbol{A}^{-1} \\boldsymbol{u} \\boldsymbol{v}^T \\boldsymbol{A}^{-1}}            {1 + \\boldsymbol{v}^T \\boldsymbol{A}^{-1} \\boldsymbol{u}} \\tag{41}\\label{eq41}  <p>\u5bf9\u5f0f\\eqref{eq40}\u5d4c\u5957\u4f7f\u7528\u4e24\u6b21Shermann-Morison-Woodbury\u6c42\u9006\u516c\u5f0f\uff0c\u518d\u7ecf\u8fc7\u4e00\u987f\u66b4\u8e81\u7684\u6f14\u7b97\u4e4b\u540e\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a  </p>   \\hat{\\boldsymbol{H}}_{k+1}      = \\hat{\\boldsymbol{H}}_{k}      + (1+\\frac{ \\boldsymbol{y}_k^T \\boldsymbol{H}_k \\boldsymbol{y}_k} {\\boldsymbol{s}_k^T \\boldsymbol{y}_k } ) \\frac{ \\boldsymbol{s}_k \\boldsymbol{s}_k^T}{\\boldsymbol{y}_k^T \\boldsymbol{s}_k }       - \\frac{ \\boldsymbol{s}_k \\boldsymbol{y}_k^T \\boldsymbol{H}_k + \\boldsymbol{H}_k \\boldsymbol{y}_k \\boldsymbol{s}_k^T } {\\boldsymbol{s}_k^T \\boldsymbol{y}_k } \\\\ \\tag{42}\\label{eq42}  <p>\u663e\u7136BFGS\u548cDFP\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u4e24\u4e2aQN\u65b9\u6cd5\uff0c\u5b9e\u8df5\u8bc1\u660eBFGS\u6bd4DFP\u76f8\u5bf9\u66f4\u4e3a\u9ad8\u6548\u548c\u7a33\u5b9a\u3002  </p>"},{"location":"markdown/optimal_convex_optimis/#44-sr1dfpbfgsbroyden","title":"4.4 SR1\u3001DFP\u548cBFGS\u7684\u5173\u7cfb\u4ee5\u53caBroyden\u65cf\u7b97\u6cd5","text":"<p>\u5728SR1\u7b97\u6cd5\u4e2d\uff0c\u5982\u679c\\hat{\\boldsymbol{H}}_{k+1}\u6b63\u5b9a\uff0c\u5bf9\u5f0f\\eqref{eq33}\u4e5f\u5e94\u7528Shermann-Morison-Woodbury\u6c42\u9006\u516c\u5f0f\uff0c\u53ef\u5f97\uff1a  </p>   \\hat{\\boldsymbol{B}}_{k+1}      = \\hat{\\boldsymbol{B}}_{k}      + \\frac{(\\boldsymbol{y}_k - \\boldsymbol{B}_k \\boldsymbol{s}_k)(\\boldsymbol{y}_k - \\boldsymbol{B}_k \\boldsymbol{s}_k)^T}            {(\\boldsymbol{y}_k - \\boldsymbol{B}_k \\boldsymbol{s}_k)^T \\boldsymbol{s}_k} \\tag{43}\\label{eq43}  <p>\u5c06\u5f0f\\eqref{eq33}\u3001\u5f0f\\eqref{eq43}\u3001\u5f0f\\eqref{eq38}\u548c\u5f0f\\eqref{eq40}\u5199\u5230\u4e00\u8d77\u4f1a\u53d1\u73b0\u4e00\u4e2a\u7279\u522b\u6709\u8da3\u7684\u73b0\u8c61\uff0c\u6570\u5b66\u5bb6\u89c9\u5f97\u8fd9\u201c\u7f8e\u5f97\u5f88\u201d\uff08\u9655\u897f\u8bdd\uff09\uff1a  </p>  \\begin{align}  \\hat{\\boldsymbol{H}}_{k+1}^{SR1}     &amp;= \\hat{\\boldsymbol{H}}_{k}      + \\frac{(\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k}) (\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T}            {(\\boldsymbol{s}_{k} - \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k})^T \\boldsymbol{y}_{k}}  \\\\  \\hat{\\boldsymbol{B}}_{k+1}^{SR1}     &amp;= \\hat{\\boldsymbol{B}}_{k}      + \\frac{(\\boldsymbol{y}_k - \\boldsymbol{B}_k \\boldsymbol{s}_k)(\\boldsymbol{y}_k - \\boldsymbol{B}_k \\boldsymbol{s}_k)^T}            {(\\boldsymbol{y}_k - \\boldsymbol{B}_k \\boldsymbol{s}_k)^T \\boldsymbol{s}_k} \\\\  \\hat{\\boldsymbol{H}}_{k+1}^{DFP}      &amp;= \\hat{\\boldsymbol{H}}_{k} + \\frac{ \\boldsymbol{s}_k \\boldsymbol{s}_k^T}{\\boldsymbol{s}_k^T \\boldsymbol{y}_k }                                   - \\frac{ \\boldsymbol{H}_k \\boldsymbol{y}_k \\boldsymbol{y}_k^T \\boldsymbol{H}_k  }{\\boldsymbol{y}_k^T \\boldsymbol{H}_k \\boldsymbol{y}_k } \\\\  \\hat{\\boldsymbol{B}}_{k+1}^{BFGS}      &amp;= \\hat{\\boldsymbol{B}}_{k}      + \\frac{ \\boldsymbol{y}_k \\boldsymbol{y}_k^T}{\\boldsymbol{y}_k^T \\boldsymbol{s}_k }       - \\frac{ \\boldsymbol{B}_k \\boldsymbol{s}_k \\boldsymbol{s}_k^T \\boldsymbol{B}_k  }{\\boldsymbol{s}_k^T \\boldsymbol{B}_k \\boldsymbol{s}_k } \\\\ \\end{align} \\tag{44}\\label{eq44}  <p>\u53ef\u89c1\uff0cSR1\u66f4\u65b0\u516c\u5f0f\u7684\\boldsymbol{H}\u548c\\boldsymbol{B}\u5f62\u5f0f\u5177\u6709\u4e00\u6837\u7684\u7ed3\u6784\uff0c\u53ea\u662f\u4e92\u6362\u4e86\\boldsymbol{s}\u548c\\boldsymbol{y}\u7684\u4f4d\u7f6e\u5e76\u628a\\boldsymbol{H}\u66ff\u6362\u4e3a\\boldsymbol{B}\u3002 DFP\u548cBFGS\u66f4\u65b0\u7684\u4e24\u4e2a\u516c\u5f0f\u4e92\u6362\u89c4\u5f8b\u7c7b\u4f3c\u3002\u56e0\u6b64\uff0c\u6570\u5b66\u5bb6\u79f0SR1\u7b97\u6cd5\u81ea\u5bf9\u5076\uff0c\u800cDFP\u548cBFGS\u7b97\u6cd5\u4e92\u4e3a\u5bf9\u5076\uff0c\u4f46DFP\u548cBFGS\u90fd\u4e0d\u662f\u81ea\u5bf9\u5076\u3002 \u7531\u4e8eDFP\u548cBFGS\u90fd\u662f\u4e24\u4e2a\u51d1\u51fa\u6765\u7684\u66f4\u65b0\u516c\u5f0f\uff0c\u6570\u5b66\u4e0a\u65e0\u6cd5\u8bc1\u660e\u8c01\u66f4\u597d\uff0c\u4e8e\u662f\u6709\u4e9b\u8d2a\u5fc3\u9b3c\u628a\u4e24\u4e2a\u7b97\u6cd5\u5408\u4e8c\u4e3a\u4e00\uff0c\u53d6\u4e00\u6b63\u6570\\phi \\in [0,1]\uff0c\u5f97\u5230\u65b0\u7684\u52a0\u6743\u66f4\u65b0\u516c\u5f0f\uff1a  </p>   \\hat{\\boldsymbol{B}}_{k+1}^{\\phi} = \\hat{\\boldsymbol{B}}_{k+1}^{DFP} + (1-\\phi_k)  \\hat{\\boldsymbol{B}}_{k+1}^{BFGS} \\tag{45}\\label{eq45}  <p>\u8ba9\\phi_k\u5728[0,1]\u4e2d\u904d\u5386\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u7cfb\u5217\\hat{\\boldsymbol{B}}_{k+1}^{\\phi_k}\uff0c\u6240\u6709\u7684\\hat{\\boldsymbol{B}}_{k+1}^{\\phi_k}\u7ec4\u6210\u7684\u96c6\u5408\u88ab\u79f0\u4e3aBroyden\u65cf\uff08\u8fd9\u4e2a\u540d\u5b57\u4e5f\u5f88\u65e0\u5398\u5934\uff09\u3002\u7531\u4e8ePDF\u548cBFGS\u90fd\u662f\u6b63\u5b9a\u66f4\u65b0\uff0cBroyden\u65cf\u7684\u6240\u6709\u66f4\u65b0\u77e9\u9635\u4e5f\u90fd\u4fdd\u6301\u6b63\u5b9a\u3002  </p>"},{"location":"markdown/optimal_convex_optimis/#45-bfgslbfgs","title":"4.5 \u6709\u9650\u5185\u5b58\u7684BFGS\uff08LBFGS\uff09","text":"<p>\u7b2c4.1\uff5e4.4\u8282\u7684\u6240\u6709\u7b97\u6cd5\u867d\u7136\u90fd\u6709\u538b\u7f29\u5185\u5b58\u7684\u5b9e\u73b0\u6280\u5de7\uff0c\u4f46\u53ea\u8981\u95ee\u9898\u89c4\u6a21\u53d8\u5f97\u5f88\u5927\uff0c\u7531\u4e8e\u66f4\u65b0\u516c\u5f0f\u9700\u4fdd\u5b58\u4e4b\u524d\u6240\u6709\u6b21\u8fed\u4ee3\u7684\\boldsymbol{u}\u548c\\boldsymbol{v}\u5411\u91cf\uff08\u6216\u8005\u5b58\u50a8\u6574\u4e2a\u6d77\u585e\u77e9\u9635\uff09\uff0c\u8ba1\u7b97\u6210\u672c\u4ecd\u7136\u53d8\u5f97\u4e0d\u53ef\u63a5\u53d7\u3002 \u56e0\u6b64\uff0c\u4e00\u4e2a\u5728\u5927\u89c4\u6a21\u6700\u4f18\u5316\u95ee\u9898\u4e2d\u5e94\u7528\u6700\u5e7f\u6cdb\u7684\u9000\u5316\u7248BFGS\u66f4\u65b0\u516c\u5f0f\u57281980\u5e74\u88abNocedal\u63d0\u51fa\uff0c\u53eb\u505a\u6709\u9650\u5185\u5b58BFGS\u7b97\u6cd5\uff08Limited-memory BFGS\uff0c\u7b80\u79f0LBFGS\uff09\u3002   LBFGS\u57fa\u4e8e\u4e00\u4e2aObvious\u7684\u4e8b\u5b9e\uff0c\u5f71\u54cd\u7b2ck\u6b21\u8fed\u4ee3\u6d77\u585e\u77e9\u9635\u903c\u8fd1\u6548\u679c\u7684\u5173\u952e\u6210\u5206\u4e00\u5b9a\u662f\u6700\u4e34\u8fd1\u7684\u524dm\u6b21\u8fed\u4ee3\u4fe1\u606f\uff08\u4e00\u822c\u53d63 \\leq m \\leq 20\uff09\u3002\u4e3a\u4e86\u63a8\u5bfcLBFGS\uff0c\u9996\u5148\u628aBFGS\u66f4\u65b0\u516c\u5f0f\\eqref{eq39}\u6539\u5199\u4e3a\uff1a  </p>  \\hat{\\boldsymbol{B}}_{k+1}^{BFGS} =  \\hat{\\boldsymbol{B}}_{k}^{(0)} + \\sum\\limits_{i=0}^{k} [\\boldsymbol{a}_i \\boldsymbol{a}_i^T - \\boldsymbol{b}_i \\boldsymbol{b}_i^T] \\tag{46}\\label{eq46}  <p>\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u548cSR1\u4e00\u6837\uff0c\u8bbe\u5b9a\\hat{\\boldsymbol{B}}_{k}^{(0)} = \\boldsymbol{I}\uff08\u4e0b\u4e00\u8282\u4f1a\u7ed9\u51fa\u66f4\u597d\u7684\u65b9\u6cd5\uff09\uff0c \u6839\u636e\u516c\u5f0f\\eqref{eq39}\u53ef\u77e5\uff0c\\boldsymbol{a}_i\u548c\\boldsymbol{b}_i\u53ef\u7528\u4ee5\u4e0b\u516c\u5f0f\u6c42\u53d6\u5e76\u5b58\u50a8(\u6ce8\uff1a\u7b26\u53f7:=\u8868\u793a\u7f16\u7a0b\u4e2d\u7684\u8d4b\u503c)\uff1a  </p>  \\begin{align}     &amp; \\boldsymbol{a}_i := \\frac{\\boldsymbol{y}_i}{\\sqrt{\\boldsymbol{y}_i^T \\boldsymbol{s}_i}}   \\\\     &amp; \\boldsymbol{b}_i := \\hat{\\boldsymbol{B}}_{i} \\boldsymbol{s}_i                         = \\hat{\\boldsymbol{B}}_{k}^{(0)} \\boldsymbol{s}_i                         +  \\sum\\limits_{i=0}^{k} [ (\\boldsymbol{a}_i^T \\boldsymbol{s}_i) \\boldsymbol{a}_i + (\\boldsymbol{b}_i^T \\boldsymbol{s}_i) \\boldsymbol{b}_i  ]  \\\\     &amp; \\boldsymbol{b}_i := \\frac{\\hat{\\boldsymbol{B}}_{i} \\boldsymbol{s}_i} {\\sqrt{\\boldsymbol{s}_i^T \\hat{\\boldsymbol{B}}_{i} \\boldsymbol{s}_i}}                        = \\frac{\\boldsymbol{b}_i}{\\sqrt{\\boldsymbol{s}_i^T  \\boldsymbol{b}_i}}  \\\\ \\end{align} \\tag{47}\\label{eq47}  <p>\u6240\u8c13LBFGS\uff0c\u5c31\u662f\u6700\u591a\u53ea\u4fdd\u5b58\u6700\u8fd1m\u6b21\u8fed\u4ee3\u7684\u6a21\u578b\u4fee\u6b63\u91cf\u548c\u68af\u5ea6\u6539\u53d8\u91cf(\u4e0d\u8db3m\u6b21\u8fed\u4ee3\u50bb\u5b50\u90fd\u77e5\u9053\u600e\u4e48\u529e)\\{\\boldsymbol{s}_{k-1}, \\boldsymbol{s}_{k-2}, \\cdots, \\boldsymbol{s}_{k-m}\\} \u548c\\{\\boldsymbol{y}_{k-1}, \\boldsymbol{y}_{k-2}, \\cdots, \\boldsymbol{y}_{k-m}\\}\uff0c\u5e76\u53ea\u7528\u8fd9\u4e9b\u4fe1\u606f\u5f97\u5230\u66f4\u65b0\u516c\u5f0f\uff0c\u5b83\u53ef\u5229\u7528\u516c\u5f0f\\eqref{eq46}\u6539\u5199\u5f97\u5230\uff1a  </p>  \\hat{\\boldsymbol{B}}_{k+1}^{LBFGS} =  \\hat{\\boldsymbol{B}}_{k+1}^{(0)} + \\sum\\limits_{i=p}^{k} [\\boldsymbol{a}_i \\boldsymbol{a}_i^T - \\boldsymbol{b}_i \\boldsymbol{b}_i^T],  p = max(k-m+1, 0) \\tag{48}\\label{eq48}  <p>\u5c0f\u8d34\u58eb\uff1a\u672c\u6587\u7684\u63a8\u5bfc\u65b9\u5f0f\u548cNocedal\u4e0d\u540c\uff0c\u7ecf\u5178LBFGS\u662f\u76f4\u63a5\u903c\u8fd1\u6d77\u585e\u9006\u77e9\u9635\\boldsymbol{H}\u7684\uff0c\u5e76\u4e14\u8fd9\u4f4d\u8001\u5148\u751f\u8fd8\u63a8\u5bfc\u51fa\u4e86\u4e00\u4e2a\u725b\u903c\u514b\u62c9\u65af\u7684\u53cc\u5faa\u73af\u9012\u5f52\u7b97\u6cd5\uff0c\u53ef\u76f4\u63a5\u9ad8\u6548\u8ba1\u7b97\\boldsymbol{H}\u548c\u68af\u5ea6\u5411\u91cf\u7684\u4e58\u79ef\uff0c\u6c42\u4e0b\u964d\u65b9\u5411\u7684\u901f\u5ea6\u51e0\u4e4e\u548cNLCG\u7b97\u6cd5\u5dee\u4e0d\u591a\u3002\u8fd9\u6d3b\u5e72\u5f97......\u8ba9\u540e\u4eba\u7edd\u4e86\u521b\u65b0\u7684\u5ff5\u5934\u3002 </p>"},{"location":"markdown/optimal_convex_optimis/#46-self-scalingbfgslbfgs","title":"4.6 \u81ea\u8c03\u8282(self-scaling)\u7684BFGS\u548cLBFGS","text":"<p>\u7b2c4.5\u8282\u7684BFGS\u66f4\u65b0\u548cLBFGS\u66f4\u65b0\u90fd\u4ece\u5355\u4f4d\u9635\\boldsymbol{I}\u5f00\u59cb\uff0c\u5728\u8fed\u4ee3\u65e9\u671f\u7684\u903c\u8fd1\u6548\u679c\u8f83\u5dee\uff0c\u4ece\u800c\u5bfc\u81f4\u6536\u655b\u8f83\u6162\u6216\u4e0d\u7a33\u5b9a\u3002 \u56e0\u6b64Shanno\uff08\u9999\u519c\uff01\u6ca1\u9519\uff0c\u53c8\u662f\u4ed6\uff01\uff09\u548cPhua\u4e8e1975\u5e74\u63d0\u51fa\u4e00\u79cd\u6539\u8fdb\u65b9\u6cd5\uff0c \u5176\u601d\u60f3\u662f\u6bcf\u6b21\u8fed\u4ee3\u90fd\u4ece\u4e00\u4e2a\u7ecf\u8fc7\u6807\u91cf\u7f29\u653e\u7684\\sigma_k \\boldsymbol{I}\u77e9\u9635\u91cd\u65b0\u5efa\u7acb\u903c\u8fd1\u3002\u539f\u8bba\u6587\u662f\u4eceBroyden\u65cf\u7684\\boldsymbol{H}\u66f4\u65b0\u63a8\u5bfc\u7684\uff0c\u770b\u5f97\u6211\u4e00\u8138\u61f5\u903c\uff0c\u8fd9\u91cc\u6211\u7528\u81ea\u5df1\u7684\u63a8\u5bfc\u65b9\u5f0f\uff0c\u7248\u6743\u6240\u6709\uff0c\u7231\u770b\u4e0d\u770b\u3002\uff1a\uff09 \u65e0\u8bba\u662fBFGS\u8fd8\u662fLBFGS\uff0c\u6d77\u585e\u66f4\u65b0\u53ef\u7edf\u4e00\u5199\u4e3a\uff1a  </p>  \\hat{\\boldsymbol{B}}_{k+1} =  \\hat{\\boldsymbol{B}}_{k} + \\Delta \\hat{\\boldsymbol{B}}_{k} \\tag{49}\\label{eq49}  <p>\u5728\u7b2c0\u6b21\u8fed\u4ee3\u65f6\uff0c\u6240\u6709QN\u7b97\u6cd5\u90fd\u662f\u68af\u5ea6\u6cd5\uff0c\u5373\\hat{\\boldsymbol{B}}_{(0)} = \\boldsymbol{I}\uff0c\u7ecf\u8fc7\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u540e\u5f97\u5230\u5411\u91cf\\boldsymbol{s}_0\u548c\\boldsymbol{y}_0\u3002 \u6240\u4ee5\u5e38\u89c4BFGS\u4e2d\\hat{\\boldsymbol{B}}_{1}=\\boldsymbol{I} + \\Delta \\hat{\\boldsymbol{B}}_{0}\uff0c\\Delta \\hat{\\boldsymbol{B}}_{0}\u7684\u6784\u5efa\u53ea\u8003\u8651\u4e86\u62df\u725b\u987f\u6761\u4ef6\\boldsymbol{B}_1 \\boldsymbol{s}_0 = \\boldsymbol{y}_0\u800c\u4e0d\u4fdd\u8bc1\u9ad8\u7cbe\u5ea6\u903c\u8fd1\uff0c \u5982\u679c\u628a\u66f4\u65b0\u516c\u5f0f\u6539\u5199\u4e3a\\hat{\\boldsymbol{B}}_{1}=\\sigma_0 \\boldsymbol{I} + \\Delta \\hat{\\boldsymbol{B}}_{0}\uff0c\u4e14\\sigma_0 \\boldsymbol{I} \\approx \\hat{\\boldsymbol{B}}_{1}\uff0c\u90a3\u5c31\u80fd\u6781\u5927\u63d0\u5347\\hat{\\boldsymbol{B}}_{1}\u7684\u903c\u8fd1\u7cbe\u5ea6\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002 \u6839\u636e\u62df\u725b\u987f\u6761\u4ef6\uff0c\u5728\u7b2ck\u6b21\u8fed\u4ee3\u6709\uff1a  </p>  \\begin{align} &amp; \\hat{\\boldsymbol{B}}_{k} \\boldsymbol{s}_{k-1} = \\boldsymbol{y}_{k-1}   \\\\ &amp; \\Rightarrow \\sigma_k \\boldsymbol{I} \\boldsymbol{s}_{k-1} \\approx \\boldsymbol{y}_{k-1} \\\\ &amp; \\Rightarrow \\boldsymbol{y}_{k-1}^T \\sigma_k  \\boldsymbol{I} \\boldsymbol{s}_{k-1} =  \\sigma_k \\boldsymbol{y}_{k-1}^T \\boldsymbol{s}_{k-1} \\approx \\boldsymbol{y}_{k-1}^T \\boldsymbol{y}_{k-1} \\\\ &amp; \\Rightarrow \\sigma_k \\approx \\frac{\\boldsymbol{y}_{k-1}^T \\boldsymbol{y}_{k-1}} {\\boldsymbol{y}_{k-1}^T \\boldsymbol{s}_{k-1}} \\\\ \\end{align} \\tag{50}\\label{eq50}  <p>\u5bf9\u5f0f\\eqref{eq46}\u548c\\eqref{eq48}\u5728\u6bcf\u6b21\u8fed\u4ee3\u4e2d\u8bbe\u5b9a\\hat{\\boldsymbol{B}}_{k}^{(0)} = \\sigma_k \\boldsymbol{I}\u540e\uff0c\u7531\u4e8e\\sigma_k\u662f\u6807\u91cf\uff0c\u6839\u636eDFP\u3001BFGS\u7b97\u6cd5\u4e2d\u51d1\u51fa\u66f4\u65b0\u516c\u5f0f\u7684\u8fc7\u7a0b\uff08\u89c1\u5f0f\\eqref{eq34}\uff5e\\eqref{eq38}\uff09\uff0c\u6240\u6709\\boldsymbol{a}_{k}\u548c\\boldsymbol{b}_{k}\u7684\u5f62\u5f0f\u4ecd\u53ef\u4fdd\u6301\u4e0d\u53d8\u3002 \u65b0\u7b97\u6cd5\u4fdd\u8bc1\u6bcf\u6b21\u8fed\u4ee3\u7684\u66f4\u65b0\u516c\u5f0f\u90fd\u81ea\u9002\u5e94\u7684\u4ece\u4e00\u4e2a\u903c\u8fd1\u5f53\u524d\u6d77\u585e\u9635\u7684\u6807\u91cf\u9635\u51fa\u53d1\uff0c\u56e0\u6b64\u4e5f\u88ab\u79f0\u4e3a\u81ea\u8c03\u8282\uff08self-scaling\uff09\u7684QN\u66f4\u65b0\u3002  </p> <p>\u5c0f\u8d34\u58eb\uff1a\u7ecf\u5178LBFGS\u5b9e\u73b0\u662f\u5bf9\\boldsymbol{H}\u66f4\u65b0\u7684\uff0c\u6b64\u65f6\u81ea\u8c03\u8282\u6807\u91cf\u4e3a1 / \\sigma_k\u3002\u4f46\u5982\u679c\u6240\u89e3\u95ee\u9898\u5b58\u5728\u66f4\u597d\u7684\u903c\u8fd1\u65b9\u6848\uff0c\u4f60\u53ef\u4ee5\u6bcf\u6b21\u8fed\u4ee3\u8ba1\u7b97\u4e00\u4e2a\u4e3b\u5bf9\u89d2\u5143\u7d20\u5927\u4e8e0\u7684\u5bf9\u89d2\u9635\uff0c\u7528\u6765\u4ee3\u66ff\\hat{\\boldsymbol{B}}_{k}^{(0)}\u6216\\hat{\\boldsymbol{H}}_{k}^{(0)}\u3002 </p>"},{"location":"markdown/optimal_convex_optimis/#5-non-linear-conjugate-gradient-methodnlcg","title":"5. \u975e\u7ebf\u6027\u5171\u8f6d\u68af\u5ea6\u6cd5\uff08Non-linear Conjugate Gradient Method\uff0cNLCG\uff09","text":"<p>\u5728\u524d\u51e0\u8282\u4e2d\uff0c\u4e3a\u4e86\u9002\u5e94\u5927\u89c4\u6a21\u95ee\u9898\uff0c\u6211\u4eec\u4e00\u6b65\u6b65\u4ece\u725b\u987f\u6cd5\u9000\u5316\u5230\u4e86QN\u65b9\u6cd5\uff0c\u6700\u7ec8\u6784\u5efa\u4e86\u53ea\u9700\u8981\u4fdd\u5b58m\u4e2a\u5411\u91cf\u5bf9\u7684LBFGS\u65b9\u6cd5\u3002\u4f46\u8fd8\u5b58\u5728\u4e00\u4e2a\u6781\u9650\u65b9\u5f0f\uff0c\u53ea\u5229\u7528\u5f53\u524d\u68af\u5ea6\u548c\u4e0a\u4e00\u6b21\u6a21\u578b\u4fee\u6b63\u91cf\u4ee5\u5c3d\u91cf\u6539\u5584\u68af\u5ea6\u6cd5\u7684\u6536\u655b\u6548\u7387\u3002 \u5728\u300a\u89e3\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684CG\u548cPCG\u65b9\u6cd5\u300b\u7684\u7b2c2.1\u8282\u4e2d\u6211\u4eec\u8bba\u8ff0\u4e86\u5728\u7ebf\u6027\u4e8c\u6b21\u578b\u4e2d\u5982\u4f55\u4ee5\u4e0b\u964d\u65b9\u5411\\boldsymbol{d}_{k-1}\u548c\u68af\u5ea6\u5411\u91cf\\boldsymbol{g}_k\u6784\u5efa\u9760\u8fd1\u725b\u987f\u6b65\u7684\\boldsymbol{d}_k\uff0c\u5e76\u4e14\u8bc1\u660e\u4e86\u7ebf\u6027CG\u662f\u4e00\u79cd\u5171\u8f6d\u65b9\u5411\u6cd5 \u3002 \u4e5f\u5c31\u662f\u8bf4CG\u4e2d\u4efb\u610f\u4e0d\u7b49\u4e8ek\u7684\u7b2cj\u6b21\u8fed\u4ee3\uff0c\u4e00\u5b9a\u6ee1\u8db3\\boldsymbol{d}_k^T \\boldsymbol{B} \\boldsymbol{d}_j = 0\u3002\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u6d77\u585e\u77e9\u9635\u6ca1\u6709\u4e0b\u6807\uff0c\u56e0\u4e3a\u7ebf\u6027\u4e8c\u6b21\u578b\u7684\u6d77\u585e\u77e9\u9635\u4e0d\u53d8\u3002 \u800cNLCG\u7684\u5b9e\u8d28\u5c31\u662f\u628aCG\u7b97\u6cd5\u201c\u5f3a\u884c\u201d\u63a8\u5e7f\u5230\u975e\u7ebf\u6027\u6700\u5c0f\u5316\u95ee\u9898\u3002\u6211\u4eec\u9996\u5148\u590d\u4e60\u4e00\u4e0b\u7ebf\u6027CG\u7684\u6b65\u957f\u548c\u4e0b\u964d\u65b9\u5411\uff08\u6b64\u65f6\u6b8b\u5dee\u5411\u91cf\\boldsymbol{r}_k= - \\boldsymbol g_k\uff09\uff0c\u5982\u4e0b\uff1a  </p>  \\begin{align} &amp; \\alpha_k = \\frac { - \\boldsymbol g_k^T \\boldsymbol d_k} {\\boldsymbol d_k^T \\boldsymbol B_k \\boldsymbol d_k}             = \\frac { \\boldsymbol r_k^T \\boldsymbol d_k} {\\boldsymbol d_k^T \\boldsymbol B \\boldsymbol d_k} \\\\ &amp; \\boldsymbol d_k = - \\boldsymbol g_k + \\beta_k \\boldsymbol d_{k-1} = \\boldsymbol r_k + \\beta_k \\boldsymbol d_{k-1}  \\\\ &amp; \\beta_k = \\frac { \\boldsymbol g_k^T \\boldsymbol g_k} {\\boldsymbol g_{k-1}^T \\boldsymbol g_{k-1}}            = \\frac { \\boldsymbol r_k^T \\boldsymbol r_k} {\\boldsymbol r_{k-1}^T \\boldsymbol r_{k-1}}  \\\\ \\end{align} \\tag{51}\\label{eq51}  <p>\u6700\u65e9\u7684NLCG\u65b9\u6cd5\u53ef\u80fd\u662f\u7531Fletcher\u548cReeve\u57281964\u5e74\u63d0\u51fa\u7684FR-NLCG\uff0c\u5b83\u7684\u5f62\u5f0f\u57fa\u672c\u548c\u5f0f\\eqref{eq51}\u4e00\u81f4\uff0c\u5982\u4e0b\uff1a  </p>  \\begin{align} &amp; \\alpha_k^{(0)} \\approx \\frac { - \\boldsymbol g_k^T \\boldsymbol d_k} {\\boldsymbol d_k^T \\boldsymbol B_k \\boldsymbol d_k} \\\\ &amp; \\boldsymbol d_k = - \\boldsymbol g_k + \\beta_k \\boldsymbol d_{k-1} \\\\ &amp; \\beta_k^{FR} = \\frac { \\boldsymbol g_k^T \\boldsymbol g_k} {\\boldsymbol g_{k-1}^T \\boldsymbol g_{k-1}} \\\\ \\end{align} \\tag{52}\\label{eq52}  <p>\u5176\u4e2d\uff0c\\alpha_k^{(0)}\u662f\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u7684\u521d\u59cb\u6b65\u957f\uff0c\u9700\u5bf9\\boldsymbol d_k^T \\boldsymbol B_k \\boldsymbol d_k\u8fdb\u884c\u67d0\u79cd\u5feb\u901f\u8fd1\u4f3c\uff08\u56e0\u4e3a\u6211\u4eec\u4e0d\u60f3\u6c42\u6d77\u585e\u77e9\u9635\uff09\u3002\u4f46\u8fd9\u79cd\u66b4\u529b\u7684\u63a8\u5e7f\u662f\u5426\u8fd8\u80fd\u4fdd\u8bc1\u8fed\u4ee3\u7684\u6536\u655b\u6027\u5462\uff1f\u6211\u4eec\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u7ec6\u81f4\u7684\u5206\u6790\uff0c\u4ee5\u5bf9\u6bd4CG\u548cNLCG\u7684\u4e0d\u540c\u3002 \u9996\u5148\uff0c\u8ba8\u8bba\u7b2ck\u6b21\u7cbe\u786e\u7ebf\u641c\u7d22\u8fed\u4ee3\u4ea7\u751f\u7684\u68af\u5ea6\\boldsymbol g_{k+1}\u3002\u5229\u7528\u4e8c\u9636\u6cf0\u52d2\u5c55\u5f00\u5f0f\\eqref{eq11}\u5e76\u5bf9\\boldsymbol m_{k+1}\u6c42\u5bfc\uff0c\u53ef\u5f97\uff1a  </p>  \\begin{align} &amp; \\boldsymbol g_{k+1} = \\frac{\\partial \\Phi(\\boldsymbol m_{k+1}) }{\\partial \\boldsymbol m_{k+1}} = \\boldsymbol g_{k} + \\alpha_k \\boldsymbol B_{k} \\boldsymbol d_{k} \\\\ &amp; \\Rightarrow \\boldsymbol{g}_{k+1}^T \\boldsymbol{d}_{k}      = \\boldsymbol{g}_{k}^T \\boldsymbol{d}_{k} + \\alpha_k \\boldsymbol d_{k}^T \\boldsymbol B_{k} \\boldsymbol d_{k}     = \\frac{\\partial \\Phi(\\boldsymbol m_{k+1}) }{\\partial \\alpha_k} = 0           \\\\ \\end{align} \\tag{53}\\label{eq53}  <p>\u8fd9\u8868\u660e\u5728\u7cbe\u786e\u7ebf\u641c\u7d22\u6761\u4ef6\u4e0bNLCG\u548cCG\u540c\u6837\u90fd\u4fdd\u8bc1\\boldsymbol{g}_{k+1}^T \\boldsymbol{d}_{k} = 0\u3002 \u7ee7\u7eed\u8003\u5bdf\\boldsymbol{g}_{k+1}^T \\boldsymbol{d}_{k+1}\u5982\u4e0b\uff1a  </p>  \\boldsymbol{g}_{k+1}^T \\boldsymbol{d}_{k+1} = - \\boldsymbol{g}_{k+1}^T \\boldsymbol{g}_{k+1} + \\beta_{k+1}^{FR} \\boldsymbol{g}_{k+1}^T \\boldsymbol{d}_{k} \\\\ \\tag{54}\\label{eq54}  <p>\u82e5\u540e\u7eed\u8fed\u4ee3\u6b65\u957f\u5747\u7531\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u5f97\u5230\uff0c\u5219\u4e0d\u80fd\u4fdd\u8bc1\u5f0f\\eqref{eq54}\u53f3\u8fb9\u7b2c\u4e8c\u9879\u4e3a0\uff0c\u6709\u53ef\u80fd\u9020\u6210\u7834\u574f\\boldsymbol{g}_{k+1}^T \\boldsymbol{d}_{k+1} &lt; 0\u7684\u76ee\u6807\u51fd\u6570\u4e0b\u964d\u5fc5\u8981\u6761\u4ef6\u3002\u5e78\u8fd0\u7684\u662f\uff0c\u6570\u5b66\u5bb6\u4eec\u5df2\u7ecf\u8bc1\u660e\u4e86\u53ea\u8981\u6bcf\u6b21\u8fed\u4ee3\u7684\u4e0d\u7cbe\u786e\u7ebf\u641c\u7d22\u6ee1\u8db3Wolfe\u6761\u4ef6\uff0c\u4e0b\u964d\u5fc5\u8981\u6761\u4ef6\u5c31\u53ef\u4ee5\u6210\u7acb\u3002 \u7136\u9e45\uff0c\u5f53\u6211\u4eec\u8003\u5bdfNLCG\u7684\u5171\u8f6d\u6027\u65f6\u51fa\u4e86\u95ee\u9898\u3002 \u5171\u8f6d\u65b9\u5411\u6cd5\u81f3\u5c11\u9700\u8981\u4fdd\u8bc1\\boldsymbol{d}_{k}^T \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1} = 0\uff0c\u628a\u5de6\u8fb9\u5c55\u5f00\u540e\u5f97\u5230\uff1a  </p>  \\boldsymbol{d}_{k}^T \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1} = - \\boldsymbol{g}_{k}^T \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1} + \\beta_k \\boldsymbol{d}_{k-1}^T \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1} \\tag{55}\\label{eq55}  <p>\u663e\u7136\uff0c\u628a\\beta_k^{FR}\u4ee3\u5165\\eqref{eq55}\u4e2d\u5e76\u4e0d\u4fdd\u8bc1\u524d\u540e\u4e24\u6b21\u8fed\u4ee3\u5173\u4e8e\u6d77\u585e\u77e9\u9635\u5171\u8f6d\u3002\u9664\u975e\\beta_k^{Daniel} = \\frac{\\boldsymbol{g}_{k}^T \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1} }{\\boldsymbol{d}_{k-1}^T \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1}}\uff0c \u8fd9\u4e2a\\beta\u503c\u7531Daniel\u57281967\u5e74\u63d0\u51fa\uff0c\u4f46\u5b83\u9700\u8981\u8ba1\u7b97\u6d77\u585e\u77e9\u9635\uff0c\u6240\u4ee5\u5e76\u4e0d\u9002\u7528\u4e8e\u5927\u89c4\u6a21\u95ee\u9898\uff08\u4f60\u90fd\u80fd\u7b97\u6d77\u585e\u4e86\uff0c\u8fd8\u641e\u5565NLCG\uff1f\uff09\u3002\u9000\u4e00\u4e07\u6b65\u8bf4\uff0c\u5373\u4f7f\u4fdd\u8bc1\\eqref{eq55}\u7b49\u4e8e0\uff0c\u7531\u4e8e\u975e\u7ebf\u6027\u95ee\u9898\u7684\u6d77\u585e\u9635\u968f\u8fed\u4ee3\u53d8\u5316\uff0cNLCG\u7684\u4e0b\u964d\u65b9\u5411\u5e76\u4e0d\u6ee1\u8db3\u5171\u8f6d\u65b9\u5411\u6cd5\u4e2d\u201c\u4e0d\u540c\u8fed\u4ee3\u7684\u4e0b\u964d\u65b9\u5411\u4e24\u4e24\u5173\u4e8e\u6d77\u585e\u5171\u8f6d\u201d\u7684\u8981\u6c42\uff08\u548c\u7ebf\u6027CG\u4e0d\u540c\uff09\u3002 \\beta_k^{FR}\u5728\u5b9e\u7528\u4e2d\u6536\u655b\u8f83\u6162\uff0c\\beta_k^{Daniel}\u8ba1\u7b97\u53c8\u592a\u8017\u65f6\uff0c\u56e0\u6b64\u5f88\u591a\u5b66\u8005\u63d0\u51fa\u4e86\u4e0d\u540c\u7684NLCG\u53d8\u79cd\uff0c\u5982\u4e0b\uff1a  </p>  \\begin{align}  \\beta_k^{PRP} &amp;= \\frac{\\boldsymbol{g}_{k}^T (\\boldsymbol{g}_{k} - \\boldsymbol{g}_{k-1} )}{\\boldsymbol{g}_{k-1}^T \\boldsymbol{g}_{k-1}} \\\\  \\beta_k^{SW} &amp;= \\frac{\\boldsymbol{g}_{k}^T (\\boldsymbol{g}_{k} - \\boldsymbol{g}_{k-1} )}{\\boldsymbol{d}_{k-1}^T (\\boldsymbol{g}_{k} - \\boldsymbol{g}_{k-1} )} \\\\  \\beta_k^{Dixon} &amp;= \\frac{\\boldsymbol{g}_{k}^T \\boldsymbol{g}_{k}}{\\boldsymbol{d}_{k-1}^T  \\boldsymbol{g}_{k-1} } \\\\  \\beta_k^{DY} &amp;= \\frac{\\boldsymbol{g}_{k}^T \\boldsymbol{g}_{k}}{\\boldsymbol{d}_{k-1}^T (\\boldsymbol{g}_{k} - \\boldsymbol{g}_{k-1} ) } \\\\ \\end{align} \\tag{56}\\label{eq56}  <p>\u5176\u4e2d\uff0cPRP\u5728\u5730\u7403\u7269\u7406\u4e2d\u8f83\u4e3a\u5e38\u7528\uff0cDY\u5219\u662f\u7531\u6211\u56fd\u5b66\u8005\u8881\u4e9a\u6e58\u63d0\u51fa\u7684\u3002\u4f46\u8fd9\u4e9b\u503c\u4ee3\u5165\u516c\u5f0f\\eqref{eq55}\u91cc\u90fd\u4e0d\u80fd\u4fdd\u8bc1\u5171\u8f6d\u6027\uff08\u5176\u4e2d\\beta_k^{SW}\u5728\u6ee1\u8db3\u62df\u725b\u987f\u6761\u4ef6\u65f6\u5c40\u90e8\u5171\u8f6d\uff0c\u6709\u5174\u8da3\u8bf7\u81ea\u5df1\u63a8\u5bfc\uff09\uff0c\u5b83\u4eec\u4e0d\u53ef\u80fd\u4ece\u672c\u8d28\u4e0a\u89e3\u51b3\u95ee\u9898\u3002</p> <p>\u5c0f\u8d34\u58eb\uff1a\u7ebf\u6027CG\u662f\u4e00\u79cd\u5171\u8f6d\u65b9\u5411\u6cd5\uff0c\u4f46NLCG\u7684\u8bf8\u591a\u53d8\u79cd\u5747\u4e0d\u4fdd\u8bc1\u4e0d\u540c\u8fed\u4ee3\u7684\u4e0b\u964d\u65b9\u5411\u4e92\u76f8\u5173\u4e8e\u67d0\u4e2a\u56fa\u5b9a\\boldsymbol{Q}\u77e9\u9635\u5171\u8f6d\uff0c\u8fd9\u5c31\u662fNLCG\u5931\u53bb\u4e8c\u6b21\u622a\u6b62\u6027\u7684\u672c\u8d28\u539f\u56e0\u3002CG\u662f\u4e00\u79cd\u5171\u8f6d\u65b9\u5411\u6cd5\uff0c\u4f46\u4e25\u8c28\u4e00\u70b9\u6765\u8bf4NLCG\u5e76\u4e0d\u662f\u4e00\u79cd\u5171\u8f6d\u65b9\u5411\u6cd5\u3002 </p> <p>\u65e0\u8bba\u5982\u4f55\uff0cNLCG\u662f\u4e00\u79cd\u6bd4\u68af\u5ea6\u6cd5\u597d\u5f97\u591a\u7684\u7b97\u6cd5\uff0c\u5982\u679c\u4f60\u89c9\u5f97LBFGS\u7684m\u4e2a\u5411\u91cf\u5bf9\u8fd8\u662f\u592a\u5360\u5185\u5b58\uff0c\u90a3NLCG\u53ef\u80fd\u662f\u4f60\u6700\u540e\u7684\u5408\u7406\u9009\u62e9\u3002\u4e0e\u7b2c4.6\u8282\u4ecb\u7ecd\u7684\u60c5\u51b5\u4e00\u6837\uff0c\u4e3a\u5c3d\u91cf\u63d0\u9ad8\u6536\u655b\u6548\u7387\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5f15\u5165\u7c7b\u4f3cself-scaling\u7684\u65b9\u6cd5\u5bf9\u5e38\u89c4NLCG\u8fdb\u884c\u6539\u8fdb\uff0c\u8fd9\u79cd\u6280\u672f\u5728NLCG\u4e2d\u88ab\u79f0\u4e3a\u201c\u9884\u6761\u4ef6\u201d\uff0c\u4e0b\u964d\u65b9\u5411\u53d8\u4e3a\uff1a  </p>   \\boldsymbol{d}_k = - \\hat{\\boldsymbol{H}}_k \\boldsymbol{g}_{k} + \\beta_k \\boldsymbol{d}_{k-1} \\tag{57}\\label{eq57}  <p>\u5176\u4e2d\uff0c\\hat{\\boldsymbol{H}}_k\u662f\u5bf9\u6d77\u585e\u9006\u77e9\u9635\u7684\u67d0\u4e2a\u9ad8\u6548\u8fd1\u4f3c\u3002\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528LBFGS\u6765\u5b9e\u73b0\u9884\u6761\u4ef6\uff0c\u4f46\u8fd9\u79cdNLCG\u7684\u5b9e\u9645\u6536\u655b\u6548\u7387\u53ef\u80fd\u548cLBFGS\u76f8\u5f53\uff0c\u4f46\u5374\u5931\u53bb\u4e86QN\u65b9\u6cd5\u7ebf\u641c\u7d22\u521d\u59cb\u6b65\u957f\u53ef\u8bbe\u5b9a\u4e3a1\u7684\u826f\u597d\u7279\u6027\u3002  </p>"},{"location":"markdown/optimal_convex_optimis/#_1","title":"\u603b\u7ed3","text":"<p>\u6211\u4eec\u4ecb\u7ecd\u4e86\u51e0\u4e4e\u6240\u6709\u7684\u7ecf\u5178\u975e\u7ebf\u6027\u51f8\u4f18\u5316\u65b9\u6cd5\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u662f\u4ece\u6cf0\u52d2\u516c\u5f0f\u5f00\u59cb\u7684\uff0c\u6240\u4ee5\u8bf4\u6cf0\u52d2\u516c\u5f0f\u5f88\u725b\u903c\u3002 \u5982\u679c\u76ee\u6807\u51fd\u6570\u548c\u521d\u59cb\u70b9\u4e00\u6837\uff0c\u90a3\u4e48\u4ee5\u4e0a\u6240\u6709\u65b9\u6cd5\u7406\u8bba\u4e0a\u4f1a\u627e\u5230\u540c\u6837\u7684\u5c40\u90e8\u6781\u5c0f\u70b9\uff08\u5bf9\u4e8e\u6709\u4e9b\u95ee\u9898\uff0c\u53ef\u80fd\u4e0d\u7a33\u5b9a\u7684\u7b97\u6cd5\u4f1a\u8fed\u4ee3\u5931\u8d25\uff09\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u4e0d\u8003\u8651\u8ba1\u7b97\u65f6\u95f4\uff0c\u5bf9\u4e8e\u540c\u6837\u7684\u76ee\u6807\u51fd\u6570\uff0c\u65e0\u7ea6\u675f\u53cd\u6f14\u7684\u7ed3\u679c\u4e0d\u7531\u53cd\u6f14\u65b9\u6cd5\u51b3\u5b9a\u3002 \u6709\u65f6\u5019\u4f60\u4f1a\u5728\u8bba\u6587\u4e2d\u770b\u5230\u67d0\u4e2a\u7b97\u6cd5\u201c\u5177\u6709\u5168\u5c40\u6536\u655b\u6027\u201d\uff0c\u8fd9\u5e76\u4e0d\u662f\u8bf4\u5b83\u80fd\u6536\u655b\u5230\u5168\u5c40\u6781\u5c0f\uff0c\u800c\u662f\u5b83\u5bf9\u4e8e\u4efb\u610f\u521d\u59cb\u70b9\u90fd\u80fd\u4ea7\u751f\u4e00\u4e2a\u6536\u655b\u7684\u8fed\u4ee3\u70b9\u5217\uff0c\u548c\u5168\u5c40\u6781\u5c0f\u5b8c\u5168\u662f\u4e24\u7801\u4e8b\uff08\u624b\u52a8\u644a\u624b\uff09\uff01\uff01\uff01 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u7ecf\u5178\u51f8\u4f18\u5316\u7b97\u6cd5\u6309\u7167\u6536\u655b\u6548\u7387\uff08\u6307\u8fed\u4ee3\u591a\u5c11\u6b21\u6536\u655b\uff09\u7531\u6162\u5230\u5feb\u7684\u6392\u5e8f\u662f\uff1a\u68af\u5ea6\u6cd5\u3001NLCG\u3001LBFGS\u3001BFGS\u3001GN\u3001\u725b\u987f\u6cd5\u3002\u6309\u5185\u5b58\u9700\u6c42\u548c\u5355\u6b21\u8fed\u4ee3\u8ba1\u7b97\u65f6\u95f4\u7684\u6392\u5e8f\u5219\u521a\u597d\u76f8\u53cd\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u5b9e\u9645\u95ee\u9898\uff0c\u603b\u6536\u655b\u65f6\u95f4\u4e0d\u4e00\u5b9a\u8c01\u5feb\u8c01\u6162\u3002\u4f46\u7efc\u5408\u8861\u91cf\u4e00\u822cNLCG\u548cLBFGS\u4f1a\u662f\u6700\u7701\u65f6\u3001\u7701\u5185\u5b58\u7684\u9009\u62e9\u3002 \u66fe\u7ecf\u4e0d\u77e5\u9053\u54ea\u4f4d\u5ba1\u7a3f\u4eba\u975e\u8981\u6559\u80b2\u6211\uff0c\u8bf4QN\u65b9\u6cd5\u662f\u5171\u8f6d\u65b9\u5411\u6cd5\u3002\u6211\u641c\u7d22\u4e86\u4e00\u4e0b\uff0c\u597d\u50cf\u8fd9\u4e2a\u63d0\u6cd5\u6765\u81ea\u4e8e\u300a\u6700\u4f18\u5316\u5bfc\u8bba\uff08An introduction to optimization\uff09\u300b\u3002\u8bc1\u660e\u5982\u4e0b\uff1a  </p>  \\begin{align}  \\boldsymbol{d}_{k}^T \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1}      &amp;= - \\boldsymbol{g}_{k}^T \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{B}_{k} \\boldsymbol{d}_{k-1} \\\\     &amp;= - \\boldsymbol{g}_{k}^T \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{B}_{k} \\boldsymbol{s}_{k-1} / \\alpha_{k-1} \\\\     &amp;= - \\boldsymbol{g}_{k}^T \\hat{\\boldsymbol{H}}_{k} \\boldsymbol{y}_{k-1} / \\alpha_{k-1} \\\\     &amp;= - \\boldsymbol{g}_{k}^T \\boldsymbol{s}_{k-1} / \\alpha_{k-1} \\\\     &amp;= - \\boldsymbol{g}_{k}^T \\boldsymbol{d}_{k-1} = 0 \\\\ \\end{align}  <p>\u4f46\u8fd9\u53ea\u8868\u660eQN\u65b9\u6cd5\u56e0\u4e3a\u8981\u6ee1\u8db3\u5f0f\\eqref{eq27}\u7684\u62df\u725b\u987f\u6761\u4ef6\uff0c\u6240\u6784\u5efa\u7684\u76f8\u90bb\u4e24\u6b21\u8fed\u4ee3\u4e0b\u964d\u65b9\u5411\u5173\u4e8e\u5f53\u524d\u6d77\u585e\u77e9\u9635\u5171\u8f6d\uff08\u6bd4NLCG\u66f4\u5171\u8f6d\uff0c\u86e4\u86e4\uff01\uff09\u3002 \u539f\u6587\u662f\u7528\u7ebf\u6027\u4e8c\u6b21\u578b\u95ee\u9898\u6765\u63a8\u5bfc\uff0c\u89c4\u5b9a\u4e86\\boldsymbol{B}_{k} \\equiv \\boldsymbol{Q}\uff0c\u8fdb\u800c\u53ef\u63a8\u51fa\u5bf9\u4efb\u610f\u4e0d\u7b49\u4e8ek\u7684\u8fed\u4ee3j\uff0c\u90fd\u5b58\u5728\\boldsymbol{d}_{k}^T \\boldsymbol{Q} \\boldsymbol{d}_{j} = 0\uff0c\u5e76\u58f0\u79f0\u201cQN\u672c\u8d28\u4e0a\u662f\u5171\u8f6d\u65b9\u5411\u6cd5\u201d\u3002 \u4f46\u5f88\u9057\u61be(\u65e5\u8bed\u597d\u50cf\u662f\u201c\u6b8b\u5ff5Da\u201d)\uff0c\u5bf9\u4e8e\u975e\u7ebf\u6027\u95ee\u9898\u8fd9\u4e00\u70b9\u5e76\u4e0d\u6210\u7acb\u3002 \u5982\u679c\u4f60\u575a\u6301QN\u662f\u4e00\u79cd\u5171\u8f6d\u65b9\u5411\u6cd5\uff0c\u90a3\u4f60\u90fd\u5bf9\u3002\uff1a\uff09\u6bd5\u7adf\u5728\u7b2c5\u8282\u6211\u4eec\u5df2\u7ecf\u8bc1\u660e\u4e86\u5927\u90e8\u5206NLCG\u90fd\u4e0d\u5171\u8f6d\uff0c\u90a3\u4e48\u5c31\u53ea\u597d\u8ba9QN\u6765\u5171\u8f6d\u4e86\u3002\u5171\u8f6d\u4e07\u5c81\uff0cOh Yeah\uff01\uff01\uff01 </p> <p>\u6700\u540e\uff0c\u6211\u4eec\u6ca1\u6709\u7ed9\u51fa\u5404\u4e2a\u7b97\u6cd5\u7684\u4f2a\u4ee3\u7801\u6216\u6d41\u7a0b\u56fe\uff0c\u56e0\u4e3a\u90a3\u5f88Obvious\uff08\u72d7\u5934\u4fdd\u547d\uff09\u3002</p>"},{"location":"markdown/spectial-relativity-throw-balls/","title":"\u72ed\u4e49\u76f8\u5bf9\u8bba\u7684\u5c0f\u7403\u2014\u2014\u603b\u6709\u4eba\u778e\u79d1\u666e","text":"<p>\u7eaf\u7cb9\u662f\u60f3\u5410\u4e2a\u69fd\uff0c\u81ea\u4ece\u67d0\u4e4e\u51fa\u73b0\uff0c\u662f\u4eba\u662f\u9b3c\u4e5f\u559c\u6b22\u5230\u5904\u201c\u79d1\u666e\u201d\u4e86\u3002\u4e5f\u4e0d\u77e5\u9053\u7f51\u4e0a\u54ea\u91cc\u8fd9\u4e48\u591a\u4ee5\u5f18\u626c\u79d1\u5b66\u4e3a\u5df1\u4efb\u52a8\u4e0d\u52a8\u8981\u7ed9\u4eba\u5f00\u6167\u6839\u7684\u5723\u8d24\uff0c\u8d34\u51fa\u5404\u79cd\u201c\u5341\u5206\u949f\u5b66\u4f1aMaxwell\u65b9\u7a0b\u7ec4\u201d\u3001\u201c\u4e8c\u5341\u4e00\u5929\u5b66\u4f1aC++\u201d\u7684\u6d1b\u9633\u8d35\u7eb8\uff0c\u4e0b\u9762\u8fd8\u8ddf\u7740\u4e00\u7fa4\u201c\u4e0d\u660e\u89c9\u5389\u201d\u3001\u201c\u697c\u4e3b\u89e3\u51b3\u6211\u4eba\u751f\u6700\u5927\u7591\u60d1\u201d\u7684\u5ec9\u4ef7\u9a6c\u5c41\u3002\u5982\u679c\u8bf4\u5730\u7403\u7269\u7406\u3001\u5730\u9707\u5b66\u8fd9\u79cd\u5c0f\u4f17\u4e13\u4e1a\u778e\u5ffd\u60a0\u4e5f\u65e0\u4f24\u5927\u96c5\uff0c\u53ef\u662f\u201c\u67d0\u4e4e\u8fbe\u4eba\u201d\u4eec\u975e\u8981\u52a8\u4e0d\u52a8\u5411\u7406\u8bba\u7269\u7406\u5f00\u5200\u3002\u800c\u81ea\u7136\u7684\uff0c\u4e3a\u4e86\u6ee1\u8db3\u201c\u7406\u8bba\u5bb6\u201d\u6784\u5efa\u4e16\u754c\u7684\u4f1f\u5927\u6784\u60f3\uff0c\u4f60\u4e0d\u5bf9\u76f8\u5bf9\u8bba\u3001\u91cf\u5b50\u529b\u5b66\u3001\u5f26\u8bba\u8fd9\u79cd\u4e1c\u897f\u201c\u79d1\u666e\u201d\u90fd\u4e0d\u597d\u610f\u601d\u8bf4\u81ea\u5df1\u5b66\u5bcc\u4e94\u8f66\u3002\u6bd4\u5982\u67d0\u6c38\u4e50\u8001\u5e08\uff0c\u5728\u67d0\u7834\u7ad9\u8bb2\u72ed\u76f8\u3001\u5e7f\u76f8\u88ab\u90ed\u5a01\u8001\u5e08\u6252\u5f97\u88e4\u8869\u90fd\u4e0d\u5269\u4e86\uff0c\u5374\u8fd8\u662f\u6b7b\u4e0d\u8ba4\u9519\u7ee7\u7eed\u8bef\u4eba\u5b50\u5f1f\u3002 \u672c\u6765\u8fd9\u4e9b\u4e1c\u897f\u4e0d\u559c\u6b22\u5c31\u4e0d\u770b\uff0c\u4f46\u7b80\u4e2d\u7279\u4f9b\u7684\u201c\u5185\u5bb9\u63a8\u8350\u201d\u786c\u662f\u975e\u903c\u7740\u4f60\u770b\u4e0d\u53ef\u3002\u6211\u5c31\u662f\u624b\u8d31\u5728\u767e\u5ea6\u67e5\u4e86\u4e00\u4e0b\u4e0d\u540c\u4ecb\u8d28\u7684\u7535\u78c1\u6ce2\u901f\u5ea6\uff0c\u7136\u540e\u624b\u4e00\u6ed1\u5c31\u70b9\u5230\u67d0\u4e4e\u4e00\u7bc7\u201c\u79d1\u666e\u5927\u4f5c\u201d\u3002\u6211\u53d1\u8a93\uff0c\u6211\u5c31\u626b\u4e86\u4e00\u773c\uff0c\u53ea\u4e00\u773c\u3002\u5a18\u5e0c\u76ae\u7684\u5c31\u5c34\u5c2c\u4e86\u3002\u4ee5\u4e0b\u4e3a\u622a\u56fe\uff1a  </p> \u56fe1 \u67d0\u4e4e\u79d1\u666e\u5927\u4f5c\u622a\u56fe"},{"location":"markdown/spectial-relativity-throw-balls/#1","title":"1. \u5c34\u5c2c\u4e4b\u5c34\u5c2c","text":"<p>\u56fe1\u7684\u5927\u610f\u662f\u60f3\u8bf4\u660e\u201c\u5982\u679c\u4e0d\u627f\u8ba4\u72ed\u4e49\u76f8\u5bf9\u8bba\u7684\u5149\u901f\u4e0d\u53d8\u539f\u7406\uff0c\u5219\u4f1a\u7834\u574f\u56e0\u679c\u6027\u3002\u201d\uff0c\u597d\u50cf\u8fd9\u4e2a\u56fe\u662f\u67d0\u5ea6\u6587\u5e93\u67d0\u9ad8\u6821\u5927\u5b66\u7269\u7406\u72ed\u76f8\u8bfe\u4ef6ppt\u7684\u4e00\u9875\u3002\u522b\u7684\u4e14\u4e0d\u8bf4\uff0c\u5982\u679c\u54ea\u4e2a\u8001\u5e08\u7528\u8fd9\u4e2appt\u6765\u53cd\u8bc1\u201c\u5149\u901f\u4e0d\u53c2\u4e0e\u901f\u5ea6\u5408\u6210\u201d\u7684\u8bdd\uff0c\u90a3\u4ed6\u4e00\u5b9a\u5f97\u91cd\u65b0\u5c48\u5c0a\u518d\u56de\u7089\u6df1\u9020\u4e00\u5e74\u5927\u5b66\u7269\u7406\u3002 \u6211\u8fd9\u4e48\u8bf4\u662f\u6709\u8bc1\u636e\u7684\uff0c\u6309\u7167\u6b64\u56fe\u89c2\u70b9\uff0c\u5728\u725b\u987f\u7edd\u5bf9\u65f6\u7a7a\u89c2\u4e0b\uff0c\u4ee5\u5c0f\u7403\u7403\u9762\u4e0a\u7684\u5149\u5b50\u521a\u521a\u53cd\u5c04\u7684\u65f6\u523b\u4e3a0\uff0c\u90a3\u4e48\u7403\u5728\u672a\u6295\u51fa\u524d\uff0c\u5149\u5b50\u82b1\u4e86t_0=d/c\u7684\u65f6\u95f4\u5230\u4ed6\u773c\u775b\u91cc\u3002\u6211\u4eec\u7b80\u5316\u70b9\u8bf4\u5c31\u662f\uff1a\u201c\u5c0f\u7403\u521a\u88ab\u6295\u51fa\u4e4b\u524d\u201d\u8fd9\u4e00\u4e8b\u4ef6\uff08\u4e0d\u59a8\u53eb\u56e0\u4e8b\u4ef6\uff09\u7684\u5230\u65f6\u4e3at_0\u3002 \u5982\u679c\u5149\u901f\u53c2\u4e0e\u901f\u5ea6\u5408\u6210\uff0c\u5f53\u5c0f\u7403\u6709\u4e86\u521d\u901f\u5ea6v\u4e4b\u540e\uff0c\u6b64\u65f6\u8ddd\u79bb\u6ca1\u53d8\uff0c\u5149\u5b50\u901f\u5ea6\u53d8\u6210\u4e86c+v\uff0c\u6545\u7403\u88ab\u6295\u51fa\u7684\u970e\u90a3\uff0c\u201c\u6295\u51fa\u77ac\u95f4\u201d\u8fd9\u4e00\u4e8b\u4ef6\uff08\u679c\u4e8b\u4ef6\uff09\u7684\u5230\u65f6\u4e3at_1=d/(c+v)\u3002\u663e\u7136t_0&gt;t_1\uff0c\u8fd9\u9020\u6210\u4e86\u201c\u56e0\u4e8b\u4ef6\u201d\u51fa\u73b0\u5728\u201c\u679c\u4e8b\u4ef6\u201d\u4e4b\u540e\u7684\u6096\u8bba\u3002\u6240\u4ee5\u5149\u901f\u4e0d\u80fd\u53c2\u4e0e\u901f\u5ea6\u5408\u6210\u3002  </p> <p>\u4f46\u662f\uff0c\u771f\u7684\u662f\u8fd9\u6837\u7684\u5417\uff1f </p> <p>\u5f88\u663e\u7136\uff0c\u5373\u4f7f\u4e0d\u8003\u8651\u5c0f\u7403\u52a0\u901f\u7b49\u95ee\u9898\uff0c\u5047\u8bbe\u4ed6\u7684\u8ba1\u7b97\u90fd\u662f\u6b63\u786e\u7684\uff0ct_0 &gt; t_1\u53ea\u8bc1\u660e\u4e86\u201c\u5149\u901f\u53c2\u4e0e\u5408\u6210\u4e0d\u5bf9\u201d\uff0c\u4f46\u5e76\u6ca1\u6709\u8bc1\u660e\u201c\u5149\u901f\u4e0d\u53c2\u4e0e\u5408\u6210\u5c31\u5bf9\u201d\u3002\u5982\u679c\u6309\u7167\u8fd9\u7bc7\u79d1\u666e\u96c4\u4f5c\u7684\u601d\u7ef4\u65b9\u6cd5\uff0c\u90a3\u4e48t_1=d/c\uff0c\u6b64\u65f6t_0=t_1\uff0c\u4e5f\u5c31\u662f\u8bf4\u56e0\u679c\u540c\u65f6\u53d1\u751f\uff0c\u8fd9\u4ecd\u7136\u662f\u6096\u8bba\u3002\u5c34\u5c2c\u4e0d\uff1f\u7136\u800c\u66f4\u5c34\u5c2c\u7684\u662f\uff0c\u5f53\u5c0f\u7403\u51fa\u624b\u7684\u90a3\u4e00\u970e\u90a3\uff0c\u5373\u4f7f\u5728\u725b\u987f\u529b\u5b66\u6846\u67b6\u4e0b\uff0c\u53ea\u8981\u5b66\u8fc7\u5927\u5b66\u7269\u7406\u7684\u90fd\u77e5\u9053t_1\u4e00\u5b9a\u4e0d\u662fd/(c+v)\u3002\u56e0\u4e3a\u56e0\u4e8b\u4ef6\u548c\u679c\u4e8b\u4ef6\u4e0b\u7684\u8def\u7a0bd\u662f\u4e0d\u76f8\u7b49\u7684\uff0c\u800c\u662f \u5f53\u65f6\u95f4\u5dee\u8d8b\u5411\u4e8e0\u65f6\uff0c\u679c\u4e8b\u4ef6\u5149\u5b50\u8d70\u8fc7\u7684\u8def\u7a0b\u6781\u9650\u662fd\u3002 </p>"},{"location":"markdown/spectial-relativity-throw-balls/#2","title":"2. \u76f8\u5bf9\u8bba\u65f6\u7a7a\u89c2\u4e0b\u7684\u6b63\u89e3","text":"<p>\u6211\u4eec\u59d1\u4e14\u8ba4\u4e3a\u79d1\u666e\u5927\u795e\u7684\u795e\u8bba\u80fd\u591f\u8bc1\u660e\u5149\u901f\u4e0d\u53c2\u4e0e\u901f\u5ea6\u5408\u6210\uff0c\u770b\u770b\u6b63\u786e\u7684\u89e3\u6cd5\u662f\u4ec0\u4e48\u6837\u7684\uff0c\u7531\u4e8e\u56fe1\u53ea\u914d\u7ed9\u5a03\u5a03\u89e3\u91ca\uff0c\u6211\u91cd\u65b0\u753b\u4e86\u4e2a\u56fe\uff1a  </p>      \u56fe2 \u91cd\u65b0\u4e0d\u7cbe\u786e\u7684\u753b\u4e00\u4e2a\u56fe <p>\u56fe2\u5fc5\u987b\u5f15\u5165\u725b\u7235\u7237\u7684\u60f3\u6cd5\uff0c\u5c0f\u7403\u5728\u51fa\u624b\u540e\u8d70\u4e86\u4e00\u4e2a\u975e\u5e38\u975e\u5e38\u5c0f\u7684\u65f6\u95f4dt\uff0c\u5176\u8d70\u8fc7\u7684\u8def\u7a0b\u662fvdt\u3002\u81ea\u7136\uff0c\u5728\u51fa\u624b\u4e4b\u524d\uff0c\u201c\u56e0\u4e8b\u4ef6\u201d\u7684\u5230\u65f6\u4ecd\u7136\u662ft_0=d/c\uff0c\u800c\u201c\u679c\u4e8b\u4ef6\u201d\u7684\u5230\u65f6\u5e94\u8be5\u662f\u7ecf\u8fc7dt\u65f6\u95f4\u4e4b\u540e\u5c0f\u7403\u53cd\u5c04\u7684\u5149\u5b50\u8d70\u65f6\uff0c\u5373:  </p>  t_1=dt + \\frac{d-vdt}{c}  <p>\u81f3\u4e8e\u5230\u5e95dt\u8fd9\u4e2a\u975e\u5e38\u975e\u5e38\u5c0f\u5230\u5e95\u662f\u591a\u5c0f\u7684\u95ee\u9898\uff0c\u725b\u7235\u7237\u6ca1\u89e3\u91ca\u6e05\u695a\uff0c\u76f4\u63a5\u5bfc\u81f4\u7b2c\u4e8c\u6b21\u6570\u5b66\u5371\u673a\uff0c\u4e00\u76f4\u5230\u5fae\u79ef\u5206\u63d0\u51fa\u8fd1100\u5e74\u540e\u67ef\u897f\u7b49\u4eba\u624d\u5f97\u4ee5\u89e3\u51b3\uff0c\u8fd9\u662f\u7279\u522b\u6709\u8da3\u7684\u4e00\u6bb5\u6570\u5b66\u53f2\u3002\u6240\u4ee5\u6211\u4f30\u8ba1\u79d1\u666e\u5927\u795e\u5e94\u8be5\u662f\u89c9\u5f97\u72ed\u4e49\u76f8\u5bf9\u8bba\u7528\u9ad8\u4e2d\u51e0\u4f55\u77e5\u8bc6\u5c31\u8db3\u591f\u4e86\u7684\uff0c\u8bdd\u8bf4\u56de\u6765\uff0c\u8c8c\u4f3c\u8fd1\u5e74\u6765\u9ad8\u4e2d\u7269\u7406\u5728\u5f00\u76f8\u5bf9\u8bba\u5185\u5bb9\uff0c\u6211\u4e0d\u7981\u6253\u4e86\u4e2a\u5bd2\u5664\u3002 \u597d\u4e86\uff0c\u65e2\u7136t_0\u548ct_1\u90fd\u6709\u4e86\uff0c\u8981\u4fdd\u6301\u201c\u56e0\u5728\u679c\u524d\u201d\u7684\u56e0\u679c\u5f8b\uff0c\u5fc5\u7136\u8981\u6c42t_0 &lt; t_1\uff0c\u5373t_1-t_0&gt;0\uff0c\u6211\u4eec\u6765\u770b\u770b\u662f\u4e0d\u662f\u8fd9\u6837\uff1a  </p>  \\begin{align}   t_1-t_0       &amp;= dt + \\frac{d-vdt}{c} - t_0 \\\\         &amp;= dt + \\frac{d-vdt}{c} - \\frac{d}{c}\\\\               &amp;= dt - \\frac{vdt}{c} + \\frac{d}{c} - \\frac{d}{c}\\\\               &amp;= (1-\\frac{v}{c})dt \\end{align}   <p>\u5f88\u660e\u663e\uff0c\u53ea\u8981\u5c0f\u7403\u4e0d\u8d85\u5149\u901f\uff0c\u5373v &lt; c\uff0c\u5219\u56e0\u679c\u5f8b\u4e0d\u4f1a\u88ab\u7834\u574f\u3002\u8fd9\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u56fe2\u7684\u7cfb\u7edf\u4e2d\uff0c\u5982\u679c\u6ee1\u8db3\u76f8\u5bf9\u8bba\u7684\u5149\u901f\u5047\u8bbe\uff0c\u90a3\u4e48\u5c0f\u7403\u4e0d\u5141\u8bb8\u8d85\u8fc7\u5149\u901f\uff0c\u7b49\u4e8e\u5149\u901f\u4e5f\u4e0d\u884c\u3002 \u4f46\u662f\uff0c\u4ec5\u8bba\u8bc1\u8fd9\u4e48\u591a\u662f\u4e0d\u591f\u7684\uff0c\u5b8c\u6574\u7684\u903b\u8f91\u94fe\u8fd8\u5fc5\u987b\u8003\u8651\u725b\u987f\u7edd\u5bf9\u65f6\u7a7a\u4e0b\u7684\u60c5\u51b5\uff1f\u79d1\u666e\u5927\u795e\u5426\u4e86\u725b\u7235\u7237\u5374\u540c\u6837\u5426\u4e86\u7231\u8001\u7239\uff0c\u6211\u53ef\u6ca1\u90a3\u4e2a\u80c6\u5b50\u3002    </p>"},{"location":"markdown/spectial-relativity-throw-balls/#3","title":"3. \u725b\u987f\u65f6\u7a7a\u89c2\u4e0b\u7684\u6b63\u89e3","text":"<p>\u5f88\u81ea\u7136\u7684\uff0c\u5728\u725b\u987f\u65f6\u7a7a\u4e0b\uff0c\u201c\u679c\u4e8b\u4ef6\u201d\u5149\u5b50\u884c\u8d70d-vdt\u8ddd\u79bb\u7684\u901f\u5ea6\u4e0d\u518d\u662fc\uff0c\u800c\u662fc+v\u3002t_0\u4ecd\u7136\u4e0d\u53d8\uff0c\u800ct_1\u7684\u8868\u8fbe\u5f0f\u4e3a:  </p>  t_1=dt + \\frac{d-vdt}{c+v}  <p>\u6b64\u65f6\u9a8c\u8bc1\u56e0\u679c\u5f8b\u7a0d\u5fae\u9ebb\u70e6\u4e00\u4e22\u4e22\uff0c\u5982\u4e0b\uff1a  </p>  \\begin{align}   t_1-t_0       &amp;= dt + \\frac{d-vdt}{c+v} - t_0 \\\\         &amp;= \\frac{dt(c+v)}{c+v} + \\frac{d-vdt}{c+v} - \\frac{t_0(c+v)}{c+v}\\\\               &amp;= \\frac{cdt+vdt+d-vdt-t_0c-t_0v}{c+v}  \\\\               &amp;= \\frac{cdt+d-d-t_0v}{c+v}  \\\\       &amp;= \\frac{cdt-t_0v}{c+v} \\end{align}   <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5fc5\u987b\u5f53cdt &gt; t_0 v\uff0c\u5373dt &gt; vd/c^2\u65f6\uff0ct_1 &gt; t_0\u8fd9\u4e00\u56e0\u679c\u5f8b\u624d\u4f1a\u6210\u7acb\u3002 \u8fd9\u663e\u7136\u4e0edt\u8fd9\u4e2a\u65e0\u7a77\u5c0f\u672c\u8eab\u77db\u76fe\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u5149\u901f\u80fd\u591f\u53c2\u4e0e\u901f\u5ea6\u5408\u6210\uff0c\u5219\u5f53\u5c0f\u7403\u521a\u51fa\u624b\u4e00\u76f4\u5230vd/c^2\u8fd9\u6bb5\u65f6\u95f4\u5185\uff0c\u56e0\u679c\u5f8b\u88ab\u7834\u574f\u2014\u2014\u4f60\u4f1a\u5148\u770b\u5230\u7403\u79bb\u4e86\u624b\uff0c\u540e\u770b\u89c1\u7403\u6ca1\u79bb\u624b\u3002  </p> <p>\u90a3\u4e48\u8bf4\u4e86\u534a\u5929\uff0c\u540c\u6837\u6211\u548c\u79d1\u666e\u5927\u795e\u90fd\u627f\u8ba4\u5149\u901f\u4e0d\u53d8\u539f\u7406\uff0c\u5dee\u522b\u5728\u54ea\u91cc\u5462\uff1f\u5f88\u660e\u663e\uff1a 1.\u6309\u7167\u5927\u795e\u7684\u63a8\u5bfc\uff0c\u627f\u8ba4\u5149\u901f\u4e0d\u53d8\u539f\u7406\u65f6\uff0c\u56e0\u679c\u540c\u65f6\u53d1\u751f\u3002\u5927\u795e\u8ba4\u4e3a\u53ea\u8981\u4e0d\u662f\u5c0f\u4e8e\u5c31\u4e00\u5b9a\u662f\u5927\u4e8e\u3002 2.\u6309\u7167\u5927\u795e\u7684\u63a8\u5bfc\uff0c\u725b\u987f\u65f6\u7a7a\u4e0b\uff0c\u5c0f\u7403\u5728\u6240\u6709\u8fd0\u884c\u671f\u90fd\u662f\u53cd\u56e0\u679c\u5f8b\u7684\u3002\u4f46\u5b9e\u9645\u4e0a\u628adt\u66ff\u6362\u4e3a\\Delta t\u540e\uff0c\u6211\u4eec\u77e5\u9053\u725b\u987f\u65f6\u7a7a\u5728\\Delta t \\in [0,vd/c^2]\u65f6\u56e0\u679c\u5f8b\u88ab\u7834\u574f\uff0c\u800c\u5e76\u4e0d\u610f\u5473\u7740\\Delta t \\in (vd/c^2, d/v)\u65f6\u56e0\u679c\u5f8b\u88ab\u7834\u574f\u3002</p>"},{"location":"markdown/spectial-relativity-throw-balls/#4","title":"4. \u603b\u7ed3","text":"<p>\u867d\u7136\u4e8b\u5b9e\u7684\u7ed3\u8bba\u76f8\u540c\uff0c\u4f46\u8bba\u8bc1\u8fc7\u7a0b\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u5f88\u591a\u79d1\u666e\u5927\u795e\u662f\u5148\u77e5\u9053\u72ed\u4e49\u76f8\u5bf9\u8bba\u662f\u6b63\u786e\u7684\uff0c\u7136\u540e\u60f3\u51fa\u5404\u79cd\u4f3c\u662f\u800c\u975e\u7684\u8bc1\u660e\u65b9\u6cd5\u6765\u51d1\u51fa\u6240\u8c13\u7684\u201c\u6096\u8bba\u201d\u3002 \u7136\u800c\u5f88\u591a\u505a\u5730\u7403\u7269\u7406\u53cd\u6f14\u548c\u52a8\u529b\u5b66\u89e3\u91ca\u7684\u96be\u9053\u4e0d\u662f\u5982\u6b64\u4e48\uff1f\u5f04\u4e2a\u7b97\u6cd5\uff0c\u641e\u4e2a\u7406\u8bba\u6570\u636e\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u201c\u5f88\u597d\u201d\u7684\u521d\u59cb\u6a21\u578b\uff0c\u7136\u540e\u7ed3\u679c\u5f88\u597d\uff0c\u7136\u540e\u6240\u4ee5\u7b97\u6cd5\u6709\u6548\uff1b\u6216\u8005\u8bbe\u5b9a\u4e00\u4e2a\u6e29\u5ea6\u3001\u538b\u529b\u3001\u542b\u6c34\u91cf\uff0c\u4e00\u7b97\uff0c\u90e8\u5206\u7194\u878d\u3002 \u641eAI\u53cd\u6f14\u7684\u4e5f\u662f\uff0c\u5728\u7406\u8bba\u6a21\u578b\u4e0a\u52a0\u968f\u673a\u6570\u751f\u6210\u8bad\u7ec3\u96c6\uff0c\u7136\u540e\u8bf4AI\u53cd\u6f14\u6bd4\u5e38\u89c4\u53cd\u6f14\u6548\u679c\u597d\uff0c\u5206\u8fa8\u7387\u9ad8\uff0c\u4e91\u4e91\u3002 \u8bc1\u5b9e\u5f88\u5bb9\u6613\uff0c\u8bc1\u4f2a\u66f4\u91cd\u8981\uff0c\u201c\u4e0e\u6216\u662f\u975e\u201d\u7684\u903b\u8f91\u57fa\u7840\u624d\u662f\u6839\u513f\u3002  </p>"}]}